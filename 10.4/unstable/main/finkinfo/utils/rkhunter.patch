--- rkhunter.orig/installer.sh	2008-02-27 16:59:22.000000000 +0100
+++ rkhunter.new/installer.sh	2008-06-10 12:52:29.000000000 +0200
@@ -1,4 +1,4 @@
-#!/bin/sh
+#!/bin/bash
 
 ################################################################################
 #
@@ -53,12 +53,13 @@
 fi
 
 case "${OPERATING_SYSTEM}" in
-AIX|OpenBSD|SunOS|IRIX*)
+AIX|OpenBSD|SunOS|IRIX*|Darwin)
 	# What is the default shell?
 	if print >/dev/null 2>&1; then
 		alias echo='print'
 		ECHOOPT="--"
-	elif [ "${OPERATING_SYSTEM}" = "IRIX" -o "${OPERATING_SYSTEM}" = "IRIX64" ]; then
+	elif [ "${OPERATING_SYSTEM}" = "IRIX" -o "${OPERATING_SYSTEM}" = "IRIX64" \
+		-o "${OPERATING_SYSTEM}" = "Darwin" ]; then
 		ECHOOPT=""
 	else
 		ECHOOPT="-e"
--- rkhunter.orig/files/rkhunter	2008-02-27 16:59:22.000000000 +0100
+++ rkhunter.new/files/rkhunter		2008-06-10 12:54:47.000000000 +0200
@@ -76,13 +76,14 @@
 fi
 
 case "${OPERATING_SYSTEM}" in
-AIX|OpenBSD|SunOS|IRIX*)
+AIX|OpenBSD|SunOS|IRIX*|Darwin)
 	# What is the default shell?
 	if print >/dev/null 2>&1; then
 		alias echo='print'
 		ECHOOPT="--"
 		MYSHELL=ksh
-	elif [ "${OPERATING_SYSTEM}" = "IRIX" -o "${OPERATING_SYSTEM}" = "IRIX64" ]; then
+	elif [ "${OPERATING_SYSTEM}" = "IRIX" -o "${OPERATING_SYSTEM}" = "IRIX64" \
+		-o "${OPERATING_SYSTEM}" = "Darwin" ]; then
 		ECHOOPT=""
 		MYSHELL=sh
 	else
@@ -3045,7 +3046,7 @@
 		if [ -n "`echo \"${STAT_CMD}\" | grep '\.pl$'`" ]; then
 			SCMD="${STAT_CMD} --modeoct --raw --ino --mode --uid --gid --size --Mtime"
 			INODECMD="${STAT_CMD} --modeoct --raw --ino"
-		elif [ $BSDOS -eq 1 ]; then
+		elif [ $BSDOS -eq 1 -o "${OPERATING_SYSTEM}" = "Darwin" ]; then
 			SCMD="${STAT_CMD} -f '%i %Mp%Lp %u %g %z %m:'"
 			INODECMD="${STAT_CMD} -f '%i'"
 		else
@@ -5362,7 +5363,7 @@
 		if [ -n "`echo \"${STAT_CMD}\" | grep '\.pl$'`" ]; then
 			SCMD="${STAT_CMD} --modeoct --raw --ino --mode --uid --gid --size --Mtime"
 			INODECMD="${STAT_CMD} --modeoct --raw --ino"
-		elif [ $BSDOS -eq 1 ]; then
+		elif [ $BSDOS -eq 1 -o "${OPERATING_SYSTEM}" = "Darwin" ]; then
 			SCMD="${STAT_CMD} -f '%i %Mp%Lp %u %g %z %m:'"
 			INODECMD="${STAT_CMD} -f '%i'"
 		else
