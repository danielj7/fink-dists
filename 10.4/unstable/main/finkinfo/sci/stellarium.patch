diff -ru stellarium-0.10.2.orig/CMakeLists.txt stellarium-0.10.2/CMakeLists.txt
--- stellarium-0.10.2.orig/CMakeLists.txt	2009-03-09 07:28:34.000000000 -0400
+++ stellarium-0.10.2/CMakeLists.txt	2009-06-14 14:22:25.000000000 -0400
@@ -32,9 +32,11 @@
 
 # best way to get to APPLE?
 IF(APPLE)
- SET(CMAKE_INCLUDE_PATH "/usr/X11/include:/usr/X11/include/freetype2:/Developer/SDKs/MacOSX10.5.sdk/usr/X11/include:/Developer/SDKs/MacOSX10.5.sdk/usr/X11/include/freetype2:/sw/include:${CMAKE_INCLUDE_PATH}")
- SET(CMAKE_LIBRARY_PATH "/Developer/SDKs/MacOSX10.5.sdk/usr/X11/lib:/sw/lib:${CMAKE_LIBRARY_PATH}")
- SET(CMAKE_C_FLAGS "-fno-common -Wall -Wextra -Wno-unused-parameter -DMACOSX -I/Developer/SDKs/MacOSX10.5.sdk/usr/X11/include -I/Developer/SDKs/MacOSX10.5.sdk/usr/X11/include/freetype2")
+ IF(APPLE_APP)
+  SET(CMAKE_C_FLAGS "-fno-common -Wall -Wextra -Wno-unused-parameter -DMACOSX -DMACOSX_APP")
+ ELSE(APPLE_APP)
+  SET(CMAKE_C_FLAGS "-fno-common -Wall -Wextra -Wno-unused-parameter -DMACOSX")
+ ENDIF(APPLE_APP)
  SET(CMAKE_CXX_FLAGS "${CMAKE_C_FLAGS}")
  SET(CMAKE_EXE_LINKER_FLAGS "-dylib_file /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib:/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib")
 ENDIF()
@@ -110,14 +112,13 @@
 
 ########### Set some global variables ###########
 IF(UNIX AND NOT WIN32)
-IF(APPLE)
-  SET(CMAKE_INSTALL_PREFIX "/Users/Shared/stellarium/Stellarium.app/Contents")
-  SET(INSTALL_DATADIR "${CMAKE_INSTALL_PREFIX}/Resources/data")
+IF(APPLE_APP)
+  SET(INSTALL_DATADIR "${CMAKE_INSTALL_PREFIX}/Resources")
   SET(INSTALL_LOCALEDIR "${CMAKE_INSTALL_PREFIX}/Resources/locale")
-ELSE(APPLE)
+ELSE(APPLE_APP)
   SET(INSTALL_DATADIR ${CMAKE_INSTALL_PREFIX}/share/stellarium)
   SET(INSTALL_LOCALEDIR ${CMAKE_INSTALL_PREFIX}/share/locale)
-ENDIF(APPLE)
+ENDIF(APPLE_APP)
 ELSE()
   SET(INSTALL_DATADIR .)
   SET(INSTALL_LOCALEDIR ./locale)
@@ -203,7 +204,7 @@
 ENDIF()
 
 ########### Macosx Bundling ###############
-IF(APPLE)
+IF(APPLE_APP)
 ADD_CUSTOM_TARGET(macosx_bundle bash util/macosx_bundle.sh ${CMAKE_INSTALL_PREFIX} ${PROJECT_SOURCE_DIR} DEPENDS install WORKING_DIRECTORY ${PROJECT_SOURCE_DIR} COMMENT "making the macosx bundle." VERBATIM)
 ENDIF()
 
diff -ru stellarium-0.10.2.orig/src/core/StelFileMgr.cpp stellarium-0.10.2/src/core/StelFileMgr.cpp
--- stellarium-0.10.2.orig/src/core/StelFileMgr.cpp	2009-03-09 07:28:33.000000000 -0400
+++ stellarium-0.10.2/src/core/StelFileMgr.cpp	2009-06-14 14:24:15.000000000 -0400
@@ -16,7 +16,7 @@
 # endif 
 #endif
 
-#ifdef MACOSX
+#ifdef MACOSX_APP
 #include "StelMacosxDirs.hpp"
 #endif
 
@@ -354,7 +354,7 @@
 	if (QFileInfo(CHECK_FILE).exists())
 		return ".";
 
-#if defined(MACOSX)
+#if defined(MACOSX_APP)
 	QFileInfo MacOSdir(QCoreApplication::applicationDirPath());
 	QDir ResourcesDir = MacOSdir.dir();
 	ResourcesDir.cd(QString("Resources"));
@@ -405,7 +405,7 @@
 QString StelFileMgr::getLocaleDir(void)
 {
 	QFileInfo localePath;
-#if defined(WIN32) || defined(CYGWIN) || defined(__MINGW32__) || defined(MINGW32) || defined(MACOSX)
+#if defined(WIN32) || defined(CYGWIN) || defined(__MINGW32__) || defined(MINGW32) || defined(MACOSX_APP)
 	// Windows and MacOS X have the locale dir in the installation folder
 	// TODO: check if this works with OSX
 	localePath = QFileInfo(getInstallationDir() + "/locale");
diff -ru stellarium-0.10.2.orig/src/core/StelIniParser.hpp stellarium-0.10.2/src/core/StelIniParser.hpp
--- stellarium-0.10.2.orig/src/core/StelIniParser.hpp	2009-03-09 07:28:33.000000000 -0400
+++ stellarium-0.10.2/src/core/StelIniParser.hpp	2009-06-14 14:25:03.000000000 -0400
@@ -27,8 +27,6 @@
 // ourselves.
 #if defined(WIN32)
 	static const QString stelEndl="\r\n";
-#elif defined(MACOSX)
-	static const QString stelEndl="\r";
 #else
 	static const QString stelEndl="\n";
 #endif
diff -ru stellarium-0.10.2.orig/src/core/StelTranslator.cpp stellarium-0.10.2/src/core/StelTranslator.cpp
--- stellarium-0.10.2.orig/src/core/StelTranslator.cpp	2009-03-09 07:28:33.000000000 -0400
+++ stellarium-0.10.2/src/core/StelTranslator.cpp	2009-06-14 14:26:22.000000000 -0400
@@ -39,7 +39,7 @@
 QString StelTranslator::systemLangName;
 
 // Use system locale language by default
-#if defined(MACOSX)
+#if defined(MACOSX_APP)
 #include "StelMacosxDirs.hpp"
 StelTranslator StelTranslator::globalTranslator = StelTranslator(PACKAGE_NAME, StelMacosxDirs::getApplicationResourcesDirectory().append( "/locale" ), "system");
 #else
diff -ru stellarium-0.10.2.orig/src/main.cpp stellarium-0.10.2/src/main.cpp
--- stellarium-0.10.2.orig/src/main.cpp	2009-03-09 07:28:33.000000000 -0400
+++ stellarium-0.10.2/src/main.cpp	2009-06-14 14:27:21.000000000 -0400
@@ -26,7 +26,7 @@
 #include <QDebug>
 #include <QGLFormat>
 #include <QPlastiqueStyle>
-#ifdef MACOSX
+#ifdef MACOSX_APP
 #include "StelMacosxDirs.hpp"
 #endif
 
@@ -65,7 +65,7 @@
 	int argc2 = argc+2;
 	QApplication app(argc2, argv2);
 
-#ifdef MACOSX
+#ifdef MACOSX_APP
 	StelMacosxDirs::addApplicationPluginDirectory();
 #endif
 	GettextStelTranslator trans;
diff -ru stellarium-0.10.2.orig/util/macosx_bundle.sh stellarium-0.10.2/util/macosx_bundle.sh
--- stellarium-0.10.2.orig/util/macosx_bundle.sh	2009-03-09 07:28:34.000000000 -0400
+++ stellarium-0.10.2/util/macosx_bundle.sh	2009-06-14 14:17:15.000000000 -0400
@@ -17,19 +17,5 @@
 rmdir ${CMAKE_INSTALL_PREFIX}/Resources/stellarium
 
 
-mkdir ${CMAKE_INSTALL_PREFIX}/Frameworks
-/usr/bin/perl util/pkgApp.pl ${CMAKE_INSTALL_PREFIX} MacOS/stellarium Frameworks 
-cp -pr /Developer/Applications/Qt/plugins/{imageformats,iconengines} ${CMAKE_INSTALL_PREFIX}/MacOS
-for f in ${CMAKE_INSTALL_PREFIX}/MacOS/{imageformats,iconengines}/*.dylib; do
-    fdir=`dirname $f`
-    dir=`basename $fdir`
-    base=`basename $f`
-    #/usr/bin/install_name_tool -id "@executable_path/$dir/$base" $f
-    for qt in `otool -L $f | egrep '	Qt' | cut -f 1 -d ' '`; do
-	newt="@executable_path/../Frameworks/$qt"
-	/usr/bin/install_name_tool -change $qt $newt $f
-    done
-done
-
 cp -pr $PROJECT_SOURCE_DIR/data/Icon.icns $CMAKE_INSTALL_PREFIX/Resources
 cp -pr $PROJECT_SOURCE_DIR/data/{PkgInfo,Info.plist} $CMAKE_INSTALL_PREFIX
