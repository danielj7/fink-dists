diff -uNr ../kdegraphics-3.2.0/kfile-plugins/configure.in.in ./kfile-plugins/configure.in.in
--- ../kdegraphics-3.2.0/kfile-plugins/configure.in.in	Fri Oct 11 04:25:30 2002
+++ ./kfile-plugins/configure.in.in	Thu Mar  4 17:01:11 2004
@@ -1,2 +1,3 @@
 DO_NOT_COMPILE="$DO_NOT_COMPILE gif"
 AC_CHECK_PROG(PDFINFO, pdfinfo, yes, no)
+KDE_TRY_TIFFLIB
diff -uNr ../kdegraphics-3.2.0/kghostview/Makefile.am ./kghostview/Makefile.am
--- ../kdegraphics-3.2.0/kghostview/Makefile.am	Tue Sep  2 10:02:44 2003
+++ ./kghostview/Makefile.am	Thu Mar  4 17:01:11 2004
@@ -4,16 +4,16 @@
 
 ####### Files
 
-bin_PROGRAMS = 	kghostview
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = 	kghostview.la
 kde_module_LTLIBRARIES = libkghostviewpart.la
-noinst_LTLIBRARIES = libdscparse.la
+noinst_LTLIBRARIES = libdscparse.la libkghostview_common.la
 
-libkghostviewpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN) -module
-libkghostviewpart_la_LIBADD = $(LIB_KFILE) $(LIB_KPARTS) -lkdeprint \
-	libdscparse.la
-
-# Check "make final" after making changes to the following line!!
-libkghostviewpart_la_SOURCES = kgvshell.cpp kgvdocument.cpp kgv_miniwidget.cpp \
+libkghostview_common_la_LDFLAGS = $(all_libraries) $(KDE_RPATH)
+libkghostview_common_la_LIBADD  = $(LIB_KFILE) $(LIB_KPARTS) \
+	$(LIB_KDEPRINT) libdscparse.la
+libkghostview_common_la_SOURCES = kgvshell.cpp kgvdocument.cpp kgv_miniwidget.cpp \
 	marklist.cpp logwindow.cpp infodialog.cpp \
 	kgvpageview.cpp ps.c kgv_view.cpp scrollbox.cpp  kgvpagedecorator.cpp \
 	kgvconfigdialog.cpp kgvmainwidget.cpp \
@@ -21,9 +21,18 @@
 	fullscreenfilter.cpp kgvfactory.cpp \
     generalsettingswidget.ui gssettingswidget.ui thumbnailservice.cpp
 
-kghostview_SOURCES = main.cpp
-kghostview_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kghostview_LDADD = libkghostviewpart.la
+libkghostviewpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN) -module
+libkghostviewpart_la_LIBADD  = libkghostview_common.la
+libkghostviewpart_la_SOURCES = dummy.cpp
+
+dummy.cpp:
+	echo > dummy.cpp
+
+# Check "make final" after making changes to the following line!!
+
+kghostview_la_SOURCES = main.cpp
+kghostview_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
+kghostview_la_LIBADD = libkghostview_common.la
 
 libdscparse_la_LDFLAGS = $(all_libraries) -no-undefined
 libdscparse_la_LIBADD = $(LIB_QT)
diff -uNr ../kdegraphics-3.2.0/kghostview/main.cpp ./kghostview/main.cpp
--- ../kdegraphics-3.2.0/kghostview/main.cpp	Sun Sep 21 04:38:18 2003
+++ ./kghostview/main.cpp	Thu Mar  4 17:01:11 2004
@@ -43,7 +43,7 @@
     KCmdLineLastOption
 };
 
-int main( int argc, char** argv )
+extern "C" int kdemain( int argc, char* argv[] )
 {
     KCmdLineArgs::init( argc, argv, KGVPart::createAboutData() );
     KCmdLineArgs::addCmdLineOptions( options );
diff -uNr ../kdegraphics-3.2.0/kpovmodeler/Makefile.am ./kpovmodeler/Makefile.am
--- ../kdegraphics-3.2.0/kpovmodeler/Makefile.am	Sat Jan 17 07:52:15 2004
+++ ./kpovmodeler/Makefile.am	Thu Mar  4 17:02:18 2004
@@ -1,5 +1,5 @@
 
-INCLUDES = $(LIBFREETYPE_CFLAGS) $(all_includes)
+INCLUDES = -I/usr/X11R6/include/freetype2 $(all_includes) $(LIBFREETYPE_CFLAGS)
 
 SUBDIRS = pics examples
 
diff -uNr ../kdegraphics-3.2.0/ksvg/impl/libs/libtext2path/src/Makefile.am ./ksvg/impl/libs/libtext2path/src/Makefile.am
--- ../kdegraphics-3.2.0/ksvg/impl/libs/libtext2path/src/Makefile.am	Sun Oct 26 05:52:43 2003
+++ ./ksvg/impl/libs/libtext2path/src/Makefile.am	Thu Mar  4 17:01:11 2004
@@ -1,7 +1,7 @@
 lib_LTLIBRARIES = libtext2path.la
 
 KDE_CXXFLAGS = $(USE_EXCEPTIONS)
-INCLUDES = $(FRIBIDI_CFLAGS) $(FREETYPE_CFLAGS) $(all_includes)
+INCLUDES = $(FREETYPE_CFLAGS) $(FRIBIDI_CFLAGS) $(all_includes)
 
 libtext2path_includedir=$(includedir)/libtext2path-0.1
 libtext2path_include_HEADERS = BezierPath.h Glyph.h GlyphTracer.h
diff -uNr ../kdegraphics-3.2.0/ksvg/plugin/backends/libart/Makefile.am ./ksvg/plugin/backends/libart/Makefile.am
--- ../kdegraphics-3.2.0/ksvg/plugin/backends/libart/Makefile.am	Sun Oct 26 05:52:43 2003
+++ ./ksvg/plugin/backends/libart/Makefile.am	Thu Mar  4 17:01:11 2004
@@ -8,4 +8,4 @@
 kde_services_DATA = ksvglibartcanvas.desktop
 
 KDE_CXXFLAGS = $(USE_EXCEPTIONS)
-INCLUDES = $(KDE_INCLUDES) $(LIBART_CFLAGS) $(FREETYPE_CFLAGS) $(FONTCONFIG_CFLAGS) -I$(top_srcdir)/ksvg/dom -I$(top_srcdir)/ksvg/impl -I$(top_srcdir)/ksvg/ecma -I$(top_srcdir)/ksvg/core -I$(top_srcdir)/ksvg/impl/libs/art_support -I$(top_srcdir)/ksvg/impl/libs/libtext2path/src $(all_includes)
+INCLUDES = $(FREETYPE_CFLAGS) $(FONTCONFIG_CFLAGS) $(KDE_INCLUDES) $(LIBART_CFLAGS) -I$(top_srcdir)/ksvg/dom -I$(top_srcdir)/ksvg/impl -I$(top_srcdir)/ksvg/ecma -I$(top_srcdir)/ksvg/core -I$(top_srcdir)/ksvg/impl/libs/art_support -I$(top_srcdir)/ksvg/impl/libs/libtext2path/src $(all_includes)
