Package: libzebrabar0-gtk
Version: 0.5
Revision: 1
Source: mirror:sourceforge:zebra/zebra-%v.tar.bz2
Source-MD5: 7e5cfba8d06fe46c4310efe67fb7a4a7

BuildDepends: <<
	atk1 (>= 1.20.0-1),
	cairo (>= 1.6.4-2),
	expat1,
	fink (>= 0.24.12-1),
	fontconfig2-dev (>= 2.4.1-1),
	freetype219 (>= 2.3.5-1),
	glib2-dev (>= 2.14.0-1),
	glitz,
	libzebrabar3 (>= 0.5-3),
	libgettext3-dev,
	libiconv-dev,
	libpng3,
	pango1-xft2-ft219-dev (>= 1.20.5-1),
	pixman (>= 0.10.0-1),
	pkgconfig,
	x11-dev,
	xft2-dev,
	xmlto
<<
Depends: %n-shlibs (= %v-%r)
BuildDependsOnly: true
Replaces: libzebrabar3 (<< 0.5-4)

PatchFile: %n.patch
PatchFile-MD5: d1f46ce2fda3b313c8cc864cd4ee6b56
PatchScript: <<
	%{default_script}

	mkdir -p _include/zebra
	ln -s ../include/config.h _include
	ln -s ../../include/zebra/zebragtk.h _include/zebra

	perl -pi -e 's,zebra/libzebra.la,,g' Makefile.in
	perl -pi -e 's,zebra.pc,,g' Makefile.in
<<
ConfigureParams: --disable-dependency-tracking --disable-video --without-imagemagick --without-npapi --with-gtk --without-python --without-qt
CompileScript: <<
#!/bin/sh -ex
	# gather flags for installed zebra
	ZEBRA_CFLAGS=`%p/bin/pkg-config --cflags zebra`
	ZEBRA_LIBS=`%p/bin/pkg-config --libs zebra`
	CPPFLAGS="$CPPFLAGS $ZEBRA_CFLAGS"
	LDFLAGS="$LDFLAGS $ZEBRA_LIBS"

	# special stuff for gtk
	export PKG_CONFIG_PATH="%p/lib/pango-ft219/lib/pkgconfig:%p/lib/fontconfig2/lib/pkgconfig:%p/lib/freetype219/lib/pkgconfig:%p/lib/pkgconfig:$PKG_CONFIG_PATH"

	./configure %c
	make
<<
InstallScript: <<
	make install DESTDIR=%d include_HEADERS= zinclude_HEADERS="include/zebra/zebragtk.h"
	rm -rf %i/share/doc/zebra
	rmdir %i/bin
	rm -rf %i/share/man
<<
DocFiles: COPYING.LIB ChangeLog HACKING NEWS README TODO

SplitOff: <<
	Package: %N-shlibs
	Files: lib/libzebragtk.0.*
	Depends: <<
		atk1-shlibs (>= 1.20.0-1),
		cairo-shlibs (>= 1.6.4-2),
		expat1-shlibs,
		fontconfig2-shlibs (>= 2.4.1-1),
		freetype219-shlibs (>= 2.3.5-1),
		glib2-shlibs (>= 2.14.0-1),
		glitz-shlibs,
		libzebrabar3-shlibs (>= 0.5-3),
		libgettext3-shlibs,
		libiconv,
		libpng3-shlibs,
		pango1-xft2-ft219-shlibs (>= 1.20.5-1),
		pixman-shlibs (>= 0.10.0-1),
		x11-shlibs
	<<
	Shlibs: %p/lib/libzebragtk.0.dylib 1.0.0 %n (>= 0.5-1)
	DocFiles: COPYING.LIB ChangeLog HACKING NEWS README TODO
<<

DescPackaging: <<
	Hack makefiles and autoconf config.h locations to use
	installed zebra instead of building locally.

	Redo doc files manually so they go where we want and include
	the files oriented towards users not installers.

	This is just the gtk lib; removing the should-be-empty bin
	dir without -f makes sure we didn't accidentally build any
	front-end programs. Only install gtk headers
<<

Description: GTK bindings for zebra barcode library
Homepage: http://zebra.sourceforge.net/
License: LGPL
Maintainer: Daniel Macks <dmacks@netspace.org>
