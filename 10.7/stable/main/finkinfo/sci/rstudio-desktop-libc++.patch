diff -uNr rstudio-0.98.1103.orig/src/cpp/core/r_util/RSessionLaunchProfile.cpp rstudio-0.98.1103/src/cpp/core/r_util/RSessionLaunchProfile.cpp
--- rstudio-0.98.1103.orig/src/cpp/core/r_util/RSessionLaunchProfile.cpp	2015-03-06 17:12:51.000000000 -0500
+++ rstudio-0.98.1103/src/cpp/core/r_util/RSessionLaunchProfile.cpp	2015-04-18 09:20:16.000000000 -0400
@@ -94,7 +94,7 @@
    configJson["cpuLimit"] = toJson(profile.config.limits.cpuLimit);
    configJson["niceLimit"] = toJson(profile.config.limits.niceLimit);
    configJson["filesLimit"] = toJson(profile.config.limits.filesLimit);
-   configJson["cpuAffinity"] = json::toJsonArray(profile.config.limits.cpuAffinity);
+   // configJson["cpuAffinity"] = json::toJsonArray(profile.config.limits.cpuAffinity);
    profileJson["config"] = configJson;
    return profileJson;
 }
From c50b3b3f07e574d4b8a0d84236700d5b91ac9d49 Mon Sep 17 00:00:00 2001
From: JJ Allaire <jj@rstudio.org>
Date: Fri, 24 Apr 2015 21:07:42 -0400
Subject: [PATCH] read file into buffer before calling std::search

---
 src/cpp/session/modules/SessionHTMLPreview.cpp | 15 ++++++++++-----
 1 file changed, 10 insertions(+), 5 deletions(-)

diff --git a/src/cpp/session/modules/SessionHTMLPreview.cpp b/src/cpp/session/modules/SessionHTMLPreview.cpp
index 777ad40..ac37d19 100644
--- a/src/cpp/session/modules/SessionHTMLPreview.cpp
+++ b/src/cpp/session/modules/SessionHTMLPreview.cpp
@@ -551,12 +551,17 @@ bool okToGenerateFile(const FilePath& rmdPath,
          return false;
       }
 
+      // copy the file's contents
+      std::vector<char> contents;
+      std::copy(std::istream_iterator<char>(*pStr),
+                std::istream_iterator<char>(),
+                std::back_inserter(contents));
+
       std::string magicGuid(MAGIC_GUID);
-      std::istreambuf_iterator<char> eod;
-      if (eod == std::search(std::istreambuf_iterator<char>(*pStr),
-                             eod,
-                             magicGuid.begin(),
-                             magicGuid.end()))
+      if (contents.end() == std::search(contents.begin(),
+                                        contents.end(),
+                                        magicGuid.begin(),
+                                        magicGuid.end()))
       {
          *pErrMsg = "Unable to generate the file '" +
                     filePath.filename() + "' because it already "
