--- koffice-1.4.2/karbon/Makefile.am	2005-09-21 08:27:54.000000000 -0400
+++ koffice-1.4.2-new/karbon/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -18,17 +18,10 @@
 # (e.g. VTranslateCmd), and commands (e.g. VCommandHistory) need KarbonPart,
 # so even moving more stuff to libkarbonbase isn't enough.
 # -> I think the whole 'base' stuff can be removed (DF)
-lib_LTLIBRARIES = libkarboncommon.la libkarbonbase.la
+lib_LTLIBRARIES = libkarboncommon.la
 kde_module_LTLIBRARIES = libkarbonpart.la
 
-libkarboncommon_la_SOURCES = karbon_factory.cc 	karbon_resourceserver.cc 	karbon_part.cc 	karbon_part_iface.cc 	karbon_part_iface.skel 	karbon_view.cc 	karbon_view_iface.cc 	karbon_view_iface.skel karbon_drag.cpp karbon_grid_data.cpp
-
-libkarbonbase_la_SOURCES = \
-	karbon_view_base.cc \
-	karbon_part_base.cc
-
-libkarbonbase_la_LDFLAGS = $(KDE_RPATH) -version-info 2:0:0 -no-undefined
-libkarbonbase_la_LIBADD = $(LIB_KOFFICEUI)
+libkarboncommon_la_SOURCES = karbon_factory.cc karbon_resourceserver.cc 	karbon_part.cc 	karbon_part_iface.cc 	karbon_part_iface.skel 	karbon_view.cc 	karbon_view_iface.cc 	karbon_view_iface.skel karbon_drag.cpp karbon_grid_data.cpp karbon_view_base.cc karbon_part_base.cc
 
 libkarboncommon_la_LDFLAGS = $(KDE_RPATH) $(LIBFREETYPE_RPATH)
 libkarboncommon_la_LIBADD = $(LIB_KOFFICECORE) $(LIB_KOFFICEUI) $(LIB_KOPAINTER) $(LIB_KOTEXT) \
@@ -42,26 +35,26 @@
 	commands/libkarboncommands.la \
 	visitors/libkarbonvisitors.la \
 	dialogs/libkarbondialogs.la \
-	libkarbonbase.la \
 	$(LIBART_LIBS) \
 	$(LIBFONTCONFIG_LIBS) \
 	$(LIBMAGICK_LIBS) \
 	$(LIBFREETYPE_LIBS)
 
-libkarbonpart_la_SOURCES = dummy.cpp
+libkarbonpart_la_SOURCES = karbon_factory_dummy.cc
 libkarbonpart_la_LDFLAGS = $(KDE_PLUGIN) $(LIBFREETYPE_RPATH)
 libkarbonpart_la_LIBADD = libkarboncommon.la
 libkarbonpart_la_METASOURCES = AUTO
 
+karbon_factory_dummy.cc: karbon_factory.cc karbon_factory.moc
+	echo '#include "karbon_factory.h"' > karbon_factory_dummy.cc && \
+	echo 'K_EXPORT_COMPONENT_FACTORY( libkarbonpart, KarbonFactory() )' >> karbon_factory_dummy.cc
+
 bin_PROGRAMS =
 kdeinit_LTLIBRARIES = karbon.la
 karbon_la_SOURCES = main.cc
 karbon_la_LDFLAGS = $(all_libraries) -module -avoid-version
 karbon_la_LIBADD = libkarboncommon.la
 
-dummy.cpp:
-	echo > dummy.cpp
-
 noinst_HEADERS = \
 	karbon_factory.h \
 	karbon_part_base.h \
--- koffice-1.4.2/karbon/main.cc	2005-09-21 08:27:54.000000000 -0400
+++ koffice-1.4.2-new/karbon/main.cc	2005-09-29 20:37:21.000000000 -0400
@@ -27,7 +27,6 @@
 
 #include "karbon_aboutdata.h"
 
-
 static const KCmdLineOptions options[] =
 	{
 		{ "+[file]", I18N_NOOP( "File to open" ), 0 } ,
--- koffice-1.4.2/kexi/formeditor/Makefile.am	2005-09-21 08:22:43.000000000 -0400
+++ koffice-1.4.2-new/kexi/formeditor/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -1,4 +1,5 @@
 include $(top_srcdir)/kexi/Makefile.global
+USE_EXCEPTIONS = -fexceptions -fno-coalesce
 
 INCLUDES = -I$(top_srcdir)/kexi/widget \
   -I$(top_srcdir)/kexi/widget/propertyeditor \
--- koffice-1.4.2/kexi/kexidb/drivers/configure.in.in	2005-09-21 08:22:32.000000000 -0400
+++ koffice-1.4.2-new/kexi/kexidb/drivers/configure.in.in	2005-09-29 20:37:21.000000000 -0400
@@ -142,8 +142,12 @@
 if test "$compile_pgsql_plugin" = "yes"; then
   AC_MSG_CHECKING([for PostgreSQL... Step 2 of 4])
   pgsql_libdirs="$ac_pgsql_libdir /usr/lib /usr/local/lib /usr/local/pgsql/lib /opt/postgres/lib"
-  AC_FIND_FILE(libpq.so, $pgsql_libdirs, pgsql_libdir)
-  if test ! -r $pgsql_libdir/libpq.so; then
+  pgsql_libdir=NO
+  for dir in $pgsql_libdirs; do
+    try="ls -1 $dir/libpq.*"
+    if test=`eval $try 2> /dev/null`; then pgsql_libdir=$dir; break; else echo "tried $dir" >&AC_FD_CC ; fi
+  done
+  if test "x$pgsql_libdir" = "xNO"; then
     compile_pgsql_plugin="no"
     AC_MSG_RESULT([not found])
   else
@@ -160,8 +164,8 @@
 if test "$compile_pgsql_plugin" = "yes"; then
   AC_MSG_CHECKING([for PostgreSQL... Step 3 of 4])
   pqxx_incdirs="$ac_pqxx_incdir /usr/include /usr/local/pqxx/include /usr/local/include"
-  AC_FIND_FILE(pqxx/pqxx, $pqxx_incdirs, pqxx_incdir)
-  if test ! -r $pqxx_incdir/pqxx/pqxx; then
+  AC_FIND_FILE(pqxx, $pqxx_incdirs, pqxx_incdir)
+  if test ! -r $pqxx_incdir/pqxx; then
     compile_pgsql_plugin="no"
     AC_MSG_RESULT([not found])
   else
@@ -177,8 +181,12 @@
 if test "$compile_pgsql_plugin" = "yes"; then
   AC_MSG_CHECKING([for PostgreSQL... Step 4 of 4])
   pqxx_libdirs="$ac_pqxx_libdir /usr/lib /usr/local/lib /usr/local/pqxx/lib"
-  AC_FIND_FILE(libpqxx.so, $pqxx_libdirs, pqxx_libdir)
-  if test ! -r $pqxx_libdir/libpqxx.so; then
+  pqxx_libdir=NO
+  for dir in $pqxx_libdirs; do
+    try="ls -1 $dir/libpqxx.*"
+    if test=`eval $try 2> /dev/null`; then pqxx_libdir=$dir; break; else echo "tried $dir" >&AC_FD_CC ; fi
+  done
+  if test "x$pqxx_libdir" = "xNO"; then
     compile_pgsql_plugin="no"
     AC_MSG_RESULT([not found])
   else
--- koffice-1.4.2/kexi/kexidb/drivers/mySQL/Makefile.am	2005-09-21 08:22:32.000000000 -0400
+++ koffice-1.4.2-new/kexi/kexidb/drivers/mySQL/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -20,7 +20,8 @@
   $(LIB_QT) \
   $(MYSQL_LIBS) \
   -lmysqlclient \
-  ../../libkexidb.la
+  ../../libkexidb.la \
+  ../../parser/libkexidbparser.la
 
 kexidb_mysqldriver_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN) $(VER_INFO) -no-undefined
 
--- koffice-1.4.2/kexi/kexidb/drivers/pqxx/Makefile.am	2005-09-21 08:22:30.000000000 -0400
+++ koffice-1.4.2-new/kexi/kexidb/drivers/pqxx/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -2,13 +2,13 @@
 
 kde_module_LTLIBRARIES = kexidb_pqxxsqldriver.la
 
-INCLUDES = -I$(srcdir)/../../.. $(all_includes) -I$(PG_INCDIR) -I$(PQXX_INCDIR)
+INCLUDES = -I$(srcdir)/../../.. $(all_includes) -I$(PG_INCDIR) -I$(PQXX_INCDIR)/pqxx -I$(PQXX_INCDIR)
 
 kexidb_pqxxsqldriver_la_METASOURCES = AUTO
 
 kexidb_pqxxsqldriver_la_SOURCES = pqxxdriver.cpp pqxxcursor.cpp pqxxconnection.cpp pqxxkeywords.cpp
 
-kexidb_pqxxsqldriver_la_LIBADD = $(LIB_KPARTS) $(LIB_QT) -lpqxx ../../libkexidb.la
+kexidb_pqxxsqldriver_la_LIBADD = $(LIB_KPARTS) $(LIB_QT) -lpqxx.2 ../../libkexidb.la
 
 kexidb_pqxxsqldriver_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN) -L$(PQXX_LIBDIR) -L$(PG_LIBDIR) $(VER_INFO) -no-undefined
 
--- koffice-1.4.2/kexi/main/Makefile.am	2005-09-21 08:22:11.000000000 -0400
+++ koffice-1.4.2-new/kexi/main/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -1,4 +1,5 @@
 include $(top_srcdir)/kexi/Makefile.global
+USE_EXCEPTIONS = -fexceptions -fno-coalesce
 
 lib_LTLIBRARIES = libkeximain.la
 libkeximain_la_SOURCES = \
--- koffice-1.4.2/kexi/main/configure.in.in	2005-09-21 08:22:11.000000000 -0400
+++ koffice-1.4.2-new/kexi/main/configure.in.in	2005-09-29 20:37:21.000000000 -0400
@@ -20,7 +20,7 @@
 AC_FIND_FILE(knewstuff/downloaddialog.h, $kde_incdirs, knewstuff_incdir)
 ac_knewstuff_includes="$knewstuff_incdir"
 
-AC_FIND_FILE(libknewstuff.so, $kde_libdirs, knewstuff_libdir)
+AC_FIND_FILE(libknewstuff.dylib, $kde_libdirs, knewstuff_libdir)
 ac_knewstuff_libraries="$knewstuff_libdir"
 
 if test "$ac_knewstuff_includes" = NO || test "$ac_knewstuff_libraries" = NO; then
--- koffice-1.4.2/kexi/main/startup/Makefile.am	2005-09-21 08:22:10.000000000 -0400
+++ koffice-1.4.2-new/kexi/main/startup/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -1,4 +1,5 @@
 include $(top_srcdir)/kexi/Makefile.global
+USE_EXCEPTIONS = -fexceptions -fno-coalesce
 
 noinst_LTLIBRARIES = libkeximainstartup.la
 
--- koffice-1.4.2/kexi/migration/pqxx/Makefile.am	2005-09-21 08:22:14.000000000 -0400
+++ koffice-1.4.2-new/kexi/migration/pqxx/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -2,7 +2,7 @@
 
 kde_module_LTLIBRARIES = keximigrate_pqxx.la
 
-INCLUDES = -I$(srcdir)/../../.. -I$(top_srcdir)/kexi $(all_includes) -I$(PG_INCDIR) -I$(PQXX_INCDIR)
+INCLUDES = -I$(srcdir)/../../.. -I$(top_srcdir)/kexi $(all_includes) -I$(PG_INCDIR) -I$(PQXX_INCDIR)/pqxx -I$(PQXX_INCDIR)
 
 keximigrate_pqxx_la_METASOURCES = AUTO
 
--- koffice-1.4.2/kexi/widget/relations/Makefile.am	2005-09-21 08:22:07.000000000 -0400
+++ koffice-1.4.2-new/kexi/widget/relations/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -1,4 +1,5 @@
 include $(top_srcdir)/kexi/Makefile.global
+USE_EXCEPTIONS = -fexceptions -fno-coalesce
 
 lib_LTLIBRARIES = libkexirelationsview.la
 
--- koffice-1.4.2/kivio/plugins/kivioconnectortool/Makefile.am	2005-09-21 08:25:54.000000000 -0400
+++ koffice-1.4.2-new/kivio/plugins/kivioconnectortool/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -1,5 +1,5 @@
 SUBDIRS = straight_connector .
-lib_LTLIBRARIES =libkivioconnectortool.la
+kde_module_LTLIBRARIES =libkivioconnectortool.la
 
 
 INCLUDES = -I$(top_srcdir)/kivio/kiviopart/config \
--- koffice-1.4.2/kivio/plugins/kivioselecttool/Makefile.am	2005-09-21 08:25:53.000000000 -0400
+++ koffice-1.4.2-new/kivio/plugins/kivioselecttool/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -1,5 +1,5 @@
 SUBDIRS = select_pics
-lib_LTLIBRARIES =libkivioselecttool.la
+kde_module_LTLIBRARIES =libkivioselecttool.la
 
 
 INCLUDES = -I$(top_srcdir)/kivio/kiviopart/config \
--- koffice-1.4.2/kivio/plugins/kiviosmlconnector/Makefile.am	2005-09-21 08:25:54.000000000 -0400
+++ koffice-1.4.2-new/kivio/plugins/kiviosmlconnector/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -1,5 +1,5 @@
 SUBDIRS=. sml_connector
-lib_LTLIBRARIES =libkiviosmlconnector.la
+kde_module_LTLIBRARIES =libkiviosmlconnector.la
 
 INCLUDES = -I$(top_srcdir)/kivio/kiviopart/config \
 	-I$(top_builddir)/kivio/kiviopart/config \
--- koffice-1.4.2/kivio/plugins/kiviotargettool/Makefile.am	2005-09-21 08:25:53.000000000 -0400
+++ koffice-1.4.2-new/kivio/plugins/kiviotargettool/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -7,7 +7,7 @@
 
 METASOURCES = AUTO
 
-lib_LTLIBRARIES =  libkiviotargettool.la
+kde_module_LTLIBRARIES =  libkiviotargettool.la
 libkiviotargettool_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN)
 libkiviotargettool_la_LIBADD = $(LIB_KOTEXT) $(LIB_KOPAINTER) $(top_builddir)/kivio/kiviopart/libkiviocommon.la
 libkiviotargettool_la_SOURCES = kiviotargettool.cpp kiviotargettoolfactory.cpp
--- koffice-1.4.2/kivio/plugins/kiviotexttool/Makefile.am	2005-09-21 08:25:53.000000000 -0400
+++ koffice-1.4.2-new/kivio/plugins/kiviotexttool/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -1,4 +1,4 @@
-lib_LTLIBRARIES =libkiviotexttool.la
+kde_module_LTLIBRARIES =libkiviotexttool.la
 
 
 INCLUDES = -I$(top_srcdir)/kivio/kiviopart/config \
--- koffice-1.4.2/kivio/plugins/kiviozoomtool/Makefile.am	2005-09-21 08:25:53.000000000 -0400
+++ koffice-1.4.2-new/kivio/plugins/kiviozoomtool/Makefile.am	2005-09-29 20:37:21.000000000 -0400
@@ -1,5 +1,5 @@
 SUBDIRS = zoom_pics
-lib_LTLIBRARIES =libkiviozoomtool.la
+kde_module_LTLIBRARIES =libkiviozoomtool.la
 
 INCLUDES = -I$(top_srcdir)/kivio/kiviopart/config \
 	-I$(top_builddir)/kivio/kiviopart/config \
--- koffice-1.4.2/krita/core/kis_generic_registry.h	2005-09-21 08:25:12.000000000 -0400
+++ koffice-1.4.2-new/krita/core/kis_generic_registry.h	2005-09-29 20:37:21.000000000 -0400
@@ -28,27 +28,27 @@
 #include "kis_global.h"
 #include "kis_id.h"
 
-template<typename _T>
+template<typename _T_GENERIC>
 class KisGenericRegistry {
-	typedef std::map<KisID, _T> storageMap;
+	typedef std::map<KisID, _T_GENERIC> storageMap;
 public:
 	KisGenericRegistry() { };
 	virtual ~KisGenericRegistry() { };
 public:
-	void add(_T item)
+	void add(_T_GENERIC item)
 	{
 		m_storage.insert( typename storageMap::value_type( item->id(), item) );
 	}
 
-	void add(KisID id, _T item)
+	void add(KisID id, _T_GENERIC item)
 	{
 		m_storage.insert(typename storageMap::value_type(id, item));
 		kdDebug(DBG_AREA_REGISTRY ) << "Added ID: " << id.id() << ", " << id.name() << "\n";
 	}
 	
-	_T get(const KisID& name) const
+	_T_GENERIC get(const KisID& name) const
 	{
-		_T p;
+		_T_GENERIC p;
 		typename storageMap::const_iterator it = m_storage.find(name);
 		if (it != m_storage.end()) {
 			p = it -> second;
@@ -64,7 +64,7 @@
 	 * Get a single entry based on the identifying part of KisID, not the
 	 * the descriptive part.
 	 */
-	_T get(const QString& id) const
+	_T_GENERIC get(const QString& id) const
 	{
 		return get(KisID(id, ""));
 	}
