Package: coreutils
Version: 6.9
Epoch: 1
Revision: 1
BuildDepends: expat, help2man, libgettext3-dev, gettext-bin, gettext-tools, libiconv-dev
Depends: libgettext3-shlibs, libiconv
NoSetLDFLAGS: true
SetLIBS: -L%p/lib
Source: mirror:gnu:%n/%n-%v.tar.bz2
Source-MD5: c9607d8495f16e98906e7ed2d9751a06
ConfigureParams: --bindir=%p/lib/%N/bin --mandir=%p/lib/%N/share/man --infodir=%p/share/info
PatchScript: sed 's|@PREFIX@|%p|g' %a/%n.patch | patch -p1
CompileScript: <<
  ./configure %c
  make
  case `uname -r` in [1-7].*) ;; *) make check;; esac
<<
InstallScript: <<
  #!/bin/sh -ev
  go() { echo "$@"; "$@"; }

  go make install DESTDIR=%d
  go rm -f %i/lib/charset.alias
  go rm -f %i/lib/%N/bin/su %i/lib/%N/bin/users %i/lib/%N/bin/who
  go ln -s share/man %i/lib/%N/man

  for d in bin share/man/man1; do
    dd=`echo "$d" | sed 's,[^/]*,..,g'`/lib/%N/$d
    go mkdir -p "%I/$d"
    go cd "%I/$d"
    for f in "$dd/"*; do
      ff=`basename "$f"`
      case $ff in
        \[) ;;
        *) go ln -s "$f" "g$ff";;
      esac
    done
  done
<<
DocFiles: COPYING README
InfoDocs: coreutils.info
Description: GNU flavoured basic commands
DescDetail: <<
The GNU Core Utilities are the basic file, shell and text manipulation
utilities of the GNU operating system.  These are the core utilities
which are expected to exist on every operating system.

Previously these utilities were offered as three individual sets of
GNU utilities, fileutils, shellutils, and textutils. Those three have
been combined into a single set of utilities called the coreutils.

The commands are named with 'g' prefix like 'gls' or 'gcp'. If you want
to use them as 'ls' or 'cp', add %p/lib/coreutils/bin to your PATH
or install the coreutils-default package.
<<
DescUsage: <<
The exotic commands like mknod may or may not work in a useful manner
on Darwin. Following commands are removed due to their breakage:
- su
- users
- who
<<
DescPort: <<
charset.alias is deleted because it is empty on Darwin anyway and
causes unnecessary conflicts between packages.
The make check fails on MacOS X <= 10.3 due to lack of lchown().
<<
SplitOff: <<
  Package: coreutils-default
  Description: GNU flavoured basic commands without 'g' prefix
  Depends: coreutils (>= %e:%v-%r)
  Conflicts: fileutils (<< 1:6.9-1), textutils (<< 1:6.9-1), shellutils (<< 1:6.9-1)
  Replaces: fileutils (<< 1:6.9-1), textutils (<< 1:6.9-1), shellutils (<< 1:6.9-1)
  DescDetail: << 
The GNU Core Utilities are the basic file, shell and text manipulation
utilities of the GNU operating system.  These are the core utilities
which are expected to exist on every operating system.

This package serves the commands without 'g' prefix like 'ls' or 'cp'.
  <<
  InstallScript: <<
    mkdir -p %i/etc/profile.d
    install -c -m 755 fink/%n.sh fink/%n.csh %i/etc/profile.d
    mkdir -p %i/lib/%n
    install -c -m 755 fink/prepend-path %i/lib/%n
    mkdir -p %i/share/doc
    ln -s %N %i/share/doc/%n
  <<
<<
SplitOff2: <<
  Package: fileutils
  Description: Backward compatibility symlinks for coreutils
  Depends: coreutils (>= %e:%v-%r), fink-obsolete-packages
  Conflicts: coreutils-default (<< 1:6.9-1)
  InstallScript: <<
    mkdir -p %i/bin
    set -ex; for f in `cat fink/%n.list`; do ln -s "../lib/%N/bin/$f" "%i/bin/$f"; done
    mkdir -p %i/share/doc
    ln -s %N %i/share/doc/%n
  <<
<<
SplitOff3: <<
  Package: textutils
  Description: Backward compatibility symlinks for coreutils
  Depends: coreutils (>= %e:%v-%r), fink-obsolete-packages
  Conflicts: coreutils-default (<< 1:6.9-1)
  InstallScript: <<
    mkdir -p %i/bin
    set -ex; for f in `cat fink/%n.list`; do ln -s "../lib/%N/bin/$f" "%i/bin/$f"; done
    mkdir -p %i/share/doc
    ln -s %N %i/share/doc/%n
  <<
  DescPort: <<
Symlinks to md5sum is not created because they are already contained
in the dpkg package.

Symlink to tsort (topological sort) is not created because it breaks
other packages. The GNU version of tsort doesn't output files that are
part of a cycle, while the BSD tsort that ships with Darwin does.
  <<
<<
SplitOff4: <<
  Package: shellutils
  Description: Backward compatibility symlinks for coreutils
  Depends: coreutils (>= %e:%v-%r), fink-obsolete-packages
  Conflicts: coreutils-default (<< 1:6.9-1)
  InstallScript: <<
    mkdir -p %i/bin
    set -ex; for f in `cat fink/%n.list`; do ln -s "../lib/%N/bin/$f" "%i/bin/$f"; done
    mkdir -p %i/share/doc
    ln -s %N %i/share/doc/%n
  <<
<<
License: GPL
Maintainer: AIDA Shinra <shinra@j10n.org>
Homepage: http://www.gnu.org/software/coreutils/
