Package: tetex-nox
Version: 2.0
Revision: 3
GCC: 3.1
Description: Base programs for teTeX, with X11 disabled
Depends: dlcompat-shlibs, t1lib1-shlibs, libpng3-shlibs, libwww-bin, ghostscript-nox, fink (>= 0.9.3), tetex-texmf (>= 2.0-1), tetex-shlibs (= %v-%r)
BuildDepends: t1lib1, libpng3, libwww, dlcompat-dev, tetex-dev (= %v-%r)
Conflicts: system-tetex, bundle-tetex, tetex-base
Provides: context, dvipdfm, epstopdf, pdftex, tetex-macosx, tetex-base
Replaces: context, dvipdfm, epstopdf, pdftex, tetex-macosx
Recommends: detex, ifmslide, latex2html, pdfscreen, pdfslide, ppower4, tex4ht, texpower
Suggests: foiltex
Source: mirror:ctan:systems/unix/teTeX/%v/distrib/tetex-src-%v.tar.gz
Source-MD5: 47aed744f1311d49dd9fbd60581da2c4
SourceDirectory: tetex-src-%v
PatchScript: sed 's|@PREFIX@|%p|g' < %a/tetex-%v-%r.patch | patch -p1
ConfigureParams: --without-x --without-texinfo --enable-shared --datadir='${prefix}/share' --infodir='${prefix}/share/info' --mandir='${prefix}/share/man' --disable-multiplatform --with-system-ncurses --with-system-pnglib --with-system-t1lib --with-system-wwwlib --with-system-zlib
CompileScript: <<
 ./configure %c
 export DYLD_LIBRARY_PATH="%b/texk/kpathsea/SHARED" ; make
<<
InstallScript: <<
 export DYLD_LIBRARY_PATH="%b/texk/kpathsea/SHARED" ; make install prefix=%i texmf=%i/share/texmf

echo "create a local texmf tree"
 mkdir -p %i/etc/texmf.local/web2c
 chmod 775 %i/etc/texmf.local
 chmod 775 %i/etc/texmf.local/web2c
 %i/bin/mktexlsr %i/etc/texmf.local
 mkdir -p %i/etc/ls-R
 mv %i/etc/texmf.local/ls-R %i/etc/ls-R/texmf.local
 ln -s %p/etc/ls-R/texmf.local %i/etc/texmf.local/ls-R
 mkdir -p %i/share
 ln -s %p/etc/texmf.local %i/share/texmf-local

echo "create a vartexmf tree"
 mkdir -p %i/etc/texmf-var
 %i/bin/mktexlsr %i/etc/texmf-var
 mv %i/etc/texmf-var/ls-R %i/etc/ls-R/texmf-var
 ln -s %p/etc/ls-R/texmf-var %i/etc/texmf-var/ls-R

echo "the ls-R file is supplied in tetex-texmf"
 rm -f %i/share/texmf/ls-R

echo "readlink is supplied in Fink's debianutils package"
 rm -f %i/bin/readlink
 rm -f %i/share/man/man1/readlink.1

echo "prepare texi2html for the alternatives system"
 mv %i/bin/texi2html %i/bin/texi2html.tetex-base
 mv %i/share/man/man1/texi2html.1 %i/share/man/man1/texi2html.1.tetex-base

rm -Rf %i/include
rm -Rf %i/lib
<<
InfoDocs: kpathsea.info web2c.info dvips.info latex.info
DocFiles: LICENSE.src ChangeLog INSTALL PROBLEMS README README.fink QuickInstall
PreInstScript: <<
  rm -f %p/etc/texmf.local/web2c/*.efmt
  rm -f %p/etc/texmf.local/web2c/*.log
  rm -f %p/etc/texmf.local/web2c/*.fmt
  rm -f %p/etc/texmf.local/web2c/*.base
  rm -f %p/etc/texmf.local/web2c/*.mem
  rm -f %p/etc/texmf.local/web2c/*.oft
<<
PostInstScript: <<
  if [ ! -e %p/share/texmf/tex/context ] ; then
    echo " "
    echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"
    echo "+ UPGRADE PROBLEM: We apologize for the inconvenience, but please reinstall +"
    echo "+ tetex-texmf and then update or install tetex-nox again.                   +"
    echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"
    echo " "
    exit 1
  fi
  update-alternatives --install %p/bin/texi2html texi2html %p/bin/texi2html.tetex-base 40
  update-alternatives --install %p/share/man/man1/texi2html.1 texi2html.1 %p/share/man/man1/texi2html.1.tetex-base 40
  mktexlsr
  fmtutil --all
  texlinks
  mktexlsr
<<
PreRmScript: <<
  if [ $1 != "upgrade" ]; then
    update-alternatives --remove texi2html %p/bin/texi2html.tetex-base
    update-alternatives --remove texi2html.1 %p/share/man/man1/texi2html.1.tetex-base
  fi
<<
License: OSI-Approved
DescDetail: <<
TeX takes a text file and a set of formatting commands as input and 
creates a typesetter independent .dvi (DeVice Independent) file as output.
TeTeX includes higher level formatting packages such as LaTeX, since
TeX by itself is not very user-friendly.
<<
DescPort: <<
To build shared libraries, we give the configure flag --enable-shared, set
the DYLD_LIBRARY_PATH environment variable, and patch klibtool.

The Makefile is patched to prevent the mktexlsr, fmtutil, and texlinks
utilities from running during Fink's install phase.  They are run in the
PostInstall script.

We have also included two small patches which were posted to the
tetex-pretest mailing list shortly after tetex-2.0 was released.

User files are stored in $HOME/Library/texmf (not $HOME/texmf) for
backwards-compatibility with earlier Fink teTeX installations.

We also set up a VARTEXMF directory for storing configuration files.
These can be modified by running "sudo texconfig".

We use update-alternatives for texi2html to allow users to install a
more up-to-date version if they choose.  We also do this for xdvi.
<<
DescPackaging: <<
 Other TeX related packages should use %p/etc/texmf.local/ as their texmf
 tree for storing files, rather than %p/share/texmf/.  In this way, the
 original texmf tree will be preserved. 

 There is a variant tetex-nox package with X11 disabled.

 texinfo is a separate package.

 readlink and its manpage are removed since they conflict with debianutils,
  an essential Fink package.

 Many thanks to the original teTeX maintainer Jeff Whitaker.
<<
Maintainer: Dave Morrison <dmrrsn@users.sourceforge.net>
Homepage: http://www.tug.org/teTeX
