# DISCLAIMER: Max Horn is the sole maintainer of this package.
# Please DO NOT MAKE MODIFICATIONS without informing the maintainer.
# Preferably, send a patch to me instead of making changes yourself!
# If that is not possible due to extra urgency, at least send me a mail.
#
# Explanation: I am sick and tired of getting back to my packages and
# discovering that people have messed with it. I am then forced to
# retrace their steps, find out who, when and why did make a certain
# change etc. -- i.e. it makes my life as maintainer harder.
# Furthermore, as maintainer I am responsible for problems caused by my
# packages. But I am not willing to take responsibility for something I
# did not do. In particular, for changes that other people introduced
# behind my back, no matter how good and noble their intentions were. As
# such, I may see myself forced to drop responsibility for (and hence,
# maintainership of) the affected package.

Package: irssi
Version: 0.8.10a
Revision: 1012
Maintainer: Max Horn <max@quendi.de>
BuildDepends: <<
 glib2-dev,
 fink (>= 0.13.0-1),
 libncurses5 (>= 5.4-20041023-1006),
 pkgconfig,
 libgettext3-dev,
 libiconv-dev
<<
Depends: <<
 glib2-shlibs,
 libncurses5-shlibs (>= 5.4-20041023-1006),
 libgettext3-shlibs,
 libiconv,
 perl586-core
<<
Conflicts: irssi-ssl
Replaces: irssi-ssl
Source: http://www.irssi.org/files/irssi-%v.tar.bz2
SourceDirectory: irssi-0.8.10
Source-MD5: 38e616bccb6a34ff6d91690317c2fa19
Patch: %n.patch
ConfigureParams: <<
 --with-modules \
 --with-ncurses=%p \
 --with-proxy \
 --enable-ipv6 \
 --mandir=%i/share/man \
 --with-perl-lib=%p/lib/perl5/5.8.6/darwin-thread-multi-2level \
 --without-socks \
 --disable-ssl
<<
#Type: perl 5.8.6
#UpdatePOD: true
CompileScript: <<
 ./configure %c
 make perlpath=perl5.8.6
<<
InstallScript: <<
 make install prefix=%i PREFIX=%i INSTALLPRIVLIB=%i/lib/perl5/5.8.6 INSTALLARCHLIB=%i/lib/perl5/5.8.6/darwin-thread-multi-2level INSTALLSITELIB=%i/lib/perl5/5.8.6 INSTALLSITEARCH=%i/lib/perl5/5.8.6/darwin-thread-multi-2level
 mkdir -p %i/share/podfiles/5.8.6
 cat %i/lib/perl5/5.8.6/darwin-thread-multi-2level/perllocal.pod | sed -e s,%i/lib/perl5,%p/lib/perl5, > %i/share/podfiles/5.8.6/perllocal.%n.pod
 rm -rf %i/lib/perl5/5.8.6/darwin-thread-multi-2level/perllocal.pod
<<
PostInstScript: <<
# Updating %p/lib/perl5/darwin-thread-multi-2level/5.8.6/perllocal.pod
mkdir -p %p/lib/perl5/5.8.6/darwin-thread-multi-2level
cat %p/share/podfiles/5.8.6/*.pod > %p/lib/perl5/5.8.6/darwin-thread-multi-2level/perllocal.pod
<<
PostRmScript: <<
# Updating %p/lib/perl5/5.8.6/darwin-thread-multi-2level/perllocal.pod
###
### check to see if any .pod files exist in %p/share/podfiles.
###
perl <<'END_PERL'
   if (-e "%p/share/podfiles/5.8.6") {
   @files = <%p/share/podfiles/5.8.6/*.pod>;
        if ($#files >= 0) {
        exec "cat %p/share/podfiles/5.8.6/*.pod > %p/lib/perl5/5.8.6/darwin-thread-multi-2level/perllocal.pod";
        }
   }
END_PERL
<<
DocFiles: AUTHORS COPYING ChangeLog NEWS README TODO
Description: Modular IRC client
DescPackaging: <<
 Update the podfiles manually, due to fink changes for Type: perl
 Enabled IRC proxy support
<<
DescPort: <<
  Patch memory leak in /quit
  See http://bugs.irssi.org/index.php?do=details&id=369
<<
Homepage: http://www.irssi.org/
License: GPL
