Package: g95
Version: 0.50
Revision: 20050405
Source: http://mirrors.rcn.net/pub/sourceware/gcc/snapshots/4.0-20050130/gcc-core-4.0-20050130.tar.bz2
Source2: ftp://ftp.cdc.noaa.gov/Public/jsw/g95/g95-%v-%r.tgz
Source-MD5: 0505cc96da2c36c5b2ecb66fcf385236
Source2-MD5: ae06c75d2c81b74e5283d463d691fd2f
NoSourceDirectory: True
NoSetCPPFLAGS: True
NoSetLDFLAGS: True
Depends: cctools (>= 576-1) | odcctools (>= 528-20041018), libiconv
BuildDepends: gmp (>= 4.1.3-11), libiconv-dev
BuildConflicts: autogen-dev
PatchScript: <<
 #!/bin/sh
 cd g95-%v
 tar -xvzf libf95.a-%v.tar.gz
 cd ..
 cd gcc-4.0-20050130
 patch -p0 < %a/%n.patch
 # make sure odcctools libtool being used.
 if test ! -f /usr/lib/libSystemStubs.a ; then perl -pi -e 's,/usr/bin/libtool,%p/lib/odcctools/bin/libtool,;' gcc/config/darwin.h ; fi
<<
CompileScript: <<
 #!/bin/sh
 darwinvers=`uname -r|cut -f1 -d.`
 cd gcc-4.0-20050130
 mkdir g95
 cd g95
 ../configure --prefix=%p --with-gmp=%p --enable-languages=c `if test ! -f /usr/lib/libSystemStubs.a ; then echo -n "--with-as=%p/lib/odcctools/bin/as --with-ld=%p/lib/odcctools/bin/ld" ; fi` --disable-checking --with-included-gettext 
 make
 cd ../../g95-%v
 ./configure --prefix=%p --with-gmp-dir=%p --with-gcc-dir=%b/gcc-4.0-20050130 --host=%m-apple-darwin${darwinvers}
 make 
 cd libf95.a-%v
 ./configure %c --host=%m-apple-darwin${darwinvers}
 make 
<<
InstallScript: <<
 #!/bin/sh
 gccverfull=`grep version_string %b/gcc-4.0-20050130/gcc/version.c | sed -e 's/.*"\([^"]*\)".*/\1/'`
 gccver=`echo ${gccverfull} | sed -e 's/\([^ ]*\) .*/\1/'`
 cd g95-%v
 mv Makefile Makefile.orig
 darwinvers=`uname -r|cut -f1 -d.`
 sed "s|%p/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}|%i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}|g" < Makefile.orig > Makefile
 make install prefix=%i 
 cd libf95.a-%v
 mv Makefile Makefile.orig
 sed "s|%p/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}|%i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}|g" < Makefile.orig > Makefile
 make install prefix=%i
 ranlib %i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}/libgcc.a
 ranlib %i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}/libf95.a
 ln -s %p/bin/%m-apple-darwin${darwinvers}-g95 %i/bin/g95
 /bin/rm -f %i/INSTALL
 mkdir -p %i/share/doc/%n
 mv %i/G95Manual.pdf %i/share/doc/%n
<<
License: GPL
DocFiles: g95-%v/COPYING
Description: Another GNU Fortran 95 compiler
DescDetail: <<
The goal of the g95 project is to create a free, open source 
Fortran 95 compiler and runtime libraries.

The 'gfortran' package is the official Fortran 95 compiler for the gcc
project, and will be included in gcc 4.0.  gfortran originated from
the g95 codebase.  At this time, g95 is a more fully-functional compiler 
than gfortran.
<<
DescPort: <<
 The gcc-4.0 20050130 snapshot is needed to build the backend.
 Requires that a compatible cctools be installed (provided by
 the odcctools package).
 Uses Peter O'Gorman's patch to prevent unlinking of /dev/null.
<<
Homepage: http://g95.org
Maintainer: Jeffrey Whitaker <jswhit@fastmail.fm>
