Info2: <<
Package: arpack-ng%type_pkg[-atlas]
Version: 3.0.2
Revision: 2
Type: -atlas (boolean), gcc(4.6)

Maintainer: Alexander Hansen <alexkhansen@users.sourceforge.net>
Description: Solve large scale eigenvalue problems
DescDetail: <<
ARPACK is a collection of Fortran77 subroutines designed to solve large scale
eigenvalue problems.  It began at Rice university:
http://www.caam.rice.edu/software/ARPACK

The arpack-ng project is a joint project between Debian, Octave and Scilab in 
order to provide a common and maintained version of arpack.

Because no single release has been published by Rice university for the last 
decade and since many software packages (Octave, Scilab, R, Matlab...) have 
forked it and implemented their own modifications, arpack-ng aims to tackle 
this issue by providing a common repository and maintained version.
<<
DescUsage: <<
This package contains static libraries, an unversioned dylib, Fortran 
examples, and documentation.
<<

BuildDependsOnly: true
Homepage: http://forge.scilab.org/index.php/p/arpack-ng/
License: BSD

Source: http://forge.scilab.org/upload/%{Ni}/files/arpack_%v.tar.gz
Source-MD5: fc744f506911401cf4573b1071c0424f
SourceDirectory: %{Ni}-%v

BuildDepends: <<
(%type_raw[-atlas] != .) atlas,
fink (>=0.30.0),
gcc%type_pkg[gcc]-compiler, 
xcode (>=2.5-1)
<<
Depends: %N-shlibs (= %v-%r )
Conflicts: %{Ni}, %{Ni}-atlas, arpack, arpack-atlas
Replaces: %{Ni}, %{Ni}-atlas, arpack, arpack-atlas

#UseMaxBuildJobs: false

# SetLDFLAGS: -Wl,-dead_strip_dylibs

ConfigureParams: <<
(%type_raw[-atlas] = .) --with-blas='-Wl,-framework,Accelerate' \
(%type_raw[-atlas] = .) --with-lapack='-Wl,-framework,Accelerate' \
--disable-dependency-tracking
<<
CompileScript: <<
	#!/bin/sh -ev
	export F77=%p/bin/gfortran-fsf-%type_raw[gcc]
	if [ "%type_raw[-atlas]" != "-atlas" ] ; 
	then 
		export FFLAGS='-ff2c'
	fi
	%{default_script}
<<
InstallScript:  <<
	make install DESTDIR=%d
	# manually install headers
	mkdir -p %i/include
	cp SRC/*.h %i/include
<<

DocFiles: CHANGES DOCUMENTS EXAMPLES README TODO COPYING DOCUMENTS
DescPackaging:  <<
	Use Xcode 3.1 and later to insure that the crappy 10.5 ld has been replaced.

	Needs a gfortran; we're going with gcc46 for now.

	Needs -ff2c when using Accelerate.framework, but not when using
	ATLAS.
	
	3.0.1-1 misbuilt:  it's best _not_ to specify --with-blas and --with-lapack
	when using atlas.
<<

Splitoff: <<
	Package: %N-shlibs
	Files: lib/libarpack.2.dylib
	Shlibs: %p/lib/libarpack.2.dylib 3.0.0 %n (>=3.0.1-1)
	Depends: <<
	(%type_raw[-atlas] != .) atlas-shlibs,
	gcc%type_pkg[gcc]-shlibs
	<<
	Conflicts: %{Ni}-shlibs, %{Ni}-atlas-shlibs
	Replaces: %{Ni}-shlibs, %{Ni}-atlas-shlibs
	DescDetail: <<
	This package contains a dynamic library.
	<<
	DocFiles: COPYING
<<
<<
