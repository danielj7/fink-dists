Package: psvn
Version: 20071115
Revision: 1
Description: Subversion interface for Emacs
License: GPL
Maintainer: None <fink-devel@lists.sourceforge.net>
Source: http://www-personal.umich.edu/~smaret/download/fink/psvn-%v.el
Source-MD5: 79993e286fb5f0cb69f4d75f7ed81a5c
NoSourceDirectory: true
Depends: emacsen, svn-client
PatchScript: <<
#!/bin/bash -ev
cd %b
mkdir fink
cd fink
cat <<END > 50psvn-vars.el
(require 'psvn)
END
cat <<END > install
#!/bin/sh
set -e
FLAVOR=\$1
echo install/psvn: Handling install of emacsen flavor \${FLAVOR}
byte_compile_options="-batch -f batch-byte-compile"
el_files="psvn.el"
el_dir=%p/share/emacs/site-lisp/psvn/
elc_dir=%p/share/\${FLAVOR}/site-lisp/psvn/
el_var_file="50psvn-vars.el"
el_var_dir=%p/etc/emacs/site-start.d/
elc_var_dir=%p/etc/\${FLAVOR}/site-start.d/
if [ \${FLAVOR} != emacs ]
then
  echo install/psvn: Byte-compiling for \${FLAVOR}
  [ -d \${elc_dir} ] || mkdir \${elc_dir}
  # Copy the temp .el files
  (cd \${el_dir} && cp \${el_files} \${elc_dir})
  (cd \${el_var_dir} && cp \${el_var_file} \${elc_var_dir})
  # Byte compile them
  (cd \${elc_dir} && \${FLAVOR} \${byte_compile_options} \${el_files} 2> /dev/null)
  (cd \${elc_var_dir} && \${FLAVOR} \${byte_compile_options} \${el_var_file} 2> /dev/null)
  # Remove the redundant .el files. Presumes that any .el files in
  # the <flavor> dir are trash.
  rm \${elc_dir}/*.el \${elc_var_dir}/*.el 
fi
exit 0;
END
cat <<END > remove
#!/bin/sh
set -e
FLAVOR=\$1
elc_dir=%p/share/\${FLAVOR}/site-lisp/psvn
elc_var_file="50psvn-vars.elc"
elc_var_dir=%p/etc/\${FLAVOR}/site-start.d/
echo remove/psvn: Handling removal of emacsen flavor \${FLAVOR}
if [ \${FLAVOR} != emacs ]
then
  echo remove/psvn-mode: Purging byte-compiled files for \${FLAVOR}
  rm -f \${elc_dir}/*.elc \${elc_var_dir}/\${elc_var_file}
  [ -d \${elc_dir} -a \`ls -la \${elc_dir}|wc -l\` -le 3 ] && rmdir \${elc_dir}
fi
exit 0;
END
<<
CompileScript: true
InstallScript: <<
  install -d %i/share/emacs/site-lisp/psvn
  install -m 644 psvn-%v.el %i/share/emacs/site-lisp/psvn/psvn.el
  install -d %i/etc/emacs/site-start.d
  install -m 644 fink/50psvn-vars.el %i/etc/emacs/site-start.d
  install -d %i/lib/emacsen-common/packages/install
  install -d %i/lib/emacsen-common/packages/remove
  install -m 755 fink/install %i/lib/emacsen-common/packages/install/psvn
  install -m 755 fink/remove %i/lib/emacsen-common/packages/remove/psvn
<<
PostInstScript: %p/lib/emacsen-common/emacs-package-install %n
PreRmScript: %p/lib/emacsen-common/emacs-package-remove %n
Homepage: http://www.xsteve.at/prg/vc_svn/
DescDetail: <<
Psvn is an interface for the revision control tool Subversion. It
provides a similar interface for Subversion as PCL-CVS for CVS.
<<
DescUsage: <<
Start the svn interface with `M-x svn-status'
<<
