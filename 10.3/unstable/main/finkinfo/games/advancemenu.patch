diff -Naur advancemenu-2.2.16/advance/advance.mak advancemenu-2.2.16-new/advance/advance.mak
--- advancemenu-2.2.16/advance/advance.mak	Sun Dec 21 16:59:49 2003
+++ advancemenu-2.2.16-new/advance/advance.mak	Sat Jan  3 22:13:35 2004
@@ -274,21 +274,21 @@
 # Common install
 
 installdirs:
-	-$(INSTALL_DATA_DIR) $(DATADIR)
-	-$(INSTALL_DATA_DIR) $(DATADIR)/doc
-	-$(INSTALL_MAN_DIR) $(PREFIX)/man/man1
+	-$(INSTALL_DATA_DIR) $(DESTDIR)$(DATADIR)
+	-$(INSTALL_DATA_DIR) $(DESTDIR)$(DATADIR)/doc
+	-$(INSTALL_MAN_DIR) $(DESTDIR)$(PREFIX)/share/man/man1
 ifneq ($(wildcard $(EMUSRC)),)
-	-$(INSTALL_DATA_DIR) $(DATADIR)/rom
-	-$(INSTALL_DATA_DIR) $(DATADIR)/sample
-	-$(INSTALL_DATA_DIR) $(DATADIR)/artwork
-	-$(INSTALL_DATA_DIR) $(DATADIR)/image
-	-$(INSTALL_DATA_DIR) $(DATADIR)/crc
+	-$(INSTALL_DATA_DIR) $(DESTDIR)$(DATADIR)/rom
+	-$(INSTALL_DATA_DIR) $(DESTDIR)$(DATADIR)/sample
+	-$(INSTALL_DATA_DIR) $(DESTDIR)$(DATADIR)/artwork
+	-$(INSTALL_DATA_DIR) $(DESTDIR)$(DATADIR)/image
+	-$(INSTALL_DATA_DIR) $(DESTDIR)$(DATADIR)/crc
 endif
 
 install-data: $(INSTALL_DATAFILES)
 ifdef INSTALL_DATAFILES
 	@for i in $(INSTALL_DATAFILES); do \
-		$(INSTALL_DATA) $$i $(DATADIR); \
+		$(INSTALL_DATA) $$i $(DESTDIR)$(DATADIR); \
 	done
 endif
 
@@ -301,7 +301,7 @@
 
 install-bin: $(INSTALL_BINFILES)
 	@for i in $(INSTALL_BINFILES); do \
-		$(INSTALL_PROGRAM) $$i $(PREFIX)/bin; \
+		$(INSTALL_PROGRAM) $$i $(DESTDIR)$(PREFIX)/bin; \
 	done
 
 uninstall-bin:
@@ -312,7 +312,7 @@
 install-doc: $(DOCOBJ) $(INSTALL_DOCFILES)
 ifdef INSTALL_DOCFILES
 	@for i in $(INSTALL_DOCFILES); do \
-		$(INSTALL_DATA) $$i $(DATADIR)/doc; \
+		$(INSTALL_DATA) $$i $(DESTDIR)$(DATADIR)/doc; \
 	done
 endif
 
@@ -326,7 +326,7 @@
 install-man: $(DOCOBJ) $(INSTALL_MANFILES)
 ifdef INSTALL_MANFILES
 	@for i in $(INSTALL_MANFILES); do \
-		$(INSTALL_DATA) $$i $(PREFIX)/man/man1; \
+		$(INSTALL_DATA) $$i $(DESTDIR)$(PREFIX)/share/man/man1; \
 	done
 endif
 
diff -Naur advancemenu-2.2.16/advance/advance.mak.orig advancemenu-2.2.16-new/advance/advance.mak.orig
--- advancemenu-2.2.16/advance/advance.mak.orig	Wed Dec 31 19:00:00 1969
+++ advancemenu-2.2.16-new/advance/advance.mak.orig	Sun Dec 21 16:59:49 2003
@@ -0,0 +1,459 @@
+############################################################################
+# Common version
+
+ifeq ($(CONF_EMU),mess)
+EMUVERSION = 0.77.0.1
+else
+EMUVERSION = 0.77.2
+endif
+MENUVERSION = 2.2.16
+CABVERSION = 1.1.4
+
+############################################################################
+# Common dir
+
+OBJ = obj/$(CONF_EMU)/$(BINARYDIR)
+MENUOBJ = obj/menu/$(BINARYDIR)
+MOBJ = obj/m/$(BINARYDIR)
+JOBJ = obj/j/$(BINARYDIR)
+KOBJ = obj/k/$(BINARYDIR)
+IOBJ = obj/i/$(BINARYDIR)
+VOBJ = obj/v/$(BINARYDIR)
+SOBJ = obj/s/$(BINARYDIR)
+CFGOBJ = obj/cfg/$(BINARYDIR)
+LINEOBJ = obj/line/$(BINARYDIR_BUILD)
+D2OBJ = obj/d2/$(BINARYDIR_BUILD)
+DOCOBJ = obj/doc
+
+############################################################################
+# Common targets
+
+ifdef ALL
+all_override: $(ALL)
+endif
+
+ifneq ($(wildcard $(EMUSRC)),)
+INSTALL_BINFILES += $(OBJ)/$(EMUNAME)$(EXE)
+ifneq ($(CONF_EMU),mess)
+INSTALL_DATAFILES += $(srcdir)/support/event.dat
+endif
+INSTALL_MANFILES += $(DOCOBJ)/advmame.1
+INSTALL_MANFILES += $(DOCOBJ)/advdev.1
+ifeq ($(CONF_EMU),mess)
+INSTALL_MANFILES += $(srcdir)/support/advmess.1
+endif
+endif
+ifneq ($(wildcard $(srcdir)/advance/menu.mak),)
+INSTALL_BINFILES += $(MENUOBJ)/advmenu$(EXE)
+INSTALL_MANFILES += $(DOCOBJ)/advmenu.1
+endif
+ifneq ($(wildcard $(srcdir)/advance/v.mak),)
+INSTALL_BINFILES += $(VOBJ)/advv$(EXE)
+INSTALL_MANFILES += $(DOCOBJ)/advv.1
+endif
+ifneq ($(wildcard $(srcdir)/advance/cfg.mak),)
+INSTALL_BINFILES += $(CFGOBJ)/advcfg$(EXE)
+INSTALL_MANFILES += $(DOCOBJ)/advcfg.1
+endif
+ifneq ($(CONF_HOST),windows)
+ifneq ($(wildcard $(srcdir)/advance/s.mak),)
+INSTALL_BINFILES += $(SOBJ)/advs$(EXE)
+INSTALL_MANFILES += $(DOCOBJ)/advs.1
+endif
+ifneq ($(wildcard $(srcdir)/advance/k.mak),)
+INSTALL_BINFILES += $(KOBJ)/advk$(EXE)
+INSTALL_MANFILES += $(DOCOBJ)/advk.1
+endif
+ifneq ($(wildcard $(srcdir)/advance/j.mak),)
+INSTALL_BINFILES += $(JOBJ)/advj$(EXE)
+INSTALL_MANFILES += $(DOCOBJ)/advj.1
+endif
+ifneq ($(wildcard $(srcdir)/advance/m.mak),)
+INSTALL_BINFILES += $(MOBJ)/advm$(EXE)
+INSTALL_MANFILES += $(DOCOBJ)/advm.1
+endif
+endif
+
+INSTALL_DOCFILES += $(subst $(srcdir)/doc/,$(DOCOBJ)/,$(subst .d,.txt,$(wildcard $(srcdir)/doc/*.d)))
+INSTALL_DOCFILES += $(subst $(srcdir)/doc/,$(DOCOBJ)/,$(subst .d,.html,$(wildcard $(srcdir)/doc/*.d)))
+WEB_DOCFILES += $(subst $(srcdir)/doc/,$(DOCOBJ)/,$(subst .d,.hh,$(wildcard $(srcdir)/doc/*.d)))
+
+all: $(DOCOBJ) $(INSTALL_BINFILES) $(INSTALL_DOCFILES) $(INSTALL_MANFILES) $(INSTALL_DATAFILES)
+emu: $(OBJ)/$(EMUNAME)$(EXE)
+menu: $(MENUOBJ)/advmenu$(EXE)
+cfg: $(CFGOBJ)/advcfg$(EXE)
+v: $(VOBJ)/advv$(EXE)
+s: $(SOBJ)/advs$(EXE)
+k: $(KOBJ)/advk$(EXE)
+i: $(IOBJ)/advi$(EXE)
+j: $(JOBJ)/advj$(EXE)
+m: $(MOBJ)/advm$(EXE)
+line: $(LINEOBJ)/advline$(EXE_BUILD)
+d2: $(D2OBJ)/advd2$(EXE_BUILD)
+web: $(DOCOBJ) $(WEB_DOCFILES)
+
+############################################################################
+# Common SRC
+
+RCSRC = $(srcdir)/support/pcvga.rc \
+	$(srcdir)/support/pcsvga60.rc \
+	$(srcdir)/support/standard.rc \
+	$(srcdir)/support/medium.rc \
+	$(srcdir)/support/extended.rc \
+	$(srcdir)/support/pal.rc \
+	$(srcdir)/support/ntsc.rc
+
+MPGLIB_SRC = \
+	$(wildcard $(srcdir)/advance/mpglib/*.c) \
+	$(wildcard $(srcdir)/advance/mpglib/*.h) \
+	$(wildcard $(srcdir)/advance/mpglib/*.txt)
+
+EXPAT_SRC = \
+	$(wildcard $(srcdir)/advance/expat/*.c) \
+	$(wildcard $(srcdir)/advance/expat/*.h) \
+	$(wildcard $(srcdir)/advance/expat/COPYING) \
+	$(wildcard $(srcdir)/advance/expat/README) \
+	$(wildcard $(srcdir)/advance/expat/*.diff)
+
+LIB_SRC = \
+	$(wildcard $(srcdir)/advance/lib/*.c) \
+	$(wildcard $(srcdir)/advance/lib/*.h) \
+	$(wildcard $(srcdir)/advance/lib/*.ico) \
+	$(wildcard $(srcdir)/advance/lib/*.rc) \
+	$(wildcard $(srcdir)/advance/lib/*.dat) \
+	$(wildcard $(srcdir)/advance/lib/*.cfg) \
+	$(wildcard $(srcdir)/advance/lib/*.html)
+
+BLIT_SRC = \
+	$(wildcard $(srcdir)/advance/blit/*.c) \
+	$(wildcard $(srcdir)/advance/blit/*.h) \
+	$(wildcard $(srcdir)/advance/blit/*.dat)
+
+CARD_SRC = \
+	$(wildcard $(srcdir)/advance/card/*.c) \
+	$(wildcard $(srcdir)/advance/card/*.h)
+	
+SVGALIB_SRC = \
+	$(wildcard $(srcdir)/advance/svgalib/*.c) \
+	$(wildcard $(srcdir)/advance/svgalib/*.h) \
+	$(wildcard $(srcdir)/advance/svgalib/*.dif) \
+	$(wildcard $(srcdir)/advance/svgalib/*.txt) \
+	$(wildcard $(srcdir)/advance/svgalib/*.bat) \
+	$(wildcard $(srcdir)/advance/svgalib/*.sh) \
+	$(wildcard $(srcdir)/advance/svgalib/*.cfg) \
+	$(wildcard $(srcdir)/advance/svgalib/*.html)
+
+SVGALIBDRIVERS_SRC = \
+	$(wildcard $(srcdir)/advance/svgalib/drivers/*.c) \
+        $(wildcard $(srcdir)/advance/svgalib/drivers/*.h)
+
+SVGALIBCLOCKCHI_SRC = \
+	$(wildcard $(srcdir)/advance/svgalib/clockchi/*.c) \
+        $(wildcard $(srcdir)/advance/svgalib/clockchi/*.h)
+
+SVGALIBRAMDAC_SRC = \
+	$(wildcard $(srcdir)/advance/svgalib/ramdac/*.c) \
+	$(wildcard $(srcdir)/advance/svgalib/ramdac/*.h)
+
+SVGALIBSVGADOS_SRC = \
+	$(wildcard $(srcdir)/advance/svgalib/svgados/*.c)
+
+SVGALIBSVGAWIN_SRC = \
+	$(wildcard $(srcdir)/advance/svgalib/svgawin/*.c) \
+	$(wildcard $(srcdir)/advance/svgalib/svgawin/*.h)
+
+SVGALIBSVGAWINSYS_SRC = \
+	$(wildcard $(srcdir)/advance/svgalib/svgawin/sys/*.h)
+
+SVGALIBSVGAWININSTALL_SRC = \
+	$(wildcard $(srcdir)/advance/svgalib/svgawin/install/makefile) \
+	$(wildcard $(srcdir)/advance/svgalib/svgawin/install/*.c) \
+	$(wildcard $(srcdir)/advance/svgalib/svgawin/install/*.h)
+
+SVGALIBSVGAWINDRIVER_SRC = \
+	$(wildcard $(srcdir)/advance/svgalib/svgawin/driver/makefile) \
+	$(wildcard $(srcdir)/advance/svgalib/svgawin/driver/sources) \
+	$(wildcard $(srcdir)/advance/svgalib/svgawin/driver/*.rc) \
+	$(wildcard $(srcdir)/advance/svgalib/svgawin/driver/*.c) \
+	$(wildcard $(srcdir)/advance/svgalib/svgawin/driver/*.h)
+
+SVGALIBSVGAVDD_SRC = \
+	$(wildcard $(srcdir)/advance/svgalib/svgavdd/*.c)
+
+SVGALIBSVGAVDDVDD_SRC = \
+	$(wildcard $(srcdir)/advance/svgalib/svgavdd/vdd/makefile) \
+	$(wildcard $(srcdir)/advance/svgalib/svgavdd/vdd/sources) \
+	$(wildcard $(srcdir)/advance/svgalib/svgavdd/vdd/*.rc) \
+	$(wildcard $(srcdir)/advance/svgalib/svgavdd/vdd/*.def) \
+	$(wildcard $(srcdir)/advance/svgalib/svgavdd/vdd/*.c) \
+	$(wildcard $(srcdir)/advance/svgalib/svgavdd/vdd/*.h)
+
+V_SRC = \
+	$(wildcard $(srcdir)/advance/v/*.c) \
+	$(wildcard $(srcdir)/advance/v/*.h)
+
+S_SRC = \
+	$(wildcard $(srcdir)/advance/s/*.c) \
+	$(wildcard $(srcdir)/advance/s/*.h)
+
+I_SRC = \
+	$(wildcard $(srcdir)/advance/i/*.c) \
+	$(wildcard $(srcdir)/advance/i/*.h)
+
+K_SRC = \
+	$(wildcard $(srcdir)/advance/k/*.c) \
+	$(wildcard $(srcdir)/advance/k/*.h)
+
+J_SRC = \
+	$(wildcard $(srcdir)/advance/j/*.c) \
+	$(wildcard $(srcdir)/advance/j/*.h)
+
+M_SRC = \
+	$(wildcard $(srcdir)/advance/m/*.c) \
+	$(wildcard $(srcdir)/advance/m/*.h)
+
+CFG_SRC = \
+	$(wildcard $(srcdir)/advance/cfg/*.c)
+
+LINE_SRC = \
+	$(wildcard $(srcdir)/advance/line/*.cc)
+
+SRCOSD = \
+	$(wildcard $(srcdir)/advance/osd/*.c) \
+	$(wildcard $(srcdir)/advance/osd/*.h) \
+	$(wildcard $(srcdir)/advance/osd/*.y) \
+	$(wildcard $(srcdir)/advance/osd/*.l)
+
+LINUX_SRC = \
+	$(wildcard $(srcdir)/advance/linux/*.c) \
+	$(wildcard $(srcdir)/advance/linux/*.h)
+
+DOS_SRC = \
+	$(wildcard $(srcdir)/advance/dos/*.c) \
+	$(wildcard $(srcdir)/advance/dos/*.h) \
+	$(wildcard $(srcdir)/advance/dos/*.dat)
+
+WINDOWS_SRC = \
+	$(wildcard $(srcdir)/advance/windows/*.c) \
+	$(wildcard $(srcdir)/advance/windows/*.h)
+
+SDL_SRC = \
+	$(wildcard $(srcdir)/advance/sdl/*.c) \
+	$(wildcard $(srcdir)/advance/sdl/*.h) \
+	$(wildcard $(srcdir)/advance/sdl/*.dat)
+
+D2_SRC = \
+	$(wildcard $(srcdir)/advance/d2/*.cc)
+
+CONF_SRC = \
+	$(srcdir)/Makefile.in \
+	$(srcdir)/config.guess \
+	$(srcdir)/config.sub \
+	$(srcdir)/configure \
+	$(srcdir)/configure.ac \
+	$(srcdir)/configure.msdos \
+	$(srcdir)/configure.windows \
+	$(srcdir)/aclocal.m4 \
+	$(srcdir)/install-sh \
+	$(srcdir)/mkinstalldirs \
+	$(srcdir)/missing
+
+CONF_BIN = \
+	$(srcdir)/support/confbin/INSTALL \
+	$(srcdir)/support/confbin/Makefile.am \
+	$(srcdir)/support/confbin/Makefile.in \
+	$(srcdir)/support/confbin/aclocal.m4 \
+	$(srcdir)/support/confbin/autogen.sh \
+	$(srcdir)/support/confbin/configure \
+	$(srcdir)/support/confbin/configure.ac \
+	$(srcdir)/support/confbin/install-sh \
+	$(srcdir)/support/confbin/missing \
+	$(srcdir)/support/confbin/mkinstalldirs
+
+############################################################################
+# Common install
+
+installdirs:
+	-$(INSTALL_DATA_DIR) $(DATADIR)
+	-$(INSTALL_DATA_DIR) $(DATADIR)/doc
+	-$(INSTALL_MAN_DIR) $(PREFIX)/man/man1
+ifneq ($(wildcard $(EMUSRC)),)
+	-$(INSTALL_DATA_DIR) $(DATADIR)/rom
+	-$(INSTALL_DATA_DIR) $(DATADIR)/sample
+	-$(INSTALL_DATA_DIR) $(DATADIR)/artwork
+	-$(INSTALL_DATA_DIR) $(DATADIR)/image
+	-$(INSTALL_DATA_DIR) $(DATADIR)/crc
+endif
+
+install-data: $(INSTALL_DATAFILES)
+ifdef INSTALL_DATAFILES
+	@for i in $(INSTALL_DATAFILES); do \
+		$(INSTALL_DATA) $$i $(DATADIR); \
+	done
+endif
+
+uninstall-data:
+ifdef INSTALL_DATAFILES
+	@for i in $(INSTALL_DATAFILES); do \
+		rm -f $(DATADIR)/$$i; \
+	done
+endif
+
+install-bin: $(INSTALL_BINFILES)
+	@for i in $(INSTALL_BINFILES); do \
+		$(INSTALL_PROGRAM) $$i $(PREFIX)/bin; \
+	done
+
+uninstall-bin:
+	@for i in $(INSTALL_BINFILES); do \
+		rm -f $(PREFIX)/bin/$$i; \
+	done
+
+install-doc: $(DOCOBJ) $(INSTALL_DOCFILES)
+ifdef INSTALL_DOCFILES
+	@for i in $(INSTALL_DOCFILES); do \
+		$(INSTALL_DATA) $$i $(DATADIR)/doc; \
+	done
+endif
+
+uninstall-doc:
+ifdef INSTALL_DOCFILES
+	@for i in $(INSTALL_DOCFILES); do \
+		rm -f $(DATADIR)/doc/$$i; \
+	done
+endif
+
+install-man: $(DOCOBJ) $(INSTALL_MANFILES)
+ifdef INSTALL_MANFILES
+	@for i in $(INSTALL_MANFILES); do \
+		$(INSTALL_DATA) $$i $(PREFIX)/man/man1; \
+	done
+endif
+
+uninstall-man:
+ifdef INSTALL_MANFILES
+	@for i in $(INSTALL_MANFILES); do \
+		rm -f $(PREFIX)/man/man1/$$i; \
+	done
+endif
+
+install: installdirs install-bin install-data install-doc install-man
+
+install-strip: install
+
+uninstall: uninstall-bin uninstall-data uninstall-doc uninstall-man
+
+############################################################################
+# Common build
+
+# Resource include dir
+RCFLAGS += --include-dir advance/lib
+
+############################################################################
+# Special Rules
+
+# Debug
+#WHOLE_CFLAGS_OPT = -O2 -Wall -Wno-sign-compare -Wno-unused
+#WHOLE_CFLAGS_EMU = -fomit-frame-pointer
+#WHOLE_LDFLAGS = -rdynamic
+DEFS_LINUX = -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_SYS_UTSNAME_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_LIBZ=1 -DHAVE_SLANG_SLANG_H=1
+
+# Optimized
+WHOLE_CFLAGS_OPT = -fomit-frame-pointer -O2 -Wall -Wno-sign-compare -Wno-unused
+WHOLE_CFLAGS_EMU =
+WHOLE_LDFLAGS = -s
+
+ARCH_I386 = CONF_ARCH=i386 CONF_CFLAGS_OPT="-march=i386 $(WHOLE_CFLAGS_OPT)" CONF_CFLAGS_EMU="$(WHOLE_CFLAGS_EMU)" CONF_LDFLAGS="$(WHOLE_LDFLAGS)"
+ARCH_PENTIUM = CONF_ARCH=pentium CONF_CFLAGS_OPT="-march=pentium $(WHOLE_CFLAGS_OPT)" CONF_CFLAGS_EMU="$(WHOLE_CFLAGS_EMU)" CONF_LDFLAGS="$(WHOLE_LDFLAGS)"
+ARCH_PENTIUM_BLEND = CONF_ARCH=pentium CONF_CFLAGS_OPT="-march=pentium -mcpu=pentium2 $(WHOLE_CFLAGS_OPT) -fno-merge-constants" CONF_CFLAGS_EMU="$(WHOLE_CFLAGS_EMU)" CONF_LDFLAGS="$(WHOLE_LDFLAGS)"
+ARCH_PENTIUM_BLEND_GCCOLD = CONF_ARCH=pentium CONF_CFLAGS_OPT="-march=i586 -mcpu=i686 $(WHOLE_CFLAGS_OPT)" CONF_CFLAGS_EMU="$(WHOLE_CFLAGS_EMU)" CONF_LDFLAGS="$(WHOLE_LDFLAGS)"
+
+mame:
+	$(MAKE) CONF=no CONF_EMU=mame emu
+
+neomame:
+	$(MAKE) CONF=no CONF_EMU=neomame emu
+
+cpmame:
+	$(MAKE) CONF=no CONF_EMU=cpmame emu
+
+tiny:
+	$(MAKE) CONF=no CONF_EMU=tiny emu
+
+# Ensure that the mess target is always created also if a mess directory exists
+.PHONY: mess
+
+mess:
+	$(MAKE) CONF=no CONF_EMU=mess emu
+
+wholemame: mamedif
+	$(MAKE) CONF=no dist
+	$(MAKE) CONF=no CONF_DIFFSRC=yes dist
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=windows distbin
+	$(MAKE) $(ARCH_PENTIUM_BLEND) CONF=no CONF_HOST=unix CONF_DEFS="$(DEFS_LINUX)" distbin
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=dos distbin
+
+dosmame:
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=dos distbin
+
+winmame:
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=windows distbin
+
+WHOLECD_FLAGS = \
+		CONF_ARCH=cd CONF_CFLAGS_OPT="-march=pentium -mcpu=pentium2 $(WHOLE_CFLAGS_OPT) -fno-merge-constants" CONF_CFLAGS_EMU="$(WHOLE_CFLAGS_EMU)" CONF_LDFLAGS="$(WHOLE_LDFLAGS)" \
+		CONF=no CONF_HOST=unix \
+		CONF_LIB_KEVENT=yes CONF_LIB_JEVENT=yes CONF_LIB_MEVENT=yes \
+		CONF_LIB_KRAW=yes CONF_LIB_MRAW=yes \
+		CONF_LIB_SVGALIB=no CONF_LIB_ALSA=yes CONF_LIB_FB=yes \
+		CONF_LIB_OSS=no CONF_LIB_PTHREAD=no CONF_LIB_SDL=no
+
+wholecd:
+	$(MAKE) $(WHOLECD_FLAGS) distbin
+	$(MAKE) $(WHOLECD_FLAGS) distmenubin
+	$(MAKE) $(WHOLECD_FLAGS) CONF_EMU=mess distbin
+
+wholemess: messdif
+	$(MAKE) CONF=no CONF_EMU=mess dist
+	$(MAKE) CONF=no CONF_EMU=mess CONF_DIFFSRC=yes dist
+	$(MAKE) $(ARCH_PENTIUM_BLEND) CONF=no CONF_HOST=unix CONF_EMU=mess CONF_DEFS="$(DEFS_LINUX)" distbin
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=windows CONF_EMU=mess distbin
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=dos CONF_EMU=mess distbin
+
+dosmess:
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=dos CONF_EMU=mess distbin
+
+winmess:
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=windows CONF_EMU=mess distbin
+
+wholemenu:
+	$(MAKE) CONF=no distmenu
+	$(MAKE) $(ARCH_PENTIUM_BLEND) CONF=no CONF_HOST=unix CONF_DEFS="$(DEFS_LINUX)" distmenubin
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=windows distmenubin
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=dos distmenubin
+
+dosmenu:
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=dos distmenubin
+
+wholecab:
+	$(MAKE) CONF=no distcab
+	$(MAKE) $(ARCH_I386) CONF=no CONF_HOST=dos distcabbin
+	$(MAKE) $(ARCH_I386) CONF=no CONF_HOST=windows distcabbin
+
+wholewin:
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=windows distbin
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=windows CONF_EMU=mess distbin
+	$(MAKE) $(ARCH_PENTIUM_BLEND_GCCOLD) CONF=no CONF_HOST=windows distmenubin
+
+distmess:
+	$(MAKE) CONF=no CONF_EMU=mess dist
+
+distmessbin:
+	$(MAKE) CONF=no CONF_EMU=mess distbin
+
+distmame:
+	$(MAKE) CONF=no CONF_EMU=mame dist
+
+distmamebin:
+	$(MAKE) CONF=no CONF_EMU=mame distbin
+
+
diff -Naur advancemenu-2.2.16/advance/linux/itty.c advancemenu-2.2.16-new/advance/linux/itty.c
--- advancemenu-2.2.16/advance/linux/itty.c	Sun Dec 21 16:59:49 2003
+++ advancemenu-2.2.16-new/advance/linux/itty.c	Sat Jan  3 22:13:35 2004
@@ -38,6 +38,8 @@
 #include "ossdl.h"
 #endif
 
+#include <sys/types.h>
+#include <machine/types.h>
 #include <sys/select.h>
 #include <stdio.h>
 #include <unistd.h>
diff -Naur advancemenu-2.2.16/advance/linux/itty.c.orig advancemenu-2.2.16-new/advance/linux/itty.c.orig
--- advancemenu-2.2.16/advance/linux/itty.c.orig	Wed Dec 31 19:00:00 1969
+++ advancemenu-2.2.16-new/advance/linux/itty.c.orig	Sun Dec 21 16:59:49 2003
@@ -0,0 +1,289 @@
+/*
+ * This file is part of the Advance project.
+ *
+ * Copyright (C) 2003 Andrea Mazzoleni
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ * In addition, as a special exception, Andrea Mazzoleni
+ * gives permission to link the code of this program with
+ * the MAME library (or with modified versions of MAME that use the
+ * same license as MAME), and distribute linked combinations including
+ * the two.  You must obey the GNU General Public License in all
+ * respects for all of the code used other than MAME.  If you modify
+ * this file, you may extend this exception to your version of the
+ * file, but you are not obligated to do so.  If you do not wish to
+ * do so, delete this exception statement from your version.
+ */
+
+#include "itty.h"
+#include "log.h"
+#include "target.h"
+#include "oslinux.h"
+#include "error.h"
+
+#ifdef USE_VIDEO_SDL
+#include "ossdl.h"
+#endif
+
+#include <sys/select.h>
+#include <stdio.h>
+#include <unistd.h>
+#include <string.h>
+#include <stdio.h>
+#include <sys/time.h>
+#include <sys/types.h>
+#include <unistd.h>
+#include <termios.h>
+
+struct inputb_tty_context {
+	unsigned last;
+	struct termios oldkbdtermios;
+	struct termios newkbdtermios;
+	adv_bool passive_flag;
+};
+
+static struct inputb_tty_context tty_state;
+
+static adv_device DEVICE[] = {
+{ "auto", -1, "Terminal input" },
+{ 0, 0, 0 }
+};
+
+adv_error inputb_tty_init(int inputb_id)
+{
+	log_std(("inputb:tty: inputb_tty_init(id:%d)\n", inputb_id));
+
+#ifdef USE_VIDEO_SDL
+	/* If the SDL video driver is used, also the SDL */
+	/* keyboard input must be used. */
+	if (os_internal_sdl_is_video_active()) {
+		error_set("Incompatible with the SDL video driver.\n");
+		return -1; 
+	}
+#endif
+
+	return 0;
+}
+
+void inputb_tty_done(void)
+{
+	log_std(("inputb:tty: inputb_tty_done()\n"));
+}
+
+adv_error inputb_tty_enable(adv_bool graphics)
+{
+	log_std(("inputb:tty: inputb_tty_enable(graphics:%d)\n", (int)graphics));
+
+#ifdef USE_VIDEO_SDL
+	/* If the SDL video driver is used, also the SDL */
+	/* keyboard input must be used. */
+	if (os_internal_sdl_is_video_active()) {
+		error_set("Incompatible with the SDL video driver.\n");
+		return -1; 
+	}
+#endif
+
+	tty_state.passive_flag = 0;
+#ifdef USE_VIDEO_SVGALIB
+	/* SVGALIB already set the terminal in KD_GRAPHICS mode and */
+	/* it waits on a signal on a vt switch */
+	if (os_internal_svgalib_is_video_mode_active()) {
+		tty_state.passive_flag = 1;
+	}
+#endif
+
+	if (!tty_state.passive_flag) {
+		/* no buffer */
+		setvbuf(stdin, 0, _IONBF, 0);
+
+		/* not canonical input */
+		if (tcgetattr(fileno(stdin), &tty_state.oldkbdtermios) != 0) {
+			error_set("Error initializing the tty driver. Function tcgetattr() failed.\n");
+			return -1;
+		}
+
+		tty_state.newkbdtermios = tty_state.oldkbdtermios;
+
+		tty_state.newkbdtermios.c_lflag &= ~(ICANON | ECHO);
+
+		if (tcsetattr(fileno(stdin), TCSAFLUSH, &tty_state.newkbdtermios) != 0) {
+			error_set("Error initializing the tty driver. Function tcsetattr(TCSAFLUSH) failed.\n");
+			return -1;
+		}
+	}
+
+	tty_state.last = 0;
+
+	return 0;
+}
+
+void inputb_tty_disable(void)
+{
+	log_std(("inputb:tty: inputb_tty_disable()\n"));
+
+	if (!tty_state.passive_flag) {
+		log_std(("inputb:tty: tcsetattr(%sICANON %sECHO)\n", (tty_state.oldkbdtermios.c_lflag & ICANON) ? "" : "~", (tty_state.oldkbdtermios.c_lflag & ECHO) ? "" : "~"));
+
+		if (tcsetattr(fileno(stdin), TCSAFLUSH, &tty_state.oldkbdtermios) != 0) {
+			/* ignore error */
+			log_std(("inputb:tty: tcsetattr(TCSAFLUSH) failed\n"));
+		}
+	}
+}
+
+static int tty_getkey(void)
+{
+	struct timeval tv;
+	fd_set fds;
+	int fd = fileno(stdin);
+	unsigned char c;
+
+	tv.tv_sec = 0;
+	tv.tv_usec = 0;
+
+	FD_ZERO(&fds);
+	FD_SET(fd, &fds);
+
+	if (select(fd + 1, &fds, 0, 0, &tv) > 0) {
+
+		if (read(fd, &c, 1) != 1) {
+			return 0;
+		}
+
+		return c;
+	}
+
+	return 0;
+}
+
+adv_bool inputb_tty_hit(void)
+{
+	log_debug(("inputb:tty: inputb_tty_count_get()\n"));
+
+	if (tty_state.last != 0)
+		return 1;
+
+	tty_state.last = tty_getkey();
+
+	return tty_state.last != 0;
+}
+
+unsigned inputb_tty_get(void)
+{
+	const unsigned max = 32;
+	char map[max+1];
+	unsigned mac;
+
+	log_debug(("inputb:tty: inputb_tty_button_count_get()\n"));
+
+	mac = 0;
+	while (mac<max && (mac==0 || tty_state.last)) {
+
+		if (tty_state.last) {
+			map[mac] = tty_state.last;
+			if (mac > 0 && map[mac] == 27) {
+				break;
+			}
+			++mac;
+			tty_state.last = 0;
+		} else {
+			target_idle();
+		}
+
+		tty_state.last = tty_getkey();
+	}
+	map[mac] = 0;
+
+	if (strcmp(map, "\033[A")==0)
+		return INPUTB_UP;
+	if (strcmp(map, "\033[B")==0)
+		return INPUTB_DOWN;
+	if (strcmp(map, "\033[D")==0)
+		return INPUTB_LEFT;
+	if (strcmp(map, "\033[C")==0)
+		return INPUTB_RIGHT;
+	if (strcmp(map, "\033[1~")==0)
+		return INPUTB_HOME;
+	if (strcmp(map, "\033[4~")==0)
+		return INPUTB_END;
+	if (strcmp(map, "\033[5~")==0)
+		return INPUTB_PGUP;
+	if (strcmp(map, "\033[6~")==0)
+		return INPUTB_PGDN;
+	if (strcmp(map, "\033[[A")==0)
+		return INPUTB_F1;
+	if (strcmp(map, "\033[[B")==0)
+		return INPUTB_F2;
+	if (strcmp(map, "\033[[C")==0)
+		return INPUTB_F3;
+	if (strcmp(map, "\033[[D")==0)
+		return INPUTB_F4;
+	if (strcmp(map, "\033[[E")==0)
+		return INPUTB_F5;
+	if (strcmp(map, "\033[17~")==0)
+		return INPUTB_F6;
+	if (strcmp(map, "\033[18~")==0)
+		return INPUTB_F7;
+	if (strcmp(map, "\033[19~")==0)
+		return INPUTB_F8;
+	if (strcmp(map, "\033[20~")==0)
+		return INPUTB_F9;
+	if (strcmp(map, "\033[21~")==0)
+		return INPUTB_F10;
+	if (strcmp(map, "\r")==0 || strcmp(map, "\n")==0)
+		return INPUTB_ENTER;
+	if (strcmp(map, "\x7F")==0)
+		return INPUTB_BACKSPACE;
+
+	if (mac != 1)
+		return 0;
+	else
+		return (unsigned char)map[0];
+
+	return 0;
+}
+
+unsigned inputb_tty_flags(void)
+{
+	return 0;
+}
+
+adv_error inputb_tty_load(adv_conf* context)
+{
+	return 0;
+}
+
+void inputb_tty_reg(adv_conf* context)
+{
+}
+
+/***************************************************************************/
+/* Driver */
+
+inputb_driver inputb_tty_driver = {
+	"tty",
+	DEVICE,
+	inputb_tty_load,
+	inputb_tty_reg,
+	inputb_tty_init,
+	inputb_tty_done,
+	inputb_tty_enable,
+	inputb_tty_disable,
+	inputb_tty_flags,
+	inputb_tty_hit,
+	inputb_tty_get
+};
+
diff -Naur advancemenu-2.2.16/advance/menu/mconfig.cc advancemenu-2.2.16-new/advance/menu/mconfig.cc
--- advancemenu-2.2.16/advance/menu/mconfig.cc	Sun Dec 21 16:59:49 2003
+++ advancemenu-2.2.16-new/advance/menu/mconfig.cc	Sat Jan  3 22:13:35 2004
@@ -984,12 +984,6 @@
 		if (target_search(path, FILE_MAXPATH, "advpac") == 0) {
 			conf_set(config_context, "", "emulator", "\"advpac\" advpac \"advpac\" \"\"");
 		}
-		if (target_search(path, FILE_MAXPATH, "xmame") == 0) {
-			conf_set(config_context, "", "emulator", "\"xmame\" xmame \"xmame\" \"\"");
-		}
-		if (target_search(path, FILE_MAXPATH, "xmame.x11") == 0) {
-			conf_set(config_context, "", "emulator", "\"xmame.x11\" xmame \"xmame.x11\" \"\"");
-		}
 		if (target_search(path, FILE_MAXPATH, "xmame.SDL") == 0) {
 			conf_set(config_context, "", "emulator", "\"xmame.SDL\" xmame \"xmame.SDL\" \"\"");
 		}
