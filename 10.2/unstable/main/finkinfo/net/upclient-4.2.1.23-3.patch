diff -ruN upclient-4.2.1.23.orig/src/upclient.h upclient-4.2.1.23/src/upclient.h
--- upclient-4.2.1.23.orig/src/upclient.h	Thu May 31 17:19:44 2001
+++ upclient-4.2.1.23/src/upclient.h	Wed Jul 31 13:43:41 2002
@@ -49,6 +49,12 @@
 #define OSLEVEL_SIZE	64 /* Protocol is not clear on this one */
 #define CPU_SIZE	64 /* Protocol is not clear on this one either */
 
+/* Needed for darwin 6+ and OSX 10.2+ */
+#ifdef __APPLE_CC__
+# include <rpcsvc/rstat.h>
+# include <mach/machine.h>
+# define CP_IDLE CPU_STATE_IDLE
+#endif /* __APPLE_CC__ */
 
 /**
  * Sanity check
