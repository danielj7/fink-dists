diff -ur jpilot-0.99.6.orig/Expense/Makefile.in jpilot-0.99.6/Expense/Makefile.in
--- jpilot-0.99.6.orig/Expense/Makefile.in	2003-07-13 06:34:06.000000000 +0200
+++ jpilot-0.99.6/Expense/Makefile.in	2005-11-17 20:09:25.000000000 +0100
@@ -194,7 +194,7 @@
 CONFIG_CLEAN_FILES =
 LTLIBRARIES = $(lib_LTLIBRARIES)
 
-libexpense_la_LDFLAGS =
+libexpense_la_LDFLAGS = -module -avoid-version
 libexpense_la_LIBADD =
 am__libexpense_la_SOURCES_DIST = expense.c
 @MAKE_EXPENSE_TRUE@am_libexpense_la_OBJECTS = expense.lo
diff -ur jpilot-0.99.6.orig/KeyRing/Makefile.in jpilot-0.99.6/KeyRing/Makefile.in
--- jpilot-0.99.6.orig/KeyRing/Makefile.in	2003-07-13 06:34:06.000000000 +0200
+++ jpilot-0.99.6/KeyRing/Makefile.in	2005-11-17 20:09:25.000000000 +0100
@@ -197,7 +197,7 @@
 CONFIG_CLEAN_FILES =
 LTLIBRARIES = $(lib_LTLIBRARIES)
 
-libkeyring_la_LDFLAGS =
+libkeyring_la_LDFLAGS = -module -avoid-version
 libkeyring_la_LIBADD =
 am__libkeyring_la_SOURCES_DIST = keyring.c
 @MAKE_KEYRING_TRUE@am_libkeyring_la_OBJECTS = keyring.lo
diff -ur jpilot-0.99.6.orig/SyncTime/Makefile.in jpilot-0.99.6/SyncTime/Makefile.in
--- jpilot-0.99.6.orig/SyncTime/Makefile.in	2003-07-13 06:34:07.000000000 +0200
+++ jpilot-0.99.6/SyncTime/Makefile.in	2005-11-17 20:09:25.000000000 +0100
@@ -194,7 +194,7 @@
 CONFIG_CLEAN_FILES =
 LTLIBRARIES = $(lib_LTLIBRARIES)
 
-libsynctime_la_LDFLAGS =
+libsynctime_la_LDFLAGS = -module -avoid-version
 libsynctime_la_LIBADD =
 am__libsynctime_la_SOURCES_DIST = synctime.c
 @MAKE_SYNCTIME_TRUE@am_libsynctime_la_OBJECTS = synctime.lo
diff -ur jpilot-0.99.6.orig/configure jpilot-0.99.6/configure
--- jpilot-0.99.6.orig/configure	2003-07-13 06:34:08.000000000 +0200
+++ jpilot-0.99.6/configure	2005-11-17 20:14:26.000000000 +0100
@@ -5788,10 +5788,11 @@
     #        cross-compilation, but unfortunately the echo tests do not
     #        yet detect zsh echo's removal of \ escapes.  Also zsh mangles
     #	     `"' quotes if we put them in here... so don't!
-    archive_cmds='$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs && $CC $(test .$module = .yes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib ${lib}-master.o $deplibs$linker_flags $(test .$module != .yes && echo -install_name $rpath/$soname $verstring)'
+    #archive_cmds='$nonopt -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs && $nonopt $(test .$module = .yes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib ${lib}-master.o $deplibs$linker_flags $(test .$module != .yes && echo -install_name $rpath/$soname $verstring)'
+    archive_cmds='$nonopt $(test .$module = .yes && echo -bundle $allow_undefined_flag || echo -dynamiclib) -o $lib $libobjs $deplibs$linker_flags $(test .$module != .yes && echo -install_name $rpath/$soname $verstring)'
     # We need to add '_' to the symbols in $export_symbols first
     #archive_expsym_cmds="$archive_cmds"' && strip -s $export_symbols'
-    hardcode_direct=yes
+    hardcode_direct=no
     hardcode_shlibpath_var=no
     whole_archive_flag_spec='-all_load $convenience'
     ;;
@@ -12029,8 +12030,6 @@
 main ()
 {
 
-int main()
-{
 #if PILOT_LINK_VERSION==0
 # if PILOT_LINK_MAJOR==11
 #  if PILOT_LINK_MINOR==0
@@ -12044,7 +12043,6 @@
 #  endif
 # endif
 #endif
-}
 
   ;
   return 0;
@@ -12086,10 +12084,7 @@
 main ()
 {
 
-int main()
-{
    exit(0);
-}
 
   ;
   return 0;
@@ -12131,14 +12126,11 @@
 main ()
 {
 
-int main()
-{
 #if PILOT_LINK_VERSION==0
 # if PILOT_LINK_MAJOR < 10
 #  error no usb, ok for serial or visor use
 # endif
 #endif
-}
 
   ;
   return 0;
@@ -12180,14 +12172,11 @@
 main ()
 {
 
-int main()
-{
 #if PILOT_LINK_VERSION==0
 # if PILOT_LINK_MAJOR > 9
 #  error good pilot-link version
 # endif
 #endif
-}
 
   ;
   return 0;
diff -ur jpilot-0.99.6.orig/ltmain.sh jpilot-0.99.6/ltmain.sh
--- jpilot-0.99.6.orig/ltmain.sh	2003-07-06 00:59:00.000000000 +0200
+++ jpilot-0.99.6/ltmain.sh	2005-11-17 20:09:25.000000000 +0100
@@ -1758,7 +1758,7 @@
 
 	  if test "$installed" = no; then
 	    notinst_deplibs="$notinst_deplibs $lib"
-	    need_relink=yes
+	    need_relink=no
 	  fi
 
 	  if test -n "$old_archive_from_expsyms_cmds"; then
diff -ur jpilot-0.99.6.orig/plugins.c jpilot-0.99.6/plugins.c
--- jpilot-0.99.6.orig/plugins.c	2003-06-03 06:45:16.000000000 +0200
+++ jpilot-0.99.6/plugins.c	2005-11-17 20:09:25.000000000 +0100
@@ -19,6 +19,7 @@
 
 #include "config.h"
 #ifdef  ENABLE_PLUGINS
+#include <sys/types.h>
 #include <dirent.h>
 #include <stdio.h>
 #include <stdlib.h>
