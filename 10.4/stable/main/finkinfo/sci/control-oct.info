Info2: <<
Package: control%type_pkg[-lapack]-oct%type_pkg[oct]
Version: 2.3.52
Type: oct (3.6.0 3.6.1 3.6.2), forge (control), -lapack (-atlas -ref .), gcc (4.7)
Revision: 1
Architecture: <<
i386,
(%type_raw[-lapack] != .) x86_64
<<
Maintainer: Alexander Hansen <alexkhansen@users.sourceforge.net>
# unfortunately, Homepage won't do types
Homepage: http://octave.sourceforge.net/control/index.html 
Description: Octave control tools
DescDetail: <<
Octave control systems package based on the proven SLICOT Fortran library

This package provides the following functions:
Examples:
	MDSSystem
	optiPID
	Anderson
	Madievski
Linear Time Invariant Models:
	dss
	filt
	frd
	ss
	tf
	zpk
Model Data Access:
	@lti/dssdata
	@lti/filtdata
	@lti/frdata
	@lti/get
	@lti/set
	@lti/ssdata
	@lti/tfdata
	@lti/zpkdata
Model Conversions:
	@lti/c2d
	@lti/d2c
	@lti/prescale
	@lti/xperm
Model Interconnections:
	@lti/append
	@lti/blkdiag
	@lti/connect
	@lti/feedback
	@lti/lft
	@lti/mconnect
	@lti/parallel
	@lti/series
Model Characteristics:
	ctrb
	ctrbf
	@lti/dcgain
	gram
	hsvd
	@lti/isct
	isctrb
	isdetectable
	@lti/isdt
	@lti/isminimumphase
	isobsv
	@lti/issiso
	isstabilizable
	@lti/isstable
	@lti/norm
	obsv
	obsvf
	@lti/pole
	pzmap
	@lti/size
	@lti/zero
Model Simplification:
	@lti/minreal
	@lti/sminreal
Time Domain Analysis:
	covar
	gensig
	impulse
	initial
	lsim
	step
Frequency Domain Analysis:
	bode
	bodemag
	@lti/freqresp
	margin
	nichols
	nyquist
	sigma
Pole Placement:
	place
	rlocus
Linear-Quadratic Control:
    dlqe
    dlqr
    estim
    kalman
    lqe
    lqr
Robust Control:
	augw
	fitfrd
	h2syn
	hinfsyn
	mixsyn
	ncfsyn
Matrix Equation Solvers:
	care
	dare
	dlyap
	dlyapchol
	lyap
	lyapchol
Model Reduction:
	bstmodred
	btamodred
	hnamodred
	spamodred
Controller Reduction:
	btaconred
	cfconred
	fwcfconred
	spaconred
Overloaded Operators:
	@lti/ctranspose
	@lti/horzcat
	@lti/inv
	@lti/minus
	@lti/mldivide
	@lti/mpower
	@lti/mrdivide
	@lti/mtimes
	@lti/plus
	@lti/subsasgn
	@lti/subsref
	@lti/transpose
	@lti/uminus
    @lti/uplus
	@lti/vertcat
Miscellaneous:
	options
	strseq
	test_control
	BMWengine
	Boeing707
	WestlandLynx
<<

License: GPL3+

BuildDepends: <<
  (%type_raw[-lapack] = -atlas)	atlas (>=3.9.11-13),
  (%type_raw[-lapack] = -atlas)	liboctave%type_pkg[oct]-ptatlas-dev,
  (%type_raw[-lapack] = .)		liboctave%type_pkg[oct]-accelerate-dev, 
  (%type_raw[-lapack] = -ref)	lapack341,
  (%type_raw[-lapack] = -ref)	liboctave%type_pkg[oct]-ref-dev,
  liboctave%type_pkg[oct]-gcc%type_pkg[gcc]-dev,
  fftw3,
  hdf5.7,
  (%type_raw[-lapack] = -ref) pkgconfig
<<
Depends: <<
  (%type_raw[-lapack] = -atlas)  atlas-shlibs (>=3.9.11-13),
  (%type_raw[-lapack] = -atlas)	octave%type_pkg[oct]-interpreter-ptatlas, 
  (%type_raw[-lapack] = .)		octave%type_pkg[oct]-interpreter-accelerate,
  (%type_raw[-lapack] = -ref)	lapack341-shlibs,
  (%type_raw[-lapack] = -ref)	octave%type_pkg[oct]-interpreter-ref,
  gcc%type_pkg[gcc]-shlibs
<<
Conflicts: <<
	octave-forge,
	%type_raw[forge]-atlas-oct%type_pkg[oct],
	%type_raw[forge]-ref-oct%type_pkg[oct],
	%type_raw[forge]-oct%type_pkg[oct]
<<
Replaces: <<
	%type_raw[forge]-atlas-oct%type_pkg[oct],
	%type_raw[forge]-ref-oct%type_pkg[oct],
	%type_raw[forge]-oct%type_pkg[oct]
<<

Source-MD5: beb7704c2ed7b073c75b658d8995c212
Source: mirror:sourceforge:octave/%type_raw[forge]-%v.tar.gz
SourceDirectory: %type_pkg[forge]

#### Insert required changes here ####

DescUsage: <<
From discussions with package's author, it appears that using either atlas
or Accelerate for lapack leads to numerical problems.  We are therefore 
looking at using the reference lapack implementation from Fink's lapack341
package.  Install control-ref-oct%type_pkg[oct] to use it.

To see the numerical issues yourself either run

test_control

or look at the individual tests from 

%p/share/octave/%type_raw[oct]/packages/%type_pkg[forge]-%v/test_control.m
<<

PatchScript: <<
	#!/bin/sh -ev
	if [ "%type_raw[-lapack]" = "-ref" ] ; then
		export PKG_CONFIG_PATH=%p/lib/lapack/pkgconfig:$PKG_CONFIG_PATH
		LAPACKLIBS=`pkg-config --libs lapack`
		perl -pi -e "s,^(LAPACK_LIBS\s:=\s).*,\1$LAPACKLIBS, ;\
					 s,^(BLAS_LIBS\s:=).*,\1,"	src/Makefile
	fi
<<

######################################

# Do not change anything from this point down, unless absolutely necessary,
# since the foo-oct%type_pkg[oct] packages are designed to be built/installed
# in the same way.

NoSetCPPFLAGS: true
NoSetLDFLAGS: true
SetLIBRARY_PATH: /usr/X11R6/lib:%p/lib
UseMaxBuildJobs: false
BuildAsNobody: false

CompileScript: <<
#!/bin/sh -ev
if [ $UID -ne 0 ]
then 
	echo "%n cannot be built with --build-as-nobody"
	exit 1
fi
export OCTAVE=%p/bin/octave-%type_raw[oct]
# repack tarball, since octave-3.4.3 appears not to want to install
# from directories
cd ..
tar -cf %type_raw[forge].tar %type_raw[forge]
cd %b
pkgsrc=%type_raw[forge].tar
%p/share/octave/%type_raw[oct]/scripts/octave-forge-compile.sh $pkgsrc
<<

InstallScript: << 
	#!/bin/sh -ev
	%p/share/octave/%type_raw[oct]/scripts/octave-forge-install.sh %type_raw[forge]-%v %i %b
	mkdir -p %i/share/octave/%type_raw[oct]/%type_raw[forge]-%v
	# copy template scripts
	cp %p/share/octave/%type_raw[oct]/scripts/octave-forge-prerm %p/share/octave/%type_raw[oct]/scripts/octave-forge-postinst %i/share/octave/%type_raw[oct]/%type_raw[forge]-%v
	cd %i/share/octave/%type_raw[oct]/%type_raw[forge]-%v
	sed -i -e 's/@PKGNAME@/%type_raw[forge]-%v/' octave-forge-postinst
	sed -i -e 's/@PKGNAME@/%type_raw[forge]/' octave-forge-prerm
	chmod a+x octave-forge*
<<
PostInstScript:  <<
	if [ -s %p/var/octave/%type_raw[oct]/octave_packages ] && [ -f %p/var/octave/%type_raw[oct]/octave_packages ] 
	then 
		%p/share/octave/%type_raw[oct]/%type_raw[forge]-%v/octave-forge-postinst
	else
 		mv %p/share/octave/%type_raw[oct]/packages/%type_raw[forge]-%v/octave_packages %p/var/octave/%type_raw[oct]/octave_packages
	fi
<<

PreRmScript: %p/share/octave/%type_raw[oct]/%type_raw[forge]-%v/octave-forge-prerm

DescPackaging: <<
Common for all octave-forge packages:

We read in postinst and prerm template scripts installed by octaveN and modify
them to use the name of this package because Octave's package manager can't 
cope with non-literal arguments.

The Type: forge (pkgname) is used to minimize what needs to be changed when
using this .info file as a template.
<<
<<