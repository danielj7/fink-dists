diff -ruN evolution-1.0.7.orig/addressbook/gui/component/select-names/e-select-names-text-model.c evolution-1.0.7/addressbook/gui/component/select-names/e-select-names-text-model.c
--- evolution-1.0.7.orig/addressbook/gui/component/select-names/e-select-names-text-model.c	Sat Sep 15 16:18:16 2001
+++ evolution-1.0.7/addressbook/gui/component/select-names/e-select-names-text-model.c	Thu Sep 26 00:01:56 2002
@@ -49,7 +49,7 @@
 static void         e_select_names_text_model_activate_obj (ETextModel *model, gint n);
 
 
-ETextModelClass *parent_class;
+static ETextModelClass *parent_class;
 #define PARENT_TYPE e_text_model_get_type()
 
 /**
diff -ruN evolution-1.0.7.orig/camel/camel-provider.c evolution-1.0.7/camel/camel-provider.c
--- evolution-1.0.7.orig/camel/camel-provider.c	Sun Oct 28 01:59:27 2001
+++ evolution-1.0.7/camel/camel-provider.c	Thu Sep 26 00:01:56 2002
@@ -32,6 +32,7 @@
 #include <config.h>
 #endif
 
+#include <sys/types.h>
 #include <dirent.h>
 #include <errno.h>
 #include <stdio.h>
diff -ruN evolution-1.0.7.orig/camel/camel-tcp-stream-raw.c evolution-1.0.7/camel/camel-tcp-stream-raw.c
--- evolution-1.0.7.orig/camel/camel-tcp-stream-raw.c	Wed Nov 28 06:08:03 2001
+++ evolution-1.0.7/camel/camel-tcp-stream-raw.c	Thu Sep 26 00:01:56 2002
@@ -367,7 +367,7 @@
 	struct sockaddr_in sin;
 	int fd;
 	int ret;
-	socklen_t len;
+	int len;
 	struct timeval tv;
 	int cancel_fd;
 	
diff -ruN evolution-1.0.7.orig/camel/providers/imap/Makefile.in evolution-1.0.7/camel/providers/imap/Makefile.in
--- evolution-1.0.7.orig/camel/providers/imap/Makefile.in	Sat Jun  8 05:54:05 2002
+++ evolution-1.0.7/camel/providers/imap/Makefile.in	Thu Sep 26 00:01:56 2002
@@ -210,7 +210,7 @@
 libcamelimapinclude_HEADERS =  	camel-imap-command.h				camel-imap-folder.h				camel-imap-message-cache.h			camel-imap-search.h				camel-imap-store.h				camel-imap-summary.h				camel-imap-types.h				camel-imap-utils.h				camel-imap-wrapper.h
 
 
-libcamelimap_la_LDFLAGS = -version-info 0:0:0
+libcamelimap_la_LDFLAGS = -version-info 0:0:0 -module
 
 noinst_HEADERS =  	camel-imap-private.h
 
diff -ruN evolution-1.0.7.orig/camel/providers/imap/camel-imap-message-cache.c evolution-1.0.7/camel/providers/imap/camel-imap-message-cache.c
--- evolution-1.0.7.orig/camel/providers/imap/camel-imap-message-cache.c	Mon Oct 29 17:24:00 2001
+++ evolution-1.0.7/camel/providers/imap/camel-imap-message-cache.c	Thu Sep 26 00:01:56 2002
@@ -26,6 +26,7 @@
 #include <config.h>
 #endif
 
+#include <sys/types.h>
 #include <ctype.h>
 #include <dirent.h>
 #include <errno.h>
diff -ruN evolution-1.0.7.orig/camel/providers/local/Makefile.in evolution-1.0.7/camel/providers/local/Makefile.in
--- evolution-1.0.7.orig/camel/providers/local/Makefile.in	Sat Jun  8 05:54:07 2002
+++ evolution-1.0.7/camel/providers/local/Makefile.in	Thu Sep 26 00:01:56 2002
@@ -213,7 +213,7 @@
 noinst_HEADERS =  	camel-local-private.h
 
 
-libcamellocal_la_LDFLAGS = -version-info 0:0:0
+libcamellocal_la_LDFLAGS = -version-info 0:0:0 -module
 
 libcamellocal_la_LIBADD = $(top_builddir)/e-util/libeutil.la $(top_builddir)/libibex/libibex.la
 
diff -ruN evolution-1.0.7.orig/camel/providers/nntp/Makefile.in evolution-1.0.7/camel/providers/nntp/Makefile.in
--- evolution-1.0.7.orig/camel/providers/nntp/Makefile.in	Sat Jun  8 05:54:06 2002
+++ evolution-1.0.7/camel/providers/nntp/Makefile.in	Thu Sep 26 00:01:56 2002
@@ -210,7 +210,7 @@
 libcamelnntpinclude_HEADERS =  	camel-nntp-auth.h				camel-nntp-folder.h				camel-nntp-grouplist.h				camel-nntp-newsrc.h				camel-nntp-resp-codes.h				camel-nntp-store.h				camel-nntp-types.h				camel-nntp-utils.h
 
 
-libcamelnntp_la_LDFLAGS = -version-info 0:0:0
+libcamelnntp_la_LDFLAGS = -version-info 0:0:0 -module
 
 EXTRA_DIST = libcamelnntp.urls
 mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs
diff -ruN evolution-1.0.7.orig/camel/providers/pop3/Makefile.in evolution-1.0.7/camel/providers/pop3/Makefile.in
--- evolution-1.0.7.orig/camel/providers/pop3/Makefile.in	Sat Jun  8 05:54:02 2002
+++ evolution-1.0.7/camel/providers/pop3/Makefile.in	Thu Sep 26 00:01:56 2002
@@ -210,7 +210,7 @@
 libcamelpop3include_HEADERS =  	camel-pop3-folder.h				camel-pop3-store.h
 
 
-libcamelpop3_la_LDFLAGS = $(KRB4_LDFLAGS) -version-info 0:0:0
+libcamelpop3_la_LDFLAGS = $(KRB4_LDFLAGS) -version-info 0:0:0 -module
 
 libcamelpop3_la_LIBADD = $(top_builddir)/e-util/libeutil.la
 
diff -ruN evolution-1.0.7.orig/camel/providers/sendmail/Makefile.in evolution-1.0.7/camel/providers/sendmail/Makefile.in
--- evolution-1.0.7.orig/camel/providers/sendmail/Makefile.in	Sat Jun  8 05:54:03 2002
+++ evolution-1.0.7/camel/providers/sendmail/Makefile.in	Thu Sep 26 00:01:56 2002
@@ -210,7 +210,7 @@
 libcamelsendmailinclude_HEADERS =  	camel-sendmail-transport.h
 
 
-libcamelsendmail_la_LDFLAGS = -version-info 0:0:0
+libcamelsendmail_la_LDFLAGS = -version-info 0:0:0 -module
 
 EXTRA_DIST = libcamelsendmail.urls
 mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs
diff -ruN evolution-1.0.7.orig/camel/providers/smtp/Makefile.in evolution-1.0.7/camel/providers/smtp/Makefile.in
--- evolution-1.0.7.orig/camel/providers/smtp/Makefile.in	Sat Jun  8 05:54:04 2002
+++ evolution-1.0.7/camel/providers/smtp/Makefile.in	Thu Sep 26 00:01:56 2002
@@ -210,7 +210,7 @@
 libcamelsmtpinclude_HEADERS =  	camel-smtp-transport.h
 
 
-libcamelsmtp_la_LDFLAGS = -version-info 0:0:0
+libcamelsmtp_la_LDFLAGS = -version-info 0:0:0 -module
 
 libcamelsmtp_la_LIBADD = $(top_builddir)/e-util/libeutil.la
 
diff -ruN evolution-1.0.7.orig/composer/e-msg-composer.c evolution-1.0.7/composer/e-msg-composer.c
--- evolution-1.0.7.orig/composer/e-msg-composer.c	Tue Jun  4 07:34:11 2002
+++ evolution-1.0.7/composer/e-msg-composer.c	Thu Sep 26 00:01:56 2002
@@ -43,6 +43,7 @@
 #include <errno.h>
 #include <ctype.h>
 #include <stdlib.h>
+#include <sys/types.h>
 #include <dirent.h>
 #include <libgnome/gnome-defs.h>
 #include <libgnomeui/gnome-app.h>
@@ -72,7 +73,8 @@
 #include "camel/camel-charset-map.h"
 #include "camel/camel-session.h"
 
-#include "mail/mail.h"
+#include "mail/mail-real.h"
+#include "mail/mail-callbacks.h"
 #include "mail/mail-crypto.h"
 #include "mail/mail-tools.h"
 #include "mail/mail-ops.h"
diff -ruN evolution-1.0.7.orig/configure evolution-1.0.7/configure
--- evolution-1.0.7.orig/configure	Sat Jun  8 03:05:23 2002
+++ evolution-1.0.7/configure	Thu Sep 26 00:04:31 2002
@@ -4154,7 +4154,8 @@
     #        cross-compilation, but unfortunately the echo tests do not
     #        yet detect zsh echo's removal of \ escapes.  Also zsh mangles
     #	     `"' quotes if we put them in here... so don't!
-    archive_cmds='$nonopt $(test .$module = .yes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib $libobjs $deplibs$linker_flags -install_name $rpath/$soname $verstring'
+    #archive_cmds='$nonopt $(test .$module = .yes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib $libobjs $deplibs$linker_flags -install_name $rpath/$soname $verstring'
+    archive_cmds='$CC $(test .$module = .yes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib $libobjs $deplibs$linkopts $(test .$module != .yes && echo -install_name $rpath/$soname $tmp_verstring)'
     # We need to add '_' to the symbols in $export_symbols first
     #archive_expsym_cmds="$archive_cmds"' && strip -s $export_symbols'
     hardcode_direct=yes
@@ -9297,7 +9298,7 @@
 
 CPPFLAGS_save="$CPPFLAGS"
 CPPFLAGS="$DB3_CFLAGS $CPPFLAGS"
-for ac_hdr in db.h db3/db.h
+for ac_hdr in db3/db.h
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
@@ -9348,11 +9349,7 @@
 #line 9349 "configure"
 #include "confdefs.h"
 
-		#ifdef HAVE_DB3_DB_H
-		#include <db3/db.h>
-		#else
 		#include <db.h>
-		#endif
 	
 int main() {
 
@@ -9396,11 +9393,7 @@
 #line 9397 "configure"
 #include "confdefs.h"
 
-			#ifdef HAVE_DB3_DB_H
-			#include <db3/db.h>
-			#else
 			#include <db.h>
-			#endif
 		
 int main() {
 
@@ -9447,11 +9440,7 @@
 #line 9448 "configure"
 #include "confdefs.h"
 
-		#ifdef HAVE_DB3_DB_H
-		#include <db3/db.h>
-		#else
 		#include <db.h>
-		#endif
 
 		int
 		main (void)
diff -ruN evolution-1.0.7.orig/doc/devel/calendar/cal-util/Makefile.in evolution-1.0.7/doc/devel/calendar/cal-util/Makefile.in
--- evolution-1.0.7.orig/doc/devel/calendar/cal-util/Makefile.in	Sat Jun  8 05:59:38 2002
+++ evolution-1.0.7/doc/devel/calendar/cal-util/Makefile.in	Thu Sep 26 00:01:56 2002
@@ -377,7 +377,7 @@
 @ENABLE_GTK_DOC_TRUE@scan-build.stamp: $(HFILE_GLOB)
 @ENABLE_GTK_DOC_TRUE@	@echo '*** Scanning header files ***'
 @ENABLE_GTK_DOC_TRUE@	if grep -l '^..*$$' $(srcdir)/$(DOC_MODULE).types > /dev/null ; then \
-@ENABLE_GTK_DOC_TRUE@	    CC="$(GTKDOC_CC)" LD="$(GTKDOC_LD)" CFLAGS="$(GTKDOC_CFLAGS)" LDFLAGS="$(GTKDOC_LIBS)" gtkdoc-scanobj --module=$(DOC_MODULE) --output-dir=$(srcdir) ; \
+@ENABLE_GTK_DOC_TRUE@	    CC="$(GTKDOC_CC)" LD="$(GTKDOC_LD)" CFLAGS="$(GTKDOC_CFLAGS) -no-cpp-precomp" LDFLAGS="$(GTKDOC_LIBS)" gtkdoc-scanobj --module=$(DOC_MODULE) --output-dir=$(srcdir) ; \
 @ENABLE_GTK_DOC_TRUE@	else \
 @ENABLE_GTK_DOC_TRUE@	    cd $(srcdir) ; \
 @ENABLE_GTK_DOC_TRUE@	    for i in $(SCANOBJ_FILES) ; do \
diff -ruN evolution-1.0.7.orig/e-util/Makefile.in evolution-1.0.7/e-util/Makefile.in
--- evolution-1.0.7.orig/e-util/Makefile.in	Sat Jun  8 05:53:24 2002
+++ evolution-1.0.7/e-util/Makefile.in	Thu Sep 26 00:01:56 2002
@@ -218,7 +218,7 @@
 pilot_sources =  	e-pilot-map.c		e-pilot-map.h		e-pilot-util.c		e-pilot-util.h
 
 @ENABLE_PILOT_CONDUITS_TRUE@pilot_compile = $(pilot_sources)
-@ENABLE_PILOT_CONDUITS_FALSE@pilot_compile = 
+@ENABLE_PILOT_CONDUITS_FALSE@pilot_compile = dummy.c
 
 libeconduit_la_SOURCES = $(pilot_compile)
 
@@ -258,11 +258,11 @@
 e-url.lo md5-utils.lo
 libeconduit_la_LDFLAGS = 
 libeconduit_la_LIBADD = 
-@ENABLE_PILOT_CONDUITS_FALSE@libeconduit_la_OBJECTS = 
+@ENABLE_PILOT_CONDUITS_FALSE@libeconduit_la_OBJECTS = dummy.lo
 @ENABLE_PILOT_CONDUITS_TRUE@libeconduit_la_OBJECTS =  e-pilot-map.lo \
 @ENABLE_PILOT_CONDUITS_TRUE@e-pilot-util.lo
 libeconduit_static_la_LIBADD = 
-@ENABLE_PILOT_CONDUITS_FALSE@libeconduit_static_la_OBJECTS = 
+@ENABLE_PILOT_CONDUITS_FALSE@libeconduit_static_la_OBJECTS = dummy.lo
 @ENABLE_PILOT_CONDUITS_TRUE@libeconduit_static_la_OBJECTS =  \
 @ENABLE_PILOT_CONDUITS_TRUE@e-pilot-map.lo e-pilot-util.lo
 libedb3util_la_LDFLAGS = 
diff -ruN evolution-1.0.7.orig/e-util/dummy.c evolution-1.0.7/e-util/dummy.c
--- evolution-1.0.7.orig/e-util/dummy.c	Thu Jan  1 09:00:00 1970
+++ evolution-1.0.7/e-util/dummy.c	Thu Sep 26 00:01:56 2002
@@ -0,0 +1,6 @@
+/* Empty placeholder, to prevent link error when no conduits are used */
+
+static int foo()
+{
+	return 0;
+}
\ No newline at end of file
diff -ruN evolution-1.0.7.orig/e-util/e-path.c evolution-1.0.7/e-util/e-path.c
--- evolution-1.0.7.orig/e-util/e-path.c	Sun Oct 28 01:59:34 2001
+++ evolution-1.0.7/e-util/e-path.c	Thu Sep 26 00:01:56 2002
@@ -20,6 +20,7 @@
 
 #include <config.h>
 
+#include <sys/types.h>
 #include <dirent.h>
 #include <string.h>
 #include <sys/stat.h>
diff -ruN evolution-1.0.7.orig/libibex/block.c evolution-1.0.7/libibex/block.c
--- evolution-1.0.7.orig/libibex/block.c	Sun Oct 28 03:18:15 2001
+++ evolution-1.0.7/libibex/block.c	Thu Sep 26 00:01:56 2002
@@ -44,7 +44,7 @@
 #define d(x)
 /*#define DEBUG*/
 
-int block_log;
+static int block_log;
 
 #ifdef IBEX_STATS
 static void
diff -ruN evolution-1.0.7.orig/libical/src/libical/icallangbind.c evolution-1.0.7/libical/src/libical/icallangbind.c
--- evolution-1.0.7.orig/libical/src/libical/icallangbind.c	Wed Apr 18 02:54:44 2001
+++ evolution-1.0.7/libical/src/libical/icallangbind.c	Thu Sep 26 00:01:56 2002
@@ -22,7 +22,6 @@
 #include "icalproperty.h"
 #include "icalerror.h"
 #include "icalmemory.h"
-#include <malloc.h>
 #include <string.h>
 
 int* icallangbind_new_array(int size){
diff -ruN evolution-1.0.7.orig/libversit/vcc.c evolution-1.0.7/libversit/vcc.c
--- evolution-1.0.7.orig/libversit/vcc.c	Tue Jun  4 04:28:54 2002
+++ evolution-1.0.7/libversit/vcc.c	Thu Sep 26 00:01:56 2002
@@ -139,9 +139,6 @@
 #endif
 
 #include <string.h>
-#ifndef __MWERKS__
-#include <malloc.h>
-#endif
 #include <stdio.h>
 #include <stdlib.h>
 #include <ctype.h>
diff -ruN evolution-1.0.7.orig/libversit/vobject.c evolution-1.0.7/libversit/vobject.c
--- evolution-1.0.7.orig/libversit/vobject.c	Sat Jan  1 05:35:35 2000
+++ evolution-1.0.7/libversit/vobject.c	Thu Sep 26 00:01:56 2002
@@ -42,10 +42,6 @@
  * vobject, and convert a vobject into its textual representation.
  */
 
-#ifndef	 MWERKS
-#include <malloc.h>
-#endif
-
 #include "vobject.h"
 #include <string.h>
 #include <stdio.h>
diff -ruN evolution-1.0.7.orig/ltmain.sh evolution-1.0.7/ltmain.sh
--- evolution-1.0.7.orig/ltmain.sh	Sat Jun  8 03:05:23 2002
+++ evolution-1.0.7/ltmain.sh	Thu Sep 26 00:10:10 2002
@@ -2931,7 +2931,23 @@
 	if test -n "$export_symbols" && test -n "$archive_expsym_cmds"; then
 	  eval cmds=\"$archive_expsym_cmds\"
 	else
-	  eval cmds=\"$archive_cmds\"
+        if test "x$verstring" = "x0.0"; then
+           tmp_verstring=
+         else
+           tmp_verstring="$verstring"
+         fi	
+	  save_deplibs="$deplibs"
+     for conv in $convenience; do
+       tmp_deplibs=
+       for test_deplib in $deplibs; do
+          if test "$test_deplib" != "$conv"; then
+            tmp_deplibs="$tmp_deplibs $test_deplib"
+          fi
+        done
+        deplibs="$tmp_deplibs"
+      done
+      eval cmds=\"$archive_cmds\"
+      deplibs="$save_deplibs"	  
 	fi
 	save_ifs="$IFS"; IFS='~'
 	for cmd in $cmds; do
diff -ruN evolution-1.0.7.orig/mail/Makefile.in evolution-1.0.7/mail/Makefile.in
--- evolution-1.0.7.orig/mail/Makefile.in	Sat Jun  8 05:56:02 2002
+++ evolution-1.0.7/mail/Makefile.in	Thu Sep 26 00:01:57 2002
@@ -210,10 +210,10 @@
 
 @ENABLE_NNTP_TRUE@EVOLUTION_MAIL_NNTP = 	mail-account-editor-news.c		mail-account-editor-news.h	
 
-evolution_mail_SOURCES =  	$(EVOLUTION_MAIL_CORBA_GENERATED)		$(EVOLUTION_MAIL_NNTP)          	component-factory.c			component-factory.h			e-searching-tokenizer.c			e-searching-tokenizer.h			folder-browser.c			folder-browser.h			folder-browser-factory.c		folder-browser-factory.h		folder-browser-ui.c			folder-browser-ui.h			folder-info.c				mail-accounts.c				mail-accounts.h				mail-account-editor.c			mail-account-editor.h			mail-account-gui.c			mail-account-gui.h			mail-autofilter.c			mail-autofilter.h			mail-callbacks.c			mail-callbacks.h			mail-config.c				mail-config.h				mail-config-druid.c			mail-config-druid.h			mail-crypto.c				mail-crypto.h				mail-display.c				mail-display.h				mail-folder-cache.c			mail-folder-cache.h			mail-format.c				mail-identify.c				mail-importer.c				mail-importer.h				mail-local.c				mail-local.h				mail-mt.c				mail-mt.h				mail-offline-handler.c			mail-offline-handler.h			mail-ops.c				mail-ops.h				mail-search.c				mail-search.h				mail-search-dialogue.c			mail-search-dialogue.h			mail-send-recv.c			mail-send-recv.h			mail-session.c				mail-session.h				mail-stream-gtkhtml.c			mail-stream-gtkhtml.h			mail-tools.c				mail-tools.h				mail-types.h				mail-vfolder.c				mail-vfolder.h				message-browser.c			message-browser.h			main.c					message-list.c				message-list.h				subscribe-dialog.c			subscribe-dialog.h			mail.h
+evolution_mail_SOURCES =  	$(EVOLUTION_MAIL_CORBA_GENERATED)		$(EVOLUTION_MAIL_NNTP)          	component-factory.c			component-factory.h			e-searching-tokenizer.c			e-searching-tokenizer.h			folder-browser.c			folder-browser.h			folder-browser-factory.c		folder-browser-factory.h		folder-browser-ui.c			folder-browser-ui.h			folder-info.c				mail-accounts.c				mail-accounts.h				mail-account-editor.c			mail-account-editor.h			mail-account-gui.c			mail-account-gui.h			mail-autofilter.c			mail-autofilter.h			mail-callbacks.c			mail-callbacks.h			mail-config.c				mail-config.h				mail-config-druid.c			mail-config-druid.h			mail-crypto.c				mail-crypto.h				mail-display.c				mail-display.h				mail-folder-cache.c			mail-folder-cache.h			mail-format.c				mail-identify.c				mail-importer.c				mail-importer.h				mail-local.c				mail-local.h				mail-mt.c				mail-mt.h				mail-offline-handler.c			mail-offline-handler.h			mail-ops.c				mail-ops.h				mail-search.c				mail-search.h				mail-search-dialogue.c			mail-search-dialogue.h			mail-send-recv.c			mail-send-recv.h			mail-session.c				mail-session.h				mail-stream-gtkhtml.c			mail-stream-gtkhtml.h			mail-tools.c				mail-tools.h				mail-types.h				mail-vfolder.c				mail-vfolder.h				message-browser.c			message-browser.h			main.c					message-list.c				message-list.h				subscribe-dialog.c			subscribe-dialog.h			mail-real.h
 
 
-evolution_mail_LDADD =  	$(top_builddir)/camel/libcamel.la			$(top_builddir)/e-util/libeutil.la			$(top_builddir)/shell/libeshell.la			$(top_builddir)/composer/libcomposer.a			$(top_builddir)/widgets/misc/libemiscwidgets.a		$(top_builddir)/addressbook/backend/ebook/libebook.la		$(top_builddir)/libversit/libversit.la			$(top_builddir)/e-util/ename/libename.la		$(top_builddir)/libibex/libibex.la			$(top_builddir)/filter/libfilter.la			$(top_builddir)/shell/importer/libevolution-importer.la					$(top_builddir)/widgets/menus/libmenus.la		$(MAILER_LIBS)
+evolution_mail_LDADD =  	$(top_builddir)/camel/libcamel.la			$(top_builddir)/e-util/libeutil.la			$(top_builddir)/shell/libeshell.la			$(top_builddir)/composer/libcomposer.a			$(top_builddir)/widgets/misc/libemiscwidgets.a		$(top_builddir)/addressbook/backend/ebook/libebook.la		$(top_builddir)/libversit/libversit.la			$(top_builddir)/e-util/ename/libename.la		$(top_builddir)/libibex/libibex.la			$(top_builddir)/filter/libfilter.la			$(top_builddir)/shell/importer/libevolution-importer.la					$(top_builddir)/widgets/menus/libmenus.la		$(top_builddir)/camel/camel-smime-context.o	$(MAILER_LIBS)
 
 
 evolution_mail_LDFLAGS =  	-export-dynamic
diff -ruN evolution-1.0.7.orig/mail/component-factory.c evolution-1.0.7/mail/component-factory.c
--- evolution-1.0.7.orig/mail/component-factory.c	Sat Jun  1 03:48:34 2002
+++ evolution-1.0.7/mail/component-factory.c	Thu Sep 26 00:01:56 2002
@@ -37,7 +37,7 @@
 #include "evolution-shell-component.h"
 #include "evolution-shell-component-dnd.h"
 #include "folder-browser.h"
-#include "mail.h"		/* YUCK FIXME */
+#include "mail-real.h"		/* YUCK FIXME */
 #include "mail-config.h"
 #include "mail-tools.h"
 #include "mail-ops.h"
diff -ruN evolution-1.0.7.orig/mail/folder-browser-factory.c evolution-1.0.7/mail/folder-browser-factory.c
--- evolution-1.0.7.orig/mail/folder-browser-factory.c	Thu Oct 25 04:00:22 2001
+++ evolution-1.0.7/mail/folder-browser-factory.c	Thu Sep 26 00:01:56 2002
@@ -31,7 +31,7 @@
 
 #include "folder-browser.h"
 #include "folder-browser-ui.h"
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-callbacks.h"
 #include "shell/Evolution.h"
 #include "mail-config.h"
diff -ruN evolution-1.0.7.orig/mail/folder-browser.c evolution-1.0.7/mail/folder-browser.c
--- evolution-1.0.7.orig/mail/folder-browser.c	Mon Feb 25 12:01:15 2002
+++ evolution-1.0.7/mail/folder-browser.c	Thu Sep 26 00:01:56 2002
@@ -52,7 +52,7 @@
 #include "e-util/e-mktemp.h"
 #include "folder-browser.h"
 #include "e-searching-tokenizer.h"
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-callbacks.h"
 #include "mail-tools.h"
 #include "message-list.h"
diff -ruN evolution-1.0.7.orig/mail/folder-info.c evolution-1.0.7/mail/folder-info.c
--- evolution-1.0.7.orig/mail/folder-info.c	Tue Oct 30 20:10:48 2001
+++ evolution-1.0.7/mail/folder-info.c	Thu Sep 26 00:01:56 2002
@@ -20,7 +20,7 @@
 #include <bonobo/bonobo-context.h>
 #include <bonobo/bonobo-exception.h>
 
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-mt.h"
 #include "mail-tools.h"
 
diff -ruN evolution-1.0.7.orig/mail/importers/Makefile.in evolution-1.0.7/mail/importers/Makefile.in
--- evolution-1.0.7.orig/mail/importers/Makefile.in	Sat Jun  8 05:56:40 2002
+++ evolution-1.0.7/mail/importers/Makefile.in	Thu Sep 26 00:01:56 2002
@@ -205,10 +205,10 @@
 
 liboutlook_la_SOURCES =  	evolution-outlook-importer.c
 
-liboutlook_la_LDFLAGS = -version-info 0:0:0
+liboutlook_la_LDFLAGS = -version-info 0:0:0 -module
 
 libmbox_la_SOURCES = evolution-mbox-importer.c
-libmbox_la_LDFLAGS = -version-info 0:0:0
+libmbox_la_LDFLAGS = -version-info 0:0:0 -module
 
 oafdir = $(datadir)/oaf
 oaf_in_files = GNOME_Evolution_Mail_Mbox_Importer.oaf.in		GNOME_Evolution_Mail_Outlook_Importer.oaf.in
diff -ruN evolution-1.0.7.orig/mail/mail-accounts.c evolution-1.0.7/mail/mail-accounts.c
--- evolution-1.0.7.orig/mail/mail-accounts.c	Tue Dec 11 04:49:55 2001
+++ evolution-1.0.7/mail/mail-accounts.c	Thu Sep 26 00:01:56 2002
@@ -33,10 +33,11 @@
 #include <camel/camel-pgp-context.h>
 
 #include <gal/widgets/e-unicode.h>
+#include <gdk-pixbuf/gdk-pixbuf.h>
 
 #include "widgets/misc/e-charset-picker.h"
 
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-accounts.h"
 #include "mail-config.h"
 #include "mail-config-druid.h"
diff -ruN evolution-1.0.7.orig/mail/mail-callbacks.c evolution-1.0.7/mail/mail-callbacks.c
--- evolution-1.0.7.orig/mail/mail-callbacks.c	Fri Apr 19 05:45:18 2002
+++ evolution-1.0.7/mail/mail-callbacks.c	Thu Sep 26 00:01:56 2002
@@ -43,7 +43,7 @@
 #include <gal/widgets/e-gui-utils.h>
 #include <gal/widgets/e-unicode.h>
 #include <filter/filter-editor.h>
-#include "mail.h"
+#include "mail-real.h"
 #include "message-browser.h"
 #include "mail-callbacks.h"
 #include "mail-config.h"
@@ -70,6 +70,10 @@
 #include <fcntl.h>
 #include <sys/stat.h>
 #endif
+
+/* more globals ... */
+extern char *evolution_dir;
+extern CamelSession *session;
 
 #define FB_WINDOW(fb) GTK_WINDOW (gtk_widget_get_ancestor (GTK_WIDGET (fb), GTK_TYPE_WINDOW))
 
diff -ruN evolution-1.0.7.orig/mail/mail-config-druid.c evolution-1.0.7/mail/mail-config-druid.c
--- evolution-1.0.7.orig/mail/mail-config-druid.c	Tue Nov  6 08:10:12 2001
+++ evolution-1.0.7/mail/mail-config-druid.c	Thu Sep 26 00:01:56 2002
@@ -42,7 +42,7 @@
 #include "mail-config-druid.h"
 #include "mail-config.h"
 #include "mail-ops.h"
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-session.h"
 
 #include <bonobo/bonobo-exception.h>
diff -ruN evolution-1.0.7.orig/mail/mail-config.c evolution-1.0.7/mail/mail-config.c
--- evolution-1.0.7.orig/mail/mail-config.c	Sat Dec 15 05:01:30 2001
+++ evolution-1.0.7/mail/mail-config.c	Thu Sep 26 00:01:56 2002
@@ -61,7 +61,7 @@
 #include <e-util/e-html-utils.h>
 #include <e-util/e-url.h>
 #include <e-util/e-passwords.h>
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-config.h"
 #include "mail-mt.h"
 #include "mail-tools.h"
@@ -109,6 +109,10 @@
 } MailConfig;
 
 static MailConfig *config = NULL;
+
+/* more globals ... */
+extern char *evolution_dir;
+extern CamelSession *session;
 
 #define MAIL_CONFIG_IID "OAFIID:GNOME_Evolution_MailConfig_Factory"
 
diff -ruN evolution-1.0.7.orig/mail/mail-display.c evolution-1.0.7/mail/mail-display.c
--- evolution-1.0.7.orig/mail/mail-display.c	Sat Feb 16 09:34:32 2002
+++ evolution-1.0.7/mail/mail-display.c	Thu Sep 26 00:01:56 2002
@@ -47,10 +47,11 @@
 #include "folder-browser-factory.h"
 #include "mail-stream-gtkhtml.h"
 #include "mail-display.h"
+#include "mail-callbacks.h"
 #include "mail-config.h"
 #include "mail-ops.h"
 #include "mail-mt.h"
-#include "mail.h"
+#include "mail-real.h"
 
 #include "art/empty.xpm"
 
diff -ruN evolution-1.0.7.orig/mail/mail-format.c evolution-1.0.7/mail/mail-format.c
--- evolution-1.0.7.orig/mail/mail-format.c	Wed Feb 13 10:13:00 2002
+++ evolution-1.0.7/mail/mail-format.c	Thu Sep 26 00:01:56 2002
@@ -44,7 +44,7 @@
 #include <e-util/e-html-utils.h>
 #include <gal/util/e-unicode-i18n.h>
 
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-tools.h"
 #include "mail-display.h"
 #include "mail-mt.h"
diff -ruN evolution-1.0.7.orig/mail/mail-identify.c evolution-1.0.7/mail/mail-identify.c
--- evolution-1.0.7.orig/mail/mail-identify.c	Sun Oct 28 03:21:05 2001
+++ evolution-1.0.7/mail/mail-identify.c	Thu Sep 26 00:01:56 2002
@@ -32,7 +32,7 @@
 #include <glib.h>
 #include <libgnomevfs/gnome-vfs-mime.h>
 #include <libgnomevfs/gnome-vfs-mime-sniff-buffer.h>
-#include "mail.h"
+#include "mail-real.h"
 
 static const char *identify_by_magic (CamelDataWrapper *data, MailDisplay *md);
 
diff -ruN evolution-1.0.7.orig/mail/mail-importer.c evolution-1.0.7/mail/mail-importer.c
--- evolution-1.0.7.orig/mail/mail-importer.c	Sat Oct 27 09:47:21 2001
+++ evolution-1.0.7/mail/mail-importer.c	Thu Sep 26 00:01:56 2002
@@ -24,6 +24,7 @@
 #include <config.h>
 #endif
 
+#include <sys/types.h>
 #include <dirent.h>
 #include <gmodule.h>
 #include <libgnome/gnome-defs.h>
@@ -36,7 +37,7 @@
 
 #include "mail-importer.h"
 #include "mail-local.h"
-#include "mail.h"
+#include "mail-real.h"
 
 
 static GList *importer_modules = NULL;
diff -ruN evolution-1.0.7.orig/mail/mail-local.c evolution-1.0.7/mail/mail-local.c
--- evolution-1.0.7.orig/mail/mail-local.c	Tue Oct 30 14:23:43 2001
+++ evolution-1.0.7/mail/mail-local.c	Thu Sep 26 00:01:56 2002
@@ -49,7 +49,7 @@
 #include "camel/camel.h"
 #include "camel/camel-vtrash-folder.h"
 
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-local.h"
 #include "mail-tools.h"
 #include "folder-browser.h"
diff -ruN evolution-1.0.7.orig/mail/mail-offline-handler.c evolution-1.0.7/mail/mail-offline-handler.c
--- evolution-1.0.7.orig/mail/mail-offline-handler.c	Sat Oct 27 09:47:21 2001
+++ evolution-1.0.7/mail/mail-offline-handler.c	Thu Sep 26 00:01:56 2002
@@ -27,7 +27,7 @@
 #endif
 
 #include "mail-offline-handler.h"
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-ops.h"
 
 #include <gtk/gtkmain.h>
diff -ruN evolution-1.0.7.orig/mail/mail-ops.c evolution-1.0.7/mail/mail-ops.c
--- evolution-1.0.7.orig/mail/mail-ops.c	Tue Mar  5 03:14:39 2002
+++ evolution-1.0.7/mail/mail-ops.c	Thu Sep 26 00:01:56 2002
@@ -37,7 +37,7 @@
 #include <camel/camel-operation.h>
 #include <camel/camel-vtrash-folder.h>
 #include <camel/camel-vee-store.h>
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-tools.h"
 #include "mail-ops.h"
 #include "mail-vfolder.h"
diff -ruN evolution-1.0.7.orig/mail/mail-send-recv.c evolution-1.0.7/mail/mail-send-recv.c
--- evolution-1.0.7.orig/mail/mail-send-recv.c	Thu Jan 24 01:52:20 2002
+++ evolution-1.0.7/mail/mail-send-recv.c	Thu Sep 26 00:01:56 2002
@@ -41,7 +41,7 @@
 
 #include "evolution-storage.h"
 
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-mt.h"
 #include "mail-config.h"
 #include "mail-session.h"
diff -ruN evolution-1.0.7.orig/mail/mail-session.c evolution-1.0.7/mail/mail-session.c
--- evolution-1.0.7.orig/mail/mail-session.c	Thu Nov 15 03:36:14 2001
+++ evolution-1.0.7/mail/mail-session.c	Thu Sep 26 00:01:56 2002
@@ -36,7 +36,7 @@
 #include "camel/camel-filter-driver.h"
 #include "filter/filter-context.h"
 #include "filter/filter-filter.h"
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-session.h"
 #include "mail-tools.h"
 #include "mail-mt.h"
diff -ruN evolution-1.0.7.orig/mail/mail-tools.c evolution-1.0.7/mail/mail-tools.c
--- evolution-1.0.7.orig/mail/mail-tools.c	Thu Jan  3 03:02:23 2002
+++ evolution-1.0.7/mail/mail-tools.c	Thu Sep 26 00:01:56 2002
@@ -38,7 +38,7 @@
 #include "filter/vfolder-context.h"
 #include "filter/filter-option.h"
 #include "filter/filter-input.h"
-#include "mail.h" /*session*/
+#include "mail-real.h" /*session*/
 #include "mail-tools.h"
 #include "mail-local.h"
 #include "mail-mt.h"
diff -ruN evolution-1.0.7.orig/mail/mail-vfolder.c evolution-1.0.7/mail/mail-vfolder.c
--- evolution-1.0.7.orig/mail/mail-vfolder.c	Tue Dec 11 04:49:55 2001
+++ evolution-1.0.7/mail/mail-vfolder.c	Thu Sep 26 00:01:56 2002
@@ -28,7 +28,7 @@
 #include "mail-tools.h"
 #include "mail-autofilter.h"
 #include "mail-folder-cache.h"
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-ops.h"
 #include "mail-mt.h"
 
diff -ruN evolution-1.0.7.orig/mail/main.c evolution-1.0.7/mail/main.c
--- evolution-1.0.7.orig/mail/main.c	Tue Dec 18 01:21:53 2001
+++ evolution-1.0.7/mail/main.c	Thu Sep 26 00:01:56 2002
@@ -33,7 +33,7 @@
 
 #include "component-factory.h"
 #include "composer/evolution-composer.h"
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-mt.h"
 
 /*#define DO_MCHECK*/
diff -ruN evolution-1.0.7.orig/mail/message-browser.c evolution-1.0.7/mail/message-browser.c
--- evolution-1.0.7.orig/mail/message-browser.c	Tue Nov  6 07:44:56 2001
+++ evolution-1.0.7/mail/message-browser.c	Thu Sep 26 00:01:56 2002
@@ -34,7 +34,7 @@
 
 #include "message-browser.h"
 
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-callbacks.h"
 #include "mail-tools.h"
 #include "message-list.h"
diff -ruN evolution-1.0.7.orig/mail/subscribe-dialog.c evolution-1.0.7/mail/subscribe-dialog.c
--- evolution-1.0.7.orig/mail/subscribe-dialog.c	Tue Oct 30 12:28:40 2001
+++ evolution-1.0.7/mail/subscribe-dialog.c	Thu Sep 26 00:01:57 2002
@@ -40,7 +40,7 @@
 #include <pthread.h>
 
 #include "evolution-shell-component-utils.h"
-#include "mail.h"
+#include "mail-real.h"
 #include "mail-tools.h"
 #include "mail-ops.h"
 #include "mail-mt.h"
diff -ruN evolution-1.0.7.orig/shell/e-local-storage.c evolution-1.0.7/shell/e-local-storage.c
--- evolution-1.0.7.orig/shell/e-local-storage.c	Tue Oct 30 14:02:49 2001
+++ evolution-1.0.7/shell/e-local-storage.c	Thu Sep 26 00:01:57 2002
@@ -33,12 +33,12 @@
 #include <config.h>
 #endif
 
+#include <sys/types.h>
 #include <dirent.h>
 
 #include <errno.h>
 #include <string.h>
 #include <sys/param.h>
-#include <sys/types.h>
 #include <sys/stat.h>
 
 #include <gtk/gtksignal.h>
