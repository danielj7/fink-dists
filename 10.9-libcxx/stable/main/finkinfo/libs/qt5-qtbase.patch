diff -ruN qtbase-opensource-src-5.5.1-orig/config.tests/unix/glib/glib.pro qtbase-opensource-src-5.5.1/config.tests/unix/glib/glib.pro
--- qtbase-opensource-src-5.5.1-orig/config.tests/unix/glib/glib.pro	2015-10-12 23:35:35.000000000 -0500
+++ qtbase-opensource-src-5.5.1/config.tests/unix/glib/glib.pro	2015-12-13 17:02:56.000000000 -0600
@@ -1,2 +1,3 @@
 SOURCES = glib.cpp
 CONFIG -= qt
+LIBS += -lgthread-2.0 -lglib-2.0
diff -ruN qtbase-opensource-src-5.5.1-orig/config.tests/unix/gnu-libiconv/gnu-libiconv.cpp qtbase-opensource-src-5.5.1/config.tests/unix/gnu-libiconv/gnu-libiconv.cpp
--- qtbase-opensource-src-5.5.1-orig/config.tests/unix/gnu-libiconv/gnu-libiconv.cpp	2015-10-12 23:35:34.000000000 -0500
+++ qtbase-opensource-src-5.5.1/config.tests/unix/gnu-libiconv/gnu-libiconv.cpp	2015-12-13 17:02:56.000000000 -0600
@@ -40,7 +40,7 @@
 {
     iconv_t x = iconv_open("", "");
 
-    const char *inp;
+    char *inp;
     char *outp;
     size_t inbytes, outbytes;
     iconv(x, &inp, &inbytes, &outp, &outbytes);
diff -ruN qtbase-opensource-src-5.5.1-orig/mkspecs/common/gcc-base-mac.conf qtbase-opensource-src-5.5.1/mkspecs/common/gcc-base-mac.conf
--- qtbase-opensource-src-5.5.1-orig/mkspecs/common/gcc-base-mac.conf	2015-10-12 23:35:32.000000000 -0500
+++ qtbase-opensource-src-5.5.1/mkspecs/common/gcc-base-mac.conf	2015-12-13 17:02:56.000000000 -0600
@@ -23,7 +23,7 @@
 QMAKE_LFLAGS           += -headerpad_max_install_names
 
 QMAKE_LFLAGS_SHLIB         += -single_module -dynamiclib
-QMAKE_LFLAGS_PLUGIN        += $$QMAKE_LFLAGS_SHLIB
+QMAKE_LFLAGS_PLUGIN        += -bundle
 QMAKE_LFLAGS_INCREMENTAL   += -undefined suppress -flat_namespace
 QMAKE_LFLAGS_SONAME        += -install_name$${LITERAL_WHITESPACE}
 QMAKE_LFLAGS_VERSION       += -current_version$${LITERAL_WHITESPACE}
diff -ruN qtbase-opensource-src-5.5.1-orig/mkspecs/common/mac.conf qtbase-opensource-src-5.5.1/mkspecs/common/mac.conf
--- qtbase-opensource-src-5.5.1-orig/mkspecs/common/mac.conf	2015-10-12 23:35:32.000000000 -0500
+++ qtbase-opensource-src-5.5.1/mkspecs/common/mac.conf	2015-12-13 17:02:56.000000000 -0600
@@ -8,6 +8,7 @@
 
 QMAKE_RESOURCE          = /Developer/Tools/Rez
 QMAKE_EXTENSION_SHLIB   = dylib
+QMAKE_EXTENSION_PLUGIN  = so
 QMAKE_LIBDIR            =
 
 # sdk.prf will prefix the proper SDK sysroot
diff -ruN qtbase-opensource-src-5.5.1-orig/mkspecs/features/create_cmake.prf qtbase-opensource-src-5.5.1/mkspecs/features/create_cmake.prf
--- qtbase-opensource-src-5.5.1-orig/mkspecs/features/create_cmake.prf	2015-10-12 23:35:32.000000000 -0500
+++ qtbase-opensource-src-5.5.1/mkspecs/features/create_cmake.prf	2015-12-13 17:02:56.000000000 -0600
@@ -147,7 +147,7 @@
         }
     } else {
         mac {
-            isEmpty(CMAKE_STATIC_TYPE): CMAKE_PlUGIN_EXT = .dylib
+            isEmpty(CMAKE_STATIC_TYPE): CMAKE_PlUGIN_EXT = .so
             else: CMAKE_PlUGIN_EXT = .a
 
             CMAKE_PLUGIN_LOCATION_RELEASE = $$PLUGIN_TYPE/lib$${TARGET}$${CMAKE_PlUGIN_EXT}
diff -ruN qtbase-opensource-src-5.6.0-orig/mkspecs/features/qt_module.prf qtbase-opensource-src-5.6.0/mkspecs/features/qt_module.prf
--- qtbase-opensource-src-5.6.0-orig/mkspecs/features/qt_module.prf	2016-03-03 05:35:22.000000000 -0600
+++ qtbase-opensource-src-5.6.0/mkspecs/features/qt_module.prf	2016-03-18 22:01:07.000000000 -0500
@@ -245,7 +245,7 @@
 load(qt_targets)
 
 # this builds on top of qt_common
-!internal_module:!lib_bundle:if(unix|mingw) {
+unix|mingw {
     CONFIG += create_pc
     QMAKE_PKGCONFIG_DESTDIR = pkgconfig
     host_build: \
diff -ruN qtbase-opensource-src-5.6.0-orig/mkspecs/macx-clang/qmake.conf qtbase-opensource-src-5.6.0/mkspecs/macx-clang/qmake.conf
--- qtbase-opensource-src-5.6.0-orig/mkspecs/macx-clang/qmake.conf	2016-03-03 05:35:22.000000000 -0600
+++ qtbase-opensource-src-5.6.0/mkspecs/macx-clang/qmake.conf	2016-03-18 22:02:34.000000000 -0500
@@ -11,6 +11,6 @@
 include(../common/clang.conf)
 include(../common/clang-mac.conf)
 
-QMAKE_MACOSX_DEPLOYMENT_TARGET = 10.7
+QMAKE_MACOSX_DEPLOYMENT_TARGET = @MACOSX_DEPLOYMENT_TARGET@
 
 load(qt_config)
diff -ruN qtbase-opensource-src-5.6.0-orig/src/platformsupport/fontdatabases/mac/coretext.pri qtbase-opensource-src-5.6.0/src/platformsupport/fontdatabases/mac/coretext.pri
--- qtbase-opensource-src-5.6.0-orig/src/platformsupport/fontdatabases/mac/coretext.pri	2016-03-03 05:35:22.000000000 -0600
+++ qtbase-opensource-src-5.6.0/src/platformsupport/fontdatabases/mac/coretext.pri	2016-03-17 21:55:50.000000000 -0500
@@ -8,6 +8,12 @@
     CONFIG += opentype
 }
 
+contains(QT_CONFIG, system-freetype) {
+    HEADERS += $$QT_SOURCE_TREE/src/gui/text/qfontengine_ft_p.h
+    SOURCES += $$QT_SOURCE_TREE/src/gui/text/qfontengine_ft.cpp
+    CONFIG += opentype
+}
+
 ios: \
     # On iOS CoreText and CoreGraphics are stand-alone frameworks
     LIBS_PRIVATE += -framework CoreText -framework CoreGraphics
diff -ruN qtbase-opensource-src-5.6.0-orig/src/plugins/platforms/cocoa/cocoa.pro qtbase-opensource-src-5.6.0/src/plugins/platforms/cocoa/cocoa.pro
--- qtbase-opensource-src-5.6.0-orig/src/plugins/platforms/cocoa/cocoa.pro	2016-03-03 05:35:22.000000000 -0600
+++ qtbase-opensource-src-5.6.0/src/plugins/platforms/cocoa/cocoa.pro	2016-03-17 21:55:06.000000000 -0500
@@ -86,6 +86,10 @@
 
 LIBS += -framework Cocoa -framework Carbon -framework IOKit -lcups
 
+contains(QT_CONFIG, system-freetype) {
+    LIBS += -lfreetype
+}
+
 QT += core-private gui-private platformsupport-private
 
 qtHaveModule(widgets) {
From 77a71c32c9d19b87f79b208929e71282e8d8b5d9 Mon Sep 17 00:00:00 2001
From: Gabriel de Dietrich <gabriel.dedietrich@qt.io>
Date: Thu, 7 Jul 2016 16:00:17 -0700
Subject: configure and mkspecs: Don't try to find xcrun with xcrun
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Since Xcode 8 (beta 2) that tool is no longer available
through xcrun. We resort to xcodebuild instead.

Change-Id: If9d7b535c1cbac2caae0112b2003283aeff34fb9
Reviewed-by: Jake Petroules <jake.petroules@qt.io>
Reviewed-by: Oswald Buddenhagen <oswald.buddenhagen@theqtcompany.com>
Reviewed-by: Morten Johan SÃ¸rvig <morten.sorvig@qt.io>
---
 configure                            | 2 +-
 mkspecs/features/mac/default_pre.prf | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/configure b/configure
index a1f0a8f..f4c7813 100755
--- a/configure
+++ b/configure
@@ -543,7 +543,7 @@ if [ "$BUILD_ON_MAC" = "yes" ]; then
         exit 2
     fi
 
-    if ! /usr/bin/xcrun -find xcrun >/dev/null 2>&1; then
+    if ! /usr/bin/xcrun -find xcodebuild >/dev/null 2>&1; then
         echo >&2
         echo "   Xcode not set up properly. You may need to confirm the license" >&2
         echo "   agreement by running /usr/bin/xcodebuild without arguments." >&2
diff --git a/mkspecs/features/mac/default_pre.prf b/mkspecs/features/mac/default_pre.prf
index 0cc8cd6..5df99d1 100644
--- a/mkspecs/features/mac/default_pre.prf
+++ b/mkspecs/features/mac/default_pre.prf
@@ -12,7 +12,7 @@ isEmpty(QMAKE_XCODE_DEVELOPER_PATH) {
         error("Xcode is not installed in $${QMAKE_XCODE_DEVELOPER_PATH}. Please use xcode-select to choose Xcode installation path.")
 
     # Make sure Xcode is set up properly
-    isEmpty($$list($$system("/usr/bin/xcrun -find xcrun 2>/dev/null"))): \
+    isEmpty($$list($$system("/usr/bin/xcrun -find xcodebuild 2>/dev/null"))): \
         error("Xcode not set up properly. You may need to confirm the license agreement by running /usr/bin/xcodebuild.")
 }
 
-- 
cgit v1.0-4-g1e03

