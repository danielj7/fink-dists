Info2: <<
Package: gracegtk%type_pkg[-blas]
Version: 0.6.0
Type: v (2012_08_03_11h13), gcc (4.7), -blas (. -ref -atlas)
Revision: 1
###
Depends: <<
(%type_raw[-blas] = -atlas) atlas-shlibs, 
(%type_raw[-blas] = -ref) lapack341-shlibs,
cairo-shlibs(>= 1.8.10-3), 
fftw3-shlibs, 
gcc%type_pkg[gcc]-shlibs,
glib2-shlibs (>= 2.22.4-4), 
gsl-shlibs,
gtk+2-shlibs (>= 2.12.0-1),
libjpeg8-shlibs,
libpng15-shlibs,
libundo-shlibs,
pdflib6-shlibs,
t1lib5-nox-shlibs, 
x11
<<
BuildDepends: <<
(%type_raw[-blas] = -atlas) atlas, 
(%type_raw[-blas] = -ref) lapack341,
atk1 (>= 1.20.0-1),
cairo (>= 1.8.10-3),
fftw3,
gcc%type_pkg[gcc]-compiler,
glib2-dev (>= 2.22.4-4),
glitz,
gsl, 
gtk+2-dev (>= 2.12.0-1), 
libjpeg8,
libpng15,
libundo,
pango1-xft2-ft219-dev (>= 1.22.0-3),
pdflib6, 
t1lib5-nox,
x11-dev
<<
Conflicts: %{ni}, %{ni}-atlas, %{ni}-ref 
Replaces: %{ni}, %{ni}-atlas, %{ni}-ref, grace ( <= 5.1.22-8 )
###
Source: mirror:sourceforge:%{ni}/%{ni}-%v_%type_raw[v].tgz
Source-MD5: 79b5a5ed081ed3fe690e157fa453166d
SourceDirectory: %{ni}-%v
###
PatchScript: <<
	perl -pi -e 's/\b(bool)\b/my\1/g' src/gw_list.c src/gw_list.h src/gg_hotwin.c
	perl -pi -e 's,${prefix}/%{ni},${prefix}/share/%{ni},' configure
	perl -pi -e 's/(TEXDOCS\s+=\s+FAQ.tex\s+)Tutorial.tex\s+UsersGuide.tex/\1GraceGTK.tex/' doc/Makefile
	perl -pi -e "s(/usr/local/%{ni})[%p/share/%{ni}]; s/firefox/open/g; s/emacs/nano/g" buildinfo/buildinfo.*	
<<
###
SetLIBS: -L%p/lib/gcc%type_raw[gcc]/lib -lgfortran
SetLDFLAGS: -Wl,-dead_strip_dylibs
ConfigureParams: <<
	( %type_raw[-blas] = -atlas ) --with-blas='-lptblas' \
	( %type_raw[-blas] = -ref ) --with-blas='`pkg-config --libs blas`' \
	( %type_raw[-blas] = . ) --with-blas='-Wl,-framework,Accelerate' \
	--x-libraries=/usr/X11/lib --x-includes=/usr/X11/include \
	--disable-netcdf
<<
###
CompileScript: <<
	#!/bin/sh -ev
	export FC=%p/bin/gcc-fsf-%type_raw[gcc]
	export F77=$FC
	if [ "%type_raw[-blas]" = "." ] ; then
		export FCFLAGS='-ff2c'
		export FFLAGS='-ff2c'
	fi
	export PKG_CONFIG_PATH=%p/lib/lapack/pkgconfig:$PKG_CONFIG_PATH
	%{default_script}
<<
###
InstallScript: <<
	#!/bin/sh -ex
  	make DESTDIR=%d install
  	# create convenience symlink for "ggrace" executable
  	install -d %i/bin
	pushd %i/bin
	ln -s ../share/%{ni}/bin/ggrace
	popd
	# remove manpages which only pertain to regular 'grace' package
	rm %i/share/%{ni}/doc/*grace*.1
<<
DocFiles: CHANGES COPYRIGHT ChangeLog GTK_DEV LICENSE README*
ConfFiles: <<
	%p/share/%{ni}/gracerc
	%p/share/%{ni}/gracerc.user
<<
###
PostInstScript: <<
update-alternatives --install %p/bin/convcal convcal %p/share/%{ni}/bin/convcal 60 \
				 	--slave %p/share/man/man1/convcal.1 convcal.1 %p/share/%{ni}/doc/convcal.1
<<
###
PreRmScript: <<
	if [ $1 != "upgrade" ]; then
    	update-alternatives --remove convcal %p/bin/convcal
  	fi
<<
###
Description: Data processing and 2-D visualization tool 
DescDetail: <<
GraceGTK is an evolution of the grapher Grace (grace-5.1.22).

It is an integrated tool to analyse numerical data (linear and non linear fit,
Fourier or wavelets transform,...) and visualize the results as curves, bar
charts or 2D color maps, up to a drawing suitable for publication in a
scientific journal.

GraceGTK is based on the GTK API with higher interactivity and new features
such as a tree view of the drawing.

The home site for Grace is http://plasma-gate.weizmann.ac.il/Grace 
The first release of GraceGTK had been done through this site and you can track
the earlier history of the project in the Development forum on this site.
<<
DescUsage:  <<
The executable name is "ggrace".

Apparently one cannot create data sets by hand or by formula.  You can install
the 'grace' package and use 'xmgrace' to do that, though.

This fork of Grace didn't produce updated manpages, but 'ggrace -help' provides
the same information.

The default help viewer is "open", i.e. whatever the default application your
system is set to use, and the default editor is nano (because I thought it was 
the most user-friendly default option).
You can override the default help viewer and editor settings via the
GRACEGTK_HELPVIEWER and GRACE_EDITOR environment variables, respectively.
For example, if you're running GraceGTK in a remote X11 session, you'll 
probably want an X11-based help viewer, e.g. an X11 firefox from Fink:

	env GRACEGTK_HELPVIEWER='firefox %s' ggrace
<<
DescPackaging:  <<
Patch configure so that everything gets installed in a policy-compliant directory 
(%p/share/gracegtk).

Patch doc/Makefile to skip building a couple of missing tex files, since building
those requires linuxdoc-tools, _and_ there are PDF versions and HTML versions included.

configure ignores its own --enable-grace-home flag, so we have to patch
configure and buildinfo/buildinfo.{c,h} to make sure that the home path is properly
set.  Similarly it ignores the --with-editor and --with

Docs live in %p/share/gracegtk/doc because there are lots of hardcoded assumptions in the
build.

Upstream README indicates that NetCDF isn't used, so explicitly disable it because
otherwise the build will still _link_ to libnetcdf.

Use update-alternatives so that %p/bin/convcal and its manpage can be installed
either by this package or by 'grace'. 
<<
DescPort:  <<
Rename a variable named "bool" since, oddly enough, that causes compiler problems.
<<
###
License: GPL2+
Homepage: http://sourceforge.net/p/gracegtk/home/gracegtk/
Maintainer: Alexander Hansen <alexkhansen@users.sourceforge.net>
<<
