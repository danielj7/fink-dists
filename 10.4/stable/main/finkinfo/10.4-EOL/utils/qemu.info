Package: qemu
Version: 0.15.1
Revision: 2
Description: Fast machine emulator and virtualizer
License: GPL

Source: http://wiki.qemu.org/download/%n-%v.tar.gz
Source-MD5: 34f17737baaf1b3495c89cd6d4a607ed

BuildDepends: fink (>= 0.24.12)

PatchFile: %n.patch
PatchFile-MD5: c819bba120764d7cafbfc7ef54d95899

PatchScript: <<
#!/bin/sh -ev
# patch configure for 32 bit build on x86_64
  if [ "%m" = "i386" ]; then
    sed -i.bak 's|-m64|-m32|g'     configure
  fi
# patch configure for ,issing -arch option in gcc-4
  sed -i.bak 's|-arch x86_64||g' configure
# patch for window glitch as proposed by Juan Pineda.
  patch -p1 <%{PatchFile}
<<

ConfigureParams: <<
(%m = i386) --cpu=%m        \
--extra-cflags=-I%p/include \
--disable-darwin-user       \
--disable-bsd-user
<<

CompileScript: <<
#!/bin/sh -ev
  mkdir build
  cd build
  ../configure %c
  make
<<

InstallScript: <<
#!/bin/sh -ev
  cd build
  make install prefix=%i    \
   sharedir=%i/share/qemu   \
   datadir=%i/share/qemu    \
   mandir=%i/share/man      \
   docdir=%i/share/doc/qemu \
   bindir=%i/bin
<<

DocFiles: README* COPYING* TODO VERSION HACKING LICENSE MAINTAINERS

DescDetail: <<
QEMU is a generic and open source machine emulator and virtualizer.

When used as a machine emulator, QEMU can run OSes and programs made for
one machine (e.g. an ARM board) on a different machine (e.g. your own PC).
By using dynamic translation, it achieves very good performance.

When used as a virtualizer, QEMU achieves near native performances by
executing the guest code directly on the host CPU. QEMU supports
virtualization when executing under the Xen hypervisor or using the KVM
kernel module in Linux.  When using KVM, QEMU can virtualize x86, server
and embedded PowerPC, and S390 guests.
<<

DescPort: <<
The systems darwin-user and bsd-user crashed. Fixes are unlikely.
Configure needs a patch for the 32 bit build on x86_64.
Bug reports are filed with upstream.
Former maintainer (10.3): Christian Schroeder <shredda@gmx.de>, qemu 0.6
<<

Homepage: http://wiki.qemu.org/Main_Page

Maintainer: Karl-Michael Schindler <karl-michael.schindler@web.de>
