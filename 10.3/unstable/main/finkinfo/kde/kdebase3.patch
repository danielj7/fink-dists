--- kdebase-3.2.0/kcontrol/randr/Makefile.am	Sun Nov 30 04:42:32 2003
+++ kdebase-3.2.0-new/kcontrol/randr/Makefile.am	Fri Jan 30 13:11:27 2004
@@ -1,10 +1,8 @@
 INCLUDES = $(all_includes)
 
-kde_module_LTLIBRARIES = kcm_randr.la
+kde_module_LTLIBRARIES = kcm_randr.la krandrinithack.la
 
 noinst_LTLIBRARIES = librandrinternal.la
-
-lib_LTLIBRARIES = krandrinithack.la
 
 librandrinternal_la_SOURCES = ktimerdialog.cpp randr.cpp
 librandrinternal_la_METASOURCES = AUTO
--- kdebase-3.2.0/libkonq/Makefile.am	Tue Sep  2 09:54:41 2003
+++ kdebase-3.2.0-new/libkonq/Makefile.am	Fri Jan 30 13:11:27 2004
@@ -21,7 +21,7 @@
 
 lib_LTLIBRARIES = libkonq.la
 libkonq_la_LDFLAGS = $(all_libraries) -version-info 6:0:2 -no-undefined
-libkonq_la_LIBADD = $(LIB_KPARTS)
+libkonq_la_LIBADD = $(LIB_KPARTS) $(LIBZ)
 
 libkonq_la_SOURCES = konq_popupmenu.cc knewmenu.cc \
    konq_xmlguiclient.cc\
--- kdebase-3.2.0/startkde	Sun Oct 26 05:45:35 2003
+++ kdebase-3.2.0-new/startkde	Fri Jan 30 13:16:26 2004
@@ -10,6 +10,8 @@
 # we have to unset this for Darwin since it will screw up KDE's dynamic-loading
 unset DYLD_FORCE_FLAT_NAMESPACE
 
+source "@PREFIX@/bin/init.sh"
+
 # Boot sequence:
 #
 # kdeinit is used to fork off processes which improves memory usage
@@ -50,6 +52,11 @@
 # Where X is the original font database that was set up before this script
 # runs.
 
+/usr/X11R6/bin/xmodmap -e "keycode 74 = Right"
+/usr/X11R6/bin/xmodmap -e "keycode 78 = Left"
+/usr/X11R6/bin/xmodmap -e "keycode 80 = Down"
+/usr/X11R6/bin/xmodmap -e "keycode 85 = Up"
+
 usr_odir=$HOME/.fonts/kde-override
 usr_fdir=$HOME/.fonts
 
@@ -153,7 +160,7 @@
     done
     dcopserver_shutdown
     # shutdown will also make kwin quit, give it time to do so
-    sleep 1
+    sleep 5
 fi
 
 # the splashscreen and progress indicator
@@ -177,7 +184,29 @@
 # We only check for 255 which means that the ksmserver process could not be 
 # started, any problems thereafter, e.g. ksmserver failing to initialize, 
 # will remain undetected.
-test -n "$KDEWM" && KDEWM="--windowmanager $KDEWM"
+
+USE_PROXY=0
+if test -n "$KDEWM"; then
+	if test -z `expr "$KDEWM" : '\(.*quartz-wm.*\)'`; then
+		USE_PROXY=1
+	fi
+	KDEWM="--windowmanager $KDEWM"
+else
+	KDEWM="--windowmanager kwin"
+	USE_PROXY=1
+fi
+
+if test "$USE_PROXY" = "1"; then
+	if test -x /usr/X11R6/bin/quartz-wm; then
+		/usr/X11R6/bin/quartz-wm --only-proxy >/dev/null 2>&1 &
+	else
+		AUTOCUTSEL=`which autocutsel 2>/dev/null`
+		if test -n "$AUTOCUTSEL" && test -x "$AUTOCUTSEL"; then
+			$AUTOCUTSEL >/dev/null 2>&1 &
+		fi
+	fi
+fi
+
 kwrapper ksmserver $KDEWM 
 if test $? -eq 255; then
   # Startup error
