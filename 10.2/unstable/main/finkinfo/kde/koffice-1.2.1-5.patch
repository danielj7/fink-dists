
RCS file: doc/kformula/esstix-kfo1.png
diff -N doc/kformula/esstix-kfo1.png
RCS file: doc/kformula/esstix-kfo2.png
diff -N doc/kformula/esstix-kfo2.png
RCS file: doc/kformula/esstix-kfo3.png
diff -N doc/kformula/esstix-kfo3.png
RCS file: doc/kword/cancel.png
diff -N doc/kword/cancel.png
RCS file: doc/kword/clipart-from-file.png
diff -N doc/kword/clipart-from-file.png
RCS file: doc/kword/clipart.png
diff -N doc/kword/clipart.png
RCS file: doc/kword/close.png
diff -N doc/kword/close.png
RCS file: doc/kword/delete-table-col.png
diff -N doc/kword/delete-table-col.png
RCS file: doc/kword/delete-table-row.png
diff -N doc/kword/delete-table-row.png
RCS file: doc/kword/details.png
diff -N doc/kword/details.png
RCS file: doc/kword/dtpfmtpg2.png
diff -N doc/kword/dtpfmtpg2.png
RCS file: doc/kword/edit.png
diff -N doc/kword/edit.png
RCS file: doc/kword/editspace.png
diff -N doc/kword/editspace.png
RCS file: doc/kword/exit.png
diff -N doc/kword/exit.png
RCS file: doc/kword/extra.png
diff -N doc/kword/extra.png
RCS file: doc/kword/fcrtb.png
diff -N doc/kword/fcrtb.png
RCS file: doc/kword/file.png
diff -N doc/kword/file.png
RCS file: doc/kword/filequickprint.png
diff -N doc/kword/filequickprint.png
RCS file: doc/kword/footdlg.png
diff -N doc/kword/footdlg.png
RCS file: doc/kword/format.png
diff -N doc/kword/format.png
RCS file: doc/kword/framemode.png
diff -N doc/kword/framemode.png
RCS file: doc/kword/insert-table-col.png
diff -N doc/kword/insert-table-col.png
RCS file: doc/kword/insert-table-row.png
diff -N doc/kword/insert-table-row.png
RCS file: doc/kword/insert.png
diff -N doc/kword/insert.png
RCS file: doc/kword/inssc.png
diff -N doc/kword/inssc.png
RCS file: doc/kword/italic.png
diff -N doc/kword/italic.png
RCS file: doc/kword/lspcbut.png
diff -N doc/kword/lspcbut.png
RCS file: doc/kword/neonpen.png
diff -N doc/kword/neonpen.png
RCS file: doc/kword/newfolder.png
diff -N doc/kword/newfolder.png
RCS file: doc/kword/nodet.png
diff -N doc/kword/nodet.png
RCS file: doc/kword/ok.png
diff -N doc/kword/ok.png
RCS file: doc/kword/part-kchart.png
diff -N doc/kword/part-kchart.png
RCS file: doc/kword/part-killustrator.png
diff -N doc/kword/part-killustrator.png
RCS file: doc/kword/part-kimage.png
diff -N doc/kword/part-kimage.png
RCS file: doc/kword/part-kimageshop.png
diff -N doc/kword/part-kimageshop.png
RCS file: doc/kword/part-kword.png
diff -N doc/kword/part-kword.png
RCS file: doc/kword/part-unspecif.png
diff -N doc/kword/part-unspecif.png
RCS file: doc/kword/parts.png
diff -N doc/kword/parts.png
RCS file: doc/kword/product.png
diff -N doc/kword/product.png
RCS file: doc/kword/table.png
diff -N doc/kword/table.png
RCS file: doc/kword/text-bold.png
diff -N doc/kword/text-bold.png
RCS file: doc/kword/text-italic.png
diff -N doc/kword/text-italic.png
RCS file: doc/kword/text-underlined.png
diff -N doc/kword/text-underlined.png
RCS file: doc/kword/textmode.png
diff -N doc/kword/textmode.png
RCS file: doc/kword/tools.png
diff -N doc/kword/tools.png
RCS file: doc/kword/underl.png
diff -N doc/kword/underl.png
RCS file: doc/kword/uplevel.png
diff -N doc/kword/uplevel.png
RCS file: doc/kword/view.png
diff -N doc/kword/view.png
--- filters/karbon/ai/Makefile.am	20 Jun 2002 04:48:48 -0000	1.1.1.2
+++ filters/karbon/ai/Makefile.am	1 Dec 2002 19:28:48 -0000	1.2
@@ -2,7 +2,7 @@
 
 libkarbonaiimport_la_LIBADD = \
 	$(LIB_KOFFICEUI) \
-	../../../karbon/libkarbonpart.la
+	../../../karbon/libkarbonpart_shared.la
 
 libkarbonaiimport_la_LDFLAGS = \
 	$(all_libraries) \
--- filters/karbon/ai/ailexer.cc	10 Aug 2002 13:48:20 -0000	1.1.1.3
+++ filters/karbon/ai/ailexer.cc	12 Aug 2002 01:08:39 -0000	1.2
@@ -38,9 +38,11 @@
   return (c==' ')||(c=='\n')||(c=='\t')||(c=='\r');
 }
 
+#ifndef isspecial
 int isspecial(char c){
   return (c=='*')||(c=='_')||(c=='?')||(c=='~')||(c=='-')||(c=='^')||(c=='`')||(c=='!')||(c=='.')||(c=='@')||(c=='&')||(c=='$')||(c=='=');
 }
+#endif
 
 int isletterhex(char c){
   return (c=='A')||(c=='B')||(c=='C')||(c=='D')||(c=='E')||(c=='F');
--- filters/karbon/eps/Makefile.am	20 Jun 2002 04:48:49 -0000	1.1.1.2
+++ filters/karbon/eps/Makefile.am	1 Dec 2002 19:28:48 -0000	1.2
@@ -9,7 +9,7 @@
 libkarbonepsexport_la_LDFLAGS = $(KDE_PLUGIN)
 libkarbonepsexport_la_LIBADD  = \
 	$(LIB_KOFFICEUI) \
-	../../../karbon/libkarbonpart.la
+	../../../karbon/libkarbonpart_shared.la
 
 libkarbonepsimport_la_SOURCES = epsimport.cc
 libkarbonepsimport_la_LDFLAGS = $(KDE_PLUGIN)
--- filters/karbon/eps/epsimport.cc	4 Dec 2002 02:59:11 -0000	1.1.1.4
+++ filters/karbon/eps/epsimport.cc	24 Mar 2003 21:11:07 -0000	1.2
@@ -73,7 +73,7 @@
 	QString input = m_chain->inputFile();
 
  	QString command(
- 		"gs -q -dNOPAUSE -dSAFER -dNODISPLAY ps2ai.ps ");
+ 		"gs -q -dBATCH -dNOPAUSE -dSAFER -dNODISPLAY ps2ai.ps ");
  	command += KShellProcess::quote(input);
  	command += " > ";
  	command += KShellProcess::quote(m_chain->outputFile());
--- filters/karbon/png/Makefile.am	20 Jun 2002 04:48:49 -0000	1.1.1.1
+++ filters/karbon/png/Makefile.am	1 Dec 2002 19:28:48 -0000	1.2
@@ -3,7 +3,7 @@
 libkarbonpngexport_la_LDFLAGS = $(KDE_PLUGIN)
 libkarbonpngexport_la_LIBADD = \
 	$(LIB_KOFFICEUI) \
-	../../../karbon/libkarbonpart.la
+	../../../karbon/libkarbonpart_shared.la
 
 INCLUDES = \
 	$(KOFFICE_INCLUDES) \
--- filters/karbon/svg/Makefile.am	20 Jun 2002 04:48:49 -0000	1.1.1.2
+++ filters/karbon/svg/Makefile.am	1 Dec 2002 19:28:49 -0000	1.2
@@ -3,7 +3,7 @@
 libkarbonsvgexport_la_LDFLAGS = $(KDE_PLUGIN)
 libkarbonsvgexport_la_LIBADD = \
 	$(LIB_KOFFICEUI) \
-	../../../karbon/libkarbonpart.la
+	../../../karbon/libkarbonpart_shared.la
 
 INCLUDES = \
 	$(KOFFICE_INCLUDES) \
--- filters/kontour/msod/Makefile.am	20 Jun 2002 04:43:07 -0000	1.1.1.1
+++ filters/kontour/msod/Makefile.am	24 Mar 2003 21:11:07 -0000	1.2
@@ -2,7 +2,7 @@
 
 INCLUDES= -I$(srcdir) $(KWMF_INCLUDES) $(KOFFICE_INCLUDES) $(all_includes)
 libmsodimport_la_LDFLAGS	= -module -avoid-version -no-undefined $(all_libraries)
-libmsodimport_la_LIBADD = $(KOFFICE_LIBS) $(LIB_KWMF)
+libmsodimport_la_LIBADD = $(KOFFICE_LIBS) $(LIB_KWMF) $(LIBZ)
 
 ####### Files
 
--- filters/kpresenter/kword/kprkword.cc	20 Jun 2002 04:49:05 -0000	1.1.1.2
+++ filters/kpresenter/kword/kprkword.cc	24 Mar 2003 21:11:07 -0000	1.2
@@ -123,8 +123,7 @@
     style.appendChild( format );
     QDomElement font = outdoc.createElement( "FONT" );
     format.appendChild( font );
-    // by picking up a font from the kpr doc we ensure that it's installed, at least
-    font.setAttribute( "name", aFont );
+    font.setAttribute( "name", titleFont ); // found when reading the first title
     QDomElement size = outdoc.createElement( "SIZE" );
     format.appendChild( size );
     size.setAttribute( "value", 24 );
@@ -132,6 +131,15 @@
     format.appendChild( bold );
     bold.setAttribute( "value", 75 );
 
+    // Create the standard style
+    style = outdoc.createElement( "STYLE" );
+    styles.appendChild( style );
+    elem = outdoc.createElement( "NAME" );
+    style.appendChild( elem );
+    elem.setAttribute( "value", "Standard" ); // no i18n here!
+    format = outdoc.createElement( "FORMAT" );
+    style.appendChild( format ); // empty format == use defaults
+
     // Write output file
 
     KoStoreDevice* out = m_chain->storageFile( "root", KoStore::Write );
@@ -147,7 +155,7 @@
 // This class is used to sort the objects by y position
 class KprObject {
  public:
-    int y;
+    double y;
     QDomElement elem;
     bool operator < ( const KprObject & c ) const
     {
@@ -180,14 +188,18 @@
         if ( object.attribute( "type" ).toInt() == 4 ) // we only care about text objs
         {
             QDomElement orig = object.namedItem( "ORIG" ).toElement();
+            if ( !orig.isNull() )
+            {
             KprObject * obj = new KprObject;
-            obj->y = orig.attribute( "y" ).toInt();
+                obj->y = orig.attribute( "y" ).toDouble();
             obj->elem = object;
             objList.inSort( obj );
         }
     }
+    }
 
     int curPage = -1;
+    //kdDebug() << "found " << objList.count() << " objects" << endl;
 
     for ( QPtrListIterator<KprObject> it(objList); it.current(); ++it )
     {
@@ -304,10 +316,10 @@
                     e.setAttribute( "value", 75 );
                     outFormatElem.appendChild( e );
                 }*/ // doesn't look good
-                if ( aFont.isEmpty() )
-                    aFont = textElem.attribute( "family" );
+                if ( titleFont.isEmpty() && isTitle )
+                    titleFont = textElem.attribute( "family" );
 
-                // Family, colour and point size are voluntarily NOT passed over.
+                // Family and point size are voluntarily NOT passed over.
                 if ( !textElem.attribute( "color" ).isEmpty())
                 {
                     QColor col;
@@ -344,7 +356,8 @@
                     outFormatsElem.appendChild( outFormatElem );
                 }
 
-            }
+            } // end "for each text element"
+
             // KPresenter seems to save a trailing space (bug!)
             int len = text.length();
             if ( len > 0 && text[ len - 1 ] == ' ' )
--- filters/kpresenter/kword/kprkword.h	20 Jun 2002 04:43:08 -0000	1.1.1.1
+++ filters/kpresenter/kword/kprkword.h	24 Mar 2003 21:11:07 -0000	1.2
@@ -40,6 +40,6 @@
     QDomDocument outdoc;
     QDomElement frameset;
     QString titleStyleName;
-    QString aFont;
+    QString titleFont;
 };
 #endif // KPRKWORD_H
--- filters/kspread/applixspread/applixspreadimport.cc	20 Jun 2002 04:43:08 -0000	1.1.1.1
+++ filters/kspread/applixspread/applixspreadimport.cc	24 Mar 2003 21:11:08 -0000	1.2
@@ -228,7 +228,7 @@
           irow   = rowstr.toInt(&ok);
 
 	  printf (" findpos: %s %d\n",rowstr.latin1(), irow );
-          sscanf (cellnostr.latin1(), "%s%d",tmp, &bla);
+          sscanf (cellnostr.latin1(), "%299s%d",tmp, &bla);
           sprintf (tmp1, "%d", irow);
           leni = strlen (tmp1);
 	  QString cellcolstr;
--- filters/kspread/csv/Makefile.am	20 Jun 2002 04:43:09 -0000	1.1.1.1
+++ filters/kspread/csv/Makefile.am	1 Dec 2002 17:02:16 -0000	1.2
@@ -9,11 +9,11 @@
 
 libcsvimport_la_SOURCES = csvimport.cc xmltree.cc csvdialog.cpp dialogui.ui
 libcsvimport_la_LDFLAGS	= $(all_libraries) -module -avoid-version -no-undefined 
-libcsvimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la
+libcsvimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la
 
 libcsvexport_la_SOURCES = csvexport.cc
 libcsvexport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libcsvexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la
+libcsvexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la
 
 METASOURCES = AUTO
 
--- filters/kspread/gnumeric/Makefile.am	20 Jun 2002 04:43:09 -0000	1.1.1.1
+++ filters/kspread/gnumeric/Makefile.am	24 Mar 2003 21:11:08 -0000	1.3
@@ -8,11 +8,11 @@
 
 libgnumericexport_la_SOURCES = gnumericexport.cc
 libgnumericexport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libgnumericexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la
+libgnumericexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la $(LIBZ)
 
 libgnumericimport_la_SOURCES = gnumericimport.cc
 libgnumericimport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libgnumericimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la
+libgnumericimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la $(LIBZ)
 
 METASOURCES = AUTO
 
--- filters/kspread/html/Makefile.am	20 Jun 2002 04:43:09 -0000	1.1.1.1
+++ filters/kspread/html/Makefile.am	1 Dec 2002 17:02:16 -0000	1.2
@@ -9,7 +9,7 @@
 
 libkspreadhtmlexport_la_SOURCES = htmlexport.cc
 libkspreadhtmlexport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libkspreadhtmlexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la
+libkspreadhtmlexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la
 
 METASOURCES = AUTO
 
--- filters/kspread/qpro/Makefile.am	20 Jun 2002 04:43:09 -0000	1.1.1.1
+++ filters/kspread/qpro/Makefile.am	1 Dec 2002 17:02:16 -0000	1.2
@@ -12,7 +12,7 @@
 libqproimport_la_SOURCES = qproimport.cc qproformula.cc
 
 libqproimport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libqproimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la \
+libqproimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la \
 	libqpro/src/libqpro.la
 
 METASOURCES = AUTO
--- filters/kspread/qpro/qproimport.cc	20 Jun 2002 04:43:09 -0000	1.1.1.1
+++ filters/kspread/qpro/qproimport.cc	24 Mar 2003 21:11:08 -0000	1.2
@@ -18,7 +18,7 @@
    Boston, MA 02111-1307, USA.
 */
 
-#include <strstream.h>
+#include <strstream>
 
 #include <kdebug.h>
 #include <kmessagebox.h>
--- filters/kspread/qpro/libqpro/src/formula.cc	20 Jun 2002 04:43:10 -0000	1.1.1.1
+++ filters/kspread/qpro/libqpro/src/formula.cc	24 Mar 2003 21:11:09 -0000	1.2
@@ -1,7 +1,7 @@
 #include <qpro/common.h>
 
-#include <iostream.h>
-#include <strstream.h>
+#include <iostream>
+#include <strstream>
 
 #include <string.h>
 
@@ -474,7 +474,7 @@
 QpFormula::floatFuncReal(const char*)
 {
    QP_INT64   lFloat;
-   ostrstream lNum;
+   std::ostrstream lNum;
 
    cFormula >> lFloat;
 
@@ -489,7 +489,7 @@
 QpFormula::intFuncReal(const char*)
 {
    QP_INT16 lInt;
-   ostrstream lNum;
+   std::ostrstream lNum;
 
    cFormula >> lInt;
 
--- filters/kspread/qpro/libqpro/src/record.cc	20 Jun 2002 04:43:10 -0000	1.1.1.1
+++ filters/kspread/qpro/libqpro/src/record.cc	24 Mar 2003 21:11:09 -0000	1.2
@@ -2,7 +2,7 @@
 
 #include <string.h>
 
-#include <iostream.h>
+#include <iostream>
 
 #include <qpro/record.h>
 #include <qpro/formula.h>
@@ -10,7 +10,7 @@
 // -----------------------------------------------------------------------
 
 #include <iomanip.h>
-#include <strstream.h>
+#include <strstream>
 
 void
 Charout(ostream& pOut, unsigned char pChar)
@@ -32,7 +32,7 @@
 int
 Hexout(char* pChar, int pLen)
 {
-   ostrstream*   lOStr = new ostrstream;
+   std::ostrstream*   lOStr = new std::ostrstream;
 
    while( pLen )
    {
@@ -57,7 +57,7 @@
       cerr << lOStr->rdbuf() << endl;
 
       delete lOStr;
-      lOStr = new ostrstream;
+      lOStr = new std::ostrstream;
    }
 
    delete lOStr;
@@ -200,7 +200,7 @@
 {
 //??? cope with relative/absolute references
 
-   strstream lOut(pText, 20, ios::out); // ??? ard coded len
+   std::strstream lOut(pText, 20, ios::out); // ??? ard coded len
    int       lPageRelative = pRow & 0x8000;
    int       lColRelative  = pRow & 0x4000;
    int       lRowRelative  = pRow & 0x2000;
--- filters/kspread/qpro/libqpro/src/stream.cc	20 Jun 2002 04:43:10 -0000	1.1.1.1
+++ filters/kspread/qpro/libqpro/src/stream.cc	24 Mar 2003 21:11:09 -0000	1.2
@@ -31,7 +31,7 @@
 #else
 #include <string.h>
 #include <fstream.h>
-#include <strstream.h>
+#include <strstream>
 
 // For IRIX
 namespace std {}
@@ -60,7 +60,7 @@
    , cOffset(0L)
    , cStreamBuf(0)
 {
-   cStreamBuf = new strstreambuf (pBuffer, pLen);
+   cStreamBuf = new std::strstreambuf (pBuffer, pLen);
 
    cIn = new istream(cStreamBuf);
 }
--- filters/kword/applixword/applixwordimport.cc	20 Jun 2002 04:43:10 -0000	1.1.1.1
+++ filters/kword/applixword/applixwordimport.cc	24 Mar 2003 21:11:09 -0000	1.2
@@ -230,7 +230,7 @@
          **********************************************************************/
         else if (mystr.startsWith ("<P "))
 	{
-	   sscanf ( (const char *) mystr.latin1(), "<P \"%s\"", stylename);
+	   sscanf ( (const char *) mystr.latin1(), "<P \"%99s\"", stylename);
            mystr.remove (0, 5+strlen(stylename));
            kdDebug()<<" Para  Name: "<< stylename<<endl;
            kdDebug()<<"       Rest: "<<mystr<<endl;
--- filters/kword/ascii/asciiexport.cc	12 Sep 2002 12:44:09 -0000	1.1.1.3
+++ filters/kword/ascii/asciiexport.cc	24 Mar 2003 21:11:09 -0000	1.2
@@ -1,4 +1,4 @@
-// $Header: /home/kde/koffice/filters/kword/ascii/asciiexport.cc,v 1.35.2.1 2002/09/02 08:34:55 mlaurent Exp $
+// $Header: /home/kde/koffice/filters/kword/ascii/asciiexport.cc,v 1.35.2.2 2003/01/10 11:15:57 goutte Exp $
 
 /* This file is part of the KDE project
    Copyright (C) 1998, 1999 Reginald Stadlbauer <reggie@kde.org>
@@ -276,6 +276,7 @@
                 break;
             }
         }
+        ProcessParagraphData ( paraText, paraFormatDataList);
         m_counterList++; // Increment the list counter
     }
     else
--- filters/kword/latex/import/kword_latex_import.desktop	12 Sep 2002 12:44:12 -0000	1.1.1.3
+++ filters/kword/latex/import/kword_latex_import.desktop	24 Mar 2003 21:11:10 -0000	1.2
@@ -2,59 +2,10 @@
 Encoding=UTF-8
 X-KDE-Export=application/x-kword
 ExportDescription=KWord
-Icon=
 X-KDE-Import=text/x-tex
 X-KDE-Weight=1
 ImportDescription=LATEX
-Name=KWord HTML Import Filter
-Name[af]=kword html in voer filter
-Name[ar]=استيراد من HTML الى KWord
-Name[az]=KWord HTML Alma Filter
-Name[bg]=Филтър за импорт на HTML в KWord
-Name[br]=Sil Enporzh HTML KWord
-Name[ca]=Filtre d'importació HTML de KWord
-Name[cs]=KWord HTML importní filtr
-Name[da]=KWord HTML-importfilter
-Name[de]=HTML-Import für KWord
-Name[el]=Φίλτρο εισαγωγής HTML του KWord
-Name[eo]=HTML-importfiltrilo por Verkilo
-Name[es]=Filtro de importación HTML de KWord
-Name[et]=KWordi HTML importfilter
-Name[fi]=KWord HTML-tuontisuodin
-Name[fr]=Filtre d'importation HTML de KWord
-Name[he]=מסנן ייבוא מ-HTML ל-KWord
-Name[hr]=KWord HTML uvozni filter
-Name[hu]=KWord HTML importszűrő
-Name[id]=Filter Impor HTML KWord
-Name[is]=HTML-innflutningssía fyrir KWord ritvinnsluna
-Name[it]=Filtro di importazione HTML per KWord
-Name[ja]=KWord HTML インポートフィルター
-Name[lt]=KWord HTML importo filtras
-Name[lv]=KWord HTML Importa Filtrs
-Name[mk]=KWord HTML увозен филтер
-Name[mt]=Filtru għall-importazzjoni ta' HTML ġo KWord
-Name[nb]=KWord HTML-importfilter
-Name[nl]=KWord's HTML-Importfilter
-Name[nn]=HTML-importfilter for KWord
-Name[pl]=Filtr importu formatu HTML do KWord
-Name[pt]=Ficheiro de importação de HTML para o KWord
-Name[pt_BR]=Filtro de importação HTML para o KWord
-Name[ro]=Filtru importare KWord pentru HTML
-Name[ru]=Фильтр импорта HTML в KWord
-Name[sk]=HTML filter pre import do KWord-u
-Name[sl]=Uvozni filter HTML za KWord
-Name[sr]=KWord filter za uvoz HTML-a
-Name[sv]=Kword HTML-importfilter
-Name[ta]=KWord HTML ­ÈìÌÁ¾¢ ÅÊ¸ðÊ
-Name[th]=ตัวกรองการนำเข้า HTML ของเอกสารข้อความ K
-Name[uk]=Фільтр імпорту ASCII для KWord
-Name[ven]=Filithara yau u dzhenisa ya fhungo la K ya HTML
-Name[wa]=Passete HTML d' intrêye po KWord
-Name[xh]=KWord HTML Icebo lokucoca ulwelo olurhwetyiweyo ngaphakathi
-Name[xx]=xx
-Name[zh_CN]=KWord HTML 导入过滤程序
-Name[zh_TW]=KWord HTML 匯入過濾程式
-Name[zu]=KWord HTML Icebo lokuhlaziya ifayela yemininingwane yezohwebo lazangaphakathi
+Name=KWord Latex Import Filter
 ServiceTypes=KOfficeFilter
 Type=Service
-X-KDE-Library=libhtmlimport
+X-KDE-Library=liblateximport
--- filters/kword/latex/import/parser/Makefile.am	4 Dec 2002 21:34:09 -0000	1.1.1.4
+++ filters/kword/latex/import/parser/Makefile.am	4 Dec 2002 21:41:38 -0000	1.5
@@ -1,7 +1,7 @@
 ####### General stuff
 
 INCLUDES= -I$(srcdir) $(all_includes)
-liblatexparser_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
+liblatexparser_la_LDFLAGS = $(all_libraries) -avoid-version -no-undefined
 liblatexparser_la_LIBADD  = -lm $(KOFFICE_LIBS)
 
 ####### Files
--- filters/kword/rtf/export/rtfexport.cc	12 Sep 2002 12:44:26 -0000	1.1.1.4
+++ filters/kword/rtf/export/rtfexport.cc	24 Mar 2003 21:11:10 -0000	1.2
@@ -799,7 +799,7 @@
       }  // end switch
    fontHeader += "\\fcharset0\\fprq2 "; // font definition
    fontHeader += fontName;
-   fontHeader += " ;}"; // end font table entry
+   fontHeader += ";}"; // end font table entry
    return font;  // this is the font selection markup
 
    }  // end fontTableMarkup()
@@ -810,9 +810,9 @@
 {
    QString text1(text);
 
-   text1 = text1.replace( QRegExp( "\\"), "\\\\");
-   text1 = text1.replace( QRegExp( "{"), "\\{");
-   text1 = text1.replace( QRegExp( "}"), "\\}");
+   text1.replace( QRegExp( "\\\\"), "\\\\");
+   text1.replace( QRegExp( "\\{"), "\\{");
+   text1.replace( QRegExp( "\\}"), "\\}");
    return text1;
 }  // end escapeRTFsymbols()
 
@@ -843,7 +843,7 @@
       else if ( ch == 0x200c ) escapedText += "\\zwnj ";
       else if ( ch == 0x200d ) escapedText += "\\zwj ";
       else if ( ch == 0x200e ) escapedText += "\\ltrmark ";
-      else if ( ch == 0x200f ) escapedText += "\\rtrmark ";
+      else if ( ch == 0x200f ) escapedText += "\\rtlmark ";
       else if ( ch == 0x2013 ) escapedText += "\\endash ";
       else if ( ch == 0x2014 ) escapedText += "\\emdash ";
       else if ( ch == 0x2018 ) escapedText += "\\lquote ";
--- filters/kword/rtf/import/rtfimport_dom.cpp	10 Aug 2002 13:48:41 -0000	1.1.1.2
+++ filters/kword/rtf/import/rtfimport_dom.cpp	24 Mar 2003 21:11:10 -0000	1.2
@@ -47,7 +47,7 @@
     close();
     array.truncate( 0 );
     setBuffer( array );
-    open( IO_WriteOnly | IO_Truncate );
+    open( IO_WriteOnly );
     documentLevel	= level;
     hasChildren		= true;
     hasAttributes	= false;
--- karbon/Makefile.am	12 Sep 2002 12:44:23 -0000	1.1.1.4
+++ karbon/Makefile.am	24 Mar 2003 21:11:10 -0000	1.3
@@ -14,10 +14,10 @@
 
 bin_PROGRAMS = karbon
 
-lib_LTLIBRARIES = karbon.la
+lib_LTLIBRARIES = karbon.la libkarbonpart_shared.la
 kde_module_LTLIBRARIES = libkarbonpart.la
 
-libkarbonpart_la_SOURCES = \
+libkarbonpart_shared_la_SOURCES = \
 	karbon_factory.cc \
 	karbon_part.cc \
 	karbon_part_iface.cc \
@@ -26,8 +26,8 @@
 	karbon_view_iface.cc \
 	karbon_view_iface.skel
 
-libkarbonpart_la_LDFLAGS = $(KDE_PLUGIN)
-libkarbonpart_la_LIBADD = $(LIB_KOFFICEUI) $(LIB_KOTEXT) \
+libkarbonpart_shared_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version
+libkarbonpart_shared_la_LIBADD = $(LIB_KOFFICEUI) $(LIB_KOTEXT) \
 	tools/libkarbontools.la \
 	dialogs/libkarbondialogs.la \
 	dockers/libkarbondockers.la \
@@ -38,18 +38,25 @@
 	core/libkarboncore.la \
 	visitors/libkarbonvisitors.la 
 
-libkarbonpart_la_METASOURCES = AUTO
+libkarbonpart_shared_la_METASOURCES = AUTO
+
+libkarbonpart_la_SOURCES = dummy.cpp
+libkarbonpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN)
+libkarbonpart_la_LIBADD  = libkarbonpart_shared.la
+
+dummy.cc:
+	echo > dummy.cc
 
 karbon_la_SOURCES = main.cc
 karbon_la_LDFLAGS = $(all_libraries) -module -avoid-version
-karbon_la_LIBADD = libkarbonpart.la
+karbon_la_LIBADD = libkarbonpart_shared.la
 
-karbon_SOURCES = dummy.cc
+karbon_SOURCES = karbon_main.cc
 karbon_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-karbon_LDADD = karbon.la
+karbon_LDADD = libkarbonpart_shared.la
 
-dummy.cc:
-	echo > dummy.cc
+karbon_main.cc: main.cc
+	cat main.cc > karbon_main.cc
 
 noinst_HEADERS = \
 	karbon_factory.h \
--- karbon/render/xrgbrender/gdk-pixbuf-xlib-private.h	20 Jun 2002 04:43:15 -0000	1.1.1.1
+++ karbon/render/xrgbrender/gdk-pixbuf-xlib-private.h	20 Jun 2002 04:48:28 -0000	1.2
@@ -31,5 +31,11 @@
 #define KSVG_BIG_ENDIAN 2
 
 /* FIXME: Make this auto-detectable */
+/* FIXME AGAIN: probably only Apple Compilers define this */
+#ifdef __BIG_ENDIAN__
+#define KSVG_BYTE_ORDER KSVG_BIG_ENDIAN
+#else
 #define KSVG_BYTE_ORDER KSVG_LITTLE_ENDIAN
+#endif
+
 #endif
--- kchart/CHANGES	4 Dec 2002 02:59:37 -0000	1.1.1.2
+++ kchart/CHANGES	24 Mar 2003 21:11:11 -0000	1.2
@@ -1,3 +1,10 @@
+Changes since KChart 1.2.1
+--------------------------
+
+Added 2 missing chart icons to the wizard
+Disabled non functional axis labels in wizard
+Fixed scaling of y axis
+
 Changes since KChart 1.2
 ------------------------
 
--- kchart/Makefile.am	10 Aug 2002 13:49:03 -0000	1.1.1.2
+++ kchart/Makefile.am	1 Dec 2002 17:02:17 -0000	1.2
@@ -46,12 +46,12 @@
 
 ## The executable
 bin_PROGRAMS = kchart
-kchart_SOURCES = dummy.cc
+kchart_SOURCES = kchart_main.cc
 kchart_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kchart_LDADD = kchart.la
+kchart_LDADD = $(LIB_KOFFICECORE)
 
-dummy.cc:
-	echo > dummy.cc
+kchart_main.cc: main.cc
+	cat main.cc > kchart_main.cc
 
 noinst_HEADERS =  kchart_part.h \
 		kchart_view.h kchart_factory.h \
--- kchart/kchartWizardLabelsLegendPage.cc	20 Jun 2002 04:49:47 -0000	1.1.1.2
+++ kchart/kchartWizardLabelsLegendPage.cc	24 Mar 2003 21:11:11 -0000	1.2
@@ -53,28 +53,34 @@
 
 
     QLabel* xlabelLA = new QLabel( i18n( "X-title:" ), tmpQGroupBox );
+    xlabelLA->setEnabled(false); //Not supported by kdChart yet
     grid2->addWidget(xlabelLA,1,0);
 
     _xlabelED = new QLineEdit( tmpQGroupBox );
+    _xlabelED->setEnabled(false); //Not supported by kdChart yet
     // PENDING(kalle) Put back in
     //   _xlabelED->setText(_chart->params()->xtitle);
     grid2->addWidget(_xlabelED,1,1);
 
     xtitlefont = new QPushButton( tmpQGroupBox );
     xtitlefont->setText(i18n("Font"));
+    xtitlefont->setEnabled(false); //Not supported by kdChart yet
     grid2->addWidget(xtitlefont,1,2);
 
     xtitlecolor=new KColorButton(tmpQGroupBox);
     // PENDING(kalle) Put back in
     //  x_color=_chart->params()->XTitleColor;
     xtitlecolor->setColor( x_color );
+    xtitlecolor->setEnabled(false); //Not supported by kdChart yet
     grid2->addWidget(xtitlecolor,1,3);
 
 
     QLabel* ylabelLA = new QLabel( i18n( "Y-title:" ), tmpQGroupBox );
+    ylabelLA->setEnabled(false); //Not supported by kdChart yet
     grid2->addWidget(ylabelLA,2,0);
 
     _ylabelED = new QLineEdit( tmpQGroupBox );
+    _ylabelED->setEnabled(false); //Not supported by kdChart yet
     // PENDING(kalle) Put back in
     //   _ylabelED->setText(_chart->params()->ytitle);
     grid2->addWidget(_ylabelED,2,1);
@@ -82,9 +88,11 @@
 
     ytitlefont = new QPushButton( tmpQGroupBox);
     ytitlefont->setText(i18n("Font"));
+    ytitlefont->setEnabled(false); //Not supported by kdChart yet
     grid2->addWidget(ytitlefont,2,2);
 
     ytitlecolor=new KColorButton(tmpQGroupBox);
+    ytitlecolor->setEnabled(false); //Not supported by kdChart yet
     // PENDING(kalle) Put back in
     //   y_color=_chart->params()->YTitleColor;
     ytitlecolor->setColor( y_color );
@@ -92,18 +100,26 @@
 
     //ytitle2 doesn't work
     QLabel* ylabelLA2 = new QLabel( i18n( "Y-title 2:" ), tmpQGroupBox );
+    ylabelLA2->setEnabled(false); //Not supported by kdChart yet
     grid2->addWidget(ylabelLA2,3,0);
 
     _ylabel2ED = new QLineEdit( tmpQGroupBox );
+    _ylabel2ED->setEnabled(false); //Not supported by kdChart yet
     // PENDING(kalle) Put back in
     //   _ylabel2ED->setText(_chart->params()->ytitle2);
     grid2->addWidget(_ylabel2ED,3,1);
 
+    ytitle2font = new QPushButton( tmpQGroupBox);
+    ytitle2font->setText(i18n("Font"));
+    ytitle2font->setEnabled(false); //Not supported by kdChart yet
+    grid2->addWidget(ytitle2font,3,2);
+
     ytitle2color=new KColorButton(tmpQGroupBox);
+    ytitle2color->setEnabled(false); //Not supported by kdChart yet
     // PENDING(kalle) Put back in
     //   y_color2=_chart->params()->YTitle2Color;
     ytitle2color->setColor( y_color2 );
-    grid2->addWidget(ytitle2color,3,2);
+    grid2->addWidget(ytitle2color,3,3);
 
     // PENDING(kalle) Put back in
     //   xlabel=_chart->params()->xTitleFont();
@@ -147,6 +163,7 @@
 
     connect(xtitlefont,SIGNAL(clicked()),this,SLOT(changeXLabelFont()));
     connect(ytitlefont,SIGNAL(clicked()),this,SLOT(changeYLabelFont()));
+    connect(ytitle2font,SIGNAL(clicked()),this,SLOT(changeY2LabelFont()));
     connect(titlefont,SIGNAL(clicked()),this,SLOT(changeTitleFont()));
     connect(legendTitleFont,SIGNAL(clicked()),this,SLOT(changeLegendTitleFont()));
 
@@ -199,6 +216,14 @@
         return;
 
 }
+
+void KChartWizardLabelsLegendPage::changeYLabel2Font()
+{
+    if (KFontDialog::getFont( ylabel2, false, this ) == QDialog::Rejected )
+        return;
+
+}
+
 void KChartWizardLabelsLegendPage::changeTitleFont()
 {
     if (KFontDialog::getFont( title ,false,this ) == QDialog::Rejected )
--- kchart/kchartWizardLabelsLegendPage.h	20 Jun 2002 04:43:17 -0000	1.1.1.1
+++ kchart/kchartWizardLabelsLegendPage.h	24 Mar 2003 21:11:11 -0000	1.2
@@ -23,6 +23,7 @@
   void apply();
   void changeXLabelFont();
   void changeYLabelFont();
+  void changeYLabel2Font();
   void changeTitleFont();
   void changeLegendTitleFont();
   void changeLegendTextFont();
@@ -62,6 +63,7 @@
 
   QFont xlabel;
   QFont ylabel;
+  QFont ylabel2;
   QFont title;
   QColor x_color;
   QColor y_color;
--- kchart/kdchart/KDChartAxesPainter.cpp	20 Jun 2002 04:49:48 -0000	1.1.1.2
+++ kchart/kdchart/KDChartAxesPainter.cpp	24 Mar 2003 21:11:11 -0000	1.2
@@ -1,5 +1,5 @@
 /* -*- Mode: C++ -*-
-   $Id: KDChartAxesPainter.cpp,v 1.12 2002/05/19 20:40:55 khz Exp $
+   $Id: KDChartAxesPainter.cpp,v 1.12.2.1 2003/01/30 21:08:00 pmueller Exp $
    KDChart - a multi-platform charting engine
 */
 
@@ -1821,22 +1821,19 @@
     */
     if ( KDChartAxisParams::AXIS_LABELS_AUTO_LIMIT == para.axisValueStart() ) {
         double orgLow( nLow );
-        modf( nLow / nDivisor, &nLow );
-        //double nMod = modf( nLow / nRound, &nLow );
-        nLow *= nRound * nDivisor;
+        modf( nLow / nDelta, &nLow );
+        nLow *= nDelta;
         if ( nLow > orgLow )
-            nLow -= nRound * nDivisor;
+            nLow -= nDelta;
         if ( 0.0 < nLow && 0.0 >= orgLow )
             nLow = 0.0;
     }
     if ( KDChartAxisParams::AXIS_LABELS_AUTO_LIMIT == para.axisValueEnd() ) {
         double orgHigh( nHigh );
-        //nHigh += 1.1 * nDelta;
-        modf( nHigh / nDivisor, &nHigh );
-        //double nMod = modf( nHigh / nRound, &nHigh );
-        nHigh *= nRound * nDivisor;
+        modf( nHigh / nDelta, &nHigh );
+        nHigh *= nDelta;
         if ( nHigh < orgHigh )
-            nHigh += nRound * nDivisor;
+            nHigh += nDelta;
         if ( 0.0 > nHigh && 0.0 <= orgHigh )
             nHigh = 0.0;
     }
--- kchart/kdchart/Makefile.am	20 Jun 2002 04:49:58 -0000	1.1.1.2
+++ kchart/kdchart/Makefile.am	1 Dec 2002 17:02:18 -0000	1.4
@@ -1,5 +1,7 @@
 lib_LTLIBRARIES = libkdchart.la
 
+libkdchart_la_LIBADD  = $(LIB_QT)
+libkdchart_la_LDFLAGS = $(all_libraries) -avoid-version
 libkdchart_la_SOURCES = KDChart.cpp 		\
 			KDChartAreaPainter.cpp	\
 			KDChartAxesPainter.cpp	\
--- kformula/Makefile.am	10 Aug 2002 13:49:17 -0000	1.1.1.3
+++ kformula/Makefile.am	1 Dec 2002 17:02:18 -0000	1.2
@@ -12,19 +12,19 @@
 libkformulapart_la_METASOURCES = AUTO
 
 ## The kdeinit loadable module
-lib_LTLIBRARIES = kformulamain.la
-kformulamain_la_SOURCES = main.cc
-kformulamain_la_LDFLAGS = $(all_libraries) -module -avoid-version
-kformulamain_la_LIBADD = $(LIB_KOFFICECORE)
+lib_LTLIBRARIES = kformula.la
+kformula_la_SOURCES = main.cc
+kformula_la_LDFLAGS = $(all_libraries) -module -avoid-version
+kformula_la_LIBADD = $(LIB_KOFFICECORE)
 
 ## The executable
 bin_PROGRAMS = kformula
-kformula_SOURCES = dummy.cc
+kformula_SOURCES = kformula_main.cc
 kformula_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kformula_LDADD = kformulamain.la
+kformula_LDADD   = $(LIB_KOFFICECORE)
 
-dummy.cc:
-	echo > dummy.cc
+kformula_main.cc:
+	cat main.cc > kformula_main.cc
 
 noinst_HEADERS =  kformula_doc.h \
 		  kformula_view.h kformula_factory.h \
--- kivio/kiviopart/Makefile.am	10 Aug 2002 13:49:24 -0000	1.1.1.3
+++ kivio/kiviopart/Makefile.am	4 Dec 2002 14:15:24 -0000	1.3
@@ -4,8 +4,8 @@
 ##############################################################
 SUBDIRS = ui kiviosdk tklib tools pics tiles stencils .
 
-kde_module_LTLIBRARIES = libkiviopart.la
-libkiviopart_la_LIBADD = \
+kde_module_LTLIBRARIES = libkiviopart.la libkiviopart_shared.la
+libkiviopart_shared_la_LIBADD = \
 		$(top_builddir)/kivio/kiviopart/tools/libtools.la\
 		$(top_builddir)/kivio/kiviopart/tklib/libtklib.la\
 		$(top_builddir)/kivio/kiviopart/kiviosdk/libkiviosdk.la\
@@ -21,8 +21,8 @@
 	-I$(top_srcdir)/lib/kformula\
 	$(all_includes)
 
-libkiviopart_la_METASOURCES = AUTO
-libkiviopart_la_SOURCES = \
+libkiviopart_shared_la_METASOURCES = AUTO
+libkiviopart_shared_la_SOURCES = \
 		kivio_canvas.cpp\
 		kivio_doc.cpp\
 		kivio_factory.cpp\
@@ -135,7 +135,16 @@
 		KIvioPageIface.skel KIvioPageIface.cc KIvioPageIface.h \
 		kivio_command.cc kivio_command.h KIvioLayerIface.cc \
 		KIvioLayerIface.h
-		
+
+libkiviopart_shared_la_LDFLAGS = -avoid-version $(all_libraries)
+
+libkiviopart_la_SOURCES = dummy.cpp
+libkiviopart_la_LDFLAGS = $(all_libraries) -avoid-version -module
+libkiviopart_la_LIBADD  = libkiviopart_shared.la
+
+dummy.cpp:
+	echo > dummy.cpp
+
 ##############################################################
 ####                  END KDEStudio part                  ####
 #2########################################################!@#$
@@ -144,15 +153,13 @@
 kivio_la_LDFLAGS = $(all_libraries) -module -avoid-version
 kivio_la_LIBADD = ../../lib/kofficecore/libkofficecore.la
 
-libkiviopart_la_LDFLAGS = -avoid-version -module $(all_libraries)
-
 bin_PROGRAMS = kivio
-kivio_SOURCES = dummy.cpp
+kivio_SOURCES = kivio_main.cpp
 kivio_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kivio_LDADD = kivio.la
+kivio_LDADD = ../../lib/kofficecore/libkofficecore.la
 
-dummy.cpp:
-	echo > dummy.cpp
+kivio_main.cpp: main.cpp
+	cat main.cpp > kivio_main.cpp
 
 kdelnk_DATA = kivio.desktop
 kdelnkdir = $(kde_appsdir)/Office
--- kivio/plugins/kivioconnectortool/Makefile.am	12 Sep 2002 12:44:57 -0000	1.1.1.3
+++ kivio/plugins/kivioconnectortool/Makefile.am	1 Dec 2002 17:02:19 -0000	1.2
@@ -30,7 +30,7 @@
 ####                  END KDEStudio part                  ####
 #2########################################################!@#$
 libkivioconnectortool_la_LDFLAGS = -module $(KDE_PLUGIN)
-libkivioconnectortool_la_LIBADD = $(all_libraries) $(top_builddir)/kivio/kiviopart/libkiviopart.la
+libkivioconnectortool_la_LIBADD = $(all_libraries) $(top_builddir)/kivio/kiviopart/libkiviopart_shared.la
 
 rc_DATA = kivioconnectortool.rc
 rcdir = $(kde_datadir)/kivio/kpartplugins
--- kivio/plugins/kivioconnectortool/straight_connector/Makefile.am	4 Dec 2002 02:59:57 -0000	1.1.1.3
+++ kivio/plugins/kivioconnectortool/straight_connector/Makefile.am	17 Dec 2002 05:01:59 -0000	1.5
@@ -10,7 +10,7 @@
 
 # Hack to make it work (dave m)
 libstraight_connector_la_LIBADD = \
-    $(top_builddir)/kivio/kiviopart/libkiviopart.la
+    $(top_builddir)/kivio/kiviopart/libkiviopart_shared.la
 
 INCLUDES = -I$(top_srcdir)/kivio/kiviopart\
 	-I$(top_srcdir)/kivio/kiviopart/kiviosdk\
@@ -33,7 +33,7 @@
 install-libLTLIBRARIES: $(lib_LTLIBRARIES)
 	@$(NORMAL_INSTALL)
 	$(mkinstalldirs) $(DESTDIR)$(libdir)
-	$(LIBTOOL)  --mode=install $(INSTALL) ./.libs/libstraight_connector.so $(DESTDIR)$(libdir)/straight_connector.ksp;
+	$(LIBTOOL)  --mode=install $(INSTALL) ./.libs/libstraight_connector.dylib $(DESTDIR)$(libdir)/straight_connector.ksp;
 
 uninstall-libLTLIBRARIES:
 	@$(NORMAL_UNINSTALL)
--- kivio/plugins/kivioselecttool/Makefile.am	12 Sep 2002 12:44:57 -0000	1.1.1.3
+++ kivio/plugins/kivioselecttool/Makefile.am	1 Dec 2002 17:02:19 -0000	1.2
@@ -26,7 +26,7 @@
 ####                  END KDEStudio part                  ####
 #2########################################################!@#$
 libkivioselecttool_la_LDFLAGS = -module $(KDE_PLUGIN)
-libkivioselecttool_la_LIBADD = $(all_libraries) $(top_builddir)/kivio/kiviopart/libkiviopart.la
+libkivioselecttool_la_LIBADD = $(all_libraries) $(top_builddir)/kivio/kiviopart/libkiviopart_shared.la
 
 rc_DATA = kivioselecttool.rc
 rcdir = $(kde_datadir)/kivio/kpartplugins
--- kivio/plugins/kiviotexttool/Makefile.am	12 Sep 2002 12:44:57 -0000	1.1.1.3
+++ kivio/plugins/kiviotexttool/Makefile.am	1 Dec 2002 17:02:19 -0000	1.2
@@ -30,7 +30,7 @@
 ####                  END KDEStudio part                  ####
 #2########################################################!@#$
 libkiviotexttool_la_LDFLAGS = -module $(KDE_PLUGIN)
-libkiviotexttool_la_LIBADD = $(all_libraries) $(top_builddir)/kivio/kiviopart/libkiviopart.la
+libkiviotexttool_la_LIBADD = $(all_libraries) $(top_builddir)/kivio/kiviopart/libkiviopart_shared.la
 
 rc_DATA = kiviotexttool.rc
 rcdir = $(kde_datadir)/kivio/kpartplugins
--- kivio/plugins/kiviozoomtool/Makefile.am	12 Sep 2002 12:44:57 -0000	1.1.1.3
+++ kivio/plugins/kiviozoomtool/Makefile.am	1 Dec 2002 17:02:20 -0000	1.2
@@ -25,7 +25,7 @@
 ####                  END KDEStudio part                  ####
 #2########################################################!@#$
 libkiviozoomtool_la_LDFLAGS = -module $(KDE_PLUGIN)
-libkiviozoomtool_la_LIBADD = $(all_libraries) $(top_builddir)/kivio/kiviopart/libkiviopart.la
+libkiviozoomtool_la_LIBADD = $(all_libraries) $(top_builddir)/kivio/kiviopart/libkiviopart_shared.la
 
 rc_DATA = kiviozoomtool.rc
 rcdir = $(kde_datadir)/kivio/kpartplugins
--- kontour/Makefile.am	10 Aug 2002 13:49:37 -0000	1.1.1.2
+++ kontour/Makefile.am	1 Dec 2002 17:02:20 -0000	1.2
@@ -19,12 +19,12 @@
 
 ## The executable
 bin_PROGRAMS = kontour
-kontour_SOURCES = dummy.cc
+kontour_SOURCES = kontour_main.cc
 kontour_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kontour_LDADD = kontour.la
+kontour_LDADD = ../lib/kofficecore/libkofficecore.la
 
-dummy.cc:
-	echo > dummy.cc
+kontour_main.cc: main.cc
+	cat main.cc > kontour_main.cc
 
 ## The part
 kde_module_LTLIBRARIES = libkontourpart.la
--- koshell/Makefile.am	20 Jun 2002 04:43:30 -0000	1.1.1.1
+++ koshell/Makefile.am	1 Dec 2002 17:02:20 -0000	1.2
@@ -2,19 +2,24 @@
 INCLUDES  = $(KOFFICE_INCLUDES) $(all_includes)
 
 ## The kdeinit loadable module
-lib_LTLIBRARIES = koshell.la
-koshell_la_SOURCES = koshell_main.cc koshell_shell.cc
-koshell_la_LDFLAGS = $(all_libraries) -avoid-version -module
-koshell_la_LIBADD = $(LIB_KOFFICEUI)
+lib_LTLIBRARIES = koshell.la libkoshell_shared.la
+
+libkoshell_shared_la_SOURCES = koshell_shell.cc
+libkoshell_shared_la_LDFLAGS = $(all_libraries) -avoid-version
+libkoshell_shared_la_LIBADD = $(LIB_KOFFICEUI)
+
+koshell_la_SOURCES = koshell_la_main.cc
+koshell_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
+koshell_la_LIBADD  = libkoshell_shared.la
+
+koshell_la_main.cc: koshell_main.cc
+	cat koshell_main.cc > koshell_la_main.cc
 
 ## The executable
 bin_PROGRAMS = koshell
-koshell_SOURCES = dummy.cc
+koshell_SOURCES = koshell_main.cc
 koshell_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-koshell_LDADD = koshell.la
-
-dummy.cc:
-	echo > dummy.cc
+koshell_LDADD = libkoshell_shared.la
 
 noinst_HEADERS = koshell_shell.h
 
--- kpresenter/Makefile.am	10 Aug 2002 13:49:51 -0000	1.1.1.3
+++ kpresenter/Makefile.am	1 Dec 2002 17:02:20 -0000	1.2
@@ -60,12 +60,12 @@
 
 ## The executable
 bin_PROGRAMS = kpresenter
-kpresenter_SOURCES = dummy.cc
+kpresenter_SOURCES = kpresenter_main.cc
 kpresenter_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kpresenter_LDADD = kpresenter.la
+kpresenter_LDADD = $(LIB_KOFFICECORE)
 
-dummy.cc:
-	echo > dummy.cc
+kpresenter_main.cc: main.cc
+	cat main.cc > kpresenter_main.cc
 
 noinst_HEADERS = koPointArray.h kprcanvas.h kprpage.h kpresenter_doc.h kpresenter_view.h \
 		backdia.h styledia.h \
--- kpresenter/kpresenter_view.cc	4 Dec 2002 03:00:06 -0000	1.1.1.5
+++ kpresenter/kpresenter_view.cc	24 Mar 2003 21:11:12 -0000	1.8
@@ -1307,7 +1307,7 @@
 
     if ( KoPageLayoutDia::pageLayout( pgLayout, hf, FORMAT_AND_BORDERS, unit ) ) {
 	PgLayoutCmd *pgLayoutCmd = new PgLayoutCmd( i18n( "Set Page Layout" ),
-						    pgLayout, oldLayout, unit, oldUnit,kPresenterDoc() );
+						    pgLayout, oldLayout, oldUnit, unit,kPresenterDoc() );
 	pgLayoutCmd->execute();
 	kPresenterDoc()->addCommand( pgLayoutCmd );
         updateRuler();
@@ -3224,7 +3224,7 @@
                                            actionCollection(), "format_style" );
     connect( actionFormatStyle, SIGNAL( activated( int ) ),
              this, SLOT( textStyleSelected( int ) ) );
-#if KDE_VERSION > 305
+#if KDE_VERSION >= 305
     actionFormatStyle->setRemoveAmpersandsInCombo( true );
 #endif
     updateStyleList();
@@ -3972,7 +3972,7 @@
 {
     QColor c = kPresenterDoc()->presPen().color();
     if ( KColorDialog::getColor( c
-#if KDE_VERSION > 305
+#if KDE_VERSION >= 305
                                  , Qt::red
 #endif
              ) ) {
@@ -4451,7 +4451,7 @@
     //(Laurent) deselect object when we change page.
     //otherwise you can change object properties on other page
     m_canvas->deSelectAllObj();
-    m_pKPresenterDoc->repaint( FALSE );
+    m_pKPresenterDoc->repaint( (bool)FALSE );
 
     m_pKPresenterDoc->displayActivePage(m_pKPresenterDoc->pageList().at(currPg));
 
@@ -5060,7 +5060,7 @@
 void KPresenterView::showFormat( const KoTextFormat &currentFormat )
 {
     actionTextFontFamily->setFont( currentFormat.font().family() );
-    actionTextFontSize->setFontSize( currentFormat.pointSize() );
+    actionTextFontSize->setFontSize( currentFormat.font().pointSize() );
     actionTextBold->setChecked( currentFormat.font().bold());
     actionTextItalic->setChecked( currentFormat.font().italic() );
     actionTextUnderline->setChecked( currentFormat.underline());
@@ -5116,7 +5116,7 @@
 {
     if (m_spell.kspell) return; // Already in progress
     m_spell.macroCmdSpellCheck=0L;
-#if KDE_VERSION > 305
+#if KDE_VERSION >= 305
     m_spell.replaceAll.clear();
 #endif
 
@@ -5173,7 +5173,7 @@
     if(m_pKPresenterDoc->getKSpellConfig())
     {
         m_pKPresenterDoc->getKSpellConfig()->setIgnoreList(m_pKPresenterDoc->spellListIgnoreAll());
-#if KDE_VERSION > 305
+#if KDE_VERSION >= 305
         m_pKPresenterDoc->getKSpellConfig()->setReplaceAllList(m_spell.replaceAll);
 #endif
 
@@ -5194,7 +5194,7 @@
                       this, SLOT( spellCheckerDone( const QString & ) ) );
     QObject::connect( m_spell.kspell, SIGNAL( ignoreall (const QString & ) ),
                       this, SLOT( spellCheckerIgnoreAll( const QString & ) ) );
-#if KDE_VERSION > 305
+#if KDE_VERSION >= 305
     QObject::connect( m_spell.kspell, SIGNAL( replaceall( const QString &, const QString & )), this, SLOT( spellCheckerReplaceAll( const QString &, const QString & )));
 #endif
 
@@ -5323,7 +5323,7 @@
     {
         m_pKPresenterDoc->setReadWrite(true);
         m_spell.textObject.clear();
-#if KDE_VERSION > 305
+#if KDE_VERSION >= 305
         m_spell.replaceAll.clear();
 #endif
 
@@ -5362,7 +5362,7 @@
     m_spell.macroCmdSpellCheck=0L;
 
     m_pKPresenterDoc->setReadWrite(true);
-#if KDE_VERSION > 305
+#if KDE_VERSION >= 305
     m_spell.replaceAll.clear();
 #endif
 
@@ -6273,7 +6273,7 @@
     // to individual actions
     QStringList lstWithAccels;
     // Generate unique accelerators for the menu items
-#if KDE_VERSION > 305  // but only if the '&' will be removed from the combobox
+#if KDE_VERSION >= 305  // but only if the '&' will be removed from the combobox
     KAccelGen::generate( lst, lstWithAccels );
 #else
     lstWithAccels = lst;
@@ -6840,6 +6840,8 @@
     if ( !m_canvas->applicableTextInterfaces().isEmpty() )
     {
         KoTextFormat format =*(m_canvas->applicableTextInterfaces().first()->currentFormat());
+        //unzoom font
+        format.setPointSize( (int)KoTextZoomHandler::layoutUnitPtToPt( format.font().pointSize() ) );
         showFormat( format );
         const KoParagLayout * paragLayout=m_canvas->applicableTextInterfaces().first()->currentParagLayoutFormat();
         KoParagCounter counter;
--- kspread/CHANGES	4 Dec 2002 03:00:18 -0000	1.1.1.5
+++ kspread/CHANGES	24 Mar 2003 21:11:12 -0000	1.2
@@ -1,3 +1,10 @@
+Changes since 1.2.1
+===================
+Bugfixes:
+- Fix display of unhided rows/columns for loaded files
+- Fix enabled status for buttons insert column/row when row/column is selected
+- Fix for display of print range with repeated rows
+
 Changes since 1.2
 =================
 Bugfixes:
--- kspread/Makefile.am	10 Aug 2002 13:50:22 -0000	1.1.1.3
+++ kspread/Makefile.am	1 Dec 2002 17:02:21 -0000	1.2
@@ -3,8 +3,8 @@
 	 -I$(top_srcdir)/kchart/kdchart $(all_includes)
 
 ## The part
-kde_module_LTLIBRARIES = libkspreadpart.la
-libkspreadpart_la_SOURCES = kspread_locale.cc \
+kde_module_LTLIBRARIES = libkspreadpart_shared.la libkspreadpart.la
+libkspreadpart_shared_la_SOURCES = kspread_locale.cc \
 	kspread_dlg_formula.cc \
 	kspread_functions.cc kspread_dlg_csv.cc \
 	kspread_canvas.cc \
@@ -41,10 +41,17 @@
 	KSpreadRowIface.skel KSpreadRowIface.cc \
 	kspread_selection.cc kspread_dlg_paperlayout.cc
 
-libkspreadpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN)
-libkspreadpart_la_LIBADD = $(top_builddir)/interfaces/libkochart.la \
+libkspreadpart_shared_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version
+libkspreadpart_shared_la_LIBADD = $(top_builddir)/interfaces/libkochart.la \
 	$(LIB_KOSCRIPT) $(LIB_KOFFICEUI) -lkspell
-libkspreadpart_la_METASOURCES = AUTO
+libkspreadpart_shared_la_METASOURCES = AUTO
+
+libkspreadpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN)
+libkspreadpart_la_LIBADD  = libkspreadpart_shared.la
+libkspreadpart_la_SOURCES = libkspreadpart_dummy.cpp
+
+libkspreadpart_dummy.cpp:
+	echo > libkspreadpart_dummy.cpp
 
 ## The kdeinit loadable module
 lib_LTLIBRARIES =  kspread.la
@@ -54,12 +61,12 @@
 
 ## The executable
 bin_PROGRAMS = kspread
-kspread_SOURCES = dummy.cc
+kspread_SOURCES = kspread_main.cc
 kspread_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kspread_LDADD = kspread.la
+kspread_LDADD = $(LIB_KOFFICECORE)
 
-dummy.cc:
-	echo > dummy.cc
+kspread_main.cc: main.cc
+	cat main.cc > kspread_main.cc
 
 noinst_HEADERS = kspread_doc.h kspread_functions.h \
 	kspread_undo.h kspread_view.h kspread_tabbar.h \
--- kspread/kspread_layout.cc	4 Dec 2002 03:00:23 -0000	1.1.1.5
+++ kspread/kspread_layout.cc	24 Mar 2003 21:11:12 -0000	1.2
@@ -2017,6 +2017,7 @@
 	    // Rise maximum size by height of row
 	    m_bHide=_hide; //unhide must be set before we request the height
 	    m_pTable->adjustSizeMaxY ( height() );
+            m_pTable->emit_updateRow( this, m_iRow );
 	}
     }
 }
@@ -2254,9 +2255,12 @@
 	    m_bHide=_hide; //hide must be set after we requested the width
 	}
 	else
+        {
 	    // Rise maximum size by width of column
 	    m_bHide=_hide; //unhide must be set before we request the width
 	    m_pTable->adjustSizeMaxX ( width() );
+            m_pTable->emit_updateColumn( this, m_iColumn );
+        }
     }
 }
 
--- kspread/kspread_selection.cc	12 Sep 2002 12:45:27 -0000	1.1.1.3
+++ kspread/kspread_selection.cc	24 Mar 2003 21:11:12 -0000	1.2
@@ -152,6 +152,8 @@
     setCursorPosition(newMarker);
   }
 
+  m_pView->enableInsertColumn( !util_isRowSelected( newSelection ) );
+  m_pView->enableInsertRow( !util_isColumnSelected( newSelection ) );
   m_pView->slotChangeSelection( table, oldSelection, oldMarker );
 }
 
--- kspread/kspread_table.cc	4 Dec 2002 03:00:25 -0000	1.1.1.5
+++ kspread/kspread_table.cc	24 Mar 2003 21:11:12 -0000	1.2
@@ -7723,7 +7723,7 @@
 
 void KSpreadTable::updatePrintRepeatRowsHeight()
 {
-    m_dPrintRepeatRowsHeight += 0.0;
+    m_dPrintRepeatRowsHeight = 0.0;
     if ( m_printRepeatRows.first != 0 )
     {
         for ( int i = m_printRepeatRows.first; i <= m_printRepeatRows.second; i++)
--- kspread/kspread_view.cc	4 Dec 2002 03:00:26 -0000	1.1.1.5
+++ kspread/kspread_view.cc	24 Mar 2003 21:11:12 -0000	1.2
@@ -2110,6 +2110,16 @@
     m_redo->setText(i18n("Redo: %1").arg(m_pDoc->undoBuffer()->getRedoName()));
 }
 
+void KSpreadView::enableInsertColumn( bool _b )
+{
+    m_insertColumn->setEnabled( _b );
+}
+
+void KSpreadView::enableInsertRow( bool _b )
+{
+    m_insertRow->setEnabled( _b );
+}
+
 void KSpreadView::undo()
 {
     m_pDoc->undo();
--- kspread/kspread_view.h	4 Dec 2002 03:00:26 -0000	1.1.1.5
+++ kspread/kspread_view.h	24 Mar 2003 21:11:12 -0000	1.2
@@ -117,6 +117,8 @@
 
     void enableUndo( bool _b );
     void enableRedo( bool _b );
+    void enableInsertColumn( bool _b );
+    void enableInsertRow( bool _b );
 
     /**
      * Called by @ref KSpreadInsertHandler
--- kspread/plugins/calculator/Makefile.am	20 Jun 2002 04:43:37 -0000	1.1.1.1
+++ kspread/plugins/calculator/Makefile.am	1 Dec 2002 17:02:21 -0000	1.2
@@ -9,7 +9,7 @@
 			main.cpp \
 			stats.cpp
 libkspreadcalc_la_LDFLAGS = -avoid-version -module -no-undefined
-libkspreadcalc_la_LIBADD = $(all_libraries) ../../libkspreadpart.la
+libkspreadcalc_la_LIBADD = $(all_libraries) ../../libkspreadpart_shared.la
 
 METASOURCES = AUTO
 
--- kspread/plugins/calculator/kcalc_core.cpp	20 Jun 2002 04:43:37 -0000	1.1.1.1
+++ kspread/plugins/calculator/kcalc_core.cpp	11 Aug 2002 16:42:11 -0000	1.2
@@ -51,7 +51,7 @@
 #undef HAVE_LONG_DOUBLE
 #endif
 
-#ifndef HAVE_FUNC_ISINF
+#if !defined(HAVE_FUNC_ISINF) || defined(__APPLE__)
 #ifdef HAVE_IEEEFP_H
 #include <ieeefp.h>
 #else
--- kugar/part/Makefile.am	20 Jun 2002 04:43:38 -0000	1.1.1.1
+++ kugar/part/Makefile.am	20 Jun 2002 04:48:29 -0000	1.2
@@ -3,7 +3,7 @@
 lib_LTLIBRARIES = libkugarpart.la
 libkugarpart_la_SOURCES = kugar_part.cpp
 libkugarpart_la_LDFLAGS = $(all_libraries) -module -avoid-version
-libkugarpart_la_LIBADD = ../lib/libkugar.la $(LIB_KPARTS) $(LIB_KDEPRINT)
+libkugarpart_la_LIBADD = ../lib/libkugar.la $(LIB_KPARTS) $(LIB_KDEPRINT) $(LIB_QT) $(LIB_KDECORE) $(LIB_KDEUI) $(LIB_KIO)
 
 libkugarpart_la_METASOURCES = AUTO
 
--- kword/Makefile.am	10 Aug 2002 13:50:51 -0000	1.1.1.3
+++ kword/Makefile.am	1 Dec 2002 17:02:21 -0000	1.2
@@ -1,3 +1,4 @@
+KDE_OPTIONS = nofinal
 
 KDE_CXXFLAGS = $(USE_RTTI)
 INCLUDES = $(KOFFICE_INCLUDES) -I$(top_srcdir)/lib/kformula \
@@ -62,12 +63,12 @@
 
 ## The executable
 bin_PROGRAMS = kword
-kword_SOURCES = dummy.cc
+kword_SOURCES = bin_main.cc
 kword_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kword_LDADD = kword.la
+kword_LDADD = ../lib/kofficecore/libkofficecore.la
 
-dummy.cc:
-	echo > dummy.cc
+bin_main.cc:
+	cat main.cc > bin_main.cc
 
 kdelnk_DATA = kword.desktop
 kdelnkdir = $(kde_appsdir)/Office
--- kword/contents.cc	4 Dec 2002 03:00:32 -0000	1.1.1.3
+++ kword/contents.cc	28 Jan 2003 15:29:04 -0000	1.2
@@ -134,7 +134,7 @@
     // We start from the end, to avoid the parag shifting problem
     KoTextParag *p = textdoc->lastParag();
     KoTextCursor *posOfTable=0L;
-    KWTextParag *posOfToc=0L;
+    KoTextParag *posOfToc=0L;
 
     while ( p )
     {
@@ -142,8 +142,6 @@
         if ( parag->style() && ( parag->style()->name().startsWith( "Contents Head" ) ||
             parag->style()->name() == "Contents Title" ) )
         {
-            posOfToc=parag;
-
             kdDebug() << "KWContents::createContents Deleting paragraph " << p << " " << p->paragId() << endl;
             // This paragraph is part of the TOC -> remove
 
@@ -172,6 +170,7 @@
             delete p;
             kdDebug() << "KWInsertTOCCommand::removeTOC " << p << " deleted" << endl;
             p = next;
+            posOfToc = p;
             kdDebug() << "KWInsertTOCCommand::removeTOC prev=" << prev << " p=" << p << endl;
             // Fix parag chain
             if ( prev )
@@ -179,6 +178,8 @@
                 prev->setNext( p );
                 if ( p )
                     p->setParagId( prev->paragId() + 1 );
+                else
+                    posOfToc = prev;
             }
             else
             {
@@ -190,6 +191,7 @@
                 {
                     textdoc->clear( true ); // recreate empty parag.
                     cursor->setParag( textdoc->firstParag() );
+                    posOfToc = textdoc->firstParag();
                     break;
                 }
             }
@@ -198,12 +200,12 @@
         p = p->prev();
     }
     textdoc->invalidate();
-     if(posOfToc)
-     {
+    if(posOfToc)
+    {
          posOfTable=new KoTextCursor( textdoc );
          posOfTable->setParag(posOfToc  );
          posOfTable->setIndex( 0 );//start of parag
-     }
+    }
     // ### TODO propagate parag ID changes.
     return posOfTable;
 }
--- kword/kwtableframeset.cc	10 Aug 2002 13:50:43 -0000	1.1.1.3
+++ kword/kwtableframeset.cc	24 Mar 2003 21:11:14 -0000	1.2
@@ -86,6 +86,11 @@
         //Do this in KWTableFrameSet::invalidate
         //m_cells.at(i)->invalidate();
     }
+    if ( isFloating() )  {
+        KWAnchor * anchor = findAnchor( 0 );
+        if ( anchor )
+            anchor->resize();
+    }
     KWFrameSet::updateFrames( flags );
 }
 
@@ -605,6 +610,7 @@
     }
     redrawFromCol=getCols();
     kdDebug(32004) << "KWTableFrameSet::recalcRows done" << endl;
+    updateFrames();
 }
 
 void KWTableFrameSet::resizeWidth( double width ) {
--- kword/kwview.cc	4 Dec 2002 03:00:40 -0000	1.1.1.5
+++ kword/kwview.cc	28 Jan 2003 15:29:04 -0000	1.2
@@ -251,12 +251,6 @@
 KWView::~KWView()
 {
     clearSelection();
-    //delete special char dlg when we close view
-    if ( m_specialCharDlg )
-    {
-        m_specialCharDlg->closeDialog();
-    }
-
     if ( m_findReplace )
     {
         // Abort any find/replace
@@ -322,8 +316,11 @@
         delete m_spell.kspell;
     }
     delete m_searchEntry;
+    m_searchEntry = 0L;
     delete m_replaceEntry;
-    delete m_specialCharDlg;
+    m_replaceEntry = 0L;
+    if ( m_specialCharDlg )
+        m_specialCharDlg->closeDialog(); // will call slotSpecialCharDlgClosed
 }
 
 
@@ -3079,7 +3076,7 @@
                     this, SLOT(slotSpecialChar(QChar,const QString &)));
         disconnect( m_specialCharDlg, SIGNAL( finished() ),
                     this, SLOT( slotSpecialCharDlgClosed() ) );
-        delete m_specialCharDlg;
+        m_specialCharDlg->deleteLater();
         m_specialCharDlg = 0L;
     }
 }
--- lib/kofficecore/koDocument.cc	4 Dec 2002 03:00:52 -0000	1.1.1.5
+++ lib/kofficecore/koDocument.cc	24 Mar 2003 21:11:14 -0000	1.2
@@ -26,6 +26,8 @@
 #include <assert.h>
 #include <unistd.h>
 
+#include <qbuffer.h>
+
 #include <koDocument.h>
 #include <koDocument_p.h>
 #include <KoDocumentIface.h>
@@ -786,11 +788,18 @@
 {
     QPixmap pix = generatePreview(QSize(256, 256));
     // Reducing to 8bpp reduces file sizes quite a lot.
-    QImage image = pix.convertToImage().convertDepth(8, Qt::AvoidDither | Qt::DiffuseDither);
+    QImageIO imageIO;
+    imageIO.setImage( pix.convertToImage().convertDepth(8, Qt::AvoidDither | Qt::DiffuseDither) );
 
+    // NOTE: we cannot use QDataStream, as it is not 1:1
     QByteArray imageData;
-    QDataStream imageStream(imageData, IO_WriteOnly);
-    imageStream << image;
+    QBuffer buffer(imageData);
+    buffer.open(IO_WriteOnly);
+    imageIO.setIODevice(&buffer);
+    imageIO.setFormat("PNG");
+    imageIO.write();
+    buffer.close();
+    
     store->write( imageData );
 }
 
--- lib/store/Makefile.am	20 Jun 2002 04:43:54 -0000	1.1.1.1
+++ lib/store/Makefile.am	24 Mar 2003 21:11:14 -0000	1.2
@@ -7,7 +7,7 @@
 
 ####### Files
 
-libkstore_la_LIBADD = $(LIB_KSYCOCA)
+libkstore_la_LIBADD = $(LIB_KSYCOCA) $(LIBZ)
 libkstore_la_SOURCES = koStore.cc koTarStore.cc koDirectoryStore.cc koZipStore.cc \
 		       kozip.cpp kofilterdev.cpp
 libkstore_la_LDFLAGS = $(all_libraries) -version-info 2:0:0 $(KDE_LDFLAGS) -no-undefined
--- tools/thumbnail/otherofficethumbnail.desktop	12 Sep 2002 12:46:24 -0000	1.1.1.4
+++ tools/thumbnail/otherofficethumbnail.desktop	24 Mar 2003 21:11:14 -0000	1.2
@@ -41,6 +41,6 @@
 Name[zh_TW]=其他 Office 檔案
 Name[zu]=Amanye Amafayela Ehhovisi
 ServiceTypes=ThumbCreator
-MimeTypes=application/illustrator,application/msexcel,application/mspowerpoint,application/msword,application/vnd.palm,application/wordperfect,application/x-abiword,application/x-amipro,application/x-applixgraphics,application/x-applixspread,application/x-applixword,application/x-gnumeric,application/x-quattropro,image/x-msod,text/rtf,text/vnd.wap.wml,text/x-csv
+MimeTypes=application/illustrator,application/msexcel,application/mspowerpoint,application/msword,application/vnd.palm,application/wordperfect,application/x-abiword,application/x-amipro,application/x-applixgraphics,application/x-applixspread,application/x-applixword,application/x-gnumeric,application/x-quattropro,image/x-msod,text/rtf,text/vnd.wap.wml
 X-KDE-Library=kofficethumbnail
 CacheThumbnail=true
