Package: ccp4
Version: 5.0
Revision: 1 
Source: ftp://ftp.%n.ac.uk/%n/current/packed/%n-%v.tar.gz
Source-MD5: 0a0c9950ed5ed0670387773c26a4cab6   
SourceDirectory: %n-%v
# Refmac bug fix
Source2: ftp://ftp.%n.ac.uk/%n/%v/patches/rcard_tor1.f-14May2004
Source2-MD5: 9109ba1436460f65aa9de4f78ab85fe0 
#
Depends: x11, tcltk, blt
BuildDepends: g77 (>= 3.4.0-2), f2c, fort77, tcltk-dev
Replaces: mosflm (<= 6.2.3-2), mosflm-small (<= 6.2.3-2), refmac (<= 5.1999-3)
NoSetCPPFLAGS: true
NoSetLDFLAGS: true
PatchScript: <<
#!/bin/zsh -f
umask 0022
# setup script for zsh and bash users
perl -pi -e 's|/usr/local|%p|g' include/%n.setup-sh        # location of tcktk, blt
perl -pi -e 's|%n-5.0d|%n-5.0|g' include/%n.setup-sh   # fix error
perl -pi -e 's|/xtal|%p/src/%f|g' include/%n.setup-sh      # build prefix
perl -pi -e 's|safari|open|g' include/%n.setup-sh          # open with any default browser
perl -pi -e 's|\${CCP4}/etc \${CBIN} \${CCP4I_TOP}/bin |\${CCP4}/etc:\${CBIN}:\${CCP4I_TOP}/bin |g' include/%n.setup-sh  # fix really bad path error
#
# setup script for tcsh users
cp include/%n.setup-dist include/%n.setup                           
perl -pi -e 's|/usr/local|%p|g' include/%n.setup          # location of tcktk, blt
perl -pi -e 's|/xtal|%p/src/%f|g' include/%n.setup        # build prefix (may be needed here)
perl -pi -e 's|netscape|open|g' include/%n.setup          # open with any default browser
perl -pi -e 's|\${CCP4}/etc \${CBIN} \${CCP4I_TOP}/bin |\${CCP4}/etc:\${CBIN}:\${CCP4I_TOP}/bin |g' include/%n.setup # fix really bad path error
#
# Quick-fix for some compilation header omissions
 cp %p/include/f2c.h    lib/ccif/g2c.h   
 cp %p/include/f2c.h    lib/src/g2c.h
 cp %p/include/f2c.h    lib/g2c.h
 cp %p/include/f2c.h    x-windows/Mosflm/cbf/src/g2c.h
 cp %p/include/f2c.h    x-windows/Mosflm/src/g2c.h
 cp %p/include/f2c.h    x-windows/RasMol/src/g2c.h
 cp %p/include/f2c.h    x-windows/ipdisp/src/g2c.h
 cp %p/include/f2c.h    x-windows/xdl_view/src/g2c.h
#
# Put the refmac patch into place
 cp ../rcard_tor1.f-14May2004    src/refmac5_/rcard_tor1.f
#
<<
CompileScript: <<
#!/bin/zsh -f
 umask 0022
. include/%n.setup-sh
./configure --with-x Darwin
#  fix a post-configure bug
perl -pi -e 's/EXTRA_LOAD_FLAGS = -lg2c//g' x-windows/XCCPJIFFY/Imakefile
#
make -i
make -i install
make clean
<<
InstallScript: <<
#!/bin/zsh -f
umask 0022
# Change environment scripts to match final installation
perl -pi -e 's|%p/src/%f|%p/share/xtal|g' include/%n.setup-sh      # install prefix
perl -pi -e 's|%p/src/%f|%p/share/xtal|g' include/%n.setup         # install prefix
#
 mkdir -p %i/share/xtal/%n-%v
 mkdir -p %i/share/man/man1
 source include/%n.setup
# set up man pages in a fink-compliant manner
cd %p/src/%n-%v-%r/%n-%v/doc
mv rasmol.doc eightbit_rasmol.doc
foreach docfilepage ( *.doc )
 cp ${docfilepage}  %i/share/man/man1/${docfilepage:r}.1
end
# back to source directory
 cd %p/src/%n-%v-%r/%n-%v
#
# install everything in one place -- users will require this
 cp -R * %i/share/xtal/%n-%v/.
 mkdir -p %i/etc/profile.d
#
# make scripts for %p/etc/profile.d and fix a bad variable that caused bugs for fink
#
 echo "source %p/share/xtal/%n-%v/include/%n.setup"     > %i/etc/profile.d/%n.csh
 echo "unsetenv XUSERFILESEARCHPATH"                   >> %i/etc/profile.d/%n.csh
# echo "setenv XAPPLRESDIR  %p/etc/app-defaults/"      >> %i/etc/profile.d/%n.csh
#
 echo ". %p/share/xtal/%n-%v/include/%n.setup-sh"       > %i/etc/profile.d/%n.sh
 echo "export XUSERFILESEARCHPATH='' "                 >> %i/etc/profile.d/%n.sh                                                                                       
# echo "export XAPPLRESDIR=%p/etc/app-defaults/ "      >> %i/etc/profile.d/%n.sh
#
 chmod a+x %i/etc/profile.d/%n.*
#
# needed for compilation of ancilliary programs such as mosflm
#
ranlib %i/share/xtal/%n-%v/lib/*.a
#
<<
Description:  Macromolecular crystallography package
DescDetail: <<
CCP4 macromolecular crystallography program suite
This version compiles with Apple's Lapack/Blas
http://www.ccp4.ac.uk
License agreement is part of configure file -- print out form and mail in, 
additional comments at http://chemistry.ucsc.edu/%7Ewgscott/xtal/page5.html
CCP4 files will be installed under %p/share/xtal/ccp4-5.0   
Note that xloggraph (still) does not compile on OSX.  View logfiles in 
mozzilla-type browser.
<<
DocFiles: README CHANGES COPYING PROBLEMS INSTALL INSTALL.html INSTALL.ps ccp4i_installation.html academic_software_licence.pdf  academic_software_licence.ps.gz  academic_software_licence.rtf
Homepage: http://www.ccp4.ac.uk conditions.txt
License: Restrictive
Maintainer: W. G. Scott <wgscott@users.sourceforge.net>


















