diff -uNr libgtop-2.20.1/configure libgtop-2.20.1-new/configure
--- libgtop-2.20.1/configure	2008-01-05 08:49:53.000000000 -0500
+++ libgtop-2.20.1-new/configure	2008-01-09 09:30:28.000000000 -0500
@@ -21122,6 +21122,13 @@
 echo $ECHO_N "checking for libgtop sysdeps directory... $ECHO_C" >&6; }
 
 	case "$host_os" in
+	darwin*)
+	  libgtop_sysdeps_dir=darwin
+	  libgtop_use_machine_h=yes
+	  libgtop_have_sysinfo=yes
+	  libgtop_need_server=yes
+	  libgtop_postinstall='chgrp kmem $(DESTDIR)$(bindir)/libgtop_server2 && chmod 6755 $(DESTDIR)/$(bindir)/libgtop_server2'
+	  ;;
 	linux*)
 	  libgtop_sysdeps_dir=linux
 	  libgtop_use_machine_h=no
@@ -32026,7 +32033,7 @@
 
 
 
-ac_config_files="$ac_config_files Makefile libgtop.spec po/Makefile.in misc/Makefile include/Makefile include/glibtop/Makefile sysdeps/Makefile sysdeps/common/Makefile sysdeps/stub/Makefile sysdeps/stub_suid/Makefile sysdeps/sun4/Makefile sysdeps/osf1/Makefile sysdeps/linux/Makefile sysdeps/freebsd/Makefile sysdeps/solaris/Makefile sysdeps/aix/Makefile sysdeps/bsd/Makefile src/Makefile src/daemon/Makefile lib/Makefile examples/Makefile doc/Makefile doc/reference/Makefile doc/reference/version.xml libgtop-2.0.pc libgtopconfig.h"
+ac_config_files="$ac_config_files Makefile libgtop.spec po/Makefile.in misc/Makefile include/Makefile include/glibtop/Makefile sysdeps/Makefile sysdeps/common/Makefile sysdeps/stub/Makefile sysdeps/stub_suid/Makefile sysdeps/sun4/Makefile sysdeps/osf1/Makefile sysdeps/linux/Makefile sysdeps/freebsd/Makefile sysdeps/solaris/Makefile sysdeps/aix/Makefile sysdeps/darwin/Makefile sysdeps/bsd/Makefile src/Makefile src/daemon/Makefile lib/Makefile examples/Makefile doc/Makefile doc/reference/Makefile doc/reference/version.xml libgtop-2.0.pc libgtopconfig.h"
 
 
 cat >confcache <<\_ACEOF
@@ -32696,6 +32703,7 @@
     "sysdeps/freebsd/Makefile") CONFIG_FILES="$CONFIG_FILES sysdeps/freebsd/Makefile" ;;
     "sysdeps/solaris/Makefile") CONFIG_FILES="$CONFIG_FILES sysdeps/solaris/Makefile" ;;
     "sysdeps/aix/Makefile") CONFIG_FILES="$CONFIG_FILES sysdeps/aix/Makefile" ;;
+    "sysdeps/darwin/Makefile") CONFIG_FILES="$CONFIG_FILES sysdeps/darwin/Makefile" ;;
     "sysdeps/bsd/Makefile") CONFIG_FILES="$CONFIG_FILES sysdeps/bsd/Makefile" ;;
     "src/Makefile") CONFIG_FILES="$CONFIG_FILES src/Makefile" ;;
     "src/daemon/Makefile") CONFIG_FILES="$CONFIG_FILES src/daemon/Makefile" ;;
diff -uNr libgtop-2.20.1/lib/Makefile.in libgtop-2.20.1-new/lib/Makefile.in
--- libgtop-2.20.1/lib/Makefile.in	2008-01-05 08:49:59.000000000 -0500
+++ libgtop-2.20.1-new/lib/Makefile.in	2008-01-09 09:30:28.000000000 -0500
@@ -288,7 +288,7 @@
 				  read_data.c write.c lib.c parameter.c \
 				  sysdeps.c
 
-libgtop_2_0_la_LDFLAGS = $(LT_VERSION_INFO) -export-symbols $(srcdir)/libgtop.sym
+libgtop_2_0_la_LDFLAGS = $(LT_VERSION_INFO)
 libgtop_2_0_la_LIBADD = $(GLIB_LIBS) $(top_builddir)/sysdeps/common/libgtop_common-2.0.la $(top_builddir)/sysdeps/@sysdeps_dir@/libgtop_sysdeps-2.0.la $(sysdeps_suid_lib)
 BUILT_SOURCES = lib.c
 EXTRA_DIST = lib.pl libgtop.sym
diff -uNr libgtop-2.20.1/lib/open.c libgtop-2.20.1-new/lib/open.c
--- libgtop-2.20.1/lib/open.c	2007-09-27 16:35:02.000000000 -0400
+++ libgtop-2.20.1-new/lib/open.c	2008-01-09 09:30:28.000000000 -0500
@@ -147,7 +147,7 @@
 
 		if (nbytes != size)
 			glibtop_error_r (server,
-					 "Requested %u bytes but got %u.",
+					 "Requested %lu bytes but got %lu.",
 					 size, nbytes);
 
 		glibtop_read_l (server, nbytes, buffer);
diff -uNr libgtop-2.20.1/src/daemon/Makefile.in libgtop-2.20.1-new/src/daemon/Makefile.in
--- libgtop-2.20.1/src/daemon/Makefile.in	2008-01-05 08:50:01.000000000 -0500
+++ libgtop-2.20.1-new/src/daemon/Makefile.in	2008-01-09 09:30:28.000000000 -0500
@@ -596,7 +596,7 @@
 
 
 install-exec-hook:
-	-@libgtop_postinstall@
+	@libgtop_postinstall@
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:
diff -uNr libgtop-2.20.1/src/daemon/main.c libgtop-2.20.1-new/src/daemon/main.c
--- libgtop-2.20.1/src/daemon/main.c	2007-09-27 16:34:51.000000000 -0400
+++ libgtop-2.20.1-new/src/daemon/main.c	2008-01-09 09:30:28.000000000 -0500
@@ -52,7 +52,7 @@
 			glibtop_server_features);
 
     if (enable_debug)
-	syslog_message (LOG_DEBUG, "SIZEOF: %u - %u - %u - %u - %u - %u",
+	syslog_message (LOG_DEBUG, "SIZEOF: %lu - %lu - %lu - %lu - %lu - %lu",
 			sizeof (glibtop_command), sizeof (glibtop_response),
 			sizeof (glibtop_mountentry), sizeof (glibtop_union),
 			sizeof (glibtop_sysdeps),
diff -uNr libgtop-2.20.1/sysdeps/Makefile.in libgtop-2.20.1-new/sysdeps/Makefile.in
--- libgtop-2.20.1/sysdeps/Makefile.in	2008-01-05 08:50:01.000000000 -0500
+++ libgtop-2.20.1-new/sysdeps/Makefile.in	2008-01-09 09:30:28.000000000 -0500
@@ -262,7 +262,7 @@
 target_vendor = @target_vendor@
 SUBDIRS = common @sysdeps_dir@
 DIST_SUBDIRS = bsd common linux osf1 \
-			  stub stub_suid sun4 freebsd solaris aix
+			  stub stub_suid sun4 darwin freebsd solaris aix
 
 all: all-recursive
 
