Package: libopenjpeg1
Version: 1.5.0
Revision: 1
Source: http://openjpeg.googlecode.com/files/openjpeg-%v.tar.gz
Source-MD5: e5d66193ddfa59a87da1eb08ea86293b
BuildDepends: <<
	doxygen,
	fink-package-precedence,
	lcms2,
	libpng15,
	libtiff,
	pkgconfig
<<
Depends: %n-shlibs (= %v-%r)
Conflicts: libopenjpeg
Replaces: libopenjpeg
BuildDependsOnly: true
PatchScript: <<
	# OS X zlib does not publish via pkg-config
	perl -pi -e 's/(libpng\d*) zlib/\1/g' configure

	find . -name Makefile.in | xargs perl -pi -e 's/echo -e/echo/g'
<<
ConfigureParams: --disable-static --libdir=%p/lib/libopenjpeg
CompileScript: <<
	./configure %c
	make V=1
	fink-package-precedence --prohibit-bdep=libopenjpeg,%n .
<<
InstallScript: make install DESTDIR=%d pkgconfigdir=%p/lib/pkgconfig
DocFiles: AUTHORS CHANGES LICENSE NEWS README THANKS
SplitOff: <<
	Package: %N-shlibs
	Files: lib/libopenjpeg/libopenjpeg.1.dylib
	Shlibs: %p/lib/libopenjpeg/libopenjpeg.1.dylib 7.0.0 %n (>= 1.5.0-1)
	DocFiles: AUTHORS CHANGES LICENSE NEWS README THANKS
<<
SplitOff2: <<
	Package: openjpeg-bin
	Depends: <<
		%N-shlibs (>= %v-%r),
		lcms2-shlibs,
		libpng15-shlibs,
		libtiff-shlibs
	<<
	Files: <<
		bin
		share/man/man1
	<<
	DocFiles: AUTHORS CHANGES LICENSE NEWS README THANKS
<<
DescPackaging: <<
	v1.3 was libopenjpeg.2.dylib. During upstream 1.3->1.5
	development, it switched from hand/hardcoded makefiles to
	libtool and jumped back to libopenjpeg.1.dylib. Future ABI
	break would have that change to libopenjpeg.2.dylib, which
	would collide with old and incompatible one of that name, so
	we bury the library to make a new install_name series.
<<
Description: JPEG2000 with lossless compression
Homepage: http://code.google.com/p/openjpeg
License: BSD
Maintainer: Daniel Macks <dmacks@netspace.org>
