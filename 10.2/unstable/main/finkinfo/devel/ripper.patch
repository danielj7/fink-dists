--- -	2003-06-16 16:57:20.000000000 +0200
+++ ripper-0.0.5/inst_all.rb	2003-06-16 16:56:39.000000000 +0200
@@ -0,0 +1,19 @@
+require 'rbconfig'
+
+$destdir=ARGV[0]
+
+$install="install"
+
+def file_install (file)
+  cmd = $install + " -D " + file + " " + $destdir
+  cmd += file =~ /\.rb$/ ?
+  Config::CONFIG["sitelibdir"] : Config::CONFIG["sitearchdir"]
+  cmd += "/" + file
+  print cmd + "\n"
+  system cmd
+end
+
+print "$destdir=#$destdir\n"
+
+file_install ("ripper.rb") and
+file_install ("ripper.#{Config::CONFIG["DLEXT"]}")
--- ripper.y	2003-07-22 13:42:24.000000000 +0200
+++ ripper/ripper.y	2003-07-22 13:49:51.000000000 +0200
@@ -2304,7 +2304,7 @@
 
 static VALUE rip_do_parse _((VALUE));
 static VALUE rip_ensure _((VALUE));
-extern VALUE rb_thread_pass _((void));
+//extern VALUE rb_thread_pass _((void));
 
 struct rip_arg {
     struct ruby_parser *parser;
@@ -2324,7 +2324,7 @@
     Data_Get_Struct(self, struct ruby_parser, parser);
 
     while (parser->parsing) {
-        rb_thread_pass();
+        rb_thread_schedule();
     }
     parser->parsing = 1;
     arg.parser = parser;
