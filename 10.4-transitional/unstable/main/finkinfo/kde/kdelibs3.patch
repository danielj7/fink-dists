diff -uNr kdelibs-3.4.0/darwin/kcmartsrc kdelibs-3.4.0-new/darwin/kcmartsrc
--- kdelibs-3.4.0/darwin/kcmartsrc	1969-12-31 19:00:00.000000000 -0500
+++ kdelibs-3.4.0-new/darwin/kcmartsrc	2005-05-09 09:45:19.000000000 -0400
@@ -0,0 +1,14 @@
+[Arts]
+AddOptions=
+Arguments=\s-F 10 -S 4096 -a esd -s 60 -m artsmessage -c drkonqi -l 3 -f
+AudioIO=esd
+AutoSuspend=true
+Bits=0
+DeviceName=
+FullDuplex=false
+Latency=250
+NetworkTransparent=false
+SamplingRate=0
+StartRealtime=false
+StartServer=true
+SuspendTime=60
diff -uNr kdelibs-3.4.0/darwin/kdeglobals kdelibs-3.4.0-new/darwin/kdeglobals
--- kdelibs-3.4.0/darwin/kdeglobals	1969-12-31 19:00:00.000000000 -0500
+++ kdelibs-3.4.0-new/darwin/kdeglobals	2005-05-09 09:45:19.000000000 -0400
@@ -0,0 +1,129 @@
+[$Version]
+update_info=kaccel.upd:kde3.3/r1,kded.upd:kde3.0,klippershortcuts.upd:04112002,kwin.upd:kde3.2Xinerama,socks.upd:kde3.0/r1
+
+[General]
+XftHintStyle=hintmedium
+XftSubPixel=
+fixed=Monaco CY,11,-1,5,50,0,0,0,0,0
+font=Baghdad,12,-1,5,50,0,0,0,0,0
+menuFont=Baghdad,12,-1,5,50,0,0,0,0,0
+taskbarFont=Baghdad,11,-1,5,50,0,0,0,0,0
+toolBarFont=Baghdad,10,-1,5,50,0,0,0,0,0
+
+[Global Shortcuts]
+Activate Window Demanding Attention=default(Alt+Ctrl+A)
+Defaults timestamp=Mar  1 200514:10:32
+Desktop Screenshot=default(Ctrl+Print)
+Enable/Disable Clipboard Actions=default(Alt+Ctrl+X)
+Halt without Confirmation=default(Alt+Ctrl+Shift+PageDown)
+Kill Window=default(Alt+Ctrl+Escape)
+Lock Session=default(Alt+Ctrl+L)
+Log Out=default(Alt+Ctrl+Delete)
+Log Out Without Confirmation=default(Alt+Ctrl+Shift+Delete)
+Manually Invoke Action on Current Clipboard=default(Alt+Ctrl+R)
+Mouse Emulation=default(Alt+F12)
+Next Taskbar Entry=none
+Popup Launch Menu=default(Alt+F1)
+Previous Taskbar Entry=none
+Reboot without Confirmation=default(Alt+Ctrl+Shift+PageUp)
+Run Command=default(Alt+F2)
+Setup Window Shortcut=none
+Show Klipper Popup-Menu=default(Alt+Ctrl+V)
+Show Taskmanager=default(Ctrl+Escape)
+Show Window List=default(Alt+F5)
+Switch One Desktop Down=none
+Switch One Desktop Up=none
+Switch One Desktop to the Left=none
+Switch One Desktop to the Right=none
+Switch User=default(Alt+Ctrl+Insert)
+Switch to Desktop 1=default(Ctrl+F1)
+Switch to Desktop 10=default(Ctrl+F10)
+Switch to Desktop 11=default(Ctrl+F11)
+Switch to Desktop 12=default(Ctrl+F12)
+Switch to Desktop 13=default(Ctrl+Shift+F1)
+Switch to Desktop 14=default(Ctrl+Shift+F2)
+Switch to Desktop 15=default(Ctrl+Shift+F3)
+Switch to Desktop 16=default(Ctrl+Shift+F4)
+Switch to Desktop 17=default(Ctrl+Shift+F5)
+Switch to Desktop 18=default(Ctrl+Shift+F6)
+Switch to Desktop 19=default(Ctrl+Shift+F7)
+Switch to Desktop 2=default(Ctrl+F2)
+Switch to Desktop 20=default(Ctrl+Shift+F8)
+Switch to Desktop 3=default(Ctrl+F3)
+Switch to Desktop 4=default(Ctrl+F4)
+Switch to Desktop 5=default(Ctrl+F5)
+Switch to Desktop 6=default(Ctrl+F6)
+Switch to Desktop 7=default(Ctrl+F7)
+Switch to Desktop 8=default(Ctrl+F8)
+Switch to Desktop 9=default(Ctrl+F9)
+Switch to Next Desktop=none
+Switch to Next Keyboard Layout=default(Alt+Ctrl+K)
+Switch to Previous Desktop=none
+Toggle Showing Desktop=default(Alt+Ctrl+D)
+Toggle Window Raise/Lower=none
+Walk Through Desktop List=default(Ctrl+Tab)
+Walk Through Desktop List (Reverse)=default(Ctrl+Shift+Tab)
+Walk Through Desktops=none
+Walk Through Desktops (Reverse)=none
+Walk Through Windows=default(Alt+Tab)
+Walk Through Windows (Reverse)=default(Alt+Shift+Tab)
+Window Above Other Windows=none
+Window Below Other Windows=none
+Window Close=default(Alt+F4)
+Window Fullscreen=none
+Window Grow Horizontal=none
+Window Grow Vertical=none
+Window Lower=none
+Window Maximize=none
+Window Maximize Horizontal=none
+Window Maximize Vertical=none
+Window Minimize=none
+Window Move=none
+Window No Border=none
+Window On All Desktops=none
+Window One Desktop Down=none
+Window One Desktop Up=none
+Window One Desktop to the Left=none
+Window One Desktop to the Right=none
+Window Operations Menu=default(Alt+F3)
+Window Pack Down=none
+Window Pack Left=none
+Window Pack Right=none
+Window Pack Up=none
+Window Raise=none
+Window Resize=none
+Window Screenshot=default(Alt+Print)
+Window Shade=none
+Window Shrink Horizontal=none
+Window Shrink Vertical=none
+Window to Desktop 1=none
+Window to Desktop 10=none
+Window to Desktop 11=none
+Window to Desktop 12=none
+Window to Desktop 13=none
+Window to Desktop 14=none
+Window to Desktop 15=none
+Window to Desktop 16=none
+Window to Desktop 17=none
+Window to Desktop 18=none
+Window to Desktop 19=none
+Window to Desktop 2=none
+Window to Desktop 20=none
+Window to Desktop 3=none
+Window to Desktop 4=none
+Window to Desktop 5=none
+Window to Desktop 6=none
+Window to Desktop 7=none
+Window to Desktop 8=none
+Window to Desktop 9=none
+Window to Next Desktop=none
+Window to Previous Desktop=none
+
+[KDE]
+ShowDeleteCommand=false
+
+[Paths]
+Trash=$HOME/Desktop/.Trash/
+
+[WM]
+activeFont=Baghdad,12,-1,5,50,0,0,0,0,0
diff -uNr kdelibs-3.4.0/darwin/konsolerc kdelibs-3.4.0-new/darwin/konsolerc
--- kdelibs-3.4.0/darwin/konsolerc	1969-12-31 19:00:00.000000000 -0500
+++ kdelibs-3.4.0-new/darwin/konsolerc	2005-05-09 09:45:19.000000000 -0400
@@ -0,0 +1,19 @@
+[Desktop Entry]
+ActiveSession=0
+AutoResizeTabs=false
+DefaultSession=shell.desktop
+DynamicTabHide=false
+Fullscreen=false
+Height 832=510
+TabViewMode=0
+Width 1280=927
+bellmode=0
+class=konsole-mainwindow#1
+defaultfont=Monaco CY,12,-1,5,50,0,0,0,0,0
+font=8
+history=1000
+historyenabled=true
+keytab=default
+schema=Linux.schema
+scrollbar=2
+tabbar=2
diff -uNr kdelibs-3.4.0/kabc/Makefile.am kdelibs-3.4.0-new/kabc/Makefile.am
--- kdelibs-3.4.0/kabc/Makefile.am	2004-11-12 12:21:02.000000000 -0500
+++ kdelibs-3.4.0-new/kabc/Makefile.am	2005-05-09 09:45:19.000000000 -0400
@@ -2,7 +2,7 @@
 
 # Make sure $(all_includes) remains last!
 INCLUDES = -I$(top_builddir)/kabc -I$(top_srcdir)/kabc -I$(top_srcdir)/kab \
-           -I$(srcdir)/vcardparser/ -I$(srcdir)/vcard/include \
+           -I$(srcdir)/vcard/include -I$(srcdir)/vcardparser/ \
            -I$(srcdir)/vcard/include/generated \
            -I$(srcdir)/vcardparser $(all_includes)
 
diff -uNr kdelibs-3.4.0/kdecore/Makefile.am kdelibs-3.4.0-new/kdecore/Makefile.am
--- kdelibs-3.4.0/kdecore/Makefile.am	2005-02-03 18:33:07.000000000 -0500
+++ kdelibs-3.4.0-new/kdecore/Makefile.am	2005-05-09 09:45:19.000000000 -0400
@@ -24,7 +24,7 @@
 
 if include_SVGICONS
 SVGICONS=svgicons
-SVGICON_LIB=svgicons/libkdesvgicons.la
+SVGICON_LIB=svgicons/libkdesvgicons.la $(LIBZ)
 endif
 
 SUBDIRS = malloc network $(SVGICONS) . kconfig_compiler tests
diff -uNr kdelibs-3.4.0/kdecore/kglobalsettings.cpp kdelibs-3.4.0-new/kdecore/kglobalsettings.cpp
--- kdelibs-3.4.0/kdecore/kglobalsettings.cpp	2005-02-23 06:56:40.000000000 -0500
+++ kdelibs-3.4.0-new/kdecore/kglobalsettings.cpp	2005-05-09 09:45:19.000000000 -0400
@@ -490,7 +490,7 @@
       s_desktopPath->append('/');
 
     // Trash Path - TODO remove in KDE4 (kio_trash can't use it for interoperability reasons)
-    *s_trashPath = *s_desktopPath + i18n("Trash") + "/";
+    *s_trashPath = *s_desktopPath + "." + i18n("Trash") + "/";
     *s_trashPath = g.readPathEntry( "Trash" , *s_trashPath);
     *s_trashPath = QDir::cleanDirPath( *s_trashPath );
     if ( !s_trashPath->endsWith("/") )
diff -uNr kdelibs-3.4.0/kdecore/ksocks.cpp kdelibs-3.4.0-new/kdecore/ksocks.cpp
--- kdelibs-3.4.0/kdecore/ksocks.cpp	2004-05-11 04:31:44.000000000 -0400
+++ kdelibs-3.4.0-new/kdecore/ksocks.cpp	2005-05-09 09:45:19.000000000 -0400
@@ -475,7 +475,7 @@
                                                    ksocklen_t addrlen) {
    if (_useSocks && F_connect)
       return (*F_connect)(sockfd, serv_addr, addrlen);
-   else return ::connect(sockfd, (sockaddr*) serv_addr, (socklen_t)addrlen);
+   else return ::connect(sockfd, (sockaddr*) serv_addr, (ksocklen_t)addrlen);
 }
 
 
@@ -498,7 +498,7 @@
    if (_useSocks && F_recvfrom) {
       return (*F_recvfrom)(s, buf, len, flags, from, fromlen);
    } else {
-      socklen_t casted_len = (socklen_t) *fromlen;
+      kde_socklen_t casted_len = (kde_socklen_t) *fromlen;
       int rc = ::recvfrom(s, (char*) buf, len, flags, from, &casted_len);
       *fromlen = casted_len;
       return rc;
@@ -510,7 +510,7 @@
                              const sockaddr *to, ksocklen_t tolen) {
    if (_useSocks && F_sendto)
       return (*F_sendto)(s, msg, len, flags, to, tolen);
-   else return ::sendto(s, (char*) msg, len, flags, to, (socklen_t)tolen);
+   else return ::sendto(s, (char*) msg, len, flags, to, (ksocklen_t)tolen);
 }
 
 
@@ -532,7 +532,7 @@
    if (_useSocks && F_getsockname) {
       return (*F_getsockname)(s, name, namelen);
    } else {
-     socklen_t casted_len = *namelen;
+     kde_socklen_t casted_len = *namelen;
      int rc = ::getsockname(s, name, &casted_len);
      *namelen = casted_len;
      return rc;
@@ -544,7 +544,7 @@
    if (_useSocks && F_getpeername) {
       return (*F_getpeername)(s, name, namelen);
    } else {
-      socklen_t casted_len = *namelen;
+      kde_socklen_t casted_len = *namelen;
       int rc = ::getpeername(s, name, &casted_len);
       *namelen = casted_len;
       return rc;
@@ -556,7 +556,7 @@
    if (_useSocks && F_accept) {
      return (*F_accept)(s, addr, addrlen);
    } else {
-      socklen_t casted_len = *addrlen;
+      kde_socklen_t casted_len = *addrlen;
       int rc = ::accept(s, addr, &casted_len);
       *addrlen = casted_len;
       return rc;
@@ -582,13 +582,13 @@
 int KSocks::bind (int sockfd, const sockaddr *my_addr, ksocklen_t addrlen) {
    if (_useSocks && F_bind)
       return (*F_bind)(sockfd, my_addr, addrlen);
-   else return ::bind(sockfd, my_addr, (socklen_t)addrlen);
+   else return ::bind(sockfd, my_addr, (ksocklen_t)addrlen);
 }
 
 int KSocks::bind (int sockfd, sockaddr *my_addr, ksocklen_t addrlen) {
    if (_useSocks && F_bind)
       return (*F_bind)(sockfd, my_addr, addrlen);
-   else return ::bind(sockfd, my_addr, (socklen_t)addrlen);
+   else return ::bind(sockfd, my_addr, (ksocklen_t)addrlen);
 }
 
 
diff -uNr kdelibs-3.4.0/kdecore/kstandarddirs.cpp kdelibs-3.4.0-new/kdecore/kstandarddirs.cpp
--- kdelibs-3.4.0/kdecore/kstandarddirs.cpp	2005-02-03 18:33:08.000000000 -0500
+++ kdelibs-3.4.0-new/kdecore/kstandarddirs.cpp	2005-05-09 09:45:19.000000000 -0400
@@ -1020,7 +1020,7 @@
     if (!strcmp(type, "data"))
 	return "share/apps/";
     if (!strcmp(type, "html"))
-	return "share/doc/HTML/";
+	return "share/doc/kde/";
     if (!strcmp(type, "icon"))
 	return "share/icons/";
     if (!strcmp(type, "config"))
diff -uNr kdelibs-3.4.0/kdecore/network/kresolvermanager.cpp kdelibs-3.4.0-new/kdecore/network/kresolvermanager.cpp
--- kdelibs-3.4.0/kdecore/network/kresolvermanager.cpp	2005-02-23 06:56:45.000000000 -0500
+++ kdelibs-3.4.0-new/kdecore/network/kresolvermanager.cpp	2005-05-09 09:45:19.000000000 -0400
@@ -31,6 +31,7 @@
 
 #ifdef HAVE_RES_INIT
 # include <sys/stat.h>
+# include <nameser.h>
 # include <resolv.h>
 # include <time.h>
 #endif
diff -uNr kdelibs-3.4.0/kdecore/network/ksocketdevice.cpp kdelibs-3.4.0-new/kdecore/network/ksocketdevice.cpp
--- kdelibs-3.4.0/kdecore/network/ksocketdevice.cpp	2005-02-03 18:33:08.000000000 -0500
+++ kdelibs-3.4.0-new/kdecore/network/ksocketdevice.cpp	2005-05-09 09:45:19.000000000 -0400
@@ -311,7 +311,7 @@
     }
 
   struct sockaddr sa;
-  socklen_t len = sizeof(sa);
+  kde_socklen_t len = sizeof(sa);
   int newfd = kde_accept(m_sockfd, &sa, &len);
   if (newfd == -1)
     {
@@ -385,7 +385,7 @@
 
 static int do_read_common(int sockfd, char *data, Q_ULONG maxlen, KSocketAddress* from, ssize_t &retval, bool peek = false)
 {
-  socklen_t len;
+  kde_socklen_t len;
   if (from)
     {
       from->setLength(len = 128); // arbitrary length
@@ -527,7 +527,7 @@
   if (m_sockfd == -1)
     return KSocketAddress();	// not open, empty value
 
-  socklen_t len;
+  kde_socklen_t len;
   KSocketAddress localAddress;
   localAddress.setLength(len = 32);	// arbitrary value
   if (kde_getsockname(m_sockfd, localAddress.address(), &len) == -1)
@@ -556,7 +556,7 @@
   if (m_sockfd == -1)
     return KSocketAddress();	// not open, empty value
 
-  socklen_t len;
+  kde_socklen_t len;
   KSocketAddress peerAddress;
   peerAddress.setLength(len = 32);	// arbitrary value
   if (kde_getpeername(m_sockfd, peerAddress.address(), &len) == -1)
diff -uNr kdelibs-3.4.0/kdecore/network/syssocket.h kdelibs-3.4.0-new/kdecore/network/syssocket.h
--- kdelibs-3.4.0/kdecore/network/syssocket.h	2005-02-23 06:56:45.000000000 -0500
+++ kdelibs-3.4.0-new/kdecore/network/syssocket.h	2005-05-09 09:45:19.000000000 -0400
@@ -53,7 +53,7 @@
   }
 
   // bind
-  inline int kde_bind(int fd, const struct sockaddr* sa, socklen_t len)
+  inline int kde_bind(int fd, const struct sockaddr* sa, kde_socklen_t len)
   {
     return ::bind(fd, sa, len);
   }
@@ -65,25 +65,25 @@
   }
 
   // connect
-  inline int kde_connect(int fd, const struct sockaddr* sa, socklen_t len)
+  inline int kde_connect(int fd, const struct sockaddr* sa, kde_socklen_t len)
   {
     return ::connect(fd, (struct sockaddr*)sa, len);
   }
 
   // accept
-  inline int kde_accept(int fd, struct sockaddr* sa, socklen_t* len)
+  inline int kde_accept(int fd, struct sockaddr* sa, kde_socklen_t* len)
   {
     return ::accept(fd, sa, len);
   }
 
   // getpeername
-  inline int kde_getpeername(int fd, struct sockaddr* sa, socklen_t* len)
+  inline int kde_getpeername(int fd, struct sockaddr* sa, kde_socklen_t* len)
   {
     return ::getpeername(fd, sa, len);
   }
 
   // getsockname
-  inline int kde_getsockname(int fd, struct sockaddr* sa, socklen_t* len)
+  inline int kde_getsockname(int fd, struct sockaddr* sa, kde_socklen_t* len)
   {
     return ::getsockname(fd, sa, len);
   }
diff -uNr kdelibs-3.4.0/kdeprint/configure.in.in kdelibs-3.4.0-new/kdeprint/configure.in.in
--- kdelibs-3.4.0/kdeprint/configure.in.in	2004-03-13 08:13:23.000000000 -0500
+++ kdelibs-3.4.0-new/kdeprint/configure.in.in	2005-05-09 09:45:19.000000000 -0400
@@ -80,7 +80,7 @@
 
       dnl check if CUPS is at least 1.1.20
       ac_have_new_cups="no"
-      AC_CHECK_CUPS_VERSION(1.0120)
+      AC_CHECK_CUPS_VERSION(1.0121)
       if test "$ac_have_new_cups" = "yes"; then
  	AC_DEFINE(HAVE_CUPS_NO_PWD_CACHE, 1, CUPS doesn't have password caching)
       fi
diff -uNr kdelibs-3.4.0/kdesu/su.cpp kdelibs-3.4.0-new/kdesu/su.cpp
--- kdelibs-3.4.0/kdesu/su.cpp	2004-04-13 09:33:21.000000000 -0400
+++ kdelibs-3.4.0-new/kdesu/su.cpp	2005-05-09 09:45:19.000000000 -0400
@@ -74,13 +74,14 @@
 	setTerminal(true);
 
     QCStringList args;
+    args += "-c";
+    args += "staff";
     if ((m_Scheduler != SchedNormal) || (m_Priority > 50))
 	args += "root";
     else
 	args += m_User;
     args += "-c";
     args += QCString(__KDE_BINDIR) + "/kdesu_stub";
-    args += "-";
 
     QCString command = __PATH_SU;
     if (::access(__PATH_SU, X_OK) != 0)
diff -uNr kdelibs-3.4.0/kdeui/Makefile.am kdelibs-3.4.0-new/kdeui/Makefile.am
--- kdelibs-3.4.0/kdeui/Makefile.am	2005-02-23 06:56:49.000000000 -0500
+++ kdelibs-3.4.0-new/kdeui/Makefile.am	2005-05-09 09:45:19.000000000 -0400
@@ -27,10 +27,10 @@
 AM_LDFLAGS = $(LDFLAGS_AS_NEEDED) $(LDFLAGS_NEW_DTAGS)
 
 lib_LTLIBRARIES = libkdeui.la libkspell.la
-libkdeui_la_LDFLAGS = $(KDE_MT_LDFLAGS) -no-undefined -version-info 6:0:2
+libkdeui_la_LDFLAGS = $(KDE_MT_LDFLAGS) $(all_libraries) -no-undefined -version-info 6:0:2
 libkdeui_la_LIBADD = ../kdecore/libkdecore.la
 
-libkspell_la_LDFLAGS = $(KDE_MT_LDFLAGS) -version-info 6:0:2 -no-undefined
+libkspell_la_LDFLAGS = $(KDE_MT_LDFLAGS) $(all_libraries) -version-info 6:0:2 -no-undefined
 libkspell_la_LIBADD = libkdeui.la
 libkspell_la_SOURCES = dummy.cpp
 
diff -uNr kdelibs-3.4.0/kimgio/Makefile.am kdelibs-3.4.0-new/kimgio/Makefile.am
--- kdelibs-3.4.0/kimgio/Makefile.am	2005-01-03 09:53:24.000000000 -0500
+++ kdelibs-3.4.0-new/kimgio/Makefile.am	2005-05-09 09:45:19.000000000 -0400
@@ -21,7 +21,7 @@
              kimg_pcx.la kimg_tga.la kimg_rgb.la kimg_xcf.la kimg_dds.la $(KIMGIO_EXR_MODULES) \
 			 kimg_psd.la
 
-KIMGIO_PLUGIN = -avoid-version -export-symbols-regex 'kimgio_.*_(read|write)'
+KIMGIO_PLUGIN = -avoid-version
 
 kimg_tiff_la_SOURCES = tiffr.cpp
 kimg_tiff_la_LDFLAGS = -module $(KIMGIO_PLUGIN) -no-undefined $(all_libraries)
diff -uNr kdelibs-3.4.0/kinit/Makefile.am kdelibs-3.4.0-new/kinit/Makefile.am
--- kdelibs-3.4.0/kinit/Makefile.am	2005-02-03 18:33:17.000000000 -0500
+++ kdelibs-3.4.0-new/kinit/Makefile.am	2005-05-09 09:45:19.000000000 -0400
@@ -15,7 +15,7 @@
 #    the Free Software Foundation, Inc., 59 Temple Place - Suite 330,
 #    Boston, MA 02111-1307, USA.
 
-INCLUDES = -I$(srcdir)/../libltdl/ $(all_includes) $(KDEINIT_XFT_INCLUDES)
+INCLUDES = -I$(srcdir)/../libltdl/ $(KDEINIT_XFT_INCLUDES) $(all_includes)
 
 SUBDIRS = . tests
 
diff -uNr kdelibs-3.4.0/kio/kssl/kopenssl.cc kdelibs-3.4.0-new/kio/kssl/kopenssl.cc
--- kdelibs-3.4.0/kio/kssl/kopenssl.cc	2005-03-04 07:34:43.000000000 -0500
+++ kdelibs-3.4.0-new/kio/kssl/kopenssl.cc	2005-05-09 09:45:19.000000000 -0400
@@ -306,6 +306,7 @@
              #elif defined(_AIX)
              << "libssl.a(libssl.so.0)"
 	     #elif defined(__APPLE__)
+	     << "libssl.0.9.7.dylib"
 	     << "libssl.dylib"
 	     << "libssl.0.9.dylib"
              #else
@@ -323,6 +324,7 @@
              #elif defined(_AIX)
              << "libcrypto.a(libcrypto.so.0)"
 	     #elif defined(__APPLE__)
+	     << "libcrypto.0.9.7.dylib"
 	     << "libcrypto.dylib"
 	     << "libcrypto.0.9.dylib"
 	     #else
diff -uNr kdelibs-3.4.0/kio/misc/kpac/Makefile.am kdelibs-3.4.0-new/kio/misc/kpac/Makefile.am
--- kdelibs-3.4.0/kio/misc/kpac/Makefile.am	2003-12-25 10:52:00.000000000 -0500
+++ kdelibs-3.4.0-new/kio/misc/kpac/Makefile.am	2005-05-09 09:45:19.000000000 -0400
@@ -10,7 +10,7 @@
 kded_proxyscout_la_SOURCES = proxyscout.skel proxyscout.cpp script.cpp \
                              downloader.cpp discovery.cpp
 kded_proxyscout_la_LDFLAGS = $(all_libraries) -module -avoid-version
-kded_proxyscout_la_LIBADD = $(LIB_KIO) $(top_builddir)/kjs/libkjs.la
+kded_proxyscout_la_LIBADD = $(LIB_KIO) $(top_builddir)/kjs/libkjs.la $(LIBRESOLV)
 
 kpac_dhcp_helper_SOURCES = kpac_dhcp_helper.c
 kpac_dhcp_helper_LDADD = $(LIBSOCKET)
diff -uNr kdelibs-3.4.0/libltdl/ltdl.c kdelibs-3.4.0-new/libltdl/ltdl.c
--- kdelibs-3.4.0/libltdl/ltdl.c	2004-09-07 07:13:36.000000000 -0400
+++ kdelibs-3.4.0-new/libltdl/ltdl.c	2005-05-09 09:48:10.000000000 -0400
@@ -643,8 +643,20 @@
      lt_module module;
      const char *symbol;
 {
+#ifdef TIGER_DLSYM_HACK
+  lt_ptr address = NULL;
+  char* u_symbol = NULL;
+  int val=asprintf(&u_symbol,"_%s",symbol);
+  address = NSAddressOfSymbol(NSLookupSymbolInModule(module,u_symbol));
+  if (((!strcmp("__kde_do_not_unload",symbol)) && (!strcmp("__kde_do_unload",symbol)))) {
+    if ((NULL == address) && NSIsSymbolNameDefined(u_symbol)) {
+      address = dlsym (module, symbol);
+    }
+  }
+  free(u_symbol);
+#else
   lt_ptr address = dlsym (module, symbol);
-
+#endif
   if (!address)
     {
       MUTEX_SETERROR (DLERROR (SYMBOL_NOT_FOUND));
