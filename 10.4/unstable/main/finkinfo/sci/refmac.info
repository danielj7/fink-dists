Package: refmac
Version: 5.4
# version 5.4.0077  : 16/ 5/2008
Revision: 4
Source: http://www.ysbl.york.ac.uk/refmac/data/refmac5.4_source.tar.gz
Source-MD5: 840c48de703ccfe979058bdb6f1edd2f
SourceRename: %n-%v.tar.gz
Source2: http://www.ysbl.york.ac.uk/refmac/data/refmac5.4_dictionary.tar.gz
Source2-MD5: 14b965dc5ab9762c819f632c133998b9
NoSourceDirectory: yes
Depends: ccp4 (>= 6.0.2-8), gcc43-shlibs
BuildDepends: ccp4-dev (>= 6.0.2-8), gcc43, ccp4 (>= 6.0.2-8) 
NoSetCPPFLAGS: true
NoSetLDFLAGS: true
Patch: refmac.patch
CompileScript: << 
#!/bin/bash -efv
export CLIB=%p/lib/ccp4-6.0.2
export BLAS_DIR=/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A
export FORTLIB=%p/lib/gcc4.3/lib
export FORTLIB2=${FORTLIB}/gcc/$(gfortran -dumpmachine)/$(gfortran -dumpversion | head -n 1 | awk '{print $NF}')
 # Reality checks
if [[ ! -d $CLIB || ! -d $FORTLIB2 ]];then
    echo "Failed to find required library directory."
    echo "Check ccp4 and gcc43 installations."
	return 10
else
     echo "" ; echo "Found ${FORTLIB2}" ;   echo ""
fi
#
make -f makefile_fink
<<
InstallScript: <<
#!/bin/bash -efv
mkdir -p %i/share/xtal/ccp4-6.0.2/bin
cp  refmac-%v     %i/share/xtal/ccp4-6.0.2/bin/.
cp  libcheck-%v   %i/share/xtal/ccp4-6.0.2/bin/.
cp  makecif-%v    %i/share/xtal/ccp4-6.0.2/bin/.
#
mkdir -p   %i/share/xtal/ccp4-6.0.2/refmac_%v_monomers
cp -R dic  %i/share/xtal/ccp4-6.0.2/refmac_%v_monomers/.
#
mkdir -p %i/bin
ln -s %p/share/xtal/ccp4-6.0.2/bin/refmac-%v     %i/bin/refmac5
ln -s %p/share/xtal/ccp4-6.0.2/bin/refmac-%v     %i/bin/refmac
ln -s %p/share/xtal/ccp4-6.0.2/bin/libcheck-%v   %i/bin/libcheck
# ln -s %p/share/xtal/ccp4-6.0.2/bin/tlsgroups%v %i/bin/tlsgroups
ln -s %p/share/xtal/ccp4-6.0.2/bin/makecif-%v    %i/bin/makecif
<<
RunTimeVars: CLIBD_MON: %p/share/xtal/ccp4-6.0.2/refmac_%v_monomers/dic/
Description: CCP4 refmac5 update
DescDetail: <<
This is a drop-in update replacement for refmac5. As long as you have
sourced %p/bin/init.(c)sh and %p is at the head of your path, no further
configuration is required.  Binaries for the programs refmac libcheck 
makecif and tlsgroups reside in $CBIN with %v suffix and are symbolically
linked to suffixless commands in %p/bin.
<<
License: LGPL             
Homepage:  http://www.ysbl.york.ac.uk/refmac
Maintainer: W. G. Scott <wgscott@users.sourceforge.net>
