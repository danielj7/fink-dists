Package: libgegl0.0.0-shlibs
Version: 0.0.20
Revision: 1

Source: ftp://ftp.gimp.org/pub/gegl/0.0/gegl-%v.tar.bz2
Source-MD5: 2e1f97ec8abd9a4a21f458b43799bff2

BuildDepends: <<
	a52dec-dev,
	amrnb-dev,
	automake1.9,
	bzip2-dev,
	cairo (>= 1.8-1),
	expat1,
	faac-dev,
	fink (>= 0.28.0-1),
	fontconfig2-dev (>= 2.4.1-1),
	freetype219 (>= 2.3.7-7),
	glib2-dev (>= 2.18.0-1),
	glitz,
	graphviz,
	gtk+2-dev (>= 2.14.0-1),
	gtk-doc (>= 1.8-1),
	intltool40,
	lame-dev,
	libavcodec-dev (>= 0.4.20071217-1),
	libavformat-dev (>= 0.4.20071217-1),
	libavutil-dev (>= 0.4.20071217-1),
	libbabl0.0.0-dev (>= 0.0.22-1),
	libcroco3 (>= 0.6.1-1002),
	libfaad1-dev,
	libgettext3-dev,
	libgnugetopt,
	libgsf1.114-dev (>= 1.14.10-1),
	libiconv-dev,
	libjpeg,
	libogg,
	libpng3,
	librsvg2 (>= 2.22.3-1),
	libtheora0,
	libvorbis0,
	libx264-dev,
	libxml2,
	openexr-dev,
	pango1-xft2-ft219-dev (>= 1.22.0-4),
	pixman (>= 0.12.0-1),
	pkgconfig (>= 0.23),
	sdl,
	x11-dev,
	xft2-dev,
	xvidcore
<<
Depends: <<
	glib2-shlibs (>= 2.18.0-1),
	libbabl0.0.0-shlibs (>= 0.0.22-1),
	libgettext3-shlibs,
	libiconv,

	a52dec-shlibs,
	amrnb-shlibs,
	bzip2-shlibs,
	cairo-shlibs (>= 1.8-1),
	expat1-shlibs,
	faac-shlibs,
	fontconfig2-shlibs (>= 2.4.1-1),
	freetype219-shlibs (>= 2.3.7-7),
	glib2-shlibs (>= 2.18.0-1),
	glitz-shlibs,
	gtk+2-shlibs (>= 2.14.0-1),
	lame-shlibs,
	libavcodec51-shlibs (>= 0.4.20071217-1),
	libavformat52-shlibs (>= 0.4.20071217-1),
	libavutil49-shlibs (>= 0.4.20071217-1),
	libbabl0.0.0-shlibs (>= 0.0.22-1),
	libcroco3-shlibs (>= 0.6.1-1002),
	libfaad1-shlibs,
	libgettext3-shlibs,
	libgnugetopt-shlibs,
	libgsf1.114-shlibs (>= 1.14.10-1),
	libiconv,
	libjpeg-shlibs,
	libogg-shlibs,
	libpng3-shlibs,
	librsvg2-shlibs (>= 2.22.3-1),
	libtheora0-shlibs,
	libvorbis0-shlibs,
	libx264-57-shlibs,
	libxml2-shlibs,
	pango1-xft2-ft219-shlibs (>= 1.22.0-4),
	pixman-shlibs (>= 0.12.0-1),
	sdl-shlibs,
	xvidcore-shlibs
<<
GCC: 4.0

PatchFile: %n.patch
PatchFile-MD5: 101e1c71c6dec3a27ce24e24a7d53039
PatchScript: <<
	%{default_script}

	perl -pi -e 's,(libopenraw-1.0),${1} > 99999.FORCE.NONDETECT,' configure
	perl -pi -e 's,(LUA_REQUIRED_VERSION=).*,${1}99999.FORCE.NONDETECT,' configure
<<

SetCPPFLAGS: -I%p/lib/fontconfig2/include
SetLDFLAGS: -L%p/lib/fontconfig2/lib
SetCFLAGS: -Os
ConfigureParams: --disable-dependency-tracking --disable-static
CompileScript: <<
#	autoreconf -f -i
	automake
	PKG_CONFIG_PATH="%p/lib/fontconfig2/lib/pkgconfig:$PKG_CONFIG_PATH" ac_cv_path_ASCIIDOC=no ac_cv_path_W3M=no DSYMUTIL=: ./configure %c
	make
<<
InstallScript: make install DESTDIR=%d
DocFiles: AUTHORS COPYING* ChangeLog NEWS README

Shlibs: %p/lib/libgegl-0.0.0.dylib 21.0.0 %n (>= 0.0.20-1)

SplitOff: <<
	Package: libgegl0.0.0-dev
	Depends: %N (= %v-%r)
	BuildDependsOnly: true
	Files: <<
		include
		lib/libgegl-0.0.{dylib,la}
		lib/pkgconfig
		share/gtk-doc
	<<
	DocFiles: AUTHORS COPYING* ChangeLog NEWS README
<<

DescPort: <<
	Make sure modules link against dependencies and all symbols
	get resolved.

	Fix -I ordering. See:
	http://bugzilla.gnome.org/show_bug.cgi?id=561317
<<
DescPackaging: <<
	Build fails if .dSYM is created for plugins: docs/gallery
	runs gegl, which recursively loads .so files. The foo.so in
	foo.so.dSYM is not a "normal" dlopen()able bundle, so gegl
	crashes. Could avoid using -g or could avoid running dsymutil.

	Uses a subdir for the plugin interface version (of which
	the lib itself has an interface subversion), so put the
	plugins in a separate package. Not ideal to have the
	plugins:Depends:shlibs (seems bad if libbabl0.0.1 loads
	babl-0.0 plugins linked against libbabl0.0.0), but otherwise
	consumers need to know to Depends on the plugins package.
	Upstream does some pretty convoluted versioning, so we'll
	just keep everything in -shlibs until it ceases to work.

	Force non-detection of libopenraw for sanity in case fink ever
	gets this lib.

	Not building workshop, so don't need lua.
<<
Description: Generic graph based-image processing lib
License: LGPL
Homepage: http://www.gegl.org
Maintainer: Daniel Macks <dmacks@netspace.org>
