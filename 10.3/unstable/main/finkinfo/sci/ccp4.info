Package: ccp4
Version: 5.0
Revision: 3
Source: ftp://ftp.%n.ac.uk/%n/current/packed/%n-%v.tar.gz
Source-MD5: 0a0c9950ed5ed0670387773c26a4cab6   
SourceDirectory: %n-%v
#
# Various CCP4 patches current on 29June2004
#
Source2: ftp://ftp.%n.ac.uk/%n/%v/patches/rcard_tor1.f-14May2004
Source2-MD5: 9109ba1436460f65aa9de4f78ab85fe0 
Source3: ftp://ftp.ccp4.ac.uk/%n/%v/patches/hkon_secder_tch.f-14May2004
Source3-MD5: e9166ff6efa3ecd35817744e509d9ad2 
Source4: ftp://ftp.ccp4.ac.uk/%n/%v/patches/uniqueify-17Jun2004
Source4-MD5: 423767be270259ab10e7df4d7bf05065
Source5: ftp://ftp.ccp4.ac.uk/%n/%v/patches/refmac5.script-26May2004
Source5-MD5: 87692370c4028247095aee0a8c1effe4 
Source6: ftp://ftp.ccp4.ac.uk/%n/%v/patches/sortmtz.def-19May2004
Source6-MD5: c40dcc5b5c78ad1fcc1d3b9aba3d6420
Source7: ftp://ftp.ccp4.ac.uk/%n/%v/patches/CCP4_utils.tcl-26May2004
Source7-MD5: 2f8449cbe72be2c44215ba33ba61583b
Source8: ftp://ftp.ccp4.ac.uk/%n/%v/patches/refmac5.tcl-10June2004
Source8-MD5: 16f355cdedc8b9b011994dc56ce34511
Source9: ftp://ftp.ccp4.ac.uk/%n/%v/patches/csymlib_f.c-24Jun2004
Source9-MD5: 61da7e03b826a745844cb83d3d083dbd
#
#
#
Depends: x11, tcltk, blt
BuildDepends: g77 (>= 3.4.0-2), f2c, fort77, tcltk-dev
Replaces: mosflm (<= 6.2.3-2), mosflm-small (<= 6.2.3-2), refmac (<= 5.1999-3)
NoSetCPPFLAGS: true
NoSetLDFLAGS: true
PatchScript: <<
#!/bin/zsh -f
umask 0022
# setup script for zsh and bash users
perl -pi -e 's|/usr/local|%p|g' include/%n.setup-sh        # location of tcktk, blt
perl -pi -e 's|%n-5.0d|%n-5.0|g' include/%n.setup-sh   # fix error
perl -pi -e 's|/xtal|%p/src/%f|g' include/%n.setup-sh      # build prefix
perl -pi -e 's|safari|open|g' include/%n.setup-sh          # open with any default browser
perl -pi -e 's|\${CCP4}/etc \${CBIN} \${CCP4I_TOP}/bin |\${CCP4}/etc:\${CBIN}:\${CCP4I_TOP}/bin|g' include/%n.setup-sh  # fix really bad path error
#
# setup script for tcsh users
cp include/%n.setup-dist include/%n.setup                           
perl -pi -e 's|/usr/local|%p|g' include/%n.setup          # location of tcktk, blt
perl -pi -e 's|/xtal|%p/src/%f|g' include/%n.setup        # build prefix (may be needed here)
perl -pi -e 's|netscape|open|g' include/%n.setup          # open with any default browser
perl -pi -e 's|\${CCP4}/etc \${CBIN} \${CCP4I_TOP}/bin |\${CCP4}/etc:\${CBIN}:\${CCP4I_TOP}/bin|g' include/%n.setup # fix really bad path error
#
# Quick-fix for some compilation header omissions
 cp %p/include/f2c.h    lib/ccif/g2c.h   
 cp %p/include/f2c.h    lib/src/g2c.h
 cp %p/include/f2c.h    lib/g2c.h
 cp %p/include/f2c.h    x-windows/Mosflm/cbf/src/g2c.h
 cp %p/include/f2c.h    x-windows/Mosflm/src/g2c.h
 cp %p/include/f2c.h    x-windows/RasMol/src/g2c.h
 cp %p/include/f2c.h    x-windows/ipdisp/src/g2c.h
 cp %p/include/f2c.h    x-windows/xdl_view/src/g2c.h
#
# Put the ccp4 patches into place
 cp ../rcard_tor1.f-14May2004        src/refmac5_/rcard_tor1.f
 cp ../hkon_secder_tch.f-14May2004   src/refmac5_/hkon_secder_tch.f
 cp ../uniqueify-17Jun2004           etc/uniqueify
 cp ../refmac5.script-26May2004      ccp4i/scripts/refmac5.script
 cp ../sortmtz.def-19May2004         ccp4i/tasks/sortmtz.def
 cp ../CCP4_utils.tcl-26May2004      ccp4i/src/CCP4_utils.tcl
 cp ../refmac5.tcl-10June2004        ccp4i/tasks/refmac5.tcl
 cp ../csymlib_f.c-24Jun2004         lib/src/csymlib_f.c
#
<<
CompileScript: <<
#!/bin/zsh -f
 umask 0022
. include/%n.setup-sh
./configure --with-x Darwin
#  fix a post-configure bug
perl -pi -e 's/EXTRA_LOAD_FLAGS = -lg2c//g' x-windows/XCCPJIFFY/Imakefile
#
make -i
make -i install
make clean
<<
InstallScript: <<
#!/bin/zsh -f
umask 0022
. include/%n.setup-sh
# Change environment scripts to match final installation
perl -pi -e 's|%p/src/%f|%p/share/xtal|g' include/%n.setup-sh      # install prefix
perl -pi -e 's|%p/src/%f|%p/share/xtal|g' include/%n.setup         # install prefix
#
 mkdir -p %i/share/xtal/%n-%v
 mkdir -p %i/share/man/man1
# set up man pages in a fink-compliant manner
cd %p/src/%n-%v-%r/%n-%v/doc
mv rasmol.doc eightbit_rasmol.doc
foreach docfilepage ( *.doc )
 cp ${docfilepage}  %i/share/man/man1/${docfilepage:r}.1
end
# back to source directory
 cd %p/src/%n-%v-%r/%n-%v
#
# install everything in one place -- users will require this
 cp -R * %i/share/xtal/%n-%v/.
#
 mkdir -p %i/lib/app-defaults
 cp lib/X11/app-defaults/XCCPJiffy %i/lib/app-defaults/.
# make scripts for %p/etc/profile.d and fix a bad variable that caused bugs for fink
#
 mkdir -p %i/etc/profile.d
#
 echo "source %p/share/xtal/%n-%v/include/%n.setup"     > %i/etc/profile.d/%n.csh
 echo "unsetenv XUSERFILESEARCHPATH"                   >> %i/etc/profile.d/%n.csh
#
 echo ". %p/share/xtal/%n-%v/include/%n.setup-sh"       > %i/etc/profile.d/%n.sh
 echo "export XUSERFILESEARCHPATH='' "                 >> %i/etc/profile.d/%n.sh                                                                                       
#
 chmod a+x %i/etc/profile.d/%n.*
#
# needed for compilation of ancilliary programs such as future versions of mosflm
#
ranlib %i/share/xtal/%n-%v/lib/*.a
#
<<
Description:  Macromolecular crystallography package
DescDetail: <<
CCP4 macromolecular crystallography program suite
This version compiles with Apple's Lapack/Blas
http://www.ccp4.ac.uk
License agreement is part of configure file -- print out form and mail in, 
additional comments at http://chemistry.ucsc.edu/~wgscott/xtal/page5.html
CCP4 files will be installed under /sw/share/xtal/ccp4-5.0   
Note that xloggraph (still) does not compile on OSX.  View logfiles in 
mozzilla-type browser.
Manually export XUSERFILESEARCHPATH=/sw/lib/app-defaults/%N if you require it 
for xplot84.
<<
DocFiles: README CHANGES COPYING PROBLEMS INSTALL INSTALL.html INSTALL.ps ccp4i_installation.html academic_software_licence.pdf  academic_software_licence.ps.gz  academic_software_licence.rtf
Homepage: http://www.ccp4.ac.uk conditions.txt
License: Restrictive
Maintainer: W. G. Scott <wgscott@users.sourceforge.net>
