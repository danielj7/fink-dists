Info4: <<
Package: lensfun
Version: 0.2.3
Revision: 3
Description: Photographic lens library
License: GPL/LGPL
Maintainer: Benjamin Reed <lensfun@fink.racoonfink.com>

Depends: %N-shlibs (>= %v-%r)
BuildDepends: <<
	doxygen,
	fink (>= 0.28-1),
	glib2-dev (>= 2.22.0-1),
	libpng15,
	make (>= 3.81-1),
	pkgconfig
<<
GCC: 4.0
BuildDependsOnly: true

Source: http://download.berlios.de/%n/%n-%v.tar.bz2
Source-MD5: c5c04be4f53e3eef450ff4948d8f65b3
PatchFile: %n.patch
PatchFile-MD5: c8ed47d6139beff8df1bf1fd1701253c

SetCFLAGS: -I%p/include
SetLIBS: -L%p/lib
NoSetCPPFLAGS: true
NoSetLDFLAGS: true

ConfigureParams: --libdir=%p/lib
CompileScript: <<
#!/bin/sh -ev
	export PKG_CONFIG_PATH="%p/lib/glib-2.0/pkgconfig-strict:$PKG_CONFIG_PATH"
	./configure %c
	make all
<<

InstallScript: <<
	make install INSTALL_PREFIX=%d
	rm -rf %i/lib/liblensfun.dylib
	rm -rf %i/lib/liblensfun.dylib.0
	mv %i/lib/liblensfun.dylib.%v %i/lib/liblensfun.0.dylib
	ln -sf liblensfun.0.dylib %i/lib/liblensfun.dylib
	install_name_tool -id %p/lib/liblensfun.0.dylib %i/lib/liblensfun.0.dylib
	mv %i/share/doc/%n-%v %i/share/doc/%n
<<
SplitOff: <<
	Package: %N-shlibs
	Depends: <<
		glib2-shlibs (>= 2.22.0-1)
	<<
	Replaces: %N (<= 1.9.14-2)
	DocFiles: README docs/*gpl*
	Files: lib/liblensfun.0*.dylib
	Shlibs: %p/lib/liblensfun.0.dylib 0.0.0 %n (>= 0.2.3-1)
<<

Homepage: http://developer.berlios.de/projects/lensfun/

DescDetail: <<
The project provides a database of photographic lenses and a library that
allows advanced access to the database including functions to correct
images based on intimate knowledge of lens characteristics and calibration
data.
<<
DescPackaging: <<
	Hooray!  Someone's crappy special home-grown build system.  Easier
	to fix after the fact than to change the build system any more than
	I have to.  ;)

	Upstream patch to allow use of libpng15 (may as well fix even
	though png is only used for self-testing). See:
	http://svn.berlios.de/viewvc/lensfun/trunk/libs/auxfun/image.cpp?r1=19&r2=132
<<
<<
