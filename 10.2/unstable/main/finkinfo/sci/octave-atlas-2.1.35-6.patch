--- octave-2.1.35/configure.orig	Sat Nov  3 08:29:56 2001
+++ octave-2.1.35/configure	Sat Nov  3 08:35:35 2001
@@ -2049,7 +2049,7 @@
   if eval "test \"`echo '$octave_cv_cxx_flag_'$ac_safe`\" = yes"; then
     echo "$ac_t""yes" 1>&6
     
-    XTRA_CXXFLAGS="$XTRA_CXXFLAGS -fno-implicit-templates"
+    XTRA_CXXFLAGS="$XTRA_CXXFLAGS -fno-coalesce-templates -fno-implicit-templates"
     echo "$ac_t""adding -fno-implicit-templates to XTRA_CXXFLAGS" 1>&6
   else
     echo "$ac_t""no" 1>&6
@@ -4094,6 +4094,9 @@
     SONAME_FLAGS='-Xlinker -soname -Xlinker $@'
     RLD_FLAG='-Xlinker -rpath -Xlinker $(octlibdir)'
   ;;
+   *-*-darwin*)
+     SH_LDFLAGS='-bundle -bundle_loader <PREFIX>/bin/octave -L<PREFIX>/lib -L<PREFIX>/lib/octave-2.1.35 -lf2c -lcruft'
+   ;;
   *-*-linux* | *-*-gnu*)
     SONAME_FLAGS='-Xlinker -soname -Xlinker $@'
     RLD_FLAG='-Xlinker -rpath -Xlinker $(octlibdir)'
@@ -5877,7 +5880,7 @@
 
   if eval "test \"`echo '$octave_cv_cxx_flag_'$ac_safe`\" = yes"; then
     echo "$ac_t""yes" 1>&6
-    RDYNAMIC_FLAG=-rdynamic
+    RDYNAMIC_FLAG=
   else
     echo "$ac_t""no" 1>&6
     
@@ -7900,7 +7903,7 @@
 DEFS=`sed -f conftest.defs confdefs.h | tr '\012' ' '`
 rm -f conftest.defs
 
-UGLY_DEFS=`echo $DEFS | sed 's,\\",\\\\\\\\\\\\\\\\\\",g'`
+UGLY_DEFS=`echo $DEFS | sed 's,\\",\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\",g'`
 echo "$ac_t""defining UGLY_DEFS to be $UGLY_DEFS" 1>&6
 
 
--- octave-2.1.35/src/Makefile.in.orig	Mon Nov  5 05:28:29 2001
+++ octave-2.1.35/src/Makefile.in	Mon Nov  5 05:32:13 2001
@@ -6,6 +6,19 @@
 # University of Wisconsin-Madison
 # Department of Chemical Engineering
 
+LIBSTDC++_OBJ := PlotFile.o filebuf.o iofscanf.o iostream.o pfstream.o \
+			SFile.o filedoalloc.o iofsetpos.o iostrerror.o procbuf.o \
+			builtinbuf.o fileops.o iogetc.o ioungetc.o sbform.o cleanup.o \
+			floatconv.o iogetdelim.o iovfprintf.o sbgetline.o cmathi.o \
+			fstream.o iogetline.o iovfscanf.o sbscan.o cstdlibi.o \
+			indstream.o ioignore.o isgetline.o stdexcepti.o cstringi.o \
+			initio.o iomanip.o isgetsb.o stdiostream.o cstrio.o \
+			ioassign.o iopadn.o isscan.o stlinst.o cstrmain.o ioextend.o \
+			iopopen.o ldcomio.o stream.o dcomio.o iofclose.o ioprims.o \
+			ldcomplex.o streambuf.o dcomplex.o iofeof.o ioprintf.o osform.o \
+			strops.o editbuf.o ioferror.o ioputc.o outfloat.o strstream.o \
+			fcomio.o iofgetpos.o ioseekoff.o parsestream.o valarray.o \
+			fcomplex.o iofread.o ioseekpos.o peekc.o
 TOPDIR = ..
 
 srcdir = @srcdir@
@@ -254,12 +267,13 @@
 
 octave: stamp-prereq $(LIBRARIES) stamp-oct-links \
 	octave.o builtins.o ops.o $(DLD_STATIC_OBJ)
+	ar -x /usr/lib/gcc/darwin/2.95.2/libstdc++.a
 	$(LD_CXX) $(CPPFLAGS) $(ALL_CXXFLAGS) $(RDYNAMIC_FLAG) \
 	$(ALL_LDFLAGS) -o octave \
 	octave.o builtins.o ops.o $(XERBLA) $(DLD_STATIC_OBJ) \
 	$(OCTAVE_LFLAGS) \
 	$(OCTAVE_LIBS) \
-	$(LEXLIB) $(BLAS_LIBS) $(FFTW_LIBS) $(LIBS) $(FLIBS)
+	$(LEXLIB) $(BLAS_LIBS) $(FFTW_LIBS) $(LIBS) $(FLIBS) $(LIBSTDC++_OBJ)
 
 stmp-pic: pic
 	@if [ -f stmp-pic ]; then \
--- octave-2.1.35/doc/interpreter/Makefile.in.orig	Mon Nov  5 06:14:38 2001
+++ octave-2.1.35/doc/interpreter/Makefile.in	Mon Nov  5 06:19:08 2001
@@ -6,6 +6,20 @@
 # University of Wisconsin-Madison
 # Department of Chemical Engineering
 
+LIBSTDC++_OBJ := PlotFile.o filebuf.o iofscanf.o iostream.o pfstream.o \
+			SFile.o filedoalloc.o iofsetpos.o iostrerror.o procbuf.o \
+			builtinbuf.o fileops.o iogetc.o ioungetc.o sbform.o cleanup.o \
+			floatconv.o iogetdelim.o iovfprintf.o sbgetline.o cmathi.o \
+			fstream.o iogetline.o iovfscanf.o sbscan.o cstdlibi.o \
+			indstream.o ioignore.o isgetline.o stdexcepti.o cstringi.o \
+			initio.o iomanip.o isgetsb.o stdiostream.o cstrio.o \
+			ioassign.o iopadn.o isscan.o stlinst.o cstrmain.o ioextend.o \
+			iopopen.o ldcomio.o stream.o dcomio.o iofclose.o ioprims.o \
+			ldcomplex.o streambuf.o dcomplex.o iofeof.o ioprintf.o osform.o \
+			strops.o editbuf.o ioferror.o ioputc.o outfloat.o strstream.o \
+			fcomio.o iofgetpos.o ioseekoff.o parsestream.o valarray.o \
+			fcomplex.o iofread.o ioseekpos.o peekc.o
+
 TOPDIR = ../..
 
 srcdir = @srcdir@
@@ -67,7 +81,8 @@
 $(TEXINFO): $(DOCSTRINGS) munge-texi
 
 munge-texi: munge-texi.o Map-s.o
-	$(CXX) $(CPPFLAGS) $(ALL_CXXFLAGS) $(ALL_LDFLAGS) -o $@ $^
+	ar -x /usr/lib/gcc/darwin/2.95.2/libstdc++.a
+	$(CXX) $(CPPFLAGS) $(ALL_CXXFLAGS) $(ALL_LDFLAGS) -o $@ $^ $(LIBSTDC++_OBJ)
 
 # Kluge: if the DOCSTRING files are present, assume they are current.
 $(DOCSTRINGS):
--- octave-2.1.35/liboctave/oct-fftw.cc.orig	Tue Nov  6 10:32:08 2001
+++ octave-2.1.35/liboctave/oct-fftw.cc	Tue Nov  6 10:31:56 2001
@@ -154,7 +154,7 @@
 {
   fftwnd_one (fftw_planner.create_plan2d (FFTW_FORWARD, nr, nc),
               reinterpret_cast<fftw_complex *> (inout),
-              NULL);
+              0);
 
   return 0;
 }
@@ -164,7 +164,7 @@
 {
   fftwnd_one (fftw_planner.create_plan2d (FFTW_BACKWARD, nr, nc),
               reinterpret_cast<fftw_complex *> (inout),
-              NULL);
+              0);
 
   const size_t npts = nr * nc;
   const Complex scale = npts;
--- octave-2.1.35/mkoctfile.in.orig	Thu Feb 14 13:36:39 2002
+++ octave-2.1.35/mkoctfile.in	Sun Feb 17 06:02:44 2002
@@ -45,7 +45,7 @@
 cfiles=
 ccfiles=
 f77files=
-objfiles=
+objfiles=`ls -1 <PREFIX>/libexec/octave/libstdc++_obj/*.o`
 octfiles=
 octfile=
 incflags=
