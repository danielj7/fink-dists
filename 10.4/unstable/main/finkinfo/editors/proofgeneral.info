# Initial Data
Package: proofgeneral
Version: 3.7pre070819
Revision: 1
Description: Emacs-based interface for proof assistants
License: GPL
Maintainer:     John Ridgway <ridgway@users.sourceforge.net>

# Dependencies
Depends: emacsen, make
BuildDepends: texinfo, pdftex, sed
Enhances: isabelle-polyml5

# Unpack
Source: http://proofgeneral.inf.ed.ac.uk/releases/ProofGeneral-%v.tar.gz
Source-MD5: 49b592cd63bde6cc7758da3db93f7f82

# Patch Phase
PatchScript: sed 's|@PREFIX@|%p|g' <%a/%n.patch | patch -p1

# Compile Phase
CompileScript: <<
  make PREFIX=%i DEST_PREFIX=%p doc.info doc.pdf doc.html
<<

# Install Phase
InstallScript: <<
  make PREFIX=%i DEST_PREFIX=%p DOCDIR=%i/share/doc/%n INSTALL_INFO="echo ignoring" install-el install-bin install-init install-doc
  install -m 644 Makefile     %i/share/emacs/site-lisp/ProofGeneral
  install -m 755 -d           %i/share/doc/%n/html
  install -m 644 doc/*.html   %i/share/doc/%n/html
<<

# Build Phase
#PreInstScript:
PostInstScript: <<
  echo -- Byte-compiling .el files
  (cd %p/share/emacs/site-lisp/ProofGeneral && make compile)
#  echo -- Fixing paths in scripts
#  (cd %p && make -f %p/share/emacs/site-lisp/ProofGeneral/Makefile PREFIX=%p pgscripts)
  echo -- Done Post-installation
<<
PreRmScript: <<
  (cd %p/share/emacs/site-lisp/ProofGeneral && rm -f .byte-compile Makefile *.elc */*.elc */*/*.elc */*/*/*.elc)
<<
#PostRmScript:
#ConfFiles:
InfoDocs: PG-adapting.info ProofGeneral.info 

# Additional Data
Homepage: http://proofgeneral.inf.ed.ac.uk/
DescDetail: <<  
  Proof General is a generic interface for proof assistants, based on the
  customizable text editor Emacs. It works with either XEmacs or GNU Emacs.
  (If you don't know Emacs, the Emacs Wiki is helpful).
<<
DescUsage: <<
Put this line in your .emacs file:

    (load-file "%p/share/emacs/site-lisp/ProofGeneral/generic/proof-site.el")

If you prefer not to edit .emacs, you can use the script in
bin/proofgeneral to launch Emacs with Proof General loaded.
<<
