Package: tcltk
Version: 8.4.16
Revision: 4
BuildDepends: x11-dev, fink (>= 0.24.12-1)
Depends: %N-shlibs (= %v-%r)
Source: mirror:sourceforge:tcl/tcl%v-src.tar.gz
Source-MD5: f1c783a49547778d160e10be2fb5d76f
SourceDirectory: tcl%v
Source2: mirror:sourceforge:tcl/tk%v-src.tar.gz
Source2-MD5: 24d18fbebe3bb8853e418431be01bf2c
PatchFile: %n.patch
PatchFile-MD5: 2244e58412e0bbaa07ce748324ccf213
PatchScript: <<
	cd .. && patch -p0 < %{PatchFile}
<<
CompileScript: <<
#!/bin/sh -ev

	pushd ../tcl%v/unix
		export COMMAND_MODE=legacy
		./configure --enable-shared --disable-corefoundation --prefix=%p --exec-prefix=%p --mandir='${prefix}/share/man'
		make
	popd
	pushd ../tk%v/unix
		./configure --enable-shared --disable-corefoundation --prefix=%p --exec-prefix=%p --mandir='${prefix}/share/man'
		make genstubs
		make
	popd
<<
InstallScript: <<
	mkdir -p %i/share/doc/%n
	cd ../tcl%v/unix && make INSTALL_ROOT=%d install
	cd ../tk%v/unix  && make INSTALL_ROOT=%d install

	ln -s wish8.4 %i/bin/wish
	ln -s tclsh8.4 %i/bin/tclsh

	ln -s tk8.4 %i/lib/tk
	ln -s libtk8.4.dylib %i/lib/libtk.dylib
	ln -s libtkstub8.4.a %i/lib/libtkstub.a
	/usr/bin/ranlib %i/lib/libtclstub8.4.a

	ln -s tcl8.4 %i/lib/tcl
	ln -s libtcl8.4.dylib %i/lib/libtcl.dylib
	ln -s libtclstub8.4.a %i/lib/libtclstub.a
	/usr/bin/ranlib %i/lib/libtkstub8.4.a
<<
# mv %i/share/man/man3/Object.3 %i/share/man/man3/Object.3.tcltk
SplitOff: <<
  Package: %N-shlibs
  Depends: x11
  Replaces: %N (<= 8.3.3-6)
  Files: lib/libtcl8.4.dylib lib/libtk8.4.dylib
  Shlibs: <<
    %p/lib/libtcl8.4.dylib 8.4.0 %n (>= 8.4.1-1)
    %p/lib/libtk8.4.dylib 8.4.0 %n (>= 8.4.1-1)
  <<
  DocFiles: <<
		../tcl%v/license.terms:LICENSE.tcl
		../tcl%v/README:README.tcl
		../tcl%v/ChangeLog:ChangeLog.tcl
		../tk%v/license.terms:LICENSE.tk
		../tk%v/README:README.tk
		../tk%v/ChangeLog:ChangeLog.tk 
	<<
<<
SplitOff2: <<
  Package: %N-dev
  BuildDependsOnly: True
  Depends: %N (= %v-%r), %N-shlibs (= %v-%r)
  Replaces: %N (<= 8.4.13-2)
  Files: <<
		lib/tclConfig.sh
		lib/tkConfig.sh
		include
		lib/libtcl*
		lib/libtk*
		share/man/man3
		share/man/mann
	<<
  DocFiles: <<
		../tcl%v/license.terms:LICENSE.tcl
		../tcl%v/README:README.tcl
		../tcl%v/ChangeLog:ChangeLog.tcl
		../tk%v/license.terms:LICENSE.tk
		../tk%v/README:README.tk
		../tk%v/ChangeLog:ChangeLog.tk 
	<<
<<

DocFiles: <<
	../tcl%v/license.terms:LICENSE.tcl
	../tcl%v/README:README.tcl
	../tcl%v/ChangeLog:ChangeLog.tcl
	../tk%v/license.terms:LICENSE.tk
	../tk%v/README:README.tk
	../tk%v/ChangeLog:ChangeLog.tk 
<<
Description: Tool Command Language and the Tk toolkit
DescPort: <<
 We add /System/Library/Tcl and /usr/lib to TCL_PACKAGE_PATH so that
 Tcl packages (such as darwinports) installed in the standard system
 locations will be found.

 What is COMMAND_MODE?

 Pass CPPFLAGS so it works as everyone expects (*after* local flags),
 despite how build system incorrectly reimplements it differently.
<<
DescPackaging: <<
 Former Maintainer: None <fink-devel@lists.sourceforge.net>
<<
DescDetail: <<
Tcl provides a portable scripting environment for Unix, Windows,
and Macintosh that supports string processing and pattern matching,
native file system access, shell-like control over other programs,
TCP/IP networking, timers, and event-driven I/O.

Tcl has traditional programming constructs like variables, loops,
procedures, namespaces, error handling, script packages, 
and dynamic loading of DLLs.

Tk provides portable GUIs on UNIX, Windows, and Macintosh.
A powerful widget set and the concise scripting interface to Tk make
it a breeze to develop sophisticated user interfaces.
<<
PostInstScript: <<
update-alternatives --install %p/share/man/man3/Object.3 Object.3 %p/share/man/man3/Object.3.tcltk 60
<<
PreRmScript: <<
if [ $1 != "upgrade" ]; then
  update-alternatives --remove Object.3 %p/share/man/man3/Object.3.tcltk
fi
<<
License: BSD
Homepage: http://www.tcl.tk
Maintainer: Daniel Macks <dmacks@netspace.org>
