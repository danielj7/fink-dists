diff -uNr gok-1.2.5/gok/gok-libusb.c gok-1.2.5-new/gok/gok-libusb.c
--- gok-1.2.5/gok/gok-libusb.c	2007-03-05 10:08:03.000000000 -0500
+++ gok-1.2.5-new/gok/gok-libusb.c	2007-07-19 14:58:02.000000000 -0400
@@ -261,6 +261,7 @@
 					/* check if the device is attached to a kernel driver and attempt to detach if it is
 					 * if the OS doesn't support detaching from the kernel driver, just try to claim the interface anyway
 					 */
+#if defined(LIBUSB_HAS_GET_DRIVER_NP) && defined(LIBUSB_HAS_DETACH_KERNEL_DRIVER_NP)
 					if (LIBUSB_HAS_GET_DRIVER_NP && LIBUSB_HAS_DETACH_KERNEL_DRIVER_NP)
 					{ 
 						gchar *driver_name = g_malloc0(128);
@@ -283,6 +284,7 @@
 						}
 						g_free(driver_name);
 					}
+#endif
 
 					if (usb_claim_interface(handle, j) < 0)
 					{
