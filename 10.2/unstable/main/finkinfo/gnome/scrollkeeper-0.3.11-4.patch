diff -Naur scrollkeeper-0.3.11.old/Makefile.in scrollkeeper-0.3.11.new/Makefile.in
--- scrollkeeper-0.3.11.old/Makefile.in	Thu Jul 25 11:27:26 2002
+++ scrollkeeper-0.3.11.new/Makefile.in	Thu Sep 19 02:10:16 2002
@@ -452,10 +452,10 @@
 	rm -rf $(DESTDIR)$(scrollkeeper_localstate_dir)
 	$(mkinstalldirs) $(DESTDIR)$(scrollkeeper_localstate_dir)
 	$(mkinstalldirs) $(DESTDIR)$(localstatedir)/log
-	PATH="$(PATH):$(DESTDIR)$(bindir)" ; \
-		echo "`date +\"%b %d %X\"` Installing ScrollKeeper `scrollkeeper-config --version`..." >> $(DESTDIR)$(localstatedir)/log/scrollkeeper.log
-	PATH="$(PATH):$(DESTDIR)$(bindir)" ; \
-		$(DESTDIR)$(bindir)/scrollkeeper-rebuilddb -q -p $(DESTDIR)$(scrollkeeper_localstate_dir)
+#	PATH="$(PATH):$(DESTDIR)$(bindir)" ; \
+#		echo "`date +\"%b %d %X\"` Installing ScrollKeeper `scrollkeeper-config --version`..." >> $(DESTDIR)$(localstatedir)/log/scrollkeeper.log
+#	PATH="$(PATH):$(DESTDIR)$(bindir)" ; \
+#		$(DESTDIR)$(bindir)/scrollkeeper-rebuilddb -q -p $(DESTDIR)$(scrollkeeper_localstate_dir)
 
 uninstall-local:
 	# Remove generated files
diff -Naur scrollkeeper-0.3.11.old/cl/src/Makefile.in scrollkeeper-0.3.11.new/cl/src/Makefile.in
--- scrollkeeper-0.3.11.old/cl/src/Makefile.in	Thu Jul 25 11:27:37 2002
+++ scrollkeeper-0.3.11.new/cl/src/Makefile.in	Thu Sep 19 02:10:16 2002
@@ -133,9 +133,9 @@
 
 
 LDADD = \
+	$(top_builddir)/libs/libscrollkeeper.la \
         $(XML_LIBS) \
-	$(XSLT_LIBS) \
-	$(top_builddir)/libs/libscrollkeeper.la
+	$(XSLT_LIBS)
 
 
 bin_PROGRAMS = scrollkeeper-preinstall scrollkeeper-update scrollkeeper-install scrollkeeper-uninstall scrollkeeper-get-cl 
diff -Naur scrollkeeper-0.3.11.old/cl/src/update.c scrollkeeper-0.3.11.new/cl/src/update.c
--- scrollkeeper-0.3.11.old/cl/src/update.c	Thu Jul 25 11:25:29 2002
+++ scrollkeeper-0.3.11.new/cl/src/update.c	Mon Sep 23 20:59:41 2002
@@ -304,7 +304,7 @@
 
 	config_omf_dir[0] = '\0';
 
-	fid = fopen("/etc/scrollkeeper.conf", "r");
+	fid = fopen("@PREFIX@/etc/scrollkeeper.conf", "r");
 	if (fid == NULL) {
 		return;
 	}
diff -Naur scrollkeeper-0.3.11.old/configure scrollkeeper-0.3.11.new/configure
--- scrollkeeper-0.3.11.old/configure	Thu Jul 25 11:26:07 2002
+++ scrollkeeper-0.3.11.new/configure	Thu Sep 19 02:10:16 2002
@@ -3538,11 +3538,11 @@
     ;;
 
   darwin* | rhapsody*)
-    allow_undefined_flag='-undefined suppress'
+    allow_undefined_flag='-undefined suppress -flat_namespace'
     # FIXME: Relying on posixy $() will cause problems for
     #        cross-compilation, but unfortunately the echo tests do not
     #        yet detect zsh echo's removal of \ escapes.
-    archive_cmds='$CC $(test .$module = .yes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib $libobjs $deplibs$linkopts -install_name $rpath/$soname $(test -n "$verstring" -a x$verstring != x0.0 && echo $verstring)'
+    archive_cmds='$CC $(test .$module = .yes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib $libobjs $deplibs$linkopts $(test .$module != .yes && echo -install_name $rpath/$soname $tmp_verstring)'
     # We need to add '_' to the symbols in $export_symbols first
     #archive_expsym_cmds="$archive_cmds"' && strip -s $export_symbols'
     hardcode_direct=yes
@@ -6279,7 +6279,7 @@
    *)
 	echo $ac_n "checking for docbook-dtd412-xml""... $ac_c" 1>&6
 echo "configure:6282: checking for docbook-dtd412-xml" >&5
-	if xmlcatalog /etc/xml/catalog "-//OASIS//DTD DocBook XML V4.1.2//EN" | grep "No entry" >/dev/null ; then
+	if xmlcatalog ${prefix}/share/xml/dtd/docbookx/catalog "-//OASIS//DTD DocBook XML V4.1.2//EN" | grep "No entry" >/dev/null ; then
 		echo "* ERROR * "
 		echo " "
 		echo "Couldn't find the DocBook XML V4.1.2 DTD.  Please make sure that you have the docbook-dtd412-xml package installed. If it is installed, the package probably did not register the DTD in the catalog properly. Consult http://scrollkeeper.sourceforge.net/docbook.shtml for more information."
diff -Naur scrollkeeper-0.3.11.old/extract/dtds/Makefile.in scrollkeeper-0.3.11.new/extract/dtds/Makefile.in
--- scrollkeeper-0.3.11.old/extract/dtds/Makefile.in	Thu Jul 25 11:27:42 2002
+++ scrollkeeper-0.3.11.new/extract/dtds/Makefile.in	Tue Sep 24 00:00:24 2002
@@ -282,9 +282,9 @@
 	#
 
 	# ScrollKeeper OMF Variation DTD V1.0
-	-/usr/bin/xmlcatalog --noout --add "public" \
-		"-//OMF//DTD Scrollkeeper OMF Variant V1.0//EN" \
-		"$(dtdsdir)/scrollkeeper-omf.dtd" $(CATALOG)
+#	-/usr/bin/xmlcatalog --noout --add "public" \
+#		"-//OMF//DTD Scrollkeeper OMF Variant V1.0//EN" \
+#		"$(dtdsdir)/scrollkeeper-omf.dtd" $(CATALOG)
 
 uninstall-local:
 	#
diff -Naur scrollkeeper-0.3.11.old/extract/src/Makefile.in scrollkeeper-0.3.11.new/extract/src/Makefile.in
--- scrollkeeper-0.3.11.old/extract/src/Makefile.in	Thu Jul 25 11:27:41 2002
+++ scrollkeeper-0.3.11.new/extract/src/Makefile.in	Thu Sep 19 02:10:16 2002
@@ -134,9 +134,9 @@
 
 
 LDADD = \
+        $(top_builddir)/libs/libscrollkeeper.la \
         $(XML_LIBS) \
-        $(XSLT_LIBS) \
-        $(top_builddir)/libs/libscrollkeeper.la
+        $(XSLT_LIBS)
 
 
 scrollkeeper_extract_SOURCES = \
diff -Naur scrollkeeper-0.3.11.old/libs/database.c scrollkeeper-0.3.11.new/libs/database.c
--- scrollkeeper-0.3.11.old/libs/database.c	Thu Jul 25 11:25:34 2002
+++ scrollkeeper-0.3.11.new/libs/database.c	Thu Sep 19 02:10:16 2002
@@ -17,6 +17,7 @@
  */
  
 #include <config.h>
+#include <limits.h>
 #include <stdlib.h>
 #include <string.h>
 #include <stddef.h>
@@ -27,7 +28,7 @@
 #include <dirent.h>
 #include <scrollkeeper.h>
 
-#define PATHLEN		256
+#define PATHLEN		PATH_MAX
 
 
 /*
diff -Naur scrollkeeper-0.3.11.old/libs/i18n.c scrollkeeper-0.3.11.new/libs/i18n.c
--- scrollkeeper-0.3.11.old/libs/i18n.c	Thu Jul 25 11:25:34 2002
+++ scrollkeeper-0.3.11.new/libs/i18n.c	Thu Sep 19 02:10:16 2002
@@ -37,7 +37,7 @@
 	
 	lang = getenv("LANGUAGE");
 	if (lang == NULL || lang[0] == '\0') {
-		lang = setlocale(LC_MESSAGES, NULL);
+		lang = setlocale(LC_ALL, NULL);
 	}
 		
 	if (lang == NULL || lang[0] == '\0') {
diff -Naur scrollkeeper-0.3.11.old/libs/install.c scrollkeeper-0.3.11.new/libs/install.c
--- scrollkeeper-0.3.11.old/libs/install.c	Thu Jul 25 11:25:34 2002
+++ scrollkeeper-0.3.11.new/libs/install.c	Mon Oct 28 21:31:27 2002
@@ -19,6 +19,7 @@
 #include <config.h>
 #include <libxml/tree.h>
 #include <libxml/parser.h>
+#include <limits.h>
 #include <stdlib.h>
 #include <string.h>
 #include <locale.h>
@@ -32,12 +33,37 @@
 #define _(String) gettext (String)
 
 #define SEP		"|"
-#define PATHLEN		256
+#define PATHLEN		PATH_MAX
 
 #ifdef SOLARIS
 /*extern char *strtok_r(char *, const char *, char **);*/
 #endif
 
+#ifndef HAVE_STRTOK_R
+static char *
+strtok_r (char *s, const char *delim, char **save_ptr)
+{
+char *token;
+
+	if (s == NULL)
+		s = *save_ptr;
+
+	s += strspn (s, delim);
+		if (*s == '\0')
+			return NULL;
+
+	token = s;
+	s = strpbrk (token, delim);
+	if (s == NULL) {
+		*save_ptr = strchr (token, '\0');
+	} else {
+		*s = '\0';
+		*save_ptr = s + 1;
+	}
+	return token;
+}
+#endif
+
 static int get_unique_doc_id(char *);
 static void add_doc_to_scrollkeeper_docs(char *, char *, char *, int, char *);
 static void add_doc_to_content_list(xmlNodePtr, char *, char **, char *, char *,
@@ -177,6 +203,7 @@
     /*
      * Validate OMF file against ScrollKeeper-OMF DTD
      */
+#if 0 /* tempoarary disabled because OMF DTD is incomplete. */
     dtd = xmlParseDTD(NULL, (const xmlChar *)SCROLLKEEPER_OMF_DTD);
     if (dtd == NULL) {
         sk_message(outputprefs, SKOUT_DEFAULT, SKOUT_QUIET, "(install)", _("Could not parse ScrollKeeper-OMF DTD: %s\n"), SCROLLKEEPER_OMF_DTD); 
@@ -192,6 +219,7 @@
         }
     }
     xmlFreeDtd(dtd);
+#endif /* tempoarary disabled because OMF DTD is incomplete. */
 		      	          
     snprintf(scrollkeeper_docs, PATHLEN, "%s/scrollkeeper_docs", scrollkeeper_dir);
     
diff -Naur scrollkeeper-0.3.11.old/libs/scrollkeeper.h.in scrollkeeper-0.3.11.new/libs/scrollkeeper.h.in
--- scrollkeeper-0.3.11.old/libs/scrollkeeper.h.in	Thu Jul 25 11:25:34 2002
+++ scrollkeeper-0.3.11.new/libs/scrollkeeper.h.in	Thu Sep 19 02:10:16 2002
@@ -21,6 +21,7 @@
 
 #include <libxml/tree.h>
 #include <sys/types.h>
+#include <limits.h>
 
 #define _(String) gettext (String)
 
@@ -29,11 +30,11 @@
  * Paths
  *
  */
-#define SCROLLKEEPERLOCALEDIR "/usr/share/locale"
+#define SCROLLKEEPERLOCALEDIR "@prefix@/share/locale"
 #define SCROLLKEEPERLOGFILE "@localstatedir@/log/scrollkeeper.log"
 #define SCROLLKEEPERLOGFILE_ROT "@localstatedir@/log/scrollkeeper.log.1"
 #define SCROLLKEEPER_OMF_DTD "@prefix@/share/xml/scrollkeeper/dtds/scrollkeeper-omf.dtd"
-#define PATHLEN		256
+#define PATHLEN		PATH_MAX
 
 /*
  *
diff -Naur scrollkeeper-0.3.11.old/libs/uninstall.c scrollkeeper-0.3.11.new/libs/uninstall.c
--- scrollkeeper-0.3.11.old/libs/uninstall.c	Thu Jul 25 11:25:34 2002
+++ scrollkeeper-0.3.11.new/libs/uninstall.c	Thu Sep 19 02:10:16 2002
@@ -17,6 +17,7 @@
  */
 
 #include <config.h>
+#include <limits.h>
 #include <libxml/tree.h>
 #include <libxml/parser.h>
 #include <stdlib.h>
@@ -29,7 +30,7 @@
 
 #define _(String) gettext (String)
 
-#define PATHLEN		256
+#define PATHLEN		PATH_MAX
 
 struct IdTab {
     int id;
diff -Naur scrollkeeper-0.3.11.old/ltmain.sh scrollkeeper-0.3.11.new/ltmain.sh
--- scrollkeeper-0.3.11.old/ltmain.sh	Thu Jul 25 11:25:58 2002
+++ scrollkeeper-0.3.11.new/ltmain.sh	Thu Sep 19 02:10:16 2002
@@ -2858,6 +2858,11 @@
 	if test -n "$export_symbols" && test -n "$archive_expsym_cmds"; then
 	  eval cmds=\"$archive_expsym_cmds\"
 	else
+	  if test "x$verstring" = "x0.0"; then
+	    tmp_verstring=
+	  else
+	    tmp_verstring="$verstring"
+	  fi
 	  eval cmds=\"$archive_cmds\"
 	fi
 	IFS="${IFS= 	}"; save_ifs="$IFS"; IFS='~'
diff -Naur scrollkeeper-0.3.11.old/scrollkeeper.xmlcatalog scrollkeeper-0.3.11.new/scrollkeeper.xmlcatalog
--- scrollkeeper-0.3.11.old/scrollkeeper.xmlcatalog	Thu Jan  1 09:00:00 1970
+++ scrollkeeper-0.3.11.new/scrollkeeper.xmlcatalog	Mon Oct 28 23:09:21 2002
@@ -0,0 +1,3 @@
+"public" \
+	"-//OMF//DTD Scrollkeeper OMF Variant V1.0//EN" \
+	"file://@PREFIX@/share/xml/scrollkeeper/dtds/scrollkeeper-omf.dtd"
