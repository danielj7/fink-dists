diff -uNr kdepim-3.3.1/admin/ltmain.sh kdepim-3.3.1-new/admin/ltmain.sh
--- kdepim-3.3.1/admin/ltmain.sh	Tue Jun 15 12:47:06 2004
+++ kdepim-3.3.1-new/admin/ltmain.sh	Fri Oct 15 09:38:17 2004
@@ -4397,6 +4397,7 @@
 	# We should set the shlibpath_var
 	rpath=
 	for dir in $temp_rpath; do
+     if test "$dir" != "/sw/lib"; then
 	  case $dir in
 	  [\\/]* | [A-Za-z]:[\\/]*)
 	    # Absolute path.
@@ -4407,6 +4408,7 @@
 	    rpath="$rpath\$thisdir/$dir:"
 	    ;;
 	  esac
+     fi
 	done
 	temp_rpath="$rpath"
       fi
diff -uNr kdepim-3.3.1/configure kdepim-3.3.1-new/configure
--- kdepim-3.3.1/configure	Mon Oct  4 04:21:15 2004
+++ kdepim-3.3.1-new/configure	Fri Oct 15 09:38:17 2004
@@ -7986,6 +7986,19 @@
     lt_cv_sys_max_cmd_len=8192;
     ;;
 
+  netbsd* | freebsd* | openbsd* | darwin* )
+    # This has been around since 386BSD, at least.  Likely further.
+    if test -x /sbin/sysctl; then
+      lt_cv_sys_max_cmd_len=`/sbin/sysctl -n kern.argmax`
+    elif test -x /usr/sbin/sysctl; then
+      lt_cv_sys_max_cmd_len=`/usr/sbin/sysctl -n kern.argmax`
+    else
+      lt_cv_sys_max_cmd_len=65536 # usable default for *BSD
+    fi
+    # And add a safety zone
+    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 4`
+    ;;
+
  *)
     # If test is not a shell built-in, we'll probably end up computing a
     # maximum length that is only half of the actual maximum length, but
@@ -9629,10 +9642,21 @@
       archive_cmds_need_lc=no
       case "$host_os" in
       rhapsody* | darwin1.[012])
-	allow_undefined_flag='-undefined suppress'
+	allow_undefined_flag='-Wl,-undefined -Wl,suppress'
 	;;
       *) # Darwin 1.3 on
-	test -z ${LD_TWOLEVEL_NAMESPACE} && allow_undefined_flag='-flat_namespace -undefined suppress'
+	if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+	  allow_undefined_flag='-Wl,-flat_namespace -Wl,-undefined -Wl,suppress'
+	else
+	  case ${MACOSX_DEPLOYMENT_TARGET} in
+	    10.[012])
+	      allow_undefined_flag='-Wl,-flat_namespace -Wl,-undefined -Wl,suppress'
+	      ;;
+	    10.*)
+	      allow_undefined_flag='-Wl,-undefined -Wl,dynamic_lookup'
+	      ;;
+	  esac
+	fi
 	;;
       esac
     	lt_int_apple_cc_single_mod=no
@@ -11482,7 +11506,18 @@
       allow_undefined_flag='-undefined suppress'
       ;;
     *) # Darwin 1.3 on
-      test -z ${LD_TWOLEVEL_NAMESPACE} && allow_undefined_flag='-flat_namespace -undefined suppress'
+	if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+	  allow_undefined_flag='-Wl,-flat_namespace -Wl,-undefined -Wl,suppress'
+	else
+	  case ${MACOSX_DEPLOYMENT_TARGET} in
+	    10.[012])
+	      allow_undefined_flag='-Wl,-flat_namespace -Wl,-undefined -Wl,suppress'
+	      ;;
+	    10.*)
+	      allow_undefined_flag='-Wl,-undefined -Wl,dynamic_lookup'
+	      ;;
+	  esac
+	fi
       ;;
     esac
     output_verbose_link_cmd='echo'
@@ -12533,7 +12568,18 @@
       allow_undefined_flag_CXX='-undefined suppress'
       ;;
     *) # Darwin 1.3 on
-      test -z ${LD_TWOLEVEL_NAMESPACE} && allow_undefined_flag_CXX='-flat_namespace -undefined suppress'
+	if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+	  allow_undefined_flag_CXX='-Wl,-flat_namespace -Wl,-undefined -Wl,suppress'
+	else
+	  case ${MACOSX_DEPLOYMENT_TARGET} in
+	    10.[012])
+	      allow_undefined_flag_CXX='-Wl,-flat_namespace -Wl,-undefined -Wl,suppress'
+	      ;;
+	    10.*)
+	      allow_undefined_flag_CXX='-Wl,-undefined -Wl,dynamic_lookup'
+	      ;;
+	  esac
+	fi
       ;;
     esac
     lt_int_apple_cc_single_mod=no
@@ -16356,7 +16402,18 @@
 	allow_undefined_flag_F77='-undefined suppress'
 	;;
       *) # Darwin 1.3 on
-	test -z ${LD_TWOLEVEL_NAMESPACE} && allow_undefined_flag_F77='-flat_namespace -undefined suppress'
+	if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+	  allow_undefined_flag_F77='-Wl,-flat_namespace -Wl,-undefined -Wl,suppress'
+	else
+	  case ${MACOSX_DEPLOYMENT_TARGET} in
+	    10.[012])
+	      allow_undefined_flag_F77='-Wl,-flat_namespace -Wl,-undefined -Wl,suppress'
+	      ;;
+	    10.*)
+	      allow_undefined_flag_F77='-Wl,-undefined -Wl,dynamic_lookup'
+	      ;;
+	  esac
+	fi
 	;;
       esac
     	lt_int_apple_cc_single_mod=no
@@ -18638,7 +18695,18 @@
 	allow_undefined_flag_GCJ='-undefined suppress'
 	;;
       *) # Darwin 1.3 on
-	test -z ${LD_TWOLEVEL_NAMESPACE} && allow_undefined_flag_GCJ='-flat_namespace -undefined suppress'
+	if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
+	  allow_undefined_flag_GCJ='-Wl,-flat_namespace -Wl,-undefined -Wl,suppress'
+	else
+	  case ${MACOSX_DEPLOYMENT_TARGET} in
+	    10.[012])
+	      allow_undefined_flag_GCJ='-Wl,-flat_namespace -Wl,-undefined -Wl,suppress'
+	      ;;
+	    10.*)
+	      allow_undefined_flag_GCJ='-Wl,-undefined -Wl,dynamic_lookup'
+	      ;;
+	  esac
+	fi
 	;;
       esac
     	lt_int_apple_cc_single_mod=no
diff -uNr kdepim-3.3.1/kontact/src/Makefile.in kdepim-3.3.1-new/kontact/src/Makefile.in
--- kdepim-3.3.1/kontact/src/Makefile.in	Mon Oct  4 04:21:10 2004
+++ kdepim-3.3.1-new/kontact/src/Makefile.in	Fri Oct 15 09:38:17 2004
@@ -505,7 +505,11 @@
 libkontact_la_LIBADD = $(LIB_KDECORE)
 #>- libkontact_la_SOURCES = prefs.kcfgc
 #>+ 1
-libkontact_la_SOURCES= prefs.cpp
+libkontact_la_SOURCES= prefs.cpp dummy.cpp
+
+dummy.cpp:
+	echo > dummy.cpp
+
 #>- kontact_METASOURCES = AUTO
 kontact_LDFLAGS = $(all_libraries) $(KDE_RPATH) -lkutils
 kontact_LDADD = $(LIB_KPARTS) $(top_builddir)/libkdepim/libkdepim.la \
diff -uNr kdepim-3.3.1/korganizer/Makefile.in kdepim-3.3.1-new/korganizer/Makefile.in
--- kdepim-3.3.1/korganizer/Makefile.in	Mon Oct  4 04:21:11 2004
+++ kdepim-3.3.1-new/korganizer/Makefile.in	Fri Oct 15 09:38:17 2004
@@ -622,7 +622,7 @@
 
 korganizer_LDFLAGS = $(all_libraries) $(KDE_RPATH)
 korganizer_LDADD = libkorganizer.la
-korganizer_SOURCES = main.cpp korganizer.cpp koapp.cpp
+korganizer_SOURCES = main.cpp koapp.cpp
 korganizer_COMPILE_FIRST = koprefs_base.h
 kde_module_LTLIBRARIES = kcm_korganizer.la libkorganizerpart.la
 kcm_korganizer_la_SOURCES = koprefsdialog.cpp
@@ -713,7 +713,7 @@
 #>- 	freebusymanager.cpp freebusyurldialog.cpp \
 #>- 	eventarchiver.cpp koidentitymanager.cpp
 #>+ 46
-libkorganizer_la_SOURCES= \
+libkorganizer_la_SOURCES= korganizer.cpp \
 	koagendaview.cpp koagenda.cpp koagendaitem.cpp \
 	datenavigator.cpp kdatenavigator.cpp datenavigatorcontainer.cpp \
 	datechecker.cpp \
diff -uNr kdepim-3.3.1/kpilot/conduits/malconduit/mal-conduit.cc kdepim-3.3.1-new/kpilot/conduits/malconduit/mal-conduit.cc
--- kdepim-3.3.1/kpilot/conduits/malconduit/mal-conduit.cc	Fri Jun 25 04:57:51 2004
+++ kdepim-3.3.1-new/kpilot/conduits/malconduit/mal-conduit.cc	Fri Oct 15 09:38:17 2004
@@ -34,6 +34,7 @@
 
 #include "options.h"
 
+#include <stdarg.h>
 #include <qregexp.h>
 #include <kconfig.h>
 #include <kdebug.h>
diff -uNr kdepim-3.3.1/kresources/slox/webdavhandler.cpp kdepim-3.3.1-new/kresources/slox/webdavhandler.cpp
--- kdepim-3.3.1/kresources/slox/webdavhandler.cpp	Sun Oct  3 03:44:46 2004
+++ kdepim-3.3.1-new/kresources/slox/webdavhandler.cpp	Fri Oct 15 09:38:49 2004
@@ -20,7 +20,11 @@
 
 #include "webdavhandler.h"
 
+#ifdef __APPLE__
+#define MAXINT INT_MAX
+#else
 #include <values.h>
+#endif
 
 #include <libkdepim/kpimprefs.h>
 
