diff -Naur Canna36p4.old/Canna.conf Canna36p4.new/Canna.conf
--- Canna36p4.old/Canna.conf	Mon Sep 22 19:27:12 2003
+++ Canna36p4.new/Canna.conf	Wed Dec  3 04:35:21 2003
@@ -156,27 +156,24 @@
 # define DefCannaLibDir $(cannaPrefix)/share/canna
 #endif
 
-cannaPrefix = DefCannaPrefix
+cannaPrefix = @PREFIX@
 cannaExecPrefix = $(cannaPrefix)
 cannaBinDir = $(cannaExecPrefix)/bin
-cannaSrvDir = DefCannaSrvDir
-XCOMM cannaLibDir = /var/lib/canna
-XCOMM cannaLibDir = /var/db/canna
-cannaLibDir = DefCannaLibDir
-XCOMM cannaManDir = $(cannaPrefix)/share/man
-cannaManDir = $(cannaPrefix)/man
+cannaSrvDir = $(cannaExecPrefix)/sbin
+cannaLibDir = $(cannaPrefix)/var/lib/canna
+cannaManDir = $(cannaPrefix)/share/man
 cannaIncDir = $(cannaPrefix)/include/canna
 
-libCannaDir = DefLibCannaDir
-ErrDir  = DefErrDir
+libCannaDir = $(cannaPrefix)/lib
+ErrDir  = $(cannaPrefix)/var/log/canna
 
 /* 次の3行は変更しないでください */
 wcharDefinition = -DCANNA_WCHAR
 Wlib =
 JapaneseLocale = japanese
 
-cannaOwner = bin
-cannaGroup = bin
+cannaOwner = canna
+cannaGroup = canna
 
 #ifdef InstallAsUser
 cannaOwnerGroup =
@@ -197,7 +194,7 @@
 /* 今のところ__APPLE__はImake.cfでundefされる */
 sharedLibExtension = $(cannaDsoRev).dylib
 #else
-sharedLibExtension = so.$(cannaDsoRev)
+sharedLibExtension = $(cannaDsoRev).dylib
 #endif
 
 /* iroha.t の場所を指定。pubdic+ があればそちらを指定します。 */
@@ -208,16 +205,16 @@
 CHGRP = :
 CHMOD = :
 #else
-CHOWN = chown
-CHGRP = chgrp
-CHMOD = chmod
+CHOWN = /usr/sbin/chown
+CHGRP = /usr/bin/chgrp
+CHMOD = /bin/chmod
 #endif
 
 /* 日本語マニュアルを使わないのであればコメントアウト */
-#define JAPANESEMAN
+/* #define JAPANESEMAN */
 
 /* locale ディレクトリを持っている場合は以下を記述する */
-/* #define LOCALE_DIR /usr/lib/locale */
+#define LOCALE_DIR /usr/share/locale
 
 /* エンジンスイッチ機能を使うのであればコメントをはずす */
 /* ※注 Canna version 3.5 ではコメントをはずさないでください */
@@ -251,7 +248,7 @@
 /* #define UseInstalledLibCanna YES */
 #define UseInstalledLibCanna NO
 
-DicDir   = $(cannaLibDir)/dic
+DicDir   = $(cannaPrefix)/var/lib/canna/dic
 
 #ifdef NeXT
 #define NO_X_ENV
diff -Naur Canna36p4.old/canna/protodefs.h Canna36p4.new/canna/protodefs.h
--- Canna36p4.old/canna/protodefs.h	Sun Oct 20 17:20:33 2002
+++ Canna36p4.new/canna/protodefs.h	Wed Dec  3 04:34:20 2003
@@ -78,7 +78,7 @@
 #define I16toI32(x) (x)
 #define I8toI32(x) (((x) & 0x80) ? ((x) | 0xffffff80) : (x))
 
-#if defined(__bsdi__) || defined(__FreeBSD__)
+#if defined(__bsdi__) || defined(__FreeBSD__) || defined(__APPLE__)
 #include <machine/endian.h>
 #endif
 
diff -Naur Canna36p4.old/canna/widedef.h Canna36p4.new/canna/widedef.h
--- Canna36p4.old/canna/widedef.h	Fri Sep 12 23:32:52 2003
+++ Canna36p4.new/canna/widedef.h	Wed Dec  3 04:38:29 2003
@@ -67,7 +67,7 @@
 #endif /* HAVE_WCHAR_OPERATION */
 
 #if (defined(__FreeBSD__) && __FreeBSD_version < 500000) \
-    || defined(__NetBSD__) || defined(__OpenBSD__) || defined(__APPLE__)
+    || defined(__NetBSD__) || defined(__OpenBSD__)
 # ifdef _BSD_WCHAR_T_
 #  undef _BSD_WCHAR_T_
 #  ifdef WCHAR16
@@ -85,6 +85,17 @@
 # endif
 # include <stddef.h>
 # define _WCHAR_T
+#elif defined(__APPLE__)
+# ifdef __WCHAR_TYPE__
+#  undef __WCHAR_TYPE__
+# endif
+# ifdef WCHAR16
+#  define __WCHAR_TYPE__ unsigned short
+# else
+#  define __WCHAR_TYPE__ unsigned long
+# endif
+# include <stddef.h>
+# define _WCHAR_T
 #else
 #if !defined(WCHAR_T) && !defined(_WCHAR_T) && !defined(_WCHAR_T_) \
  && !defined(__WCHAR_T) && !defined(_GCC_WCHAR_T) && !defined(_WCHAR_T_DEFINED)
@@ -92,7 +103,7 @@
 typedef unsigned short wchar_t;
 # else
 /* replace this with #include or typedef appropriate for your system */
-typedef unsigned long wchar_t;
+#  include <wchar.h>
 # endif
 # define WCHAR_T
 # define _WCHAR_T
diff -Naur Canna36p4.old/update-canna-dics-dir Canna36p4.new/update-canna-dics-dir
--- Canna36p4.old/update-canna-dics-dir	Thu Jan  1 09:00:00 1970
+++ Canna36p4.new/update-canna-dics-dir	Wed Dec  3 04:34:26 2003
@@ -0,0 +1,14 @@
+#!/bin/sh -e
+
+PATH=/bin:/sbin:/usr/bin:/usr/sbin:@PREFIX@/bin:@PREFIX@/sbin
+
+LIST_FILE=@PREFIX@/var/lib/canna/dic/canna/dics.dir
+LIST_DIR=@PREFIX@/var/lib/canna/dics.d
+
+TMPFILE=`tempfile`
+cat ${LIST_DIR}/* >>${TMPFILE}
+mv ${TMPFILE} ${LIST_FILE}
+chmod 0644 ${LIST_FILE}
+chown canna:canna ${LIST_FILE}
+
+exit 0
