Info2:<<
Package: git
Version: 1.7.2.3
Revision: 1
Distribution: 10.4
Type: pm 5.8.6

Depends: <<
	email-valid-pm%type_pkg[pm],
	error-pm,
	expat1-shlibs,
	file-temp-pm%type_pkg[pm],
	getopt-long-pm%type_pkg[pm],
	libcurl4-shlibs (>= 7.18.2-1),
	libiconv,
	libnet-pm%type_pkg[pm],
	mailtools-pm%type_pkg[pm],
	net-smtp-ssl-pm%type_pkg[pm],
	term-ansicolor-pm,
	term-readline-pm%type_pkg[pm]
<<
BuildDepends: <<
	expat1,
	fink (>= 0.24.12),
	libcurl4 (>= 7.18.2-1),
	libiconv-dev,
	system-openssl-dev
<<
Replaces: git-core

Source: mirror:custom:/software/scm/%n/%n-%v.tar.bz2
Source-MD5: d88c06f6442156686deb4b4fbab0954c
Source2: mirror:custom:/software/scm/%n/%n-htmldocs-%v.tar.bz2
Source2-MD5: e8505ed81506ee4ad6e15d149f366866
Source2ExtractDir: doc
Source3: mirror:custom:/software/scm/%n/%n-manpages-%v.tar.bz2
Source3-MD5: 2ef8d3959c832347c29885627ebc0682

PatchFile: %n.patch
PatchFile-MD5: 9c7c4ad0cdb96c4679bcb75364e57355
PatchScript: <<
	#!/bin/bash -ev
	%{default_script}
	# Fix up paths in documentation to point to %p.
	perl -pi -e 's,/usr/(share|bin)/git,%p/\1/git,g; s,/usr/libexec,%p/lib,g' ../man1/* ../doc/*
	# Setting these variables in 'config.mak' lets Makefile import them
	# automatically instead of always manually passing them to make.
	cat >> config.mak << EOF
NO_FINK=1
NO_DARWIN_PORTS=1
NO_MSGFMT=1
GITWEB_CONFIG_SYSTEM=%p/gitweb.conf
CC_LD_DYNPATH=-L
AR=ar
EOF
<<

UseMaxBuildJobs: true

# Let configure do the work of setting up the environment instead of
# patching and passing things manually to make.
SetCPPFLAGS: -I%p/lib/system-openssl/include
SetLDFLAGS: -L%p/lib/system-openssl/lib
# Darwin needs no special flags for pthreads, so set flags to ' ' because
# "-pthreads" causes problems for gcc-4.0.
ConfigureParams: <<
	--libexecdir='${exec_prefix}/lib' \
	--enable-pthreads=' ' \
	--without-python \
	--with-perl='/usr/bin/perl%type_raw[pm]' \
	--with-tcltk='/usr/bin/wish' \
	--with-openssl='%p/lib/system-openssl'
<<
# See? No more CompileScript!

# Tests are much cleaner looking too.
InfoTest: <<
	TestScript: <<
		#!/bin/bash -ev
		
		if [ $UID = 0 ]; then
			# Some tests fail when run as root.
			GIT_SKIP_TESTS='t0001.25 t0004.2 t0004.3 t0004.4 t0004.5 t1004.13 t3700.21 t3700.22 t3700.23 t3700.24 t3700.25 t4201.2 t7006 t7300.26' make -k test || exit 2
		else
			GIT_SKIP_TESTS="t4201.2 t7006" make -k test || exit 2
		fi
	<<
	TestSuiteSize: large
<<

InstallScript: <<
	make install DESTDIR=%d
	
	mkdir -p %i/share/man %i/share/doc
	cp -R ../man* %i/share/man
	cp -R ../doc %i/share/doc/%n
	mkdir -p %i/share/emacs/site-lisp
	cp contrib/emacs/*.el %i/share/emacs/site-lisp
	mkdir -p %i/etc/bash_completion.d
	cp contrib/completion/git-completion.bash %i/etc/bash_completion.d/
<<

UpdatePOD: true
DocFiles: COPYING README

SplitOff: <<
	Package: git-cvsimport
	Description: Tool to import a CVS repository into git
	Depends: %N (=%v-%r), cvsps
	Files: <<
		lib/git-core/%n
		share/doc/%N/%n.html
		share/man/man1/%n.1
	<<
	DocFiles: COPYING
<<

SplitOff2: <<
	Package: git-archimport
	Description: Tool to import an arch repository into git
	Depends: %N (=%v-%r), string-shellquote-pm
	Recommends: arch-tla
	Files: <<
		lib/git-core/%n
		share/doc/%N/%n.html
		share/man/man1/%n.1
	<<
	DocFiles: COPYING
<<

SplitOff3: <<
	Package: git-svn
	Description: Tool to let git use subversion repositories
	Depends: %N (=%v-%r), svn-swig-pm%type_pkg[pm], libwww-pm%type_pkg[pm], term-readkey-pm%type_pkg[pm]
	Files: <<
		lib/git-core/%n
		share/doc/%N/%n.html
		share/man/man1/%n.1
	<<
	DocFiles: COPYING
<<

Description: Distributed version control system
DescDetail: <<
Git is an open source, distributed version control system designed to
handle everything from small to very large projects with speed and
efficiency.

Every Git clone is a full-fledged repository with complete history and
full revision tracking capabilities, not dependent on network access or
a central server. Branching and merging are fast and easy to do.

To use git-archimport you must install arch-tla. I didn't make it a
dependency since it doesn't affect building and it's probably not common.
<<
DescPackaging: Previously maintained by Brendan Cully <brendan@finkproject.org>
License: GPL
Homepage: http://git-scm.com/
Maintainer: Daniel Johnson <daniel@daniel-johnson.org>
CustomMirror: <<
	Primary: http://www.kernel.org/pub
	asi-CN: http://www.cn.kernel.org/pub
	asi-IN: http://www.in.kernel.org/pub
	asi-JP: http://www.jp.kernel.org/pub
	asi-KR: http://www.kr.kernel.org/pub
	asi-MY: http://www.my.kernel.org/pub
	asi-SG: http://www.sg.kernel.org/pub
	asi-TW: http://www.tw.kernel.org/pub
	aus-AU: http://www.au.kernel.org/pub
	aus-NZ: http://www.nz.kernel.org/pub
	eur-BA: http://www.ba.kernel.org/pub
	eur-BE: http://www.be.kernel.org/pub
	eur-BG: http://www.bg.kernel.org/pub
	eur-CH: http://www.ch.kernel.org/pub
	eur-CZ: http://www.cz.kernel.org/pub
	eur-DE: http://www.de.kernel.org/pub
	eur-DK: http://www.dk.kernel.org/pub
	eur-EE: http://www.ee.kernel.org/pub
	eur-ES: http://www.es.kernel.org/pub
	eur-FI: http://www.fi.kernel.org/pub
	eur-FR: http://www.fr.kernel.org/pub
	eur-GR: http://www.gr.kernel.org/pub
	eur-HR: http://www.hr.kernel.org/pub
	eur-HU: http://www.hu.kernel.org/pub
	eur-IE: http://www.ie.kernel.org/pub
	eur-IL: http://www.il.kernel.org/pub
	eur-IS: http://www.is.kernel.org/pub
	eur-IT: http://www.it.kernel.org/pub
	eur-LI: http://www.li.kernel.org/pub
	eur-LT: http://www.lt.kernel.org/pub
	eur-LU: http://www.lu.kernel.org/pub
	eur-LV: http://www.lv.kernel.org/pub
	eur-MD: http://www.md.kernel.org/pub
	eur-MK: http://www.mk.kernel.org/pub
	eur-NL: http://www.nl.kernel.org/pub
	eur-NO: http://www.no.kernel.org/pub
	eur-PL: http://www.pl.kernel.org/pub
	eur-PT: http://www.pt.kernel.org/pub
	eur-RO: http://www.ro.kernel.org/pub
	eur-RU: http://www.ru.kernel.org/pub
	eur-SE: http://www.se.kernel.org/pub
	eur-SI: http://www.si.kernel.org/pub
	eur-SK: http://www.sk.kernel.org/pub
	eur-TR: ftp://ftp.tr.kernel.org/pub
	eur-UA: http://www.ua.kernel.org/pub
	eur-UK: http://www.uk.kernel.org/pub
	nam-CA: http://www.ca.kernel.org/pub
	nam-MX: http://www.mx.kernel.org/pub
	nam-US: http://www.us.kernel.org/pub
	sam-AR: http://www.ar.kernel.org/pub
	sam-BR: http://www.br.kernel.org/pub
	sam-CL: http://www.cl.kernel.org/pub
	sam-VE: http://www.ve.kernel.org/pub
<<
<<
