Package: netpbm10
Version: 10.47.45
Revision: 3
BuildDepends: <<
	fink-package-precedence,
	libiconv-dev,
	libjasper.1,
	libjbig,
	libjpeg9,
	libpng14,
	libtiff5,
	libxml2
<<
Depends: %N-shlibs (= %v-%r)
Conflicts: <<
	netpbm, netpbm10, netpbm11
<<
# Replaces netpbm-bin because man3 and man5 dirs were previously installed
# in the wrong SplitOff.
Replaces: <<
	netpbm-bin (<< 10.47.44-2),
	netpbm, netpbm10, netpbm11
<<
BuildDependsOnly: True
Source: http://www.snaggledworks.com/fink/src/netpbm-%v.tar.bz2
Source-MD5: 4be834374a2254edc2203ecbf726af6d
Source-Checksum: SHA1(d7dc010aee17a4a71f86252f2631507dc108dc92)
NoSetMAKEFLAGS: true
NoSetLDFLAGS: true
SetLIBRARY_PATH: %p/lib
PatchFile: %n.patch
PatchFile-MD5: 9db143091ceddcad05150ec01fdc75ba
PatchScript: <<
 sed 's|@PREFIX@|%p|g' < %{PatchFile} | patch -p1
 cat config.mk.in Makefile.config.fink >config.mk
<<
UseMaxBuildJobs: false
CompileScript: <<
	make
	fink-package-precedence --depfile-ext='\.d' --prohibit-bdep=netpbm,netpbm10,netpbm11 .
<<
InfoTest: <<
	TestScript: <<
		#!/bin/sh -ev
		# tests are manually run inside their directories.
		export DYLD_LIBRARY_PATH=%b/package/lib
		### pamtosvg.test hangs, so don't test it.
		for test_file in `find . -name *.test -print | grep -v examples | grep -v pamtosvg`; do
			testdir=`dirname $test_file`
			testname=`basename $test_file`
			pushd $testdir
				echo ""
				echo "Running test: $test_file"
				sh ./$testname || exit 2
			popd
		done
	<<
<<
InstallScript: <<
	# pkgdir = where 'make package' sends everything
	make package pkgdir=`pwd`/package SYMLINK='ln -s'
	install -d -m 755 %i/share %i/share/netpbm
	printf "package\n%i\n\n\n\n%i/share/netpbm\n\n\n" | ./installnetpbm
	rm -rf %i/share/man/web
	mv %i/bin/doc.url %i/share/netpbm
<<
SplitOff: <<
  Package: %N-shlibs
  Files: lib/libnetpbm.*.dylib
  Shlibs: %p/lib/libnetpbm.10.dylib 11.0.0 %n (>= 10.12-1)
  Conflicts: netpbm (<< 9.25-1)
  DocFiles: README doc/*
<<
SplitOff2: <<
  Package: netpbm-bin
  Depends: <<
    %N-shlibs (= %v-%r),
    libiconv,
    libjasper.1-shlibs,
    libjbig-shlibs,
    libjpeg9-shlibs,
    libpng14-shlibs,
    libtiff5-shlibs,
    libxml2-shlibs
  <<
  # Replaces netpbm10 because man3 and man5 dirs were previously installed
  # in the wrong SplitOff.
  Replaces: netpbm10 (<< 10.47.44-2)
  Files: <<
  	bin
  	share/man/man1
  	share/man/man5
  	share/netpbm
  <<
  DocFiles: README doc/*
<<
DocFiles: README doc/*
Description: Graphics manipulation programs and libraries
DescPort: <<
 Security patches thanks to Tomoaki Okayama:
  CVE-2005-2978: netpbm-10.26.12-pnmtopng-CAN-2005-2978.patch (from SUSE)
  CVE-2005-3662: netpbm-10.26.12-pnmtopng-overflow.patch      (from SUSE)
<<
License: OSI-Approved
Homepage: http://netpbm.sourceforge.net
Maintainer: Hanspeter Niederstrasser <nieder@users.sourceforge.net>
DescPackaging: <<
 Originally packaged by Masanori Sekino.
 Previously maintained by:	Dave Morrison <drm@finkproject.org>

 Tarball generated with these commands:
 svn checkout -r 1960 http://svn.code.sf.net/p/netpbm/code/stable/ netpbm-10.47.45
 tar cfj netpbm-10.47.45.tar.bz2 netpbm-10.47.45
 
 nieder: 
 Change from 'super stable' to 'stable' trees.
 'Stable' tree fails with libpng15, so keep at libpng14 for now.
 Reorganize man* to put into proper SplitOff.
 Move data files from %p/lib to %p/share/netpbm and transfer to -bin SplitOff.
   This matches Debian's layout.
<<
