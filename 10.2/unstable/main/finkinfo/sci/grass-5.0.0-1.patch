--- grass-5.0.0/configure	Mon Jun 17 01:29:17 2002
+++ grass-5.0.0-patched/configure	Wed Oct 23 21:25:54 2002
@@ -8336,7 +8336,7 @@
 
 ac_save_cppflags="$CPPFLAGS"
 CPPFLAGS="$PQINCPATH $CPPFLAGS"
-for ac_hdr in postgres.h
+for ac_hdr in server/postgres.h
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
@@ -8372,7 +8372,7 @@
   echo "$ac_t""no" 1>&6
 ac_save_cppflags="$CPPFLAGS"
 CPPFLAGS=" $CPPFLAGS"
-for ac_hdr in postgres_fe.h
+for ac_hdr in server/postgres_fe.h
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
@@ -9493,12 +9493,12 @@
 
 
 
-echo $ac_n "checking for dnrm2_ in -lblas""... $ac_c" 1>&6
-echo "configure:9498: checking for dnrm2_ in -lblas" >&5
+echo $ac_n "checking for dnrm2_ in -lf77blas -lcblas -latlas""... $ac_c" 1>&6
+echo "configure:9498: checking for dnrm2_ in -lf77blas -lcblas -latlas" >&5
 ac_lib_var=`echo blas'_'dnrm2_ | sed 'y%./+-%__p_%'`
 
 ac_save_LIBS="$LIBS"
-LIBS="-lblas $MATHLIB  $LIBS"
+LIBS="-lf77blas -lcblas -latlas $MATHLIB  $LIBS"
 cat > conftest.$ac_ext <<EOF
 #line 9504 "configure"
 #include "confdefs.h"
@@ -9525,16 +9525,16 @@
 
 if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
   echo "$ac_t""yes" 1>&6
-  BLASLIB="$BLASLIB -lblas "
+  BLASLIB="$BLASLIB -lf77blas -lcblas -latlas "
 else
   echo "$ac_t""no" 1>&6
 
-echo $ac_n "checking for dnrm2_ in -lblas""... $ac_c" 1>&6
-echo "configure:9534: checking for dnrm2_ in -lblas" >&5
+echo $ac_n "checking for dnrm2_ in -lf77blas -lcblas -latlas""... $ac_c" 1>&6
+echo "configure:9534: checking for dnrm2_ in -lf77blas -lcblas -latlas" >&5
 ac_lib_var=`echo blas'_'dnrm2_ | sed 'y%./+-%__p_%'`
 
 ac_save_LIBS="$LIBS"
-LIBS="-lblas $MATHLIB -lg2c $LIBS"
+LIBS="-lf77blas -lcblas -latlas $MATHLIB -lg2c $LIBS"
 cat > conftest.$ac_ext <<EOF
 #line 9540 "configure"
 #include "confdefs.h"
@@ -9561,7 +9561,7 @@
 
 if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
   echo "$ac_t""yes" 1>&6
-  BLASLIB="$BLASLIB -lblas -lg2c"
+  BLASLIB="$BLASLIB -lf77blas -lcblas -latlas -lg2c"
 else
   echo "$ac_t""no" 1>&6
 
--- grass-5.0.0/src/display/d.zoom/cmd/set.c	Tue Apr 30 20:23:56 2002
+++ grass-5.0.0-patched/src/display/d.zoom/cmd/set.c	Thu Oct 24 14:51:26 2002
@@ -8,7 +8,7 @@
 
 static int max(int,int);
 
-double round(double in, int sd) {
+double int_round(double in, int sd) {
     double mult = 1, out;
     
     while ( rint(in * mult) < pow(10,sd-1)  )
@@ -52,8 +52,8 @@
     
     resetres = 1;
     while ( resetres ) {
-	nsr = round(window->ns_res, 3); 
-	ewr = round(window->ew_res, 3); 
+	nsr = int_round(window->ns_res, 3); 
+	ewr = int_round(window->ew_res, 3); 
 
 	td = ceil (north / nsr);
 	tnorth = td * nsr;
@@ -67,8 +67,8 @@
 	ns = tnorth - tsouth;
 	ew = teast - twest;
 	if ( ( ns < 2 * window->ns_res  || ew < 2 * window->ew_res )  && !hand )   {
-	    nsr = round (nsr/10.0, 3);
-	    ewr = round (ewr/10.0, 3);
+	    nsr = int_round (nsr/10.0, 3);
+	    ewr = int_round (ewr/10.0, 3);
 	    if ( nsr < 0.00000001 || ewr < 0.00000001 ) {
 		fprintf(stderr, "Minimum resolution supported by d.zoom reached.\n") ;
 		resetwin = 0;
@@ -102,8 +102,8 @@
     nrow = ( tnorth - tsouth ) / window->ns_res; 
     ncol = ( teast - twest ) / window->ew_res; 
     if ( ( nrow > 10000000 || ncol > 10000000 ) && !hand ) {
-	nsr = round ( window->ns_res * 10, 3); 
-	ewr = round ( window->ew_res * 10, 3); 
+	nsr = int_round ( window->ns_res * 10, 3); 
+	ewr = int_round ( window->ew_res * 10, 3); 
 	fprintf(stderr, "\nResolution is too high for selected region.\n") ;
 	fprintf(stderr, "Buttons:\n") ;
 	fprintf(stderr, "%s Decrease resolution to n-s = %.20f e-w = %.20f\n", LBTN, nsr, ewr);

--- grass-5.0.0/src/imagery/i.pca/cmd/main.c	Tue Jan 22 15:51:06 2002
+++ grass-5.0.0-patched/src/imagery/i.pca/cmd/main.c	Thu Oct 24 17:40:00 2002
@@ -339,7 +339,7 @@
 }
 
 CELL 
-round (double x)
+int_round (double x)
 {
   CELL n;
 
--- grass-5.0.0/src/raster/r.sun/main.c	Wed Jun 19 01:35:39 2002
+++ grass-5.0.0-patched/src/raster/r.sun/main.c	Thu Oct 24 17:43:25 2002
@@ -43,7 +43,6 @@
 #include <stdio.h>
 #include <stdlib.h>
 #include <math.h>
-#include <malloc.h>
 #include "gis.h"
 #include "Vect.h"
 #include "projects.h"

--- grass-5.0.0/src/libes/vect32/georef/Gmakefile	Sat Apr 20 06:39:05 2002
+++ grass-5.0.0-patched/src/libes/vect32/georef/Gmakefile	Thu Oct 24 20:44:55 2002
@@ -60,7 +60,7 @@
 #  notice that bin_point becomes geo.point in the etc directory
 
 $(ETC)/geo.point: bin_point.o $(DEPGISLIB) $(DEPLOCKLIB)
-	$(CC) $(LDFLAGS)  -o $(ETC)/geo.point  bin_point.o  libgeo.a $(GISLIB) $(LOCKLIB) $(MATHLIB) $(XDRLIB)
+	$(CC) $(LDFLAGS)  -o $(ETC)/geo.point  bin_point.o  vars.o  libgeo.a $(GISLIB) $(LOCKLIB) $(MATHLIB) $(XDRLIB)
 
 
 $(ETC)/geo.quest: geo_quest.o $(DEPGISLIB) 
@@ -68,6 +68,6 @@
 
 
 $(ETC)/geo.unlock: geo_unlock.o $(DEPGISLIB) $(DEPLOCKLIB)
-	$(CC) $(LDFLAGS)  -o $@  geo_unlock.o  libgeo.a $(GISLIB)  $(LOCKLIB) $(MATHLIB) $(XDRLIB)
+	$(CC) $(LDFLAGS)  -o $@  geo_unlock.o  vars.o  libgeo.a $(GISLIB)  $(LOCKLIB) $(MATHLIB) $(XDRLIB)
 
 $(DEPGISLIB) $(DEPLOCKLIB): #

--- grass-5.0.0/src.contrib/GMSL/g3d/src3d/sites/s.vol.rst/main.c	Thu Apr 25 03:04:31 2002
+++ grass-5.0.0-patched/src.contrib/GMSL/g3d/src3d/sites/s.vol.rst/main.c	Fri Oct 25 07:21:38 2002
@@ -30,7 +30,6 @@
 #include <stdlib.h>
 #include <math.h>
 #include <string.h>
-#include <malloc.h>
 #include "gis.h"
 #include "site.h"
 #include "userglobs.h"

--- grass-5.0.0/src.contrib/GMSL/g3d/src3d/sites/s.vol.rst/dataoct.c	Thu Apr 25 03:04:31 2002
+++ grass-5.0.0-patched/src.contrib/GMSL/g3d/src3d/sites/s.vol.rst/dataoct.c	Fri Oct 25 08:49:22 2002
@@ -27,7 +27,7 @@
 *****************************************************************************/
 
 #include <stdio.h>
-#include <malloc.h>
+#include <stdlib.h>
 #include "dataoct.h" 
 #include "externs.h" 

--- grass-5.0.0/src.contrib/GMSL/g3d/src3d/sites/s.vol.rst/user2.c	Thu Apr 25 03:04:31 2002
+++ grass-5.0.0-patched/src.contrib/GMSL/g3d/src3d/sites/s.vol.rst/user2.c	Fri Oct 25 08:50:32 2002
@@ -28,7 +28,7 @@
 
 #include <stdio.h>
 #include <math.h>
-#include <malloc.h>
+#include <stdlib.h>
 #include "gis.h"
 
 #include "oct.h"

--- grass-5.0.0/src.contrib/GMSL/g3d/src3d/sites/s.vol.rst/user4.c	Thu Apr 25 03:04:31 2002
+++ grass-5.0.0-patched/src.contrib/GMSL/g3d/src3d/sites/s.vol.rst/user4.c	Fri Oct 25 08:51:00 2002
@@ -28,7 +28,7 @@
 
 #include <stdio.h>
 #include <math.h>
-#include <malloc.h>
+#include <stdlib.h>
 #include "gis.h"
 
 #include "oct.h"

--- grass-5.0.0/src/general/init/Gmakefile	Mon Jun 17 01:29:22 2002
+++ grass-5.0.0-patched/src/general/init/Gmakefile	Thu Oct 24 22:01:32 2002
@@ -43,7 +43,7 @@
 	chmod +x $@
 
 $(ETC)/set_data: $(SET_DATA) $(DEPGISLIB) $(DEPVASKLIB) $(DEPEDITLIB)
-	$(CC) $(LDFLAGS) -o $@ $(SET_DATA) $(EDITLIB) $(GISLIB) $(VASKLIB) $(CURSES) $(MATHLIB) $(XDRLIB)
+	$(CC) $(LDFLAGS) -o $@ $(SET_DATA) $(DEPEDITLIB) $(EDITLIB) $(GISLIB) $(VASKLIB) $(CURSES) $(MATHLIB) $(XDRLIB)
 
 $(ETC)/echo: echo.o
 	$(CC) $(LDFLAGS) echo.o -o $@

--- grass-5.0.0/src/general/g.region/inter/Gmakefile	Mon Apr 15 23:26:26 2002
+++ grass-5.0.0-patched/src/general/g.region/inter/Gmakefile	Fri Oct 25 14:51:26 2002
@@ -21,7 +21,7 @@
 DEPLIBS=$(DEPEDITLIB) $(DEPGISLIB) $(DEPVASKLIB) $(DEPVECTLIB) $(DEPDATETIMELIB)
 
 $(BIN_INTER)/$(PGM): $(LIST) $(DEPLIBS)
-	$(CC) $(LDFLAGS) -o $@ $(LIST) $(LIBES) $(CURSES) $(MATHLIB) $(XDRLIB)
+	$(CC) $(LDFLAGS) -o $@ $(LIST) $(DEPEDITLIB) $(LIBES) $(CURSES) $(MATHLIB) $(XDRLIB)
 
 $(LIST): glob.h
 
--- grass-5.0.0/src/mapdev/v.reclass/inter/Gmakefile	Mon Apr 15 23:26:35 2002
+++ grass-5.0.0-patched/src/mapdev/v.reclass/inter/Gmakefile	Fri Oct 25 15:57:45 2002
@@ -4,7 +4,7 @@
 PGM=v.reclass 
 
 $(BIN_INTER)/$(PGM): $(RECLASS) $(DEPGISLIB) $(DEPVASKLIB) $(DEPEDITLIB)
-	$(CC) $(LDFLAGS) -o $@ $(RECLASS) $(EDITLIB) $(GISLIB) $(VASKLIB) $(EXTRALIB) $(CURSES) $(MATHLIB) $(XDRLIB)
+	$(CC) $(LDFLAGS) -o $@ $(RECLASS) $(DEPEDITLIB) $(EDITLIB) $(GISLIB) $(VASKLIB) $(EXTRALIB) $(CURSES) $(MATHLIB) $(XDRLIB)
 
 $(DEPGISLIB): #
 $(DEPVASKLIB): #

--- grass-5.0.0/src/raster/r.reclass/inter/Gmakefile	Mon Apr 15 23:26:45 2002
+++ grass-5.0.0-patched/src/raster/r.reclass/inter/Gmakefile	Fri Oct 25 16:41:51 2002
@@ -7,7 +7,7 @@
 all: $(HOME)/r.reclass $(HOME)/r.mask
 
 $(HOME)/r.reclass: $(RECLASS) $(DEPGISLIB) $(DEPVASKLIB) $(DEPEDITLIB)
-	$(CC) $(LDFLAGS) -o $@ $(RECLASS) $(EDITLIB) $(GISLIB) $(VASKLIB) $(CURSES) $(MATHLIB) $(XDRLIB)
+	$(CC) $(LDFLAGS) -o $@ $(RECLASS) $(DEPEDITLIB) $(EDITLIB) $(GISLIB) $(VASKLIB) $(CURSES) $(MATHLIB) $(XDRLIB)
 
 $(HOME)/r.mask: $(MASK) $(DEPGISLIB) $(DEPVASKLIB)
 	$(CC) $(LDFLAGS) -o $@ $(MASK) $(GISLIB) $(VASKLIB) $(CURSES) $(MATHLIB) $(XDRLIB)

--- grass-5.0.0/src/raster/r.support/inter/Gmakefile	Mon Apr 15 23:26:46 2002
+++ grass-5.0.0-patched/src/raster/r.support/inter/Gmakefile	Fri Oct 25 16:51:50 2002
@@ -16,13 +16,13 @@
 	$(CC) $(LDFLAGS) -o $@ $(MODCOLR) $(GISLIB) $(TERMLIB) $(MATHLIB) $(XDRLIB)
 
 $(ETC)/modhead: $(MODHEAD) $(DEPGISLIB) $(DEPVASKLIB) $(DEPEDITLIB)
-	$(CC) $(LDFLAGS) -o $@ $(MODHEAD) $(EDITLIB) $(GISLIB) $(VASKLIB) $(CURSES) $(MATHLIB) $(XDRLIB)
+	$(CC) $(LDFLAGS) -o $@ $(MODHEAD) $(DEPEDITLIB) $(EDITLIB) $(GISLIB) $(VASKLIB) $(CURSES) $(MATHLIB) $(XDRLIB)
 
 $(ETC)/modcats: $(MODCATS) $(DEPGISLIB) $(DEPVASKLIB) $(DEPEDITLIB)
-	$(CC) $(LDFLAGS) -o $@ $(MODCATS) $(EDITLIB) $(GISLIB) $(VASKLIB) $(CURSES) $(MATHLIB) $(XDRLIB)
+	$(CC) $(LDFLAGS) -o $@ $(MODCATS) $(DEPEDITLIB) $(EDITLIB) $(GISLIB) $(VASKLIB) $(CURSES) $(MATHLIB) $(XDRLIB)
 
 $(ETC)/modhist: $(MODHIST) $(DEPGISLIB) $(DEPVASKLIB) $(DEPEDITLIB)
-	$(CC) $(LDFLAGS) -o $@ $(MODHIST) $(EDITLIB) $(GISLIB) $(VASKLIB) $(CURSES) $(MATHLIB) $(XDRLIB)
+	$(CC) $(LDFLAGS) -o $@ $(MODHIST) $(DEPEDITLIB) $(EDITLIB) $(GISLIB) $(VASKLIB) $(CURSES) $(MATHLIB) $(XDRLIB)
 
 $(HOME)/r.support: $(SUPPORT) $(DEPGISLIB)
 	$(CC) $(LDFLAGS) -o $@ $(SUPPORT) $(GISLIB) $(TERMLIB) $(MATHLIB) $(XDRLIB)

--- grass-5.0.0/src/raster/r.weight/inter/Gmakefile	Wed Apr 17 21:41:02 2002
+++ grass-5.0.0-patched/src/raster/r.weight/inter/Gmakefile	Fri Oct 25 17:27:57 2002
@@ -28,7 +28,7 @@
 pgm: $(ETC)/r.weight
 
 $(ETC)/r.weight: $(OFILES) $(DEPLIBS)
-	$(CC) $(LDFLAGS) -o $@ $(OFILES) $(LIBES) $(CURSES) $(MATHLIB) $(XDRLIB) $(LEXLIB)
+	$(CC) $(LDFLAGS) -o $@ $(OFILES) $(DEPEDITLIB) $(LIBES) $(CURSES) $(MATHLIB) $(XDRLIB) $(LEXLIB)
 
 $(BIN_INTER)/r.weight: weight.sh
 	rm -f $@ ; cp $? $@ ; chmod 0755 $@

--- grass-5.0.0/src.contrib/GMSL/NVIZ2.2/src/runInfxQry.c	Fri Feb 22 16:34:41 2002
+++ grass-5.0.0-patched/src.contrib/GMSL/NVIZ2.2/src/runInfxQry.c	Sun Oct 27 00:26:01 2002
@@ -2,7 +2,6 @@
 */
 #include "config.h"
 
-#if defined(HAVE_POSTGRES_H) || defined(HAVE_POSTGRES_FE_H)
 
 #include "gis.h"
 #include "infx.h"
@@ -176,5 +175,4 @@
 	return long_str ;
 }
 
-#endif
 
--- grass-5.0.0/src/raster/r.in.gdal/Gmakefile	Mon Apr 15 23:26:41 2002
+++ grass-5.0.0-patched/src/raster/r.in.gdal/Gmakefile	Fri Oct 25 20:58:59 2002
@@ -8,6 +8,6 @@
 DEPLIBS= $(DEPGISLIB) $(DEPIMAGERYLIB) $(DEPGPROJLIB)
 $(BIN_CMD)/$(PGM): $(LIST) $(DEPGISLIB)
 	$(CC) $(LDFLAGS) -o $@ $(LIST) \
-		$(GDAL_LIBS) $(LIBES) $(MATHLIB) $(XDRLIB)
+		$(GDAL_LIBS) -ldl $(LIBES) $(MATHLIB) $(XDRLIB)
 
 $(DEPGISLIB): #

--- grass-5.0.0/src.garden/grass.postgresql/g.column.pg/infxColumn.c	Wed Apr 10 22:07:57 2002
+++ grass-5.0.0-patched/src.garden/grass.postgresql/g.column.pg/infxColumn.c	Tue Oct 29 16:51:08 2002
@@ -3,16 +3,9 @@
 #include "column.h"
 #include <libpq-fe.h>
 #include "glocale.h"
-
-#ifdef HAVE_POSTGRES_H
-#include <postgres.h>
-#else
-#ifdef HAVE_POSTGRES_FE_H
-#include <postgres_fe.h>
-#else
-#error Neither <postgres.h> nor <postgres_fe.h> available
-#endif
-#endif
+#include <server/c.h>
+#include <server/postgres.h>
+#include <server/postgres_fe.h>
 
 #define LEN 20
 #define LINE 80

--- grass-5.0.0/src.contrib/GMSL/g3d/src3d/sites/s.vol.rst/oct.c	Thu Apr 25 03:04:31 2002
+++ grass-5.0.0-patched/src.contrib/GMSL/g3d/src3d/sites/s.vol.rst/oct.c	Tue Oct 29 17:01:55 2002
@@ -27,7 +27,7 @@
 *****************************************************************************/
 
 #include <stdio.h>
-#include <malloc.h>
+#include <stdlib.h>
 #include <math.h>
 
 #include "oct.h"

--- grass-5.0.0/src/raster/r.in.gdal/gbgetsymbol.c	Sat Apr 27 01:05:32 2002
+++ grass-5.0.0-patched/src/raster/r.in.gdal/gbgetsymbol.c	Tue Oct 29 17:26:54 2002
@@ -56,7 +56,6 @@
 /* ==================================================================== */
 /*                  Unix Implementation                                 */
 /* ==================================================================== */
-#if defined(__unix) || defined(__unix__)
 
 #include <dlfcn.h>
 
@@ -96,7 +95,6 @@
     return( pSymbol );
 }
 
-#endif /* def __unix__ && defined(HAVE_DLFCN_H) */
 
 /* ==================================================================== */
 /*                 Windows Implementation                               */
