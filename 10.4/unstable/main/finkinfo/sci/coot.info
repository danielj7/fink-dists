Package: coot
Version: 0.5-pre-1-1280
Revision: 2
GCC: 4.0 
Source: http://www.ysbl.york.ac.uk/~emsley/software/pre-release/coot-0.5-pre-1-revision-1280.tar.gz  
# Source: http://www.ysbl.york.ac.uk/~emsley/software/%n-%v.tar.gz
Source-MD5: 963a00ebde05d0290a5832a8d8986969
SourceDirectory: %n-0.5-pre-1
Source2: http://www.ysbl.york.ac.uk/refmac/data/refmac5.4_dictionary.tar.gz
Source2-MD5: 14b965dc5ab9762c819f632c133998b9
Source3: http://www.ysbl.york.ac.uk/~emsley/software/extras/reference-structures.tar.gz
Source3-MD5: 257ab90d44f1c877ada96720dbb87c13 
#
###############################################################################
Description: Crystallographic molecular graphics
Conflicts: guile, guile-shlibs
DescDetail: <<
Coot stands for Crystallograhic Object Oriented Toolkit. It is a testbest 
toolkit for (Protein) Crystallography. Coot uses professional (and free) 
widgets (with the gui builder glade), mmdb, clipper, and OpenGL, together 
with a new approach to map contouring and importing/creation and other
(modelling) operations. The mmdb, clipper, ssm and mccp4 libraries are now
provided in the ccp4-onlylibs-dev fink package. On-line documentation is 
available from the coot Web site (see below) and is updated regularly.
.
To have an Aqua-like Coot gtk+2 environment, issue the following command:
 echo "include \"%p/share/themes/Glossy_P/gtk-2.0/gtkrc\"">~/.gtkrc-2.0
or simply create a file called ~/.gtkrc-2.0 and put this line in it:
 include \"%p/share/themes/Glossy_P/gtk-2.0/gtkrc\"
.
Install povray and raster3d fink packages to use the F8 key for producing 
ray-traced images.
<<
###############################################################################
Recommends:  povray, ccp4, raster3d                        
BuildDepends: <<
 ccp4-onlylibs-dev  (>= 6.0.99-1),
 atk1 (>= 1.20.0-1)              ,
 cairo (>= 1.6-1)                ,
 expat1                          ,
 fontconfig2-dev (>= 2.4.1-1)    ,
 freetype219 (>= 2.3.5-1)        ,
 freeglut                        ,
 giflib                          ,
 glib2-dev (>= 2.14.0-1)         ,
 glitz                           ,
 gmp			            	 ,
 gsl                             ,
 gtk+2  (>= 2.12.0-1)            ,
 gtk+2-dev (>= 2.12.0-1)         ,
 gtkglext1                       ,
 guile18                         ,
 guile18-dev                     ,
 guile18-lib                     ,
 guile18-gtk-dev (>= 2.0-9)      ,
 guile18-net-http                ,
 imlib                           ,
 libart2 (>= 2.3.16-2)           ,
 libgettext3-dev                 ,
 libglade2 (>= 2.6.2-1)          ,
 libgnomecanvas2-dev (>= 2.20.0) ,
 libiconv-dev                    ,
 libjpeg                         ,
 libpng3                         ,
 librsvg2-gtk (>= 2.20.0-1)      ,
 libtool14		            	 ,
 pango1-xft2-ft219-dev (>= 1.18.4-1) ,
 pixman (>= 0.10.0-1)            ,
 pygtk2-gtk-py25-dev             ,
 python25                        ,
 swig                            ,
 x11-dev                         ,
 xft2-dev
<<
#            
# Note: gtkglext1 IS required at runtime for stereo functionality
Depends: <<
 atk1-shlibs (>= 1.20.0-1)        ,             
 coot-shlibs (= %v-%r)            ,
 freeglut-shlibs                  ,
 giflib-shlibs                    ,
 glib2-shlibs (>= 2.14.0-1)       ,
 gmp-shlibs                       , 
 gnome-themes-glossy-p            ,
 gsl-shlibs                       ,
 gtk+2-shlibs (>= 2.12.0-1)       ,
 gtkglext1-shlibs                 ,
 gtkglext1                        ,
 guile18                          ,
 guile18-goosh (>= 1.3-2)         ,
 guile18-gtk        (>= 2.0-9)    ,
 guile18-gtk-shlibs (>= 2.0-9)    ,
 guile18-gui                      ,
 guile18-lib                      ,
 guile18-shlibs                   ,
 guile18-www                      ,
 guile18-net-http                 ,
 imlib-shlibs                     ,
 libart2-shlibs                   ,
 libgettext3-shlibs               ,
 libgnomecanvas2-shlibs (>= 2.20.0),
 libiconv                         ,
 libjpeg-shlibs                   ,
 libpng3-shlibs                   ,
 librsvg2-shlibs (>= 2.20.0-1)    ,
 libtiff-shlibs                   ,
 libtool14-shlibs                 ,
 librsvg2-gtk  (>= 2.20.0-1)      ,
 pango1-xft2-ft219-shlibs (>= 1.18.4-1) ,
 pygtk2-gtk-py25                  ,
 python25                         ,
 x11
<<
#
###############################################################################
BuildDependsOnly: false
NoSetLDFLAGS: true
Patch: %n.patch
PatchScript:  <<
#!/bin/zsh -exf
if [[ $(sw_vers -productVersion) < 10.5 ]]; then
    :
else
    patch -p1 < %a/%n-10.5.patch
fi
perl -pi.bak -e 's|use-modules \(goosh\)|use-modules \(goosh goosh\)|g' scheme/coot-utils.scm
#perl -pi.bak -e 's/include <malloc.h>//g' **/*.c
# Use the correct povray directory
perl -pi.bak -e 's|povray-3.5|povray-3.6|g' scheme/povray.scm
# Use "open" to display the png snapshot in Preview.app (or the user's default application)
perl -pi.bak -e 's|coot-png-display-program \"display\"|coot-png-display-program \"open\"|g' scheme/raster3d.scm
# This is required to get the map displayed on both sides of side-by-side stereo
echo "(set-display-lists-for-maps 0)"  >>| scheme/group-settings.scm
# Fix configure to work with gpp4 library instead of ccp4c
# perl -pi -e 's|ccp4c|gpp4|g' configure
#perl -pi.bak -e 's|2.8.0|2.6.0|g' configure
# perl -pi.bak -e 's|have_glut=no|have_glut=yes|g' configure
perl -pi.bak -e 's|have_goosh=no|have_goosh=yes|g' configure
# perl -pi.bak -e 's|have_guile_gui=no|have_guile_gui=yes|g' configure
perl -pi -e "s|guile-config|guile-1.8-config|g" configure
perl -pi -e 's|\(goosh\)|\(goosh goosh\)|g' configure
###
<<
###############################################################################
ConfigureParams: <<  
--with-mmdb-prefix=%p/share/xtal/ccp4-onlylibs-dev-6.0.99 --with-clipper-prefix=%p/share/xtal/ccp4-onlylibs-dev-6.0.99  --with-fftw=%p/share/xtal/ccp4-onlylibs-dev-6.0.99 \
--with-glut-prefix=%p --with-gl-prefix=/usr/X11R6 --with-gtk2 \
--with-gnomecanvas-prefix=%p --with-ssmlib-prefix=%p/share/xtal/ccp4-onlylibs-dev-6.0.99  \
--with-imlib-prefix=%p --with-gtkgl-prefix=%p --with-glib-prefix=%p \
--with-guile-gtk --with-guile-gtk-prefix=%p  \
--with-gsl-prefix=%p --with-guile --with-python 
<<
###############################################################################
CompileScript: <<
#!/bin/zsh -efv
# set -x
export PATH=%p/bin:%p/share/guile/1.8/scripts/binoverride:$PATH:%p/share/guile/1.8/goosh
export SED=/usr/bin/sed
export COOT_REFMAC_LIB_DIR=%p/share/coot/lib
export PKG_CONFIG_PATH=%p/lib/pango-ft219/lib/pkgconfig:%p/lib/fontconfig2/lib/pkgconfig:%p/lib/freetype219/lib/pkgconfig:${PKG_CONFIG_PATH}
FLIBS="-L%p/lib" \
CPPFLAGS="-I%p/share/xtal/ccp4-onlylibs-dev-6.0.99/include -I%p/share/xtal/ccp4-onlylibs-dev-6.0.99/lib -I%p/share/xtal/ccp4-onlylibs-dev-6.0.99/lib/ssm -I%p/include -I/usr/X11R6/include" \
LDFLAGS="-Wl,-dylib_file,%p/lib/pango-ft219/lib/libpango-1.0.dylib:%p/lib/pango-ft219/lib/libpangocairo-1.0.dylib:%p/lib/pango-ft219/lib/libpangoft2-1.0.dylib:%p/lib/pango-ft219/lib/libpangox-1.0.dylib:%p/lib/pango-ft219/lib/libpangoxft-1.0.dylib -L%p/lib/pango-ft219/lib  -L%p/share/xtal/ccp4-onlylibs-dev-6.0.99/lib -L%p/lib -L/usr/lib -lSystemStubs -flat_namespace -L/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries" \
CXX="/usr/bin/g++" \
CC="/usr/bin/gcc" \
PYTHON=%p/bin/python2.5 \
DYLD_LIBRARY_PATH="" \
./configure %c
# py_path="%p/bin/python2.5" \
#
#remake the  src/coot_wrap_python.cc and src/coot_wrap_guile.cc files
   /bin/rm -f **/coot_wrap_**.cc
   cd src
   touch c-interface-database.hh
   make coot_wrap_guile.cc
   make coot_wrap_python.cc
   cp coot_wrap_guile_pre.cc coot_wrap_guile.cc
   cd ..
   make
<<
###############################################################################
InstallScript: <<
#!/bin/zsh -efv
export PATH=%p/bin:%p/share/guile/1.8/scripts/binoverride:$PATH
export SED=/usr/bin/sed
export COOT_REFMAC_LIB_DIR=%p/share/coot/lib
cp src/coot.py python/coot.py
make install prefix=%i
#
# Clean up the 120 MB  mess, which zsh makes so much fun:
/bin/rm -f **/*.o
# enable coot to use its own refmac library:
#
perl -pi.bak -e 's|\# COOT_REFMAC_LIB|COOT_REFMAC_LIB|g' setup/coot.sh
perl -pi.bak -e 's|\# export COOT_REFMAC_LIB_DIR|export COOT_REFMAC_LIB_DIR|g' setup/coot.sh  
perl -pi.bak -e 's|\# setenv COOT_REFMAC_LIB_DIR|setenv COOT_REFMAC_LIB_DIR|g' setup/coot.csh  
#
# Add ancillary files to %i/share/coot:
#
mkdir -p %i/share/coot/etc
mkdir -p %i/share/coot/python
cp src/coot.py %i/share/coot/python/coot.py
cp -R setup %i/share/coot/. 
# This installs the refmac monomer library
mkdir -p %i/share/coot/lib/data
cp -R ../dic %i/share/coot/lib/data/monomers
# cp %i/share/coot/etc/python/coot.py %i/share/coot/python/.
# Reference structures should be in %i/share/coot/reference-structures
cp -R ../reference-structures %i/share/coot/.
cp -R * %i/share/coot/etc/.
# Get rid of spurious, wrongly placed directory
rm -rf %i/setup
# The new wrapper creates problems.  Get rid of it.
# Clean up the rest of the mess.
/bin/rm -f %i/bin/coot
cp %i/bin/coot-real %i/bin/coot
/bin/rm -f %i/bin/coot-real 
/bin/rm -rf %i/include
/bin/rm -rf %i/**/.libs
<<
RuntimeVars: COOT_REFMAC_LIB_DIR: %p/share/coot/lib
###############################################################################
DocFiles: README AUTHORS NEWS COPYING ABOUT-NLS BUGS TODO
License: GPL
Maintainer: W. G. Scott <wgscott@users.sourceforge.net> 
Homepage: http://www.ysbl.york.ac.uk/~emsley/coot/doc/user-manual.html 
###############################################################################
#
SplitOff: <<
Package: %N-shlibs
Files: <<
lib/libccp4mg-*.dylib  
lib/libcoot-*.dylib  
lib/libcootaneer*.dylib
<<
	Shlibs: <<
		%p/lib/libccp4mg-surface.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libccp4mg-utils.0.dylib 				1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-analysis.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-AngleInfo.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-atomutils.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-cabuild.0.dylib 				1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-compat.0.dylib 				1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-coord-extras.0.dylib 		1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-coord-utils.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-coords.0.dylib 				1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-db-main.0.dylib 				1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-geometry.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-high-res.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-ideal.0.dylib 				1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-isosurface.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-ligand.0.dylib 				1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-map-heavy.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-map-utils.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-mini-mol.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-mmtz-extras.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-sequence-view.0.dylib 		1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-shelx.0.dylib 				1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-skeleton.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-surface.0.dylib 				1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-tw.0.dylib 					1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-utils.0.dylib 				1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-wrap-guile.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcoot-wrap-python.0.dylib 			1.0.0 %n (>= 0.5-pre-1-1280-1)
		%p/lib/libcootaneer.0.dylib					1.0.0 %n (>= 0.5-pre-1-1280-1)
	<<
DocFiles: README AUTHORS NEWS COPYING ABOUT-NLS BUGS TODO
<< 
#
###############################################################################
#
SplitOff2: <<
Package: %N-dev
Depends: %N (= %v-%r)
BuildDependsOnly: True
Files: <<   
lib/*.a
lib/*.la
<<
DocFiles: README AUTHORS NEWS COPYING ABOUT-NLS BUGS TODO
<<
###############################################################################
