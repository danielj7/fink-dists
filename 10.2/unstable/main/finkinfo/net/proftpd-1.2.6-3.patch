diff -ruN proftpd-1.2.6.orig/README.PAM proftpd-1.2.6/README.PAM
--- proftpd-1.2.6.orig/README.PAM	2000-08-18 14:16:40.000000000 -0600
+++ proftpd-1.2.6/README.PAM	2002-10-25 10:18:19.000000000 -0600
@@ -33,18 +33,18 @@
 following lines for RedHat installations:
 
 #%PAM-1.0
-auth       required     /lib/security/pam_listfile.so item=user sense=deny file=/etc/ftpusers onerr=succeed
-auth       required     /lib/security/pam_pwdb.so shadow nullok
-account    required     /lib/security/pam_pwdb.so
-session    required     /lib/security/pam_pwdb.so
+auth       required     /lib/pam/pam_listfile.so item=user sense=deny file=/etc/ftpusers onerr=succeed
+auth       required     /lib/pam/pam_pwdb.so shadow nullok
+account    required     /lib/pam/pam_pwdb.so
+session    required     /lib/pam/pam_pwdb.so
 
 For SuSE:
 
 #%PAM-1.0
-auth       required     /lib/security/pam_listfile.so item=user sense=deny file=/etc/ftpusers onerr=succeed
-auth       required     /lib/security/pam_unix.so shadow nullok
-account    required     /lib/security/pam_unix.so
-session    required     /lib/security/pam_unix.so
+auth       required     /lib/pam/pam_listfile.so item=user sense=deny file=/etc/ftpusers onerr=succeed
+auth       required     /lib/pam/pam_unix.so shadow nullok
+account    required     /lib/pam/pam_unix.so
+session    required     /lib/pam/pam_unix.so
 
 These settings are valid for RedHat and SuSE Linux systems.  Other Linux
 distributions may differ.
diff -ruN proftpd-1.2.6.orig/config.h.in proftpd-1.2.6/config.h.in
--- proftpd-1.2.6.orig/config.h.in	2002-06-27 16:36:25.000000000 -0600
+++ proftpd-1.2.6/config.h.in	2002-10-25 10:29:09.000000000 -0600
@@ -351,8 +351,8 @@
 /* Define if you have the <regex.h> header file.  */
 #undef HAVE_REGEX_H
 
-/* Define if you have the <security/pam_appl.h> header file.  */
-#undef HAVE_SECURITY_PAM_APPL_H
+/* Define if you have the <pam/pam_appl.h> header file.  */
+#undef HAVE_PAM_PAM_APPL_H
 
 /* Define if you have the <shadow.h> header file.  */
 #undef HAVE_SHADOW_H
diff -ruN proftpd-1.2.6.orig/configure proftpd-1.2.6/configure
--- proftpd-1.2.6.orig/configure	2002-07-02 18:30:37.000000000 -0600
+++ proftpd-1.2.6/configure	2002-10-25 10:18:19.000000000 -0600
@@ -5293,7 +5293,7 @@
 
 if test x"$enable_pam" != xno ; then
 
-for ac_header in security/pam_appl.h
+for ac_header in pam/pam_appl.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
 if eval "test \"\${$as_ac_Header+set}\" = set"; then
diff -ruN proftpd-1.2.6.orig/configure.in proftpd-1.2.6/configure.in
--- proftpd-1.2.6.orig/configure.in	2002-07-02 18:25:28.000000000 -0600
+++ proftpd-1.2.6/configure.in	2002-10-25 10:18:19.000000000 -0600
@@ -293,7 +293,7 @@
 dnl really shouldn't have anything to do with force_shadow or use_shadow.
 dnl jss - 2/22/2001
 if test x"$enable_pam" != xno ; then
-  AC_CHECK_HEADERS(security/pam_appl.h,
+  AC_CHECK_HEADERS(pam/pam_appl.h,
     [ if test `echo $ac_addl_modules | grep -c mod_pam` = "0"; then
         ac_addl_modules="mod_pam.o $ac_addl_modules"
         ac_build_addl_modules="modules/mod_pam.o $ac_build_addl_modules"
diff -ruN proftpd-1.2.6.orig/contrib/README.linux-privs proftpd-1.2.6/contrib/README.linux-privs
--- proftpd-1.2.6.orig/contrib/README.linux-privs	1998-10-17 20:24:41.000000000 -0600
+++ proftpd-1.2.6/contrib/README.linux-privs	2002-10-25 10:18:19.000000000 -0600
@@ -7,7 +7,7 @@
 security model under Linux.  Documentation on the project as a whole
 can be found at:
 
-ftp://linux.kernel.org/pub/linux/libs/security/linux-privs
+ftp://linux.kernel.org/pub/linux/libs/pam/linux-privs
 
 Without going into gory detail, POSIX.1e basically specifies an interface
 to such goodies as capabilities, capability sets, access control lists,
diff -ruN proftpd-1.2.6.orig/contrib/dist/rpm/ftp.pamd proftpd-1.2.6/contrib/dist/rpm/ftp.pamd
--- proftpd-1.2.6.orig/contrib/dist/rpm/ftp.pamd	2002-05-18 09:06:22.000000000 -0600
+++ proftpd-1.2.6/contrib/dist/rpm/ftp.pamd	2002-10-25 10:18:19.000000000 -0600
@@ -1,6 +1,6 @@
 #%PAM-1.0
-auth       required	/lib/security/pam_listfile.so item=user sense=deny file=/etc/ftpusers onerr=succeed
-auth       required	/lib/security/pam_pwdb.so shadow nullok
+auth       required	/lib/pam/pam_listfile.so item=user sense=deny file=/etc/ftpusers onerr=succeed
+auth       required	/lib/pam/pam_pwdb.so shadow nullok
 
 # If this is enabled, anonymous logins will fail because the 'ftp' user does
 # not have a "valid" shell, as listed in /etc/shells.
@@ -8,7 +8,7 @@
 # If you enable this, it is recommended that you do *not* give the 'ftp'
 # user a real shell. Instead, give the 'ftp' user /bin/false for a shell and
 # add /bin/false to /etc/shells.
-#auth       required	/lib/security/pam_shells.so
+#auth       required	/lib/pam/pam_shells.so
 
-account    required	/lib/security/pam_pwdb.so
-session    required	/lib/security/pam_pwdb.so
+account    required	/lib/pam/pam_pwdb.so
+session    required	/lib/pam/pam_pwdb.so
diff -ruN proftpd-1.2.6.orig/contrib/libcap/Makefile proftpd-1.2.6/contrib/libcap/Makefile
--- proftpd-1.2.6.orig/contrib/libcap/Makefile	1999-09-11 18:08:25.000000000 -0600
+++ proftpd-1.2.6/contrib/libcap/Makefile	2002-10-25 10:18:19.000000000 -0600
@@ -1,5 +1,5 @@
 ## This libcap (for proftpd) is originally from libcap-1.03,
-## at ftp://linux.kernel.org/pub/libs/security/linux-privs.
+## at ftp://linux.kernel.org/pub/libs/pam/linux-privs.
 ## This interface is SPECIFIC TO THE LINUX 2.2 KERNEL!!!  IT IS NOT GUARANTEED
 ## TO WORK ON ANY PRIOR OR LATER VERSION (ie: 2.1.x or 2.3.x).
 ## If this library stops working, please contact proftpd@proftpd.net.
diff -ruN proftpd-1.2.6.orig/contrib/mod_wrap.html proftpd-1.2.6/contrib/mod_wrap.html
--- proftpd-1.2.6.orig/contrib/mod_wrap.html	2002-02-14 09:39:18.000000000 -0700
+++ proftpd-1.2.6/contrib/mod_wrap.html	2002-10-25 10:18:19.000000000 -0600
@@ -22,7 +22,7 @@
 <p>
 If not installed on your system, the TCP wrappers library, required by this
 module, can be found
-<a href="ftp://ftp.porcupine.org/pub/security/tcp_wrappers_7.6.tar.gz">here</a>,
+<a href="ftp://ftp.porcupine.org/pub/pam/tcp_wrappers_7.6.tar.gz">here</a>,
 on Wietse Venema's site.  Once installed, it <i>highly recommended</code>
 that the <code>hosts_access(3)</code> and <code>hosts_access(5)</code> man
 pages be read and understood.  The <a href="#Installation">installation</a>
diff -ruN proftpd-1.2.6.orig/doc/faq.html proftpd-1.2.6/doc/faq.html
--- proftpd-1.2.6.orig/doc/faq.html	2002-05-12 15:02:04.000000000 -0600
+++ proftpd-1.2.6/doc/faq.html	2002-10-25 10:18:19.000000000 -0600
@@ -2431,8 +2431,8 @@
 >	  <PRE
 CLASS="PROGRAMLISTING"
 >            PAM(exit): Permission denied
-            open_module: stat(/usr/lib/security/pam_unix.so.1) failed: No such file or directory
-            load_modules: can not open module /usr/lib/security/pam_unix.so.1
+            open_module: stat(/usr/lib/pam/pam_unix.so.1) failed: No such file or directory
+            load_modules: can not open module /usr/lib/pam/pam_unix.so.1
             PAM(exit): Dlopen failure.
           </PRE
 ></P
@@ -3994,11 +3994,11 @@
 ><PRE
 CLASS="PROGRAMLISTING"
 >#%PAM-1.0
-auth       required     /lib/security/pam_listfile.so item=user
+auth       required     /lib/pam/pam_listfile.so item=user
 sense=deny file=/etc/ftpusers onerr=succeed
-auth       required     /lib/security/pam_pwdb.so shadow nullok
-account    required     /lib/security/pam_pwdb.so
-session    required     /lib/security/pam_pwdb.so
+auth       required     /lib/pam/pam_pwdb.so shadow nullok
+account    required     /lib/pam/pam_pwdb.so
+session    required     /lib/pam/pam_pwdb.so
           </PRE
 ><H3
 CLASS="BRIDGEHEAD"
@@ -4016,16 +4016,16 @@
 #%PAM-1.0
 
 # Uncomment this to achieve what used to be ftpd -A.
-# auth       required     /lib/security/pam_listfile.so item=user sense=allow file=/etc/ftpchroot onerr=fail
+# auth       required     /lib/pam/pam_listfile.so item=user sense=allow file=/etc/ftpchroot onerr=fail
 
-auth     required       /lib/security/pam_listfile.so item=user
+auth     required       /lib/pam/pam_listfile.so item=user
 sense=deny file=/etc/ftpusers onerr=succeed
-auth     sufficient     /lib/security/pam_ftp.so
-auth     required       /lib/security/pam_unix.so
-auth     required       /lib/security/pam_shells.so
-account  required       /lib/security/pam_unix.so
-password required       /lib/security/pam_unix.so
-session  required       /lib/security/pam_unix.so
+auth     sufficient     /lib/pam/pam_ftp.so
+auth     required       /lib/pam/pam_unix.so
+auth     required       /lib/pam/pam_shells.so
+account  required       /lib/pam/pam_unix.so
+password required       /lib/pam/pam_unix.so
+session  required       /lib/pam/pam_unix.so
           </PRE
 ><H3
 CLASS="BRIDGEHEAD"
diff -ruN proftpd-1.2.6.orig/include/default_paths.h proftpd-1.2.6/include/default_paths.h
--- proftpd-1.2.6.orig/include/default_paths.h	2002-06-23 13:03:22.000000000 -0600
+++ proftpd-1.2.6/include/default_paths.h	2002-10-25 10:18:19.000000000 -0600
@@ -36,7 +36,7 @@
  * ftpcount, ftpwho, etc.
  */
 #ifndef RUN_DIR
-#define RUN_DIR			"/var/run/proftpd"
+#define RUN_DIR			"@FINKPREFIX@/var/run/proftpd"
 #endif
 
 /* The location you wish to place any core files produced as a result of
@@ -50,14 +50,14 @@
  * when run in standalone daemon mode.
  */
 #ifndef PID_FILE_PATH
-#define PID_FILE_PATH		"/var/run/proftpd.pid"
+#define PID_FILE_PATH		"@FINKPREFIX@/var/run/proftpd.pid"
 #endif
 
 /* The default location of the proftpd configuration file.  Can be
  * overriden at runtime with the '-c' switch
  */
 #ifndef CONFIG_FILE_PATH
-#define	CONFIG_FILE_PATH	"/etc/proftpd.conf"
+#define	CONFIG_FILE_PATH	"@FINKPREFIX@/etc/proftpd.conf"
 #endif
 
 /* The location of your `shells' file; a newline delimited list of
@@ -70,17 +70,17 @@
  * log files.  These can be overridden in the configuration file via
  * "TransferLog" and "ExtendedLog".  (note ExtendedLog does not work yet)
  */
-#define XFERLOG_PATH		"/var/log/xferlog"
-#define EXTLOG_PATH		"/var/log/proftpd-log"
+#define XFERLOG_PATH		"@FINKPREFIX@/var/log/xferlog"
+#define EXTLOG_PATH		"@FINKPREFIX@/var/log/proftpd-log"
 
 /* Location of the file that tells proftpd to discontinue servicing
  * requests.
  */
-#define SHUTMSG_PATH		"/etc/shutmsg"
+#define SHUTMSG_PATH		"@FINKPREFIX@/etc/shutmsg"
 
 /* Location of the file containing users that *cannot* use ftp
  * services (odd, eh?)
  */
-#define FTPUSERS_PATH		"/etc/ftpusers"
+#define FTPUSERS_PATH		"@FINKPREFIX@/etc/ftpusers"
 
 #endif /* PROFTPD_PATHS_H */
diff -ruN proftpd-1.2.6.orig/modules/mod_pam.c proftpd-1.2.6/modules/mod_pam.c
--- proftpd-1.2.6.orig/modules/mod_pam.c	2002-07-18 17:01:44.000000000 -0600
+++ proftpd-1.2.6/modules/mod_pam.c	2002-10-25 10:29:10.000000000 -0600
@@ -43,9 +43,9 @@
 
 #ifdef HAVE_PAM
 
-#ifdef HAVE_SECURITY_PAM_APPL_H
-#include <security/pam_appl.h>
-#endif /* HAVE_SECURITY_PAM_APPL_H */
+#ifdef HAVE_PAM_PAM_APPL_H
+#include <pam/pam_appl.h>
+#endif /* HAVE_PAM_PAM_APPL_H */
 
 static pam_handle_t *	pamh			= NULL;
 static char *		pamconfig		= "ftp";
diff -ruN proftpd-1.2.6.orig/src/auth.c proftpd-1.2.6/src/auth.c
--- proftpd-1.2.6.orig/src/auth.c	2002-06-25 10:37:36.000000000 -0600
+++ proftpd-1.2.6/src/auth.c	2002-10-25 10:18:19.000000000 -0600
@@ -498,7 +498,7 @@
     /* Note: the number of groups returned should, barring error,
      * always be at least 1, as per getgroups(2) behavior.  This one
      * ID is present because it is the primary group membership set in
-     * struct passwd, from /etc/passwd.  This will need to be documented
+     * struct passwd, from @FINKPREFIX@/etc/passwd.  This will need to be documented
      * for the benefit of auth_getgroup() implementors.
      */
   }
diff -ruN proftpd-1.2.6.orig/src/dirtree.c proftpd-1.2.6/src/dirtree.c
--- proftpd-1.2.6.orig/src/dirtree.c	2002-08-28 10:00:22.000000000 -0600
+++ proftpd-1.2.6/src/dirtree.c	2002-10-25 10:18:19.000000000 -0600
@@ -376,10 +376,10 @@
 
     /* Perform a fixup on configuration directives so that:
      * -argv[0]--  -argv[1]-- ----argv[2]-----
-     * <Option     /etc/adir  /etc/anotherdir>
+     * <Option     @FINKPREFIX@/etc/adir  @FINKPREFIX@/etc/anotherdir>
      *   .. becomes ..
      * -argv[0]--  -argv[1]-  ----argv[2]----
-     * <Option>    /etc/adir  /etc/anotherdir
+     * <Option>    @FINKPREFIX@/etc/adir  @FINKPREFIX@/etc/anotherdir
      */
 
     if(new_cmd->argc && *(new_cmd->argv[0]) == '<') {
@@ -1961,11 +1961,11 @@
        * Just a partial match on the pathname does not mean that the longer
        * path is the subdirectory of the other -- they might just be sharing
        * the last path component! 
-       * /var/www/.1
-       * /var/www/.14
+       * @FINKPREFIX@/var/www/.1
+       * @FINKPREFIX@/var/www/.14
        *            ^ -- not /, not subdir
-       * /var/www/.1
-       * /var/www/.1/images
+       * @FINKPREFIX@/var/www/.1
+       * @FINKPREFIX@/var/www/.1/images
        *            ^ -- /, is subdir
        */
       if (strlen(path) > len && path[len] != '/')
diff -ruN proftpd-1.2.6.orig/src/ftpcount.1 proftpd-1.2.6/src/ftpcount.1
--- proftpd-1.2.6.orig/src/ftpcount.1	2002-06-22 01:02:29.000000000 -0600
+++ proftpd-1.2.6/src/ftpcount.1	2002-10-25 10:18:20.000000000 -0600
@@ -29,11 +29,11 @@
 proftpd's scoreboard.
 .SH FILES
 .PD 0
-.B /usr/bin/ftpcount
+.B @FINKPREFIX@/usr/bin/ftpcount
 .br
-.B /var/run/proftpd-[pid]
+.B @FINKPREFIX@/var/run/proftpd-[pid]
 .br
-.B /var/run/proftpd-inetd
+.B @FINKPREFIX@/var/run/proftpd-inetd
 .PD
 .SH AUTHORS
 .PP
diff -ruN proftpd-1.2.6.orig/src/ftpcount.c proftpd-1.2.6/src/ftpcount.c
--- proftpd-1.2.6.orig/src/ftpcount.c	2002-06-23 13:03:24.000000000 -0600
+++ proftpd-1.2.6/src/ftpcount.c	2002-10-25 10:18:20.000000000 -0600
@@ -24,7 +24,7 @@
  * the source code for OpenSSL in the source distribution.
  */
 
-/* Shows a count of "who" is online via proftpd.  Uses the /var/run/proftpd*
+/* Shows a count of "who" is online via proftpd.  Uses the @FINKPREFIX@/var/run/proftpd*
  * log files.
  *
  * $Id: ftpcount.c,v 1.14 2002/06/23 19:03:24 castaglia Exp $
diff -ruN proftpd-1.2.6.orig/src/ftpshut.8 proftpd-1.2.6/src/ftpshut.8
--- proftpd-1.2.6.orig/src/ftpshut.8	2002-06-22 01:02:29.000000000 -0600
+++ proftpd-1.2.6/src/ftpshut.8	2002-10-25 10:18:20.000000000 -0600
@@ -21,7 +21,7 @@
 command provides an automated shutdown procedure that a superuser
 can use to automagically disconnect current proftpd connections,
 and deny new connections.  The command creates a control file as
-.B /etc/shutmsg
+.B @FINKPREFIX@/etc/shutmsg
 to inform proftpd processes about an impending shutdown.
 .SH OPTIONS
 .TP 10
@@ -97,9 +97,9 @@
 until the indicated time on the following day.
 .SH FILES
 .PD 0
-.B /usr/sbin/ftpshut
+.B @FINKPREFIX@/usr/sbin/ftpshut
 .br
-.B /etc/shutmsg
+.B @FINKPREFIX@/etc/shutmsg
 .PD
 .SH AUTHORS
 .PP
diff -ruN proftpd-1.2.6.orig/src/ftpwho.1 proftpd-1.2.6/src/ftpwho.1
--- proftpd-1.2.6.orig/src/ftpwho.1	2002-06-22 01:02:30.000000000 -0600
+++ proftpd-1.2.6/src/ftpwho.1	2002-10-25 10:18:20.000000000 -0600
@@ -32,11 +32,11 @@
 host and current working directory.
 .SH FILES
 .PD 0
-.B /usr/bin/ftpwho
+.B @FINKPREFIX@/usr/bin/ftpwho
 .br
-.B /var/run/proftpd-[pid]
+.B @FINKPREFIX@/var/run/proftpd-[pid]
 .br
-.B /var/run/proftpd-inetd
+.B @FINKPREFIX@/var/run/proftpd-inetd
 .PD
 .SH AUTHORS
 .PP
diff -ruN proftpd-1.2.6.orig/src/ftpwho.c proftpd-1.2.6/src/ftpwho.c
--- proftpd-1.2.6.orig/src/ftpwho.c	2002-06-23 13:03:24.000000000 -0600
+++ proftpd-1.2.6/src/ftpwho.c	2002-10-25 10:18:20.000000000 -0600
@@ -24,7 +24,7 @@
  * the source code for OpenSSL in the source distribution.
  */
 
-/* Shows "who" is online via proftpd.  Uses the /var/run/proftpd* log files.
+/* Shows "who" is online via proftpd.  Uses the @FINKPREFIX@/var/run/proftpd* log files.
  * 
  * $Id: ftpwho.c,v 1.3 2002/06/23 19:03:24 castaglia Exp $
  */
diff -ruN proftpd-1.2.6.orig/src/main.c proftpd-1.2.6/src/main.c
--- proftpd-1.2.6.orig/src/main.c	2002-08-30 18:08:39.000000000 -0600
+++ proftpd-1.2.6/src/main.c	2002-10-25 10:18:20.000000000 -0600
@@ -1634,7 +1634,7 @@
     }
 
     /* If running (a flag signaling whether proftpd is just starting up)
-     * AND shutdownp (a flag signalling the present of /etc/shutmsg) are
+     * AND shutdownp (a flag signalling the present of @FINKPREFIX@/etc/shutmsg) are
      * true, then log an error stating this -- but don't stop the server.
      */
     if(shutdownp && !running) {
diff -ruN proftpd-1.2.6.orig/src/proftpd.8 proftpd-1.2.6/src/proftpd.8
--- proftpd-1.2.6.orig/src/proftpd.8	2002-06-22 01:02:30.000000000 -0600
+++ proftpd-1.2.6/src/proftpd.8	2002-10-25 10:18:20.000000000 -0600
@@ -30,7 +30,7 @@
 option, the main
 .B proftpd
 daemon writes its process ID to
-.B /var/run/proftpd.pid
+.B @FINKPREFIX@/var/run/proftpd.pid
 to make it easy to know which process to SIGHUP.
 .SH OPTIONS
 .TP 12
@@ -61,7 +61,7 @@
 .TP
 .BI \-c,\--config " config\-file"
 Specifies an alternate \fIconfig\-file\fP to be parsed at startup, rather
-than the default (typically found in \fB/etc/proftpd.conf\fP).
+than the default (typically found in \fB@FINKPREFIX@/etc/proftpd.conf\fP).
 .TP
 .BI \-t,\--configtest
 Read the configuration file, report any syntax errors, and exit.
@@ -76,21 +76,21 @@
 Lists all modules compiled into proftpd.
 .SH FILES
 .PD 0
-.B /usr/sbin/proftpd
+.B @FINKPREFIX@/usr/sbin/proftpd
 .br
-.B /usr/bin/ftpwho
+.B @FINKPREFIX@/usr/bin/ftpwho
 .br
-.B /usr/bin/ftpcount
+.B @FINKPREFIX@/usr/bin/ftpcount
 .br
-.B /usr/sbin/ftpshut
+.B @FINKPREFIX@/usr/sbin/ftpshut
 .br
-.B /var/log/xferlog
+.B @FINKPREFIX@/var/log/xferlog
 .br
-.B /var/run/proftpd-[pid]
+.B @FINKPREFIX@/var/run/proftpd-[pid]
 .br
-.B /var/run/proftpd.pid
+.B @FINKPREFIX@/var/run/proftpd.pid
 .br
-.B /var/run/proftpd-inetd
+.B @FINKPREFIX@/var/run/proftpd-inetd
 .PD
 .SH AUTHORS
 .PP
diff -ruN proftpd-1.2.6.orig/src/xferlog.5 proftpd-1.2.6/src/xferlog.5
--- proftpd-1.2.6.orig/src/xferlog.5	2001-08-01 09:17:07.000000000 -0600
+++ proftpd-1.2.6/src/xferlog.5	2002-10-25 10:18:20.000000000 -0600
@@ -7,7 +7,7 @@
 .B xferlog
 file contains logging information from the FTP server daemon,
 .BR proftpd (8).
-This file usually is found in /var/log, but can be located anywhere by
+This file usually is found in @FINKPREFIX@/var/log, but can be located anywhere by
 using a
 .BR proftpd (8)
 configuration directive.
@@ -154,7 +154,7 @@
 .SH FILES
 .PD 0
 .TP 20
-.B /var/log/xferlog
+.B @FINKPREFIX@/var/log/xferlog
 .PP
 .PD
 .SH AUTHORS
