--- numpy/numpy/distutils/fcompiler/gnu.py.orig	2006-01-07 07:19:24.000000000 -0700
+++ numpy/numpy/distutils/fcompiler/gnu.py	2006-01-07 07:21:59.000000000 -0700
@@ -29,7 +29,8 @@
         'compiler_f77' : [fc_exe,"-Wall","-fno-second-underscore"],
         'compiler_f90' : None,
         'compiler_fix' : None,
-        'linker_so'    : [fc_exe,"-Wall"],
+#       'linker_so'    : [fc_exe,"-Wall"],
+        'linker_so'    : [fc_exe+" -undefined dynamic_lookup -bundle"],
         'archiver'     : ["ar", "-cr"],
         'ranlib'       : ["ranlib"],
         'linker_exe'   : [fc_exe,"-Wall"]
@@ -64,7 +65,7 @@
             os.environ['MACOSX_DEPLOYMENT_TARGET'] = '%s.%s' % (major,
                 minor)
             
-            opt.extend(['-undefined', 'dynamic_lookup', '-bundle'])
+            #opt.extend(['-undefined', 'dynamic_lookup', '-bundle'])
         else:
             opt.append("-shared")
         if sys.platform[:5]=='sunos':
@@ -108,7 +109,11 @@
         if g2c is not None:
             opt.append(g2c)
         if sys.platform == 'darwin':
-            opt.append('cc_dynamic')
+            #opt.append('cc_dynamic')
+            import platform
+            opt = []
+            if platform.mac_ver()[0] < 10.4:
+                opt.append('cc_dynamic')
         return opt
 
     def get_flags_debug(self):
@@ -224,7 +229,8 @@
         'compiler_f77' : [fc_exe,"-Wall","-ffixed-form","-fno-second-underscore"],
         'compiler_f90' : [fc_exe,"-Wall","-fno-second-underscore"],
         'compiler_fix' : [fc_exe,"-Wall","-ffixed-form","-fno-second-underscore"],
-        'linker_so'    : [fc_exe,"-Wall"],
+        #'linker_so'    : [fc_exe,"-Wall"],
+        'linker_so'    : [fc_exe+" -undefined dynamic_lookup -bundle"],
         'archiver'     : ["ar", "-cr"],
         'ranlib'       : ["ranlib"],
         'linker_exe'   : [fc_exe,"-Wall"]
--- numpy/numpy/distutils/fcompiler/ibm.py.orig	2006-01-07 07:19:32.000000000 -0700
+++ numpy/numpy/distutils/fcompiler/ibm.py	2006-01-07 07:23:10.000000000 -0700
@@ -15,7 +15,8 @@
         'compiler_f77' : ["xlf"],
         'compiler_fix' : ["xlf90", "-qfixed"],
         'compiler_f90' : ["xlf90"],
-        'linker_so'    : ["xlf95"],
+        #'linker_so'    : ["xlf95"],
+        'linker_so'    : ["xlf95 -undefined dynamic_lookup -bundle"],
         'archiver'     : ["ar", "-cr"],
         'ranlib'       : ["ranlib"]
         }
@@ -45,7 +46,8 @@
     def get_flags_linker_so(self):
         opt = []
         if sys.platform=='darwin':
-            opt.append('-Wl,-bundle,-flat_namespace,-undefined,suppress')
+            #opt.append('-Wl,-bundle,-flat_namespace,-undefined,suppress')
+            pass
         else:
             opt.append('-bshared')
         version = self.get_version(ok_status=[0,40])
--- numpy/numpy/distutils/fcompiler/g95.py.orig	2006-01-07 07:26:45.000000000 -0700
+++ numpy/numpy/distutils/fcompiler/g95.py	2006-01-07 07:23:39.000000000 -0700
@@ -16,7 +16,8 @@
         'compiler_f77' : ["g95", "-ffixed-form"],
         'compiler_fix' : ["g95", "-ffixed-form"],
         'compiler_f90' : ["g95"],
-        'linker_so'    : ["g95","-shared"],
+        #'linker_so'    : ["g95","-shared"],
+        'linker_so'    : ["g95 -undefined dynamic_lookup -bundle"],
         'archiver'     : ["ar", "-cr"],
         'ranlib'       : ["ranlib"]
         }
