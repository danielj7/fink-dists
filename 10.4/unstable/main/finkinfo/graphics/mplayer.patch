diff -rauN MPlayer-1.0rc2/libmpdemux/demux_audio.c MPlayer-1.0rc2-p1/libmpdemux/demux_audio.c
--- MPlayer-1.0rc2/libmpdemux/demux_audio.c	2007-10-07 19:49:33.000000000 +0000
+++ MPlayer-1.0rc2-p1/libmpdemux/demux_audio.c	2008-02-05 18:23:02.000000000 +0000
@@ -229,6 +229,8 @@
           ptr += 4;
 
           comment = ptr;
+          if (&comment[length] < comments || &comment[length] >= &comments[blk_len])
+            return;
           c = comment[length];
           comment[length] = 0;
 
diff -rauN MPlayer-1.0rc2/libmpdemux/demux_mov.c MPlayer-1.0rc2-p1/libmpdemux/demux_mov.c
--- MPlayer-1.0rc2/libmpdemux/demux_mov.c	2007-10-07 19:49:33.000000000 +0000
+++ MPlayer-1.0rc2-p1/libmpdemux/demux_mov.c	2008-02-05 18:24:01.000000000 +0000
@@ -173,11 +173,12 @@
     i=trak->chunkmap_size;
     while(i>0){
 	--i;
-	for(j=trak->chunkmap[i].first;j<last;j++){
+	j=FFMAX(trak->chunkmap[i].first, 0);
+	for(;j<last;j++){
 	    trak->chunks[j].desc=trak->chunkmap[i].sdid;
 	    trak->chunks[j].size=trak->chunkmap[i].spc;
 	}
-	last=trak->chunkmap[i].first;
+	last=FFMIN(trak->chunkmap[i].first, trak->chunks_size);
     }
 
 #if 0
@@ -235,6 +236,8 @@
     s=0;
     for(j=0;j<trak->durmap_size;j++){
 	for(i=0;i<trak->durmap[j].num;i++){
+	    if (s >= trak->samples_size)
+		break;
 	    trak->samples[s].pts=pts;
 	    ++s;
 	    pts+=trak->durmap[j].dur;
@@ -246,6 +249,8 @@
     for(j=0;j<trak->chunks_size;j++){
 	off_t pos=trak->chunks[j].pos;
 	for(i=0;i<trak->chunks[j].size;i++){
+	    if (s >= trak->samples_size)
+		break;
 	    trak->samples[s].pos=pos;
 	    mp_msg(MSGT_DEMUX, MSGL_DBG3, "Sample %5d: pts=%8d  off=0x%08X  size=%d\n",s,
 		trak->samples[s].pts,
@@ -1568,8 +1573,7 @@
 			if( udta_len>udta_size)
 				udta_len=udta_size;
 			{
-			char dump[udta_len-4];
-			stream_read(demuxer->stream, (char *)&dump, udta_len-4-4);
+			stream_skip(demuxer->stream, udta_len-4-4);
 			udta_size -= udta_len;
 			}
 		    }
diff -rauN MPlayer-1.0rc2/stream/stream_cddb.c MPlayer-1.0rc2-p1/stream/stream_cddb.c
--- MPlayer-1.0rc2/stream/stream_cddb.c	2007-10-07 19:49:26.000000000 +0000
+++ MPlayer-1.0rc2-p1/stream/stream_cddb.c	2008-02-05 18:24:39.000000000 +0000
@@ -53,6 +53,7 @@
 #include "version.h"
 #include "stream.h"
 #include "network.h"
+#include "libavutil/intreadwrite.h"
 
 #define DEFAULT_FREEDB_SERVER	"freedb.freedb.org"
 #define DEFAULT_CACHE_DIR	"/.cddb/"
@@ -453,8 +454,9 @@
 		} else {
 			len = ptr2-ptr+1;
 		}
+		len = FFMIN(sizeof(album_title) - 1, len);
 		strncpy(album_title, ptr, len);
-		album_title[len-2]='\0';
+		album_title[len]='\0';
 	}
 	mp_msg(MSGT_DEMUX, MSGL_STATUS, MSGTR_MPDEMUX_CDDB_ParseOKFoundAlbumTitle, album_title);
 	return 0;
@@ -490,8 +492,9 @@
 				} else {
 					len = ptr2-ptr+1;
 				}
+				len = FFMIN(sizeof(album_title) - 1, len);
 				strncpy(album_title, ptr, len);
-				album_title[len-2]='\0';
+				album_title[len]='\0';
 			}
 			mp_msg(MSGT_DEMUX, MSGL_STATUS, MSGTR_MPDEMUX_CDDB_ParseOKFoundAlbumTitle, album_title);
 			return cddb_request_titles(cddb_data);
diff -rauN MPlayer-1.0rc2/stream/url.c MPlayer-1.0rc2-p1/stream/url.c
--- MPlayer-1.0rc2/stream/url.c	2007-10-07 19:49:26.000000000 +0000
+++ MPlayer-1.0rc2-p1/stream/url.c	2008-02-05 18:26:16.000000000 +0000
@@ -328,6 +328,7 @@
 		}
 	}
 	
+	tmp = NULL;
 	while(i < len) {
 		// look for the next char that must be kept
 		for  (j=i;j<len;j++) {
diff -ur MPlayer-1.0rc2/configure MPlayer-1.0rc2-p1/configure
--- MPlayer-1.0rc2/configure	2007-10-08 05:49:33.000000000 +1000
+++ MPlayer-1.0rc2-p1/configure	2008-03-10 19:47:42.000000000 +1100
@@ -2275,9 +2275,11 @@
     test "$_sse2"     != no && _sse2=yes
     test "$_ssse3"    != no && _ssse3=yes
     test "$_mtrr"     != no && _mtrr=yes
+    _inc_extra="$_inc_extra -mmmx -msse -msse2 -msse3 -mssse3 -m3dnow"
   fi
   if ppc; then
     _altivec=yes
+    _inc_extra="$_inc_extra -maltivec"
   fi
 fi

@@ -7486,7 +7486,7 @@
 # to use its own copy of the library)
 echocheck "DVD support (libdvdnav)"
 if test "$_dvdnav" = auto ; then
-  $_dvdnavconfig --version --minilibs >> $TMPLOG 2>&1 || _dvdnav=no
+  $_dvdnavconfig --version --libs >> $TMPLOG 2>&1 || _dvdnav=no
 fi
 if test "$_dvdnav" = auto ; then
   cat > $TMPC <<EOF
@@ -7508,7 +7508,7 @@
   _dvdnav_version=`$_dvdnavconfig --version | sed "s/\.//g"`
   _def_dvdnav_version="#define DVDNAVVERSION $_dvdnav_version"
   _inc_extra="$_inc_extra `$_dvdnavconfig --cflags`"
-  _ld_extra="$_ld_extra `$_dvdnavconfig --minilibs`"
+  _ld_extra="$_ld_extra `$_dvdnavconfig --libs`"
   _inputmodules="dvdnav $_inputmodules"
 else
   _def_dvdnav='#undef USE_DVDNAV'
diff -ur MPlayer-1.0rc2/libvo/aclib_template.c MPlayer-1.0rc2-p1/libvo/aclib_template.c
--- MPlayer-1.0rc2/libvo/aclib_template.c	2007-10-08 05:49:33.000000000 +1000
+++ MPlayer-1.0rc2-p1/libvo/aclib_template.c	2008-03-10 19:47:42.000000000 +1100
@@ -109,7 +109,7 @@
 #elif defined ( HAVE_3DNOW )
 #define PREFETCH  "prefetch"
 #else
-#define PREFETCH "/nop"
+#define PREFETCH "nop"
 #endif
 
 /* On K6 femms is faster of emms. On K7 femms is directly mapped on emms. */
diff -ur MPlayer-1.0rc2/libvo/osd_template.c MPlayer-1.0rc2-p1/libvo/osd_template.c
--- MPlayer-1.0rc2/libvo/osd_template.c	2007-10-08 05:49:33.000000000 +1000
+++ MPlayer-1.0rc2-p1/libvo/osd_template.c	2008-03-10 19:47:42.000000000 +1100
@@ -16,8 +16,8 @@
 #define PREFETCHW "prefetcht0"
 #define PAVGB	  "pavgb"
 #else
-#define PREFETCH "/nop"
-#define PREFETCHW "/nop"
+#define PREFETCH "nop"
+#define PREFETCHW "nop"
 #endif
 
 #ifdef HAVE_3DNOW
