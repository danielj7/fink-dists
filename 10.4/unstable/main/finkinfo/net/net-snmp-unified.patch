diff -Nurd net-snmp-5.4.2.1/configure.in net-snmp-5.4.2.1-new/configure.in
--- net-snmp-5.4.2.1/configure.in	2008-10-31 11:22:23.000000000 -0400
+++ net-snmp-5.4.2.1-new/configure.in	2009-04-22 12:40:16.000000000 -0400
@@ -3072,7 +3072,9 @@
 # check the cflags
 if test "x$embed_perl" != "xno" ; then
     AC_MSG_CHECKING([for Perl CFLAGS])
-    perlcflags=`$myperl -MExtUtils::Embed -e ccopts`
+    changequote(, )
+    perlcflags=`$myperl -MExtUtils::Embed -e ccopts | /usr/bin/sed -e 's,-arch [^ ]*,,g'`
+    changequote([, ])
     if test "x$perlcflags" != "x" ; then
       AC_MSG_RESULT([$perlcflags])
       CFLAGS="$CFLAGS $perlcflags"
@@ -3088,7 +3090,9 @@
 # check the ldflags
 if test "x$embed_perl" != "xno" ; then
     AC_MSG_CHECKING([for Perl LDFLAGS])
-    netsnmp_perlldopts=`$myperl -MExtUtils::Embed -e ldopts`
+    changequote(, )
+    netsnmp_perlldopts=`$myperl -MExtUtils::Embed -e ldopts | /usr/bin/sed -e 's,-arch [^ ]*,,g'`
+    changequote([, ])
     if test "x$netsnmp_perlldopts" != "x" ; then
       AC_MSG_RESULT([$netsnmp_perlldopts])
     else
@@ -3104,7 +3108,7 @@
       # Perl ccdlflags (RPATH to libperl, hopefully)
       AC_MSG_CHECKING([for Perl CCDLFLAGS])
       changequote(, )
-      netsnmp_perlccdlflags=`$myperl -V:ccdlflags | $myperl -n -e 'print $1 '"if (/^\s*ccdlflags='([^']+)';/);"`
+      netsnmp_perlccdlflags=`$myperl -V:ccdlflags | /usr/bin/sed -e 's,-arch [^ ]*,,g'`
       changequote([, ])
       AC_MSG_RESULT([$netsnmp_perlccdlflags])
       PERLLDOPTS_FOR_APPS="$netsnmp_perlccdlflags"
diff -Nurd net-snmp-5.4.2.1/perl/TrapReceiver/Makefile.PL net-snmp-5.4.2.1-new/perl/TrapReceiver/Makefile.PL
--- net-snmp-5.4.2.1/perl/TrapReceiver/Makefile.PL	2007-06-18 10:10:08.000000000 -0400
+++ net-snmp-5.4.2.1-new/perl/TrapReceiver/Makefile.PL	2009-04-22 12:04:19.000000000 -0400
@@ -108,7 +108,7 @@
     else {
 	$opts = NetSNMPGetOpts();
 	$Params{'LDDLFLAGS'} = "$Config{lddlflags} " . `$opts->{'nsconfig'} --ldflags`;
-	$Params{'LIBS'} = '-lnetsnmptrapd -lnetsnmpagent -lnetsnmp';
+	$Params{'LIBS'} = '-lnetsnmptrapd -lnetsnmpagent -lnetsnmp -lnetsnmpmibs -lnetsnmphelpers ';
 	chomp($Params{'LIBS'});
 	if (!$ENV{'NETSNMP_CCFLAGS'}) {
 	    $Params{'CCFLAGS'} = `$opts->{'nsconfig'} --cflags`;
