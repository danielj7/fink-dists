Package: db42
Version: 4.2.50
Revision: 1
Source: http://www.sleepycat.com/update/snapshot/db-%v.NC.tar.gz
Replaces: db, db3, db31 (<< 3.1.17-8), db4-ssl, db4, db41-ssl, db42-ssl
Conflicts: db3, db31 (<< 3.1.17-8), db4-ssl, db4, db41-ssl, db42-ssl
Depends: db42-shlibs (= %v-%r) | db42-ssl-shlibs (=%v-%r)
BuildDepends: fink (>= 0.16.0-1), system-java14-dev
BuildDependsOnly: true
NoSetLDFlags: true
NoSetCPPFlags: true
SetCFlags: -Os
SetCXXFlags: -Os
#Patch: %n.patch
ConfigureParams: --enable-compat185 --enable-cxx --includedir=%p/include/db4 --enable-java
GCC: 3.3
CompileScript: <<
#! /bin/sh -ex
JAVA14=`ls -d /System/Library/Frameworks/JavaVM.framework/Versions/1.4.*/`
VERSIONS="-avoid-version  -XCClinker -current_version -XCClinker 4.2.50 -XCClinker -compatibility_version -XCClinker 4.2 -no-undefined"
LIBDB="libdb-4.2.la"
LIBDBCXX="libdb_cxx-4.2.la"
cd build_unix;
../dist/configure %c JAVAC=$JAVA14/Commands/javac JAR=$JAVA14/Commands/jar
perl -pi -e 's,api_java,,g' Makefile
make UTIL_PROGS=""
rm ".libs/$LIBDB" $LIBDB
make SOLINK="\$(LIBTOOL) --mode=link cc $VERSIONS" UTIL_PROGS=""
rm ".libs/$LIBDBCXX" $LIBDBCXX
make XSOLINK="\$(LIBTOOL) --mode=link --tag=CXX c++ $VERSIONS" UTIL_PROGS=""
make
<<
InstallScript: <<
(cd build_unix; make install prefix=%I docdir=%I/share/doc/db42-doc/docs includedir=%I/include/db4)
rm -f %i/lib/db.jar
<<
SplitOff: <<
 Package: %N-shlibs
 Replaces: db42-ssl-shlibs
 Conflicts: db42-ssl-shlibs
 Description: Shared Libraries for db42
 Files: lib/libdb-4.2.dylib lib/libdb_cxx-4.2.dylib
 Shlibs: <<
    %p/lib/libdb-4.2.dylib 4.2.0 %n (>= 4.2.50-1)
    %p/lib/libdb_cxx-4.2.dylib 4.2.0 %n (>= 4.2.50-1)
 <<
 DocFiles: LICENSE
<<
SplitOff2: <<
 Package: %N-bin
 Depends: %N-shlibs (= %v-%r)
 Conflicts: db3-bin, db31 (<< 3.1.17-2), db4-ssl-bin, db4-bin, db41-ssl-bin, db42-ssl-bin
 Replaces: db3-bin, db4 (<< 4.0.14-4), db31 (<< 3.1.17-2), db4-ssl-bin, db4-bin, db41-ssl-bin, db42-ssl-bin
 Description: Binary utilities for db42
 Files: bin
 DocFiles: LICENSE
<<
SplitOff3: <<
 Package: %N-doc
 Description: Documentation for db42
 Files: share/doc/db42-doc
 DocFiles: LICENSE
<<
Splitoff4: <<
 Package: %N-java
 Conflicts: db41-ssl-java, db42-ssl-java, db41-java
 Replaces: db41-ssl-java, db42-ssl-java, db41-java
 Depends: system-java14
 Description: Java libraries for db42
 Files: lib/libdb_java*
 JarFiles: build_unix/db.jar
 DocFiles: LICENSE
<<
DocFiles: LICENSE README
License: OSI-Approved
Description: Berkeley DB embedded database - non crypto
Homepage: http://www.sleepycat.com/
Maintainer: Peter O'Gorman <peter@pogma.com>
Source-MD5: e99c178f07213e6713d4962f09ec4565
