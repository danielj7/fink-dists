Package: g77
Version: 3.4.3
Revision: 102
Source: mirror:gnu:gcc/gcc-%v/gcc-%v.tar.bz2
Source-MD5: e744b30c834360fccac41eb7269a3011
NoSourceDirectory: True
BuildDepends: libgettext3-dev, gettext-tools, libiconv-dev
Depends: libgettext3-shlibs, libiconv
ConfigureParams: --enable-languages=f77 --infodir='${prefix}/share/info' --libexecdir='${prefix}/lib' --disable-shared
NoSetMAKEFLAGS: true
SetMAKEFLAGS: -j1
PatchScript: <<
 #!/bin/sh -ev
 if [ %m = "i386" ]; then patch -p1 < %a/gcc-%v-intel.diffs; fi
 cd gcc-%v/gcc
 sed -i -e 's|$(ALL_CPPFLAGS) $(INCLUDES)|$(INCLUDES) $(ALL_CPPFLAGS)|g'  Makefile.in
 if [ %m = "powerpc" ]; then sed -i -e '/extern int sigaltstack/d' config/rs6000/host-darwin.c; fi 
 if test -f /usr/lib/libSystemStubs.a ; then
   perl -pi.bak -e 's|-lSystem|%%{!mlong-double-64:%%{pg:-lSystemStubs_profile;:-lSystemStubs}} -lSystem -lmx %%:if-exists(/usr/lib/gcc/%m-apple-darwin8/4.0.0/libgcc.a) %%:if-exists(/usr/lib/gcc/%m-apple-darwin8/4.0.1/libgcc.a)|' config/darwin.h
 else
   perl -pi.bak -e 's|-lSystem|-lSystem /usr/lib/gcc/darwin/3.3/libgcc.a|' config/darwin.h
 fi
 egrep -rI '(head|tail) +\-[0-9]' *|cut -f1 -d:|sort -u|xargs perl -pi -e 's,(head|tail) +\-([0-9]),\1 \-n\2,g'
<<
CompileScript: <<
 #!/bin/sh -ev
 mkdir darwin 
 cd darwin
 ../gcc-%v/configure %c
 make CFLAGS='-O -fno-common' LIBCFLAGS='-g -O2 -fno-common' LIBCXXFLAGS='-g -O2 -fno-implicit-templates' bootstrap
# cd gcc; make check-g77
<<
InstallScript: <<
 #!/bin/sh -ev
 cd darwin
 make install prefix=%i
 cd %i/bin
 /bin/rm -f gcc gccbug cpp gcov powerpc-apple*
 ln -s %p/bin/g77 f77
 darwinvers=`/usr/bin/uname -v | cut -f1 -d":" | awk '{print $4}'`
 gccvers=`%i/bin/g77 -dumpversion | head -n 1 | cut -f4 -d" "`
 ln -s %p/lib/gcc/%m-apple-darwin${darwinvers}/${gccvers}/include/g2c.h %i/include/g2c.h
 /bin/rm -rf %i/share/locale %i/man
 /bin/rm -f %i/lib/charset.alias
 /bin/rm -f %i/share/info/gcc* %i/share/info/cpp*
 /bin/mv -f %i/lib/libiberty.a %i/lib/libiberty-g77.a
 for i in `find %i -name "*.a" ` ; do
	nmedit -p $i
 done
<<
License: GPL
DocFiles: gcc-%v/gcc/f/ChangeLog gcc-%v/COPYING gcc-%v/COPYING.LIB
InfoDocs: g77.info
Description: GNU Fortran compiler
DescDetail: <<
 g77 consists of several components:       

 1) The g77 command itself.
 2) The libg2c run-time library.  This library contains the 
    machine code needed to support capabilities of the Fortran
    language that are not directly provided by the machine code 
    generated by the g77 compilation phase.       
 3) The compiler itself, internally named f771.       
    f771 does not generate machine code directly -- 
    it generates assembly code, leaving the conversion to 
    actual machine code to an assembler, usually named as.

 g77 supports some fortran90 features, like automatic arrays,
 free source form, and DO WHILE.
<<
DescPort: <<
 Installs g77 from the FSF gcc distribution.

 This version does not install in /usr. It contains its own cc1 and
 libgcc.a installed in %p.

 libiberty.a moved to libiberty-g77.a to avoid conflict with ddd.

 Built with -fno-common, and global symbols in the static libraries
 private extern using "nmedit -p". These changes (from Peter O'Gorman)
 allow g77 to build shared libs on darwin.
<<
DescUsage: <<
 Does not support -framework argument, to link frameworks use -Wl flag
 (for example, to link vecLib use "-Wl,-framework -Wl,vecLib").

 No man page, use "info g77".
<<
DescPackaging: <<
 Earlier versions by Jeffrey Whitaker
<<
Homepage: http://gcc.gnu.org/onlinedocs/g77/
Maintainer:  George Helffrich <george.helffrich@bristol.ac.uk>

