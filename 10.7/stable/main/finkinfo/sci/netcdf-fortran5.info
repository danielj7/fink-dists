Package: netcdf-fortran5
Version: 4.2
Revision: 1
BuildDependsOnly: true
Maintainer: Alexander Hansen <alexkhansen@users.sourceforge.net>

Depends: %n-shlibs (= %v-%r)
BuildDepends: doxygen, hdf5.7, gcc46, fink-package-precedence, netcdf-c7 (= %v-%r), netcdf-bin (= %v-%r), libcurl4, szip
Conflicts: netcdf (<= 3.6.1-1003), netcdf-absoft, netcdf-g95, netcdf-gfortran, netcdf7-gfortran
Replaces: netcdf (<= 3.6.1-1003), netcdf-absoft, netcdf-g95, netcdf-gfortran, netcdf7-gfortran

Source: ftp://ftp.unidata.ucar.edu/pub/netcdf/netcdf-fortran-%v.tar.gz
Source-MD5: cc3bf530223e8f4aff93793b9f197bf3
SetCFLAGS: -O2
SetLDFLAGS: -lsz -Wl,-dead_strip_dylibs

ConfigureParams: <<
  --enable-shared --disable-static \
  FFLAGS=-O2 FCFLAGS=-O2 FC=%p/bin/gfortran \
  F77=%p/bin/gfortran F90=%p/bin/gfortran \
  --mandir='${prefix}/share/man' \
  --infodir='${prefix}/share/info' \
  --docdir='${prefix}/share/doc/netcdf' 
<<
CompileScript: <<
	%{default_script}
	fink-package-precedence .
	<<
InstallScript: <<
  #!/bin/sh -ev
  make install DESTDIR=%d
  mkdir -p %i/share/doc
  mkdir -p %i/share/info
  # Add examples for F77 and F90
  mkdir -p %i/share/doc/netcdf7/examples
  cp -r examples/F* examples/Makefile %i/share/doc/netcdf7/examples
  # manually add docs
  for ftype in dvi html pdf ps txt 
  	do cp man4/netcdf-f77.$ftype man4/netcdf-f90.$ftype %i/share/doc/netcdf7
  done
  cp man4/netcdf_f{77,90}-man.html %i/share/doc/netcdf7
<<
SplitOff: <<
  Package: %N-shlibs
  Depends: netcdf-c7-shlibs (>= %v-%r), gcc46-shlibs
  Files: lib/libnetcdff.*.dylib
  Shlibs: %p/lib/libnetcdff.5.dylib 9.0.0 %n (>= 4.2-1)
  DocFiles: COPYRIGHT README 
<<
InfoDocs: netcdf-f77.info netcdf-f90.info
DocFiles: COPYRIGHT README
Description: Interface & lib for array-based data access
DescDetail: <<
The netCDF (network Common Data Form) library defines a machine-independent
format for representing scientific data. Together, the interface, library,
and format support the creation, access, and sharing of scientific data.

This package provides a library, documentation, and examples for interfacing
with Fortran 77 and Fortran 90 code using the gfortran compiler.  Because the
library links to libraries from gcc4N-shlibs, a particular gcc4N had to be 
chosen.
<<
DescUsage: <<
When building by hand, make sure netcdf-c7 is installed.
<<
DescPackaging: <<
Manually move docs from the tarball to avoid potentially triggering a rebuild.
<<
DescPort: <<
FFLAGS=-O2 FCFLAGS=-O2 is essential to avoid debugging mode flags (-g).

Manually feed "-lsz" and "-I%p/include" to the configure script to find szlib
and hdf5.7, respectively.
<<
Homepage: http://www.unidata.ucar.edu/software/netcdf/
License: OSI-Approved
