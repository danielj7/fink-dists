diff -uNr amarok-1.2.3/amarok/configure.in.in amarok-1.2.3-new/amarok/configure.in.in
--- amarok-1.2.3/amarok/configure.in.in	2005-03-28 14:15:55.000000000 -0500
+++ amarok-1.2.3-new/amarok/configure.in.in	2005-05-13 08:27:31.000000000 -0400
@@ -16,6 +16,8 @@
 # BEGIN KDEMULTIMEDIA CHECK
 ###############################################################################
 
+KDE_CHECK_HEADERS(sys/soundcard.h)
+
 KDE_CHECK_HEADER(arts/artsmodules.h, have_kdemm=yes, have_kdemm=no)
 
 AM_CONDITIONAL(with_arts, [test x$have_kdemm = xyes -a x$build_arts = xyes])
diff -uNr amarok-1.2.3/amarok/src/Makefile.am amarok-1.2.3-new/amarok/src/Makefile.am
--- amarok-1.2.3/amarok/src/Makefile.am	2005-03-28 14:15:55.000000000 -0500
+++ amarok-1.2.3-new/amarok/src/Makefile.am	2005-05-13 08:36:29.000000000 -0400
@@ -114,7 +114,7 @@
 
 amarokapp_LDFLAGS = \
     $(all_libraries) \
-    $(KDE_RPATH)
+    $(KDE_RPATH) -Xlinker -framework -Xlinker CoreFoundation
 
 METASOURCES = \
     AUTO
diff -uNr amarok-1.2.3/amarok/src/engine/enginebase.cpp amarok-1.2.3-new/amarok/src/engine/enginebase.cpp
--- amarok-1.2.3/amarok/src/engine/enginebase.cpp	2005-03-28 14:15:55.000000000 -0500
+++ amarok-1.2.3-new/amarok/src/engine/enginebase.cpp	2005-05-13 08:27:31.000000000 -0400
@@ -7,7 +7,9 @@
 #include <fcntl.h>
 #include <math.h>
 #include <sys/ioctl.h>
+#ifdef HAVE_SYS_SOUNDCARD_H
 #include <sys/soundcard.h>
+#endif
 #include <sys/wait.h>
 #include <unistd.h>
 
@@ -54,6 +56,7 @@
 
         if ( m_mixer >= 0 )
         {
+#ifdef HAVE_SYS_SOUNDCARD_H
             int devmask, recmask, i_recsrc, stereodevs;
             if ( ioctl( m_mixer, SOUND_MIXER_READ_DEVMASK, &devmask )       == -1 ) goto failure;
             if ( ioctl( m_mixer, SOUND_MIXER_READ_RECMASK, &recmask )       == -1 ) goto failure;
@@ -62,6 +65,7 @@
             if ( !devmask )                                                         goto failure;
 
             setVolumeSW( 100 ); //seems sensible
+#endif
 
             return true;
         }
@@ -100,8 +104,10 @@
 {
     if ( isMixerHW() )
     {
+#ifdef HAVE_SYS_SOUNDCARD_H
         percent = percent + ( percent << 8 );
         ioctl( m_mixer, MIXER_WRITE( 4 ), &percent );
+#endif
     }
 }
 
diff -uNr amarok-1.2.3/amarok/src/vis/Makefile.am amarok-1.2.3-new/amarok/src/vis/Makefile.am
--- amarok-1.2.3/amarok/src/vis/Makefile.am	2005-03-28 14:15:55.000000000 -0500
+++ amarok-1.2.3-new/amarok/src/vis/Makefile.am	2005-05-13 08:27:42.000000000 -0400
@@ -3,7 +3,7 @@
 endif
 
 if with_libvisual
-    LIBVISUAL_BUILD = libvisual
+    LIBVISUAL_BUILD = 
 endif
 
 SUBDIRS = \
