diff -Nurd -x'*~' gdm-2.24.1.orig/common/gdm-signal-handler.c gdm-2.24.1/common/gdm-signal-handler.c
--- gdm-2.24.1.orig/common/gdm-signal-handler.c	2008-11-18 17:38:43.000000000 -0500
+++ gdm-2.24.1/common/gdm-signal-handler.c	2009-01-20 16:53:43.000000000 -0500
@@ -27,7 +27,9 @@
 #include <unistd.h>
 #include <string.h>
 #include <signal.h>
+#if HAVE_EXECINFO_H
 #include <execinfo.h>
+#endif
 #include <syslog.h>
 #include <sys/wait.h>
 #include <sys/stat.h>
@@ -160,6 +162,7 @@
 static void
 fallback_get_backtrace (void)
 {
+#ifdef HAVE_EXECINFO_H
         void *  frames[64];
         size_t  size;
         char ** strings;
@@ -173,9 +176,10 @@
                 }
                 free (strings);
                 syslog (LOG_CRIT, "******************* END **********************************");
-        } else {
-                g_warning ("GDM crashed, but symbols couldn't be retrieved.");
+                return;
         }
+#endif
+        g_warning ("GDM crashed, but symbols couldn't be retrieved.");
 }
 
 
diff -Nurd -x'*~' gdm-2.24.1.orig/configure gdm-2.24.1/configure
--- gdm-2.24.1.orig/configure	2008-11-18 18:06:46.000000000 -0500
+++ gdm-2.24.1/configure	2009-01-20 22:21:52.000000000 -0500
@@ -23441,7 +23441,7 @@
 GNOME_PANEL_REQUIRED_VERSION=2.0.0
 LIBXKLAVIER_REQUIRED_VERSION=3.5
 #FONTCONFIG_REQUIRED_VERSION=2.6.0
-FONTCONFIG_REQUIRED_VERSION=2.5.0
+FONTCONFIG_REQUIRED_VERSION=2.4.0
 
 
 
@@ -31654,6 +31654,7 @@
 fi
 
 
+ac_pam_includes="/usr/include"
 if test "x$have_pam" = "xyes"; then
    pam_appl_h="$ac_pam_includes/security/pam_appl.h"
    { $as_echo "$as_me:$LINENO: checking for const pam_message" >&5
diff -Nurd -x'*~' gdm-2.24.1.orig/daemon/gdm-session-record.c gdm-2.24.1/daemon/gdm-session-record.c
--- gdm-2.24.1.orig/daemon/gdm-session-record.c	2008-11-18 17:38:44.000000000 -0500
+++ gdm-2.24.1/daemon/gdm-session-record.c	2009-01-20 16:29:30.000000000 -0500
@@ -322,8 +322,10 @@
 #elif defined(HAVE_UT_UT_TIME)
                 u->ut_time = session_record.ut_time;
 #endif
+#ifdef HAVE_UT_UT_EXIT_E_TERMINATION
                 u->ut_exit.e_termination = 0;
                 u->ut_exit.e_exit = 0;
+#endif
 
                 pututxline (u);
 
diff -Nurd -x'*~' gdm-2.24.1.orig/daemon/gdm-xdmcp-display-factory.c gdm-2.24.1/daemon/gdm-xdmcp-display-factory.c
--- gdm-2.24.1.orig/daemon/gdm-xdmcp-display-factory.c	2008-11-18 17:38:44.000000000 -0500
+++ gdm-2.24.1/daemon/gdm-xdmcp-display-factory.c	2009-01-20 22:48:05.000000000 -0500
@@ -368,9 +368,6 @@
                 if (ai->ai_flags & AI_NUMERICHOST) {
                         g_string_append (str, "numhost ");
                 }
-                if (ai->ai_flags & AI_NUMERICSERV) {
-                        g_string_append (str, "numserv ");
-                }
                 if (ai->ai_flags & AI_V4MAPPED) {
                         g_string_append (str, "v4mapped ");
                 }
@@ -600,20 +597,22 @@
         return TRUE;
 }
 
+#ifdef HAVE_TCPWRAPPERS
+
+/*
+ * Avoids a warning, my tcpd.h file doesn't include this prototype, even
+ * though the library does include the function and the manpage mentions it
+ */
+extern int hosts_ctl (char *daemon,
+                      char *client_name,
+                      char *client_addr,
+                      char *client_user);
+#endif
+
 static gboolean
 gdm_xdmcp_host_allow (GdmAddress *address)
 {
 #ifdef HAVE_TCPWRAPPERS
-
-        /*
-         * Avoids a warning, my tcpd.h file doesn't include this prototype, even
-         * though the library does include the function and the manpage mentions it
-         */
-        extern int hosts_ctl (char *daemon,
-                              char *client_name,
-                              char *client_addr,
-                              char *client_user);
-
         char       *client;
         char       *host;
         gboolean    ret;
diff -Nurd -x'*~' gdm-2.24.1.orig/gui/simple-greeter/gdm-greeter-login-window.c gdm-2.24.1/gui/simple-greeter/gdm-greeter-login-window.c
--- gdm-2.24.1.orig/gui/simple-greeter/gdm-greeter-login-window.c	2008-11-18 17:49:12.000000000 -0500
+++ gdm-2.24.1/gui/simple-greeter/gdm-greeter-login-window.c	2009-01-20 22:14:20.000000000 -0500
@@ -68,7 +68,7 @@
 #include "gdm-user-chooser-widget.h"
 
 #ifdef HAVE_PAM
-#include <security/pam_appl.h>
+#include <pam/pam_appl.h>
 #define PW_ENTRY_SIZE PAM_MAX_RESP_SIZE
 #else
 #define PW_ENTRY_SIZE GDM_MAX_PASS
diff -Nurd -x'*~' gdm-2.24.1.orig/gui/simple-greeter/gdm-language-chooser-widget.c gdm-2.24.1/gui/simple-greeter/gdm-language-chooser-widget.c
--- gdm-2.24.1.orig/gui/simple-greeter/gdm-language-chooser-widget.c	2008-11-18 17:38:43.000000000 -0500
+++ gdm-2.24.1/gui/simple-greeter/gdm-language-chooser-widget.c	2009-01-20 15:34:07.000000000 -0500
@@ -133,7 +133,6 @@
 static gboolean
 language_has_font (const char *locale)
 {
-        const FcCharSet *charset;
         FcPattern       *pattern;
         FcObjectSet     *object_set;
         FcFontSet       *font_set;
@@ -147,29 +146,21 @@
 
         gdm_parse_language_name (locale, &language_code, NULL, NULL, NULL);
 
-        charset = FcLangGetCharSet ((FcChar8 *) language_code);
-        if (!charset) {
-                /* fontconfig does not know about this language */
-                is_displayable = TRUE;
-        } else {
-                /* see if any fonts support rendering it */
-                pattern = FcPatternBuild (NULL, FC_LANG, FcTypeString, language_code, NULL);
-
-                if (pattern == NULL)
-                        goto done;
+        pattern = FcPatternBuild (NULL, FC_LANG, FcTypeString, language_code, NULL);
+        if (pattern == NULL)
+                goto done;
 
-                object_set = FcObjectSetCreate ();
+        object_set = FcObjectSetBuild (NULL, NULL);
 
-                if (object_set == NULL)
-                        goto done;
+        if (object_set == NULL)
+                goto done;
 
-                font_set = FcFontList (NULL, pattern, object_set);
+        font_set = FcFontList (NULL, pattern, object_set);
 
-                if (font_set == NULL)
-                        goto done;
+        if (font_set == NULL)
+                goto done;
 
-                is_displayable = (font_set->nfont > 0);
-        }
+        is_displayable = (font_set->nfont > 0);
 
  done:
 
diff -Nurd -x'*~' gdm-2.24.1.orig/gui/simple-greeter/gdm-user-manager.c gdm-2.24.1/gui/simple-greeter/gdm-user-manager.c
--- gdm-2.24.1.orig/gui/simple-greeter/gdm-user-manager.c	2008-11-18 17:38:43.000000000 -0500
+++ gdm-2.24.1/gui/simple-greeter/gdm-user-manager.c	2009-01-20 23:28:46.000000000 -0500
@@ -1280,11 +1280,7 @@
         new_users = NULL;
 
         errno = 0;
-        fp = fopen (PATH_PASSWD, "r");
-        if (fp == NULL) {
-                g_warning ("Unable to open %s: %s", PATH_PASSWD, g_strerror (errno));
-                goto out;
-        }
+        setpwent();
 
         g_hash_table_foreach (manager->priv->users, listify_hash_values_hfunc, &old_users);
         g_slist_foreach (old_users, (GFunc) g_object_ref, NULL);
@@ -1297,7 +1293,7 @@
                 }
         }
 
-        for (pwent = fgetpwent (fp); pwent != NULL; pwent = fgetpwent (fp)) {
+        for (pwent = getpwent(); pwent != NULL; pwent = getpwent()) {
                 GdmUser *user;
 
                 user = NULL;
@@ -1360,7 +1356,6 @@
  out:
         /* Cleanup */
 
-        fclose (fp);
 
         g_slist_foreach (new_users, (GFunc) g_object_thaw_notify, NULL);
         g_slist_foreach (new_users, (GFunc) g_object_unref, NULL);
