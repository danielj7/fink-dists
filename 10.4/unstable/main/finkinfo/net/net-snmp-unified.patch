diff -Nurd net-snmp-5.6.1/agent/mibgroup/hardware/memory/memory_darwin.c net-snmp-5.6.1-new/agent/mibgroup/hardware/memory/memory_darwin.c
--- net-snmp-5.6.1/agent/mibgroup/hardware/memory/memory_darwin.c	2007-06-18 17:12:35.000000000 -0400
+++ net-snmp-5.6.1-new/agent/mibgroup/hardware/memory/memory_darwin.c	2011-03-30 10:29:12.000000000 -0400
@@ -9,6 +9,11 @@
 #include <sys/stat.h>
 #include <sys/sysctl.h>
 
+#ifdef HAVE_VM_REGION_64
+#define VM_REGION_FUNC vm_region_64
+#else
+#define VM_REGION_FUNC vm_region
+#endif
 
 /*
  * Retained from UCD implementation
@@ -75,7 +80,7 @@
             for (address = 0;; address += size) {
                 /* Get memory region. */
                 count = VM_REGION_EXTENDED_INFO_COUNT; 
-                if (vm_region(tasks[j], &address, &size, VM_REGION_EXTENDED_INFO, (vm_region_extended_info_t)&info, &count, &object_name) != KERN_SUCCESS) {
+                if (VM_REGION_FUNC(tasks[j], &address, &size, VM_REGION_EXTENDED_INFO, (vm_region_extended_info_t)&info, &count, &object_name) != KERN_SUCCESS) {
                     /* No more memory regions. */
                     break;
                 }
diff -Nurd net-snmp-5.6.1/agent/mibgroup/host/hr_swrun.c net-snmp-5.6.1-new/agent/mibgroup/host/hr_swrun.c
--- net-snmp-5.6.1/agent/mibgroup/host/hr_swrun.c	2010-07-29 10:58:47.000000000 -0400
+++ net-snmp-5.6.1-new/agent/mibgroup/host/hr_swrun.c	2011-03-30 09:35:37.000000000 -0400
@@ -39,9 +39,6 @@
 #if HAVE_SYS_PROC_H
 #include <sys/proc.h>
 #endif
-#if HAVE_KVM_H
-#include <kvm.h>
-#endif
 #if HAVE_SYS_SYSCTL_H
 #include <sys/sysctl.h>
 #endif
diff -Nurd net-snmp-5.6.1/agent/mibgroup/ucd-snmp/memory_darwin7.c net-snmp-5.6.1-new/agent/mibgroup/ucd-snmp/memory_darwin7.c
--- net-snmp-5.6.1/agent/mibgroup/ucd-snmp/memory_darwin7.c	2008-10-21 17:10:43.000000000 -0400
+++ net-snmp-5.6.1-new/agent/mibgroup/ucd-snmp/memory_darwin7.c	2011-03-30 10:29:30.000000000 -0400
@@ -48,6 +48,12 @@
 #include "memory.h"
 #include "memory_darwin7.h"
 
+#ifdef HAVE_VM_REGION_64
+#define VM_REGION_FUNC vm_region_64
+#else
+#define VM_REGION_FUNC vm_region
+#endif
+
 /*
  *  * Swap info 
  *   */
@@ -387,7 +393,7 @@
             for (address = 0;; address += size) {
                 /* Get memory region. */
                 count = VM_REGION_EXTENDED_INFO_COUNT; 
-                if (vm_region(tasks[j], &address, &size, VM_REGION_EXTENDED_INFO, (vm_region_extended_info_t)&info, &count, &object_name) != KERN_SUCCESS) {
+                if (VM_REGION_FUNC(tasks[j], &address, &size, VM_REGION_EXTENDED_INFO, (vm_region_extended_info_t)&info, &count, &object_name) != KERN_SUCCESS) {
                     /* No more memory regions. */
                     break;
                 }
diff -Nurd net-snmp-5.6.1/configure.d/config_os_functions net-snmp-5.6.1-new/configure.d/config_os_functions
--- net-snmp-5.6.1/configure.d/config_os_functions	2010-12-06 17:08:12.000000000 -0500
+++ net-snmp-5.6.1-new/configure.d/config_os_functions	2011-03-30 10:27:44.000000000 -0400
@@ -95,7 +95,8 @@
                [sigprocmask                                    ] dnl
                [statfs          statvfs       stime            ] dnl
                [strncasecmp     system                         ] dnl
-               [uname           usleep                         ] )
+               [uname           usleep                         ] dnl
+               [vm_region       vm_region_64                   ] )
 
 #  Apps:
 AC_CHECK_FUNCS([getdtablesize                                  ] dnl
diff -Nurd net-snmp-5.6.1/configure.d/config_project_perl_python net-snmp-5.6.1-new/configure.d/config_project_perl_python
--- net-snmp-5.6.1/configure.d/config_project_perl_python	2010-07-29 11:47:40.000000000 -0400
+++ net-snmp-5.6.1-new/configure.d/config_project_perl_python	2011-03-30 09:32:45.000000000 -0400
@@ -87,7 +87,7 @@
     if test "xenable_perl_cc_checks" != "xno" ; then
         AC_MSG_CHECKING([for Perl cc])
         changequote(, )
-        PERLCC=`$myperl -V:cc | $myperl -n -e 'print if (s/^\s*cc=.([-=\w\s\/]+).;\s*/$1/);'`
+        PERLCC=`$myperl -V:cc | $myperl -n -e 'print if (s/^\s*cc=.([-=\w\s\.\/]+).;\s*/$1/);'`
         changequote([, ])
         if test "x$PERLCC" != "x" ; then
             AC_MSG_RESULT([$PERLCC])
@@ -192,7 +192,7 @@
 #
 if test "x$embed_perl" != "xno" ; then
     AC_MSG_CHECKING([for Perl CFLAGS])
-    perlcflags=`$myperl -MExtUtils::Embed -e ccopts`
+    perlcflags=`$myperl -MExtUtils::Embed -e ccopts | /usr/bin/sed -e 's,-arch [^ ]*,,g'`
     if test "x$perlcflags" != "x" ; then
       AC_MSG_RESULT([$perlcflags])
       CFLAGS="$CFLAGS $perlcflags"
@@ -209,7 +209,7 @@
 #
 if test "x$embed_perl" != "xno" ; then
     AC_MSG_CHECKING([for Perl LDFLAGS])
-    netsnmp_perlldopts=`$myperl -MExtUtils::Embed -e ldopts`
+    netsnmp_perlldopts=`$myperl -MExtUtils::Embed -e ldopts | /usr/bin/sed -e 's,-arch [^ ]*,,g'`
     if test "x$netsnmp_perlldopts" != "x" ; then
       AC_MSG_RESULT([$netsnmp_perlldopts])
     else
@@ -228,7 +228,7 @@
       #
       AC_MSG_CHECKING([for Perl CCDLFLAGS])
       changequote(, )
-      netsnmp_perlccdlflags=`$myperl -V:ccdlflags | $myperl -n -e 'print $1 '"if (/^\s*ccdlflags='([^']+)';/);"`
+      netsnmp_perlccdlflags=`$myperl -V:ccdlflags | /usr/bin/sed -e 's,-arch [^ ]*,,g'`
       changequote([, ])
       AC_MSG_RESULT([$netsnmp_perlccdlflags])
       PERLLDOPTS_FOR_APPS="$netsnmp_perlccdlflags"
diff -Nurd net-snmp-5.6.1/net-snmp-config.in net-snmp-5.6.1-new/net-snmp-config.in
--- net-snmp-5.6.1/net-snmp-config.in	2010-10-13 05:58:34.000000000 -0400
+++ net-snmp-5.6.1-new/net-snmp-config.in	2011-03-30 09:34:09.000000000 -0400
@@ -57,7 +57,7 @@
 NSC_SRCDIR=@srcdir@
 NSC_INCDIR=${NSC_PREFIX}/include
 NSC_BASE_SUBAGENT_LIBS="-lnetsnmpagent -lnetsnmp"
-NSC_BASE_AGENT_LIBS="-lnetsnmpagent -lnetsnmpmibs -lnetsnmp"
+NSC_BASE_AGENT_LIBS="-lnetsnmpagent -lnetsnmpmibs -lnetsnmp -lnetsnmphelpers"
 NSC_SRC_LIBDIRS="agent/.libs snmplib/.libs"
 NSC_SRC_LIBDEPS="agent/.libs/libnetsnmpmibs.a agent/.libs/libnetsnmpagent.a snmplib/.libs/libnetsnmp.a"
 
