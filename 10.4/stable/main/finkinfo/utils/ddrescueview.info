Package: ddrescueview
Version: 0.3
Revision: 1
Description: Graphical viewer for GNU ddrescue log files
Architecture: powerpc, i386, x86_64
BuildDepends: lazarus-aqua | lazarus-lcl-carbon, libicns1-bin, imagemagick
License: GPL

# Unpack Phase:
Source: mirror:sourceforge:/%n/Releases/v%v/%n-source-%v.zip
Source-MD5: c56c2157e72aaf043ef9684b8fe13057
SourceDirectory: source

PatchScript: <<
#!/bin/sh -ev
  sed -i.bak 's|--strip-all||g' ddrescueview.lpi
<<

# Compile Phase (NOTE: there is no configure):
CompileScript: <<
#!/bin/sh -ev

  lazbuild ddrescueview.lpi

  convert ddrescueview.ico ddrescueview.png
  mv ddrescueview-1.png ddrescueview.png
  convert ddrescueview.png  -resize 512x512 ddrescueviewa.png
  convert ddrescueview.png  -resize 256x256 ddrescueviewb.png
  convert ddrescueview.png  -resize 128x128 ddrescueviewc.png
# using ddrescueview.png screws png2icns
  convert ddrescueviewa.png -resize  32x32  ddrescueviewd.png
  convert ddrescueview.png  -resize  16x16  ddrescueviewe.png
  png2icns ddrescueview.icns ddrescueviewa.png ddrescueviewb.png ddrescueviewc.png ddrescueviewd.png ddrescueviewe.png

  rm ddrescueview.app/Contents/MacOS/ddrescueview
  mv ddrescueview ddrescueview.app/Contents/MacOS/
  mv ddrescueview.icns ddrescueview.app/Contents/Resources/
  sed -i.bak 's|English|English</string> <key>CFBundleIconFile</key> <string>ddrescueview|g' ddrescueview.app/Contents/Info.plist
  rm ddrescueview.app/Contents/Info.plist.bak

<<

# Install Phase:
InstallScript: <<
#!/bin/sh -ev
  echo "nothing to install!"
<<

AppBundles: ddrescueview.app
DocFiles: ../*.txt

DescDetail: <<
This small tool allows the user to graphically examine ddrescue's log 
files in a user friendly GUI application. The Main window displays a 
block grid with each block's color representing the block types it 
contains. Many people know this type of view from defragmentation 
programs. The program is written in Object Pascal using the Lazarus IDE.
<<

DescUsage: <<
Double click the program ddrescueview in /Applications/Fink
<<

DescPort: <<
After the start there is this error message:
  Unable to open file "-psn_0_......."
No idea how to fix it.
<<

Homepage: http://sourceforge.net/projects/ddrescueview
Maintainer: Karl-Michael Schindler <karl-michael.schindler@web.de>
