Package: qgis-plugin-osm
Architecture: powerpc, i386, x86_64
Distribution: 10.4, 10.5, 10.6
Version: 0.5.0
Revision: 1
Description: MapServer plugin for QGIS
License: GPL
Homepage: http://qgis.org
Maintainer: BABA Yoshihiko <babayoshihiko@mac.com>
Depends:
BuildDepends:

# Unpack Phase.
Source: http://qgis.org/downloads/qgis-1.6.0.tar.bz2
Source-MD5: 9ea8a784d970f5009b0e6271820248f6
SourceDirectory: qgis-1.6.0

SetCFLAGS: -fno-common
SetLDFLAGS: -liconv
CompileScript: <<
#!/bin/bash -ev
  # Find Fink's PyQt4
  PY_VER=2.7
  perl -pi -e 's|sys.path = \[\\\"\"|sys.path = \[\\\"%p/lib/qt4-mac/lib/python'${PY_VER}'/site-packages\\", \\"\"|' src/python/qgspythonutilsimpl.cpp
  
  export QTDIR=%p/lib/qt4-mac
  export PYTHONPATH=%p/lib/qt4-mac/lib/python$PY_VER/site-packages:$PYTHONPATH
  export PATH=%p/lib/qt4-mac/lib/python$PY_VER/bin:$PATH
  
  
  QGIS_OPTIONS="-DCMAKE_PREFIX_PATH=%p
                -DEXECUTABLE_OUTPUT_PATH=%b/build/src/mac/Contents/MacOS
                -DCMAKE_INSTALL_PREFIX=%b/Applications
                -DCMAKE_BUILD_TYPE=Release
                -DGDAL_INCLUDE_DIR=%p/include/gdal1
                -DGEOS_CONFIG=%p/opt/libgeos3.2.2/bin/geos-config
                -DQT_BINARY_DIR=%p/lib/qt4-mac/bin
                -DQT_INCLUDE_DIR=%p/lib/qt4-mac/include
                -DQT_QMAKE_EXECUTABLE=%p/lib/qt4-mac/bin/qmake
                -DPYTHON_DEBUG_LIBRARY=%p/lib/python$PY_VER/config/libpython$PY_VER.dylib
                -DPYTHON_INCLUDE_PATH=%p/include/python$PY_VER
                -DPYTHON_LIBRARY=%p/lib/python$PY_VER/config/libpython$PY_VER.dylib
                -DPYTHON_EXECUTABLE=%p/bin/python$PY_VER
                -DPYUIC4_PROGRAM=%p/lib/qt4-mac/lib/python$PY_VER/bin/pyuic4
                -DSIP_INCLUDE_DIR=%p/include/python$PY_VER
                -DSIP_BINARY_PATH=%p/bin
                -DPOSTGRESQL_PREFIX=%p
                -DPOSTGRES_CONFIG=%p/bin/pg_config
                -DSQLITE3_INCLUDE_DIR=
                -DSQLITE3_LIBRARY=
                -DQWT_LIBRARY=%p/lib/qt4-mac/lib/libqwt.5.2.0.dylib
                -DQWT_INCLUDE_DIR=%p/lib/qt4-mac/include/qwt/"
  QGIS_DIR=Applications/QGIS.app/Contents
  
  mkdir build
  pushd build
  cmake $QGIS_OPTIONS ..
  # make pluginstaller
  # make mapserverexport
  make osmplugin
  pushd python/plugins
  make install CMAKE_INSTALL_PREFIX=%b SIP_MAC_PATH=%p/bin
  popd
  
<<
InstallScript: <<
  mkdir -p %i/share/qgis/python/plugins
  cp -R Applications/QGIS.app/Contents/Resources/python/plugins/osm %i/share/qgis/python/plugins/
<<
