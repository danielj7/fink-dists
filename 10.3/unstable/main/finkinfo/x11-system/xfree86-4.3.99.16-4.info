Package: xfree86
Version: 4.3.99.16
Revision: 4
Depends: %N-shlibs (>= %v-%r)
Replaces: x11
Provides: xserver, x11, rman, libgl, xfree86-base-threaded, xfree86-rootless-threaded, xft2, fontconfig1
Conflicts: xfree86-base, xfree86-base-threaded, xfree86-rootless, xfree86-rootless-threaded, system-xfree86, xfree86
GCC: 3.3
Source: ftp://ftp.xfree86.org/pub/XFree86/develsnaps/XFree86-%v.tar.bz2
Source-MD5: 9060c02f9e07620b8595e4d3da77a4b3
SourceDirectory: xc
PatchScript: <<
 echo '#define ExtraIncDir      %p/include'       > config/cf/host.def
 echo '#define EtcX11Directory  ProjectRoot/etc' >> config/cf/host.def
 patch -p0 < %a/%f.patch
<<
CompileScript: <<
#!/bin/sh -e

 if [ -f /usr/lib/libXplugin.dylib ]; then
   make World
 else
   echo "Whoa there, buddy, you're missing a library that *has* to be installed"
   echo "for this to build.  Not only that, it's part of the 'essential' install"
   echo "for Panther, so if you don't have it, either you're trying to build this"
   echo "package on 10.2 (and you're a naughty, naughty person), or your OSX"
   echo "install is corrupt.  I'm going to bail now."
   exit 1
 fi
<<
SplitOff: <<
 Package: %N-shlibs 
 Conflicts: xfree86-base-shlibs, xfree86-base-threaded-shlibs, xfree86-rootless-shlibs, xfree86-rootless-threaded-shlibs, system-xfree86, xfree86-shlibs
 Provides: libgl-shlibs, xfree86-base-threaded-shlibs, xfree86-rootless-threaded-shlibs, x11-shlibs, xft1-shlibs, xft2-shlibs, fontconfig1-shlibs
 Files: <<
   /usr/X11R6/lib/libAppleWM.*.dylib
   /usr/X11R6/lib/libFS.*.dylib
   /usr/X11R6/lib/libGL*.*.dylib
   /usr/X11R6/lib/libICE.*.dylib
   /usr/X11R6/lib/libOSMesa.*.dylib
   /usr/X11R6/lib/libSM.*.dylib
   /usr/X11R6/lib/libX11.*.dylib
   /usr/X11R6/lib/libXRes.*.dylib
   /usr/X11R6/lib/libXTrap.*.dylib
   /usr/X11R6/lib/libXaw.*.dylib
   /usr/X11R6/lib/libXcursor.*.dylib
   /usr/X11R6/lib/libXext.*.dylib
   /usr/X11R6/lib/libXfont.*.dylib
   /usr/X11R6/lib/libXfontcache.*.dylib
   /usr/X11R6/lib/libXft.*.dylib
   /usr/X11R6/lib/libXi.*.dylib
   /usr/X11R6/lib/libXinerama.*.dylib
   /usr/X11R6/lib/libXmu.*.dylib
   /usr/X11R6/lib/libXmuu.*.dylib
   /usr/X11R6/lib/libXp.*.dylib
   /usr/X11R6/lib/libXpm.*.dylib
   /usr/X11R6/lib/libXrandr.*.dylib
   /usr/X11R6/lib/libXrender.*.dylib
   /usr/X11R6/lib/libXss.*.dylib
   /usr/X11R6/lib/libXt.*.dylib
   /usr/X11R6/lib/libXtst.*.dylib
   /usr/X11R6/lib/libXv.*.dylib
   /usr/X11R6/lib/libXvMC.*.dylib
   /usr/X11R6/lib/libXxf86misc.*.dylib
   /usr/X11R6/lib/libXxf86vm.*.dylib
   /usr/X11R6/lib/libdps.*.dylib
   /usr/X11R6/lib/libdpstk.*.dylib
   /usr/X11R6/lib/libexpat.*.dylib
   /usr/X11R6/lib/libfontconfig.*.dylib
   /usr/X11R6/lib/libfontenc.*.dylib
   /usr/X11R6/lib/libfreetype.*.dylib
   /usr/X11R6/lib/liboldX.*.dylib
   /usr/X11R6/lib/libpsres.*.dylib
   /usr/X11R6/lib/libxkbfile.*.dylib
   /usr/X11R6/lib/libxkbui.*.dylib
 <<
 Shlibs: <<
   /usr/X11R6/lib/libAppleWM.1.dylib 1.0.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/libFS.6.dylib 6.0.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/libGL.1.dylib 1.2.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libGLU.1.dylib 1.3.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libICE.6.dylib 6.3.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libOSMesa.4.dylib 4.0.0 %n (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libSM.6.dylib 6.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libX11.6.dylib 6.2.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXRes.1.dylib 1.0.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/libXTrap.6.dylib 6.4.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXaw.6.dylib 6.1.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXaw.7.dylib 7.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXcursor.1.dylib 1.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXext.6.dylib 6.4.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXfont.1.dylib 1.5.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/libXft.1.dylib 1.1.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXft.2.dylib 2.1.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/libXi.6.dylib 6.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXinerama.1.dylib 1.0.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/libXmu.6.dylib 6.2.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXmuu.1.dylib 1.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXp.6.dylib 6.2.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXpm.4.dylib 4.11.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXrandr.2.dylib 2.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXrender.1.dylib 1.2.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXss.1.dylib 1.0.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/libXt.6.dylib 6.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXtst.6.dylib 6.1.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXv.1.dylib 1.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libXvMC.1.dylib 1.0.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/libXxf86misc.1.dylib 1.1.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/lib/libXxf86vm.1.dylib 1.0.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/libdps.1.dylib 1.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libdpstk.1.dylib 1.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libexpat.0.dylib 0.4.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/libfontconfig.1.dylib 1.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libfontenc.1.dylib 1.0.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/libfreetype.6.dylib 6.3.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/liboldX.6.dylib 6.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libpsres.1.dylib 1.0.0 xfree86 (>= 4.3.0-13) | system-xfree86 (>= 2:4.3-1)
   /usr/X11R6/lib/libxkbfile.1.dylib 1.0.0 %n (>= 4.3.99.15-1)
   /usr/X11R6/lib/libxkbui.1.dylib 1.0.0 %n (>= 4.3.99.15-1)
 <<
 PreInstScript: <<
    case "$1" in
    install)
    if [ -e /usr/X11R6/lib/libX11.6.dylib ]; then
      echo
      echo "You have an existing X11 installation in /usr/X11R6/lib."
      echo "This package refuses to overwrite these. Remove them, then tell Fink to"
      echo "install xfree86-shlibs again. (The package won't be recompiled.)"
      echo
      echo "Press Return to continue."
      read
      exit 1
    fi
    ;;
    upgrade)
    ;;
    esac
   <<
 <<
SplitOff2: <<
 Package: %N-dev
 Depends: %N-shlibs (= %v-%r)
 Conflicts: xfree86-base-dev, xfree86-base-threaded-dev, xfree86-rootless-dev, xfree86-rootless-threaded-dev, system-xfree86-dev
 Replaces: xfree86 (<< 4.3.99.16-3), xfree86-base-dev, xfree86-base-threaded-dev, xfree86-rootless-dev, xfree86-rootless-threaded-dev, system-xfree86-dev
 Provides: x11-dev, libgl-dev, xft2-dev, fontconfig1-dev
 Files: <<
   /usr/X11R6/include
   /usr/X11R6/lib/libAppleWM.dylib
   /usr/X11R6/lib/libFS.dylib
   /usr/X11R6/lib/libGL.dylib
   /usr/X11R6/lib/libICE.dylib
   /usr/X11R6/lib/libOSMesa.dylib
   /usr/X11R6/lib/libSM.dylib
   /usr/X11R6/lib/libX11.dylib
   /usr/X11R6/lib/libXRes.dylib
   /usr/X11R6/lib/libXTrap.dylib
   /usr/X11R6/lib/libXaw.dylib
   /usr/X11R6/lib/libXcursor.dylib
   /usr/X11R6/lib/libXext.dylib
   /usr/X11R6/lib/libXfont.dylib
   /usr/X11R6/lib/libXfontcache.dylib
   /usr/X11R6/lib/libXft.dylib
   /usr/X11R6/lib/libXi.dylib
   /usr/X11R6/lib/libXinerama.dylib
   /usr/X11R6/lib/libXmu.dylib
   /usr/X11R6/lib/libXmuu.dylib
   /usr/X11R6/lib/libXp.dylib
   /usr/X11R6/lib/libXpm.dylib
   /usr/X11R6/lib/libXrandr.dylib
   /usr/X11R6/lib/libXrender.dylib
   /usr/X11R6/lib/libXss.dylib
   /usr/X11R6/lib/libXt.dylib
   /usr/X11R6/lib/libXtst.dylib
   /usr/X11R6/lib/libXv.dylib
   /usr/X11R6/lib/libXvMC.dylib
   /usr/X11R6/lib/libXxf86misc.dylib
   /usr/X11R6/lib/libXxf86vm.dylib
   /usr/X11R6/lib/libdps.dylib
   /usr/X11R6/lib/libdpstk.dylib
   /usr/X11R6/lib/libexpat.dylib
   /usr/X11R6/lib/libfontconfig.dylib
   /usr/X11R6/lib/libfontenc.dylib
   /usr/X11R6/lib/libfreetype.dylib
   /usr/X11R6/lib/liboldX.dylib
   /usr/X11R6/lib/libpsres.dylib
   /usr/X11R6/lib/libxkbfile.dylib
   /usr/X11R6/lib/libxkbui.dylib
 <<
<<
InstallScript: <<
 make install install.man DESTDIR=%d
 mkdir -p %d/private 
 mv %d/etc %d/private 
<<
#
PreInstScript: <<
echo "WARNING: if you compile X11 applications against this XFree86 release,"
echo "you will *not* be able to run them if you decide to revert to Apple's"
echo "X11 provided with Panther."

case "$1" in
  install)
    if [ -e /usr/X11R6/bin/xterm -o -e /usr/X11R6/bin/xrdb -o \
	 -e /etc/X11 -o -L /etc/X11 ]; then
      echo
      echo "You have an existing X11 installation in /usr/X11R6 and/or /etc/X11."
      echo "This package refuses to overwrite these. Remove them, then tell Fink to"
      echo "install xfree86 again. (The package won't be recompiled.) If you want"
      echo "to keep your X11 installation, install system-xfree86 resp. system-xtools"
      echo "instead to make this known to Fink's package system."
      echo
      echo "Press Return to continue."
      read
      exit 1
    fi
    ;;
  upgrade)

    # deal with font listings (we no longer use xfont-base, font
    #  packages install their fonts in the Fink directories)
    for dir in 100dpi 75dpi CID cyrillic local misc Speedo Type1 ; do
      rm -f /usr/X11R6/lib/X11/fonts/$dir/fonts.dir /usr/X11R6/lib/X11/fonts/$dir/fonts.scale /usr/X11R6/lib/X11/fonts/$dir/fonts.scale.bak
    done
    ;;
esac
<<
PostInstScript: <<
if [ -L /etc/X11 ]; then
  rm -f /etc/X11
else
  if [ -e /etc/X11 ]; then
    echo "ERROR: /etc/X11 exists, but is not a symlink to /usr/X11R6/etc."
    exit 1
  fi
fi
ln -s /usr/X11R6/etc /etc/X11
<<
PreRmScript: <<
case "$1" in
  remove|purge)
    if [ -L /etc/X11 ]; then
      rm -f /etc/X11
    fi
    ;;
esac
<<
#
Description: Free X11 implementation for Darwin and Mac OS X
DescDetail: <<
XFree86 is a free X11 implementation that supports Darwin and Mac OS X.
This will let you run X11 applications and desktop environments.

This is a snapshot of what will become XFree86 4.4.  It includes all of
the changes Apple has made to their X11 release in Panther (minus the
proprietary quartz-wm), as well as other changes and bugfixes.  Because
libXplugin is available on every Panther install, it is even capable of
using the same quartz acceleration routines used by Apple's X11, without
needing their SDK to be installed when building.

IMPORTANT UPGRADE NOTICE:
-------------------------------------------------------------------------
If you already have the fink xfree86-base or xfree86-base-threaded package
installed, you cannot install this package with "fink install xfree86".

Instead, please install the xfree86-upgrade package and run the shell
script "upgrade-xfree86".
-------------------------------------------------------------------------
<<
DescPackaging: <<
WARNING: This package will not honor the prefix you installed Fink
in. It will always install into /usr/X11R6. This is by design. The
preinst script checks to make sure it doesn't overwrite existing
files.

Based on the XFree86 package.
<<
License: BSD
Homepage: http://www.xfree86.org/
Maintainer: Benjamin Reed <ranger@befunk.com>
