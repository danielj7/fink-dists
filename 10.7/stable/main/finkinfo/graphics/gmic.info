Package: gmic
Version: 1.5.8.5
Revision: 1
Description: GREYC's Magic Image Converter
License: DFSG-Approved
Maintainer: Hanspeter Niederstrasser <nieder@users.sourceforge.net>
Depends: <<
	atk1-shlibs (>= 1.32.0-1),
	cairo-shlibs (>= 1.12.14-1),
	fftw3-shlibs,
	fontconfig2-shlibs (>= 2.10.2-1),
	freetype219-shlibs (>= 2.4.11-1),
	gcc48-shlibs,
	gimp2-shlibs | gimp2-svg-shlibs,
	glib2-shlibs (>= 2.22.4-5),
	gtk+2-shlibs (>= 2.18.9-11),
	ilmbase-shlibs,
	libgettext8-shlibs,
	libjpeg9-shlibs (>= 9-3),
	libopenexr6-shlibs,
	libpng16-shlibs,
	libtiff5-shlibs,
	pango1-xft2-ft219-shlibs (>= 1.24.5-7),
	x11-shlibs
<<
BuildDepends: <<
	atk1 (>= 1.32.0-1),
	cairo (>= 1.12.14-1),
	dos2unix,
	fink-package-precedence,
	fftw3,
	fontconfig2-dev (>= 2.10.2-1),
	freetype219 (>= 2.4.11-1),
	gcc48-compiler,
	gimp2-dev | gimp2-svg-dev,
	glib2-dev (>= 2.22.4-5),
	gtk+2-dev (>= 2.18.9-11),
	ilmbase,
	libjpeg9 (>= 9-3),
	libopenexr6,
	libpng16,
	libtiff5,
	pango1-xft2-ft219-dev (>= 1.24.5-7),
	system-openssl-dev,
	x11-dev,
	xcode (>= 4.6)
<<
CustomMirror: <<
	Primary: http://downloads.sourceforge.net/%n/
	Secondary: http://downloads.sourceforge.net/%n/old/
<<
Source: mirror:custom:%n_%v.tar.gz
Source-MD5: 6bfa5cf4fff73d892578079b76fcba62
Source-Checksum: SHA1(5ef90c478308707e51ca57e831384e62015cc5ac)
SourceDirectory: %n-%v
PatchFile: %n.patch
PatchFile-MD5: dcc7173f4985d9803563c7573a9a3f89
PatchScript: <<
	# Upstream do'h
	# https://sourceforge.net/p/gmic/bugs/22/
	dos2unix src/Makefile
	sed 's|@FINKPREFIX@|%p|g' < %{PatchFile} | patch -p1
<<
### super memory intensive to compile, so only use 1 job to build
UseMaxBuildJobs: false
GCC: 4.0
CompileScript: <<
	#!/bin/sh -ev
	pushd src
		### 'make' also builds the zart test frontend that uses qt4, 
		### so let's not use it for now
		#export PATH=%p/lib/qt4-x11/bin:$PATH
		#make
		make macosx IS_GCC=yes
		make gimp IS_GCC=yes
		fink-package-precedence --depfile-ext='\.d' .
	popd
<<
InstallScript: <<
	#!/bin/sh -ev
	pushd src
		make install DESTDIR=%d
	popd
<<
DocFiles: COPYING README
Homepage: http://gmic.sourceforge.net/
DescDetail: <<
 G'MIC is focused on the design of possibly complex pipelines for converting,
 manipulating, filtering and visualizing generic 1d/2d/3d multi-spectral image
 datasets. This includes of course color images, but also more complex data
 as image sequences or 3d(+t) volumetric float-valued datasets.

 G'MIC is an open framework : the default language can be extended with
 custom G'MIC-written commands, defining thus new image available filters or
 effects. By the way, it already contains a substantial set of pre-defined
 image processing algorithms and pipelines (more than 1000).

 Includes these two binary tools:
   - The command-line executable 'gmic' to use the G'MIC framework from a
     shell.
   - The interactive and extensible plug-in 'gmic_gimp' to bring G'MIC
     capabilities to the image retouching software GIMP.
   - The ZArt real-time interface for webcams is currently not included in 
     the Fink package.
<<
DescPort: <<
o Hangs (or takes a _really_ long time) when using clang and optimizing at -O3.
  Change to use gcc48 since that builds when optimized. If want to change to
  clang, needs clang >= 3.1, and so must force xcode >= 4.5 (clang 4).  Also,
  remove IS_GCC=yes flag to stop -O3 optimizing.

o Be consistent in the use of $prefix to avoid installing outside %p

o The OpenCV parts of zart were created for an older version, and OpenCV
  changed their library names after 2.2, so make sure we use current names
<<
DescUsage: <<
This package installs a command line utility and Gimp-2.0 plugin.
<<
