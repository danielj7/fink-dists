diff -uNr graphviz-1.16-orig/lefty/common.h graphviz-1.16/lefty/common.h
--- graphviz-1.16-orig/lefty/common.h	2007-11-23 00:37:42.000000000 +0100
+++ graphviz-1.16/lefty/common.h	2007-11-23 00:38:07.000000000 +0100
@@ -50,6 +50,9 @@
 #endif
 /* */
 
+#ifdef HAVE_SYS_TYPES_H
+#include <sys/types.h>
+#endif
 #ifdef FEATURE_CS
 #include <ast.h>
 #else
@@ -68,9 +71,6 @@
 #ifdef HAVE_LIMITS_H
 #include <limits.h>
 #endif
-#ifdef HAVE_SYS_TYPES_H
-#include <sys/types.h>
-#endif
 #ifdef HAVE_SYS_STAT_H
 #include <sys/stat.h>
 #endif
diff -uNr graphviz-1.16-orig/lefty/os/unix/io.c graphviz-1.16/lefty/os/unix/io.c
--- graphviz-1.16-orig/lefty/os/unix/io.c	2007-11-23 00:37:42.000000000 +0100
+++ graphviz-1.16/lefty/os/unix/io.c	2007-11-23 00:38:07.000000000 +0100
@@ -1,5 +1,12 @@
 /* Lefteris Koutsofios - AT&T Bell Laboratories */
 
+#ifdef __APPLE__
+#include <AvailabilityMacros.h>
+#ifndef MAC_OS_X_VERSION_10_3
+#define socklen_t int
+#endif
+#endif
+
 #include "common.h"
 #include "io.h"
 #ifdef FEATURE_CS
diff -uNr graphviz-1.16-orig/ns/ns.c graphviz-1.16/ns/ns.c
--- graphviz-1.16-orig/ns/ns.c	2007-11-23 00:37:43.000000000 +0100
+++ graphviz-1.16/ns/ns.c	2007-11-23 00:38:07.000000000 +0100
@@ -10,19 +10,25 @@
 
 #ifdef HAVE_VALUES_H
 #include <values.h>
-#else
+#endif
+
+#ifdef HAVE_LIMITS_H
 #include <limits.h>
+#endif
+
 #ifndef MAXINT
 #define MAXINT INT_MAX
 #endif
+
 #include <float.h>
+
 #ifndef MAXDOUBLE
 #define MAXDOUBLE DBL_MAX
 #endif
+
 #ifndef MAXFLOAT
 #define MAXFLOAT FLT_MAX
 #endif
-#endif
 
 static int NS_run;
 
diff -uNr graphviz-1.16-orig/tkspline/tkspline.c graphviz-1.16/tkspline/tkspline.c
--- graphviz-1.16-orig/tkspline/tkspline.c	2007-11-23 00:37:43.000000000 +0100
+++ graphviz-1.16/tkspline/tkspline.c	2007-11-23 00:39:17.000000000 +0100
@@ -3,7 +3,6 @@
 #endif
 
 #include <tk.h>
-#include <tkInt.h>
 
 #ifndef CONST84
 #define CONST84
