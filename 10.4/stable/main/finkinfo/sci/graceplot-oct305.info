Info2: <<
Package: graceplot-oct305
Version: 1.0.6
Type: oct (3.0.5), forge (graceplot), gcc (4.6)
Revision: 7
Maintainer: Alexander Hansen <alexkhansen@users.sourceforge.net>
# unfortunately, Homepage won't do types
Homepage: http://octave.sourceforge.net/
Description: Graceplot bindings for octave
DescDetail: <<
Allows Octave to plot using GRACE.
It provides the following functions:
graphics:
        grace_octave_path
        toggle_grace_use
        subtitle
        cla
support:
        __grcmd__
        __grcla__
        __grclf__
        __grexit__
        __grfigure__
        __grgetstat__
        __grhold__
        __grinit__
        __grishold__
        __grnewset__
        __grsetgraph__
<<
License: GPL2

# All octave-forge packages have to have the following BuildDepends:
#  liboctave%type_pkg[oct]-gcc%type_pkg[gcc]-dev,
# fftw3, hdf5.7-oldapi

BuildDepends: <<
  liboctave%type_pkg[oct]-gcc%type_pkg[gcc]-dev,
  fftw3,
  hdf5.7-oldapi,
  fink (>=0.32)
 <<
RuntimeDepends: <<
  grace,
  io-oct%type_pkg[oct], 
  general-oct%type_pkg[oct]
<<
Depends: << 
  octave%type_pkg[oct]-interpreter,
  gcc%type_pkg[gcc]-shlibs
<<
Conflicts: octave-forge, octave-forge-%type_raw[forge] (<< 1.0.6-999)
Replaces: octave-forge-%type_raw[forge] (<< 1.0.6-999)

Source-MD5: 928765a7cc8160801fc9c754080a3af9

#### Insert required changes here ####

######################################

# Do not change anything from this point down, unless absolutely necessary,
# since the foo-oct%type_pkg[oct] packages are designed to be built/installed
# in the same way.

Source: mirror:sourceforge:octave/%type_raw[forge]-%v.tar.gz

NoSetCPPFLAGS: true
NoSetLDFLAGS: true
SetLIBRARY_PATH: /usr/X11R6/lib:%p/lib
UseMaxBuildJobs: false
BuildAsNobody: false

CompileScript: <<
#!/bin/sh -ev
if [ $UID -ne 0 ]
then 
	echo "%n cannot be built with --build-as-nobody"
	exit 1
fi
export OCTAVE=%p/bin/octave-%type_raw[oct]
%p/share/octave/%type_raw[oct]/scripts/octave-forge-compile.sh %type_raw[forge]-%v
<<

InstallScript: << 
	#!/bin/sh -ev
	%p/share/octave/%type_raw[oct]/scripts/octave-forge-install.sh %type_raw[forge]-%v %i %b
	mkdir -p %i/share/octave/%type_raw[oct]/%type_raw[forge]-%v
	# copy template scripts
	cp %p/share/octave/%type_raw[oct]/scripts/octave-forge-prerm %p/share/octave/%type_raw[oct]/scripts/octave-forge-postinst %i/share/octave/%type_raw[oct]/%type_raw[forge]-%v
	cd %i/share/octave/%type_raw[oct]/%type_raw[forge]-%v
	sed -i -e 's/@PKGNAME@/%type_raw[forge]-%v/' octave-forge-postinst
	sed -i -e 's/@PKGNAME@/%type_raw[forge]/' octave-forge-prerm
	chmod a+x octave-forge*
<<

PostInstScript:  <<
	if [ -s %p/var/octave/%type_raw[oct]/octave_packages ] && [ -f %p/var/octave/%type_raw[oct]/octave_packages ] 
	then 
 		`which xvfb-run` %p/share/octave/%type_raw[oct]/%type_raw[forge]-%v/octave-forge-postinst
	else
 		mv %p/share/octave/%type_raw[oct]/packages/%type_raw[forge]-%v/octave_packages %p/var/octave/%type_raw[oct]/octave_packages
	fi
<<

PreRmScript: `which xvfb-run` %p/share/octave/%type_raw[oct]/%type_raw[forge]-%v/octave-forge-prerm

DescPackaging: <<
Common for all octave-forge packages.

We read in postinst and prerm template scripts installed by octaveN and modify
them to use the name of this package because Octave's package manager can't 
cope with non-literal arguments.

The Type: forge (pkgname) is used to minimize what needs to be changed when
using this .info file as a template.
<<
<<