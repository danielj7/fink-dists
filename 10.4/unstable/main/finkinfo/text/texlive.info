Info2: <<
Package: texlive%type_pkg[-nox]
Type: -nox (boolean)
Version: 0.20080816
Revision: 2
GCC: 4.0
Description: Bundle package for TeX Live
Depends: %N-base (= %v-%r), texinfo, debianutils, texi2html
BuildDepends: <<
 libkpathsea4 (>= 3.5.7-1), t1lib5-nox, libpng3 (>= 1:1.2.8-1), libwww, libncurses5 (>= 5.4-20041023-1006), fink (>= 0.24.12),
 libjpeg, libiconv-dev,
 xz, freetype219 (>= 2.2.1-4),
 (%type_raw[-nox] = .)  t1lib5-x11, 
 (%type_raw[-nox] = .)  gd2 (>= 2.0.35-2), 
 (%type_raw[-nox] = .) x11, 
 (%type_raw[-nox] = .) xmkmf (>= 1.0.2-3),
 (%type_raw[-nox] = .) openmotif3
<<
Conflicts: <<
 system-tetex, tetex, tetex-nox, ptex (<= 3.1.10-1), ptex-nox (<= 3.1.10-1),
 texlive, texlive-nox
<<
Replaces: <<
 tetex, tetex-nox, ptex (<= 3.1.10-1), ptex-nox (<= 3.1.10-1),
 texlive, texlive-nox
<<
Provides: bundle-tetex, bundle-texlive
Recommends: detex, latex2html, tex4ht
Suggests: foiltex
Source: mirror:ctan:systems/texlive/Source/texlive-20080816-source.tar.lzma
Source-MD5: 554287c3e458da776edd684506048d45
Source2: http://tutimura.ath.cx/~nob/tex/ptexlive/ptexlive-20091009.tar.gz
Source2-MD5: 20df6cd2937f36eaf10e7066982232e2
Tar2FilesRename: ptexlive-20091009:ptexlive
NoSourceDirectory: true
PatchFile: texlive.patch
PatchFile-MD5: 7752f72a160e53fa1d5df638c97b19a7
PatchScript: <<
 lzma -dc texlive-20080816-source.tar.lzma | tar xf -
 mv       texlive-20080816-source                texlive
 sed 's|@PREFIX@|%p|g' < %{PatchFile} | patch -d texlive -p1

 # Change the directory to be installed
 sed -i.bak 's|^  texmf|  share/texmf|' texlive/texk/texlive/Makefile.in

 # Don't use tmpnam() in dvipdfm. (impoted from tetex-3.0-4.FC4)
 patch -d texlive -p1 < ptexlive/security/tetex-2.0.2-dvipdfm-security.patch

 # Fix xpdf integer overflow CVE-2007-3387 (impoted from tetex-3.0-35.fc6)
 patch -d texlive -p1 < ptexlive/security/texlive2007-CVE-2007-3387.patch

 # Fix cm-super bug on dvipdfm.map
 patch -d texlive -p1 < ptexlive/archive/updmap-cmsuper.patch

 # add --nostop option: don't stop even if a map file is not found
 patch -d texlive -p1 < ptexlive/archive/updmap-nostop.patch

 # for pTeX (Japanese font setting)
 patch -d texlive -p1 < ptexlive/archive/updmap-live2008-4b.diff
<<
SetCPPFLAGS:-I%p/lib/freetype219/include/freetype2 -I%p/lib/freetype219/include
SetLDFLAGS: -L%p/lib/freetype219/lib
NoSetMAKEFLAGS: true
SetMAKEFLAGS: -j1
ConfigureParams: <<
 --without-texi2html --without-texinfo --enable-shared \
 --datadir='${prefix}/share' --infodir='${prefix}/share/info' \
 --mandir='${prefix}/share/man' --disable-multiplatform --with-system-ncurses \
 --with-system-pnglib --with-system-t1lib --with-system-wwwlib \
 --with-system-zlib \
 --without-psutils --without-dialog --without-tex4htk --without-t1utils \
 --without-detex --without-dvipdfmx --without-lcdf-typetools \
 --without-xindy --without-xdv2pdf --without-xetex --without-xdvipdfmx \
 --without-lacheck --without-ttf2pk \
 --with-luatex --with-mf-nowin --with-old-mac-fonts \
 --with-system-freetype2 --with-freetype2-libdir=%p/lib/freetype219/lib \
 --with-freetype2-include=%p/lib/freetype219/include \
 (%type_raw[-nox] = .) --with-system-gd 
 (%type_raw[-nox] = .) --x-includes=/usr/X11R6/include
 (%type_raw[-nox] = .) --x-libraries=/usr/X11R6/lib
 (%type_raw[-nox] = -nox) --without-x 
 (%type_raw[-nox] = -nox) --without-xdvik
 (%type_raw[-nox] = -nox) --without-pdfopen
<<
CompileScript: <<
#!/bin/bash -ev
 export PATH=%p/lib/xmkmf/bin:%p/lib/freetype219/bin:$PATH 
 export IMAKEINCLUDE=-I%p/lib/X11/config
 mkdir texlive/Work
 cd texlive/Work && ../configure %c && make
<<
InstallScript: <<
#!/bin/bash -ev
 export PATH=%p/lib/xmkmf/bin:$PATH 
 export IMAKEINCLUDE=-I%p/lib/X11/config
 cd texlive/Work && make install prefix=%i texmf=%i/share/texmf run_texlinks=true run_mktexlsr=true
 %i/bin/mktexlsr %i/share/texmf

echo "Removing files that belong to the libkpathsea4 package..."

 rm -R %i/include
 rm -R %i/lib
 rm %i/share/info/kpathsea.info

echo "Setting up symlinks ..."
 export DYLD_LIBRARY_PATH="%b/texk/kpathsea/SHARED" PATH=%i/bin:$PATH TEXMFMAIN=%p/share/texmf-dist ; texlinks --cnffile %i/share/texmf/web2c/fmtutil.cnf --verbose %i/bin

echo "Creating a local texmf tree, and symlinking it into place ..."
 mkdir -p %i/etc/texmf.local
 %i/bin/mktexlsr %i/etc/texmf.local
 mkdir -p %i/share
 ln -s %p/etc/texmf.local %i/share/texmf-local

echo "Creating a VARTEXMF tree, including a fonts directory ..."
 mkdir -p %i/var/lib/texmf/fonts
 %i/bin/mktexlsr %i/var/lib/texmf

echo "Creating a TEXMFCONFIG tree ..."
 mkdir -p %i/etc/texmf-config
 %i/bin/mktexlsr %i/etc/texmf-config

echo "Removing the ls-R file, which is supplied in the texlive-texmf package ..."
 rm -f %i/share/texmf-dist/ls-R

if [ "%type_raw[-nox]" == "." ]; then
echo "Preparing xdvi for the alternatives system ..."
 mv %i/bin/xdvi %i/bin/xdvik
 mv %i/share/man/man1/xdvi.1 %i/share/man/man1/xdvik.1
fi
<<
DocFiles: texlive/README
SplitOff: <<
 Package: %N-base
 Description: Base programs for a TeX Live installation
 Depends: <<
  t1lib5-nox-shlibs, libpng3-shlibs (>= 1:1.2.8-1), 
  libwww-bin, libncurses5-shlibs (>= 5.4-20041023-1006), ncurses (>= 5.4-20041023-1006),
  fink (>= 0.12.0-1), libkpathsea4-shlibs (>= 3.5.7-1), texlive-texmf,
  freetype219-shlibs (>= 2.2.1-4),
  (%type_raw[-nox] = .) t1lib5-x11-shlibs,
  (%type_raw[-nox] = -nox) ghostscript-nox, 
  (%type_raw[-nox] = .) ghostscript, 
  (%type_raw[-nox] = .) gd2-shlibs (>= 2.0.35-2), 
  (%type_raw[-nox] = .) x11, 
  (%type_raw[-nox] = .) x11-shlibs,
  (%type_raw[-nox] = .) openmotif3-shlibs
 <<
 Conflicts: <<
  texlive-base (>= 0), texlive-nox-base,
  tetex-base (>= 0), tetex-nox-base, ptex-base (<= 3.1.10-1003), ptex-nox-base (<= 3.1.10-1003)
 <<
 Replaces: <<
  texlive-base (>= 0), texlive-nox-base,
  tetex-base (>= 0), tetex-nox-base, ptex-base (<= 3.1.10-1003), ptex-nox-base (<= 3.1.10-1003),
  context, dvipdfm, epstopdf, pdftex, tetex-macosx, tetex (<= 2.0-3),
  (%type_raw[-nox] = .) xdvi (<=  22.70-1), 
 <<
 Provides: context, dvipdfm, epstopdf, pdftex, tetex-macosx, tetex-base, tetex3-base, texlive-base
 Files: bin etc share/info share/man share/texmf share/texmf-dist share/texmf-local var
 InfoDocs: web2c.info dvips.info dvipng.info
 DocFiles: texlive/README
 ConfFiles: %p/share/texmf/web2c/texmf.cnf
 PreInstScript: <<
  echo "Removing any leftover files from obsolete teTeX installations ..."
  rm -f %p/etc/texmf.local/web2c/*
  rm -f %p/etc/ls-R/texmf.macosx
  rm -Rf %p/share/texmf.macosx
  rm -Rf %p/etc/texmf-var
  rm -Rf %p/var/lib/texmf
 <<
 PostInstScript: <<
if [ -e %p/bin/xdvik ] ; then
  update-alternatives --install %p/bin/xdvi xdvi %p/bin/xdvik 30 --slave %p/share/man/man1/xdvi.1 xdvi.1 %p/share/man/man1/xdvik.1
fi
  mktexlsr %p/share/texmf{,-dist} %p/etc/texmf-config %p/etc/texmf.local 
  PATH=%p/bin:${PATH} texconfig-sys init

  echo "Adjusting permissions ..."
  chmod -R a+rX %p/etc/texmf.local
  chmod -R a+rwX %p/var/lib/texmf
  chmod -R a+rwX %p/etc/texmf-config
  if [ -f ~/Library/texmf/ls-R ]; then chmod a+rw ~/Library/texmf/ls-R; fi
 <<
 PreRmScript: <<
  if [ "$1" != "upgrade" ]; then
    if [ -e %p/bin/xdvik ]; then
      update-alternatives --remove xdvi %p/bin/xdvik
    fi
  fi
 <<
<<
License: Restrictive/Distributable
Maintainer: Todai Fink Team <fink@sodan.ecc.u-tokyo.ac.jp>
Homepage: http://www.tug.org/texlive/
<<
