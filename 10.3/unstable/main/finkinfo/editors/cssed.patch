--- cssed-pre0.1/Makefile.old.am	Mon Jan 12 23:06:32 2004
+++ cssed-pre0.1/Makefile.am	Sun Jan 25 11:31:32 2004
@@ -1,6 +1,6 @@
 ## Process this file with automake to produce Makefile.in
 
-SUBDIRS = libcroco scintilla src po
+SUBDIRS = libcroco scintilla src
 
 man_MANS = cssed.1
 
--- cssed-pre0.1/configure.in	Wed Dec 24 16:23:11 2003
+++ cssed-pre0.1/configure.in.patched	Sat Jan 17 20:10:52 2004
@@ -31,6 +31,7 @@
 AC_PROG_LN_S
 AC_PROG_MAKE_SET
 AC_PROG_RANLIB
+AC_CANONICAL_HOST
 
 dnl Checks for typedefs, structures, and compiler characteristics.
 AC_HEADER_STDBOOL
@@ -45,12 +46,38 @@
 AM_GLIB_GNU_GETTEXT
 
 dnl ************************
+dnl Checks for OS type
+dnl ************************
+case "${host}" in
+i[[3456]]86-*-linux-gnu*) 
+	OSTYPE="LINUX"
+	 ;;
+dnl sparc*-sun-solaris2.[[56789]]*) echo "System solaris2" ;;
+dnl sparc*-sun-solaris*) echo "System Solaris" ;;
+dnl mips*-*-elf*) echo "System mips" ;;
+powerpc-apple-darwin*)
+	OSTYPE="DARWIN"
+	;; 
+esac
+
+dnl ************************
 dnl Checks for librarries
 dnl ************************
 
 AC_PATH_PROG(PKG_CONFIG, pkg-config, no)
 if test "x$PKG_CONFIG" = "xno" ; then
-	AC_MSG_ERROR(pkg-config not found please install pkg-config)
+	if test "x$OSTYPE" = "xDARWIN";then
+		AC_MSG_CHECKING(if pkg-config is in @PREFIX@/bin)
+		if test -x @PREFIX@/bin/pkg-config; then
+			echo "yes"			
+			 AC_MSG_ERROR(pkg-config exist but out of the PATH. Please add @PREFIX@/bin to your PATH environment variable.PATH=$PATH:@PREFIX@/bin)			
+		else
+			AC_MSG_ERROR(pkg-config not found please install pkg-config or ensure that it is in a directory included in your PATH. You can also set 
+the PKG_CONFIG environment variable)
+		fi
+	else
+		AC_MSG_ERROR(pkg-config not found please install pkg-config or ensure that it is in a directory included in your PATH)
+	fi
 fi
 
 echo -n "checking for gtk+-2.0... "
@@ -91,7 +118,32 @@
 AC_SUBST(PACKAGE_CFLAGS)
 AC_SUBST(PACKAGE_LIBS)
 
-
+dnl *********************************
+dnl Check for expat library in MacOsX
+dnl *********************************
+if test "x$OSTYPE" = "xDARWIN"; then
+      	PACKAGE_LIBS="$PACKAGE_LIBS -lexpat" 
+	AC_MSG_CHECKING(if expat links in this system)
+       	 AC_TRY_LINK(
+       	  [#include <expat.h>],
+       	  [  XML_Parser p;
+       	     p = XML_ParserCreate(NULL);
+       	 ], expat_link=1)
+       	 if test "$expat_link" != 1; then
+       	        echo "*FAILED*"
+       	        if test -d /usr/X11R6; then
+       		         echo "standard X11 directory found in /usr/"
+			if test -e /usr/X11R6/lib/libexpat.dylib; then
+             			echo "expat exists, adding /usr/X11R6/lib to the link path and praying for the best"
+				PACKAGE_LIBS="-L/usr/X11R6/lib $PACKAGE_LIBS"
+			else
+				AC_MSG_ERROR(I'm unable to find expat in this system)
+			fi
+		else
+			AC_MSG_ERROR(I'm unable to compile a expat test in this system and can't find expat libs)
+		fi
+       	fi
+fi
 dnl With defines at configure time
 AC_ARG_WITH(debugging-output,
 [  --with-debugging-output Turns debugging output on],[

--- cssed-pre0.1/src/document.c	Mon Jan 12 05:43:29 2004
+++ cssed-pre0.1/src/document.patched.c	Mon Jan 12 05:43:55 2004
@@ -31,8 +31,8 @@
 #include <gtk/gtk.h>
 #include <stdio.h>
 #include <unistd.h>
-#include <sys/mman.h>
 #include <sys/types.h>
+#include <sys/mman.h>
 #include <sys/stat.h>
 #include <fcntl.h>
 #include <libgen.h>	

--- cssed-pre0.1/src/xmlparser.c	Mon Jan 12 05:43:03 2004
+++ cssed-pre0.1/src/xmlparser.patched.c	Mon Jan 12 05:44:17 2004
@@ -25,8 +25,8 @@
 #include <stdlib.h>
 #include <expat.h>
 #include <unistd.h>
-#include <sys/mman.h>
 #include <sys/types.h>
+#include <sys/mman.h>
 #include <sys/stat.h>
 #include <fcntl.h>
 #include <gtk/gtk.h>
