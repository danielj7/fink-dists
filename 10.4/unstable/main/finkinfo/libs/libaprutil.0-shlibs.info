Package: libaprutil.0-shlibs
Version: 1.3.4
Revision: 8

Depends: db47-aes-shlibs | db47-shlibs, expat1-shlibs, gdbm3-shlibs, libapr.0-shlibs, libiconv, mysql-ssl15-shlibs | mysql15-shlibs, openldap24-shlibs, postgresql83-shlibs, sqlite-shlibs, sqlite3-shlibs, unixodbc2-shlibs | unixodbc2-nox-shlibs
BuildDepends: db47-aes | db47, expat1, gdbm3, libapr.0-dev, libiconv-dev, mysql-ssl15-dev | mysql15-dev, openldap24-dev, postgresql83-dev, sqlite-dev, sqlite3-dev, unixodbc2 | unixodbc2-nox, pkgconfig
Replaces: libaprutil0-shlibs
# a transient libaprutil0-shlibs accidentally installed something else at the install_name location

Source: mirror:apache:apr/apr-util-%v.tar.gz
Source-MD5: a10e2ca150ff07f484c724c36142211f

PatchScript: <<
  ### Fix layout
  perl -pi -e 's,/usr/local,%p,g' config.layout
  perl -pi -e 's,\@LDADD_ldap\@|\@APRUTIL_EXPORT_LIBS\@,,g' apr-util.pc.in apu-config.in
  perl -pi -e 's,\@APRUTIL_MAJOR_VERSION\@,,' test/Makefile.in
<<

ConfigureParams: --enable-layout=GNU --with-apr=%p --with-ldap-include=%p/include --with-ldap-lib=%p/lib --with-ldap --with-dbm=db47 --with-gdbm=%p --with-berkeley-db=%p --with-pgsql=%p --with-mysql=%p --with-sqlite2=%p --with-sqlite3=%p --with-expat=%p --with-iconv=%p --disable-static

NoSetLDFLAGS: true

InstallScript: <<
  make install prefix=%i
  rm %i/lib/aprutil.exp
  #No need for dependency_libs in .la files if not building static libs
  perl -pi -e "s/dependency_libs=.*$/dependency_libs=''/" %i/lib/*.la %i/lib/apr-util-1/*la
<<

DocFiles: CHANGES LICENSE NOTICE README.MySQL

Shlibs: <<
  %p/lib/libaprutil.0.dylib 4.0.0 %n (>= 1.3.4-4)
<<

SplitOff: <<
  Package: libaprutil.0-dev
  Conflicts: apr-common (<< 1:0-0), apr-ssl-common (<< 1:0-0), aprutil-dev (<< 1:0-0), libaprutil-dev (<< 1:0-0)
  Replaces: apr-common (<< 1:0-0), apr-ssl-common (<< 1:0-0), aprutil-dev (<< 1:0-0), libaprutil-dev (<< 1:0-0)
  Depends: %N (= %v-%r), pkgconfig
  BuildDependsOnly: True
  Description: Headers and static libraries for APRUTIL
  Files: <<
    bin
    include
    lib/pkgconfig
    lib/libaprutil.la
    lib/libaprutil.dylib
  <<
  DocFiles: LICENSE
<<

Description: APRUTIL shared libraries
DescDetail: <<
  The mission of the Apache Portable Runtime (APR) project is to create and
  maintain software libraries that provide a predictable and consistent
  interface to underlying platform-specific implementations. The primary goal
  is to provide an API to which software developers may code and be assured
  of predictable if not identical behaviour regardless of the platform on
  which their software is built, relieving them of the need to code
  special-case conditions to work around or take advantage of
  platform-specific deficiencies or features.
<<
License: BSD
Maintainer: Justin F. Hallett <thesin@users.sourceforge.net>
Homepage: http://apr.apache.org/

InfoTest: TestScript: make check || exit 2
