--- R/configure.orig	Fri Nov 12 05:43:57 2004
+++ R/configure	Fri Nov 12 06:53:30 2004
@@ -28944,7 +28944,7 @@
 
     ## LIBR_LDFLAGS="-dynamiclib -install_name ${R_FRAMEWORK_DIR}/Versions/${PACKAGE_VERSION}/Resources/bin/libR.dylib -compatibility_version ${PACKAGE_VERSION}  -current_version ${PACKAGE_VERSION}"
     MAJR_VERSION=`echo "${PACKAGE_VERSION}" | sed  -e "s/[\.][1-9]$/.0/"`
-    LIBR_LDFLAGS="-dynamiclib -install_name libR.dylib -compatibility_version ${MAJR_VERSION}  -current_version ${PACKAGE_VERSION}  -headerpad_max_install_names"
+    LIBR_LDFLAGS="-dynamiclib -install_name ${prefix}/R.framework/Versions/${PACKAGE_VERSION}/Resources/lib/libR.dylib -compatibility_version ${MAJR_VERSION}  -current_version ${PACKAGE_VERSION}  -headerpad_max_install_names"
     ##    fi
     ## <FIXME>
     ## We need '-framework Carbon' because currently the Quartz device
--- R/Makefile.in.orig	Fri Nov 12 05:47:28 2004
+++ R/Makefile.in	Fri Nov 12 06:48:44 2004
@@ -87,7 +87,8 @@
 	  $(INSTALL_DATA) $(srcdir)/$${f} "$(rhome)"; \
 	done
 @WANT_R_FRAMEWORK_TRUE@		$(MAKE) install-R-framework
-@WANT_R_FRAMEWORK_TRUE@		@(sed 's/^LIBR =.*/LIBR = -framework R/' \
+#@WANT_R_FRAMEWORK_TRUE@		@(sed 's/^LIBR =.*/LIBR = -framework R/' \
+@WANT_R_FRAMEWORK_TRUE@                @(sed 's|^LIBR =.*|LIBR = -F$(prefix) -framework R|' \
 @WANT_R_FRAMEWORK_TRUE@		  $(top_builddir)/etc/Makeconf > "$(rhome)/etc/Makeconf")
 @WANT_R_FRAMEWORK_TRUE@		@(sed 's/Versions\/$(VERSION)\/Resources/Resources/' \
 @WANT_R_FRAMEWORK_TRUE@		  $(R_FRAMEWORK_DIR)/Resources/bin/R > \
@@ -198,8 +199,8 @@
 	@(cd "$(R_FRAMEWORK_DIR)/Resources/bin" && \
 	  sed 's/^args=/args=--gui=aqua/' < R > RAqua && \
 	  chmod 755 RAqua) 
-	@(cd "$(R_FRAMEWORK_DIR)/Resources/lib" && \
-	  install_name_tool -id "$(R_FRAMEWORK_DIR)/Versions/$(VERSION)/Resources/lib/libR.dylib" ../lib/libR.dylib)
+#@(cd "$(R_FRAMEWORK_DIR)/Resources/lib" && \
+#  install_name_tool -id "$(R_FRAMEWORK_DIR)/Versions/$(VERSION)/Resources/lib/libR.dylib" ../lib/libR.dylib)
 	@(sed 's/Versions\/$(VERSION)\/Resources/Resources/' $(R_FRAMEWORK_DIR)/Resources/bin/RAqua > \
 	  $(R_FRAMEWORK_DIR)/Resources/bin/RRAqua)
 	@(mv $(R_FRAMEWORK_DIR)/Resources/bin/RRAqua $(R_FRAMEWORK_DIR)/Resources/bin/RAqua)
@@ -213,18 +214,18 @@
 	  -change libR.dylib "$(R_FRAMEWORK_DIR)/Versions/$(VERSION)/Resources/lib/libR.dylib" \{\} \;)
 
 install-aqua:
-	@(rm -rf /Applications/R.app)
-	@(mkdir -p /Applications/R.app/Contents/Resources)
+	@(rm -rf $(FINKPREFIX)/Applications/R.app)
+	@(mkdir -p $(FINKPREFIX)/Applications/R.app/Contents/Resources)
 	@(cd "$(srcdir)/src/modules/aqua/Contents" && \
-	  cp PkgInfo /Applications/R.app/Contents)
+	  cp PkgInfo $(FINKPREFIX)/Applications/R.app/Contents)
 	@(cd "$(top_builddir)/src/modules/aqua/Contents" && \
-	  cp Info.plist  /Applications/R.app/Contents)
+	  cp Info.plist  $(FINKPREFIX)/Applications/R.app/Contents)
 	@(cd "$(srcdir)/src/modules/aqua/Contents/Resources" && \
-	  cp -R * /Applications/R.app/Contents/Resources)
-	@(mkdir -p /Applications/R.app/Contents/MacOS)
-	@test -f "$(R_FRAMEWORK_DIR)/Resources/bin/RAqua"  \
-	  || (echo "please, make install-R-framework first" &&  exit 1)
-	@(cd /Applications/R.app/Contents/MacOS && \
-	  ln -f -n "$(R_FRAMEWORK_DIR)/Resources/bin/RAqua" R && \
+	  cp -R * $(FINKPREFIX)/Applications/R.app/Contents/Resources)
+	@(mkdir -p $(FINKPREFIX)/Applications/R.app/Contents/MacOS)
+#@test -f "$(R_FRAMEWORK_DIR)/Resources/bin/RAqua"  \
+#  || (echo "please, make install-R-framework first" &&  exit 1)
+	@(cd $(FINKPREFIX)/Applications/R.app/Contents/MacOS && \
+	  ln -f -s "$(R_FRAMEWORK_DIR)/Resources/bin/RAqua" R && \
 	  chmod 755 R)
 TAGS:
