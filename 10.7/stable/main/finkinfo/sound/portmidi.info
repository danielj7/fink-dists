Package: portmidi
Version: 0.217
Revision: 1
Maintainer: Sjors Gielen <fink@sjorsgielen.nl>

Depends: portmidi-shlibs (= %v-%r)
BuildDepends: cmake, fink (>= 0.24.12)
BuildDependsOnly: true

Source: mirror:sourceforge:portmedia/%n-src-217.zip
Source-MD5: 03f46fd3947e2ef4c8c465baaf832241
PatchFile: %n.patch
PatchFile-MD5: a4c3b2e6088f61b235f4293a285b4fef
SourceDirectory: portmidi

CompileScript: <<
#!/bin/sh -ev
	cmake -DCMAKE_INSTALL_PREFIX:PATH=%p .
	make VERBOSE=1
<<

InstallScript: <<
	ls -laR
	mkdir -p %i/include %i/lib
	cp pm_common/portmidi.h %i/include
	cp porttime/porttime.h %i/include

	install_name_tool -id "%p/lib/libpmjni.0.0.dylib" libpmjni.dylib
	cp libpmjni.dylib %i/lib/libpmjni.0.0.dylib
	ln -s %i/lib/libpmjni.0.0.dylib %i/lib/libpmjni.0.dylib
	ln -s %i/lib/libpmjni.0.0.dylib %i/lib/libpmjni.dylib

	install_name_tool -id "%p/lib/libportmidi.0.0.dylib" libportmidi.dylib
	cp libportmidi.dylib %i/lib/libportmidi.0.0.dylib
	ln -s %i/lib/libportmidi.0.0.dylib %i/lib/libportmidi.0.dylib
	ln -s %i/lib/libportmidi.0.0.dylib %i/lib/libportmidi.dylib

	cp libportmidi_s.a %i/lib
	ranlib %i/lib/libportmidi_s.a

	ls -laR %i
<<

DocFiles: CHANGELOG.txt README.txt license.txt

Description: Cross-platform real-time MIDI input/output

License: BSD
Homepage: http://portmedia.sourceforge.net/

SplitOff: <<
  Package: %N-shlibs
  Files: <<
    lib/libpmjni.0.0.dylib
    lib/libportmidi.0.0.dylib
  <<
  Shlibs: <<
    %p/lib/libpmjni.0.0.dylib 0.0.0 %n (>= 0.217-1)
    %p/lib/libportmidi.0.0.dylib 0.0.0 %n (>= 0.217-1)
  <<
  DocFiles: license.txt
<<
