Package:coot
Version: 0.0.7
Revision: 2
BuildDepends: clipper, glib, gtk-canvas, gtk+2, glut, gtkglarea, guile16, guile16-dev, gsl, libglade2
# scientificpython-py23
Depends: clipper, guile16-shlibs, gtkglarea, gsl-shlibs, libglade2-shlibs, guile16-gtk, guile16-www, guile16-gui, guile16-goosh, libssm
# scientificpython-py23, 
Source: http://www.ysbl.york.ac.uk/~emsley/software/%n-%v.tar.gz
Source-MD5: c0fcee8e687b7cc2deaa42311309da73 
Source2: http://www.ysbl.york.ac.uk/~emsley/software/coot-scheme-0.0.1.tar.gz
Source2-MD5: f150acd6a9468d0d630153268b55fb1b  
Source3: http://www.ysbl.york.ac.uk/~emsley/software/extras/syminfo.lib
Source3-MD5: ee0781efc2874c601441078d76c03cb9
Source4: http://www.ysbl.york.ac.uk/~emsley/software/extras/refmac-lib-data-monomers.tar.gz
Source4-MD5: c7aa4ee8861d7e82df985fe2eb39c289
Source5: http://www.ysbl.york.ac.uk/~emsley/software/extras/reference-structures.tar.gz
Source5-MD5: c09bb6b5524901cb0fde14589546224e
Source6: http://www.chemistry.ucsc.edu/~wgscott/xtal/%n-getopt.h.gz
Source6-MD5: 2e62360c294b0d76ef3f055870fb9259
DocFiles: README AUTHORS NEWS COPYING ABOUT-NLS BUGS TODO
Description: Crystallographic molecular graphics
DescDetail: <<
Coot stands for Crystallograhic Object Oriented Toolkit.  
It is a testbest toolkit for (Protein) Crystallography.  Coot used to
be called MapView.  Coot uses professional (and free) widgets (with
the gui builder glade), mmdb, clipper, and OpenGL, together with a new
approach to map contouring and importing/creation and other
(modelling) operations.
<<
PatchScript:  <<
#!/bin/zsh -f

# Make a wrapper for coot to avoid DYLD_LIBRARY_PATH issue and put other env variables in there
# as long as we are at it.

cat >| coot.zsh << eof-1
#!/bin/zsh
PUTATIVELY_ERSTWHILE_DYLD_LIBRARY_PATH=\$DYLD_LIBRARY_PATH
PUTATIVELY_ERSTWHILE_GUILE_LOAD_PATH=\$GUILE_LOAD_PATH
ERSTWHILE_CLIBD=\$CLIBD
export DYLD_LIBRARY_PATH=%p/lib
export COOT_SCHEME_DIR=%p/share/%n/scheme
export COOT_REFMAC_LIB_DIR=%p/share/coot/lib
export COOT_STANDARD_RESIDUES=%p/share/%n/standard-residues.pdb
export GUILE_LOAD_PATH=\$GUILE_LOAD_PATH:%p/share/guile/1.6:%p/share/guile:%p/share/guile/1.6/gtk-1.2:%p/share/guile/1.6/gui:%p/share/guile/1.6/goosh:%p/share/guile/1.6/www
export COOT_REF_STRUCTS=%p/share/coot/reference-structures
export COOT_RESOURCES_FILE=%p/share/coot/cootrc
export COOT_RESOURCES_DIR=%p/share/coot/pixmaps
export CLIBD=%p/share/coot/lib
%p/bin/coot.exe "\$@"
export DYLD_LIBRARY_PATH=\$PUTATIVELY_ERSTWHILE_DYLD_LIBRARY_PATH
export GUILE_LOAD_PATH=\$PUTATIVELY_ERSTWHILE_GUILE_LOAD_PATH
export CLIBD=\$ERSTWHILE_CLIBD
eof-1

chmod a+x coot.zsh

perl -pi -e 's/include <malloc.h>//g' **/*.c
perl -pi -e 's|core -L\$clipper_prefix/mccp4 -lmccp4 \$MMDB_LIBS -L\$clipper_prefix/fftw/lib -lrfftw -lfftw -lz -lm|core  -lmccp4 \$MMDB_LIBS  -lsrfftw -lsfftw -lz -lm|g' configure

# Add missing header file
cp ../%n-getopt.h.gz .
gunzip %n-getopt.h.gz
cp %n-getopt.h coot-utils/.
<<
CompileScript: <<
#!/bin/zsh -f
  export PATH=%p/share/guile/1.6/scripts/binoverride:$PATH
./configure --prefix=%i --with-mmdb-prefix=%p --with-clipper-prefix=%p --with-glut-prefix=%p --with-gl-prefix=/usr/X11R6 --with-gtkcanvas-prefix=%p --with-guile=%p --with-fftw=%p --with-mmdbssm-prefix=%p --with-imlib-prefix=%p --with-gtkgl-prefix=%p --with-glib-prefix=%p --with-gsl-prefix=%p
# --with-python=%p
#
  export GUILE_LOAD_PATH=%p/share/guile/1.6
#
cp ../syminfo.lib .
make
<<
InstallScript: <<
#!/bin/zsh -f
make install
/bin/rm -rf %i/setup
#
# Add ancillary files to %i/share/coot:
#
mkdir -p %i/share/coot
cp -R ../scheme %i/share/coot/.
cp -R ../lib %i/share/coot/.
cp -R ../reference-structures %i/share/coot/.
cp ../syminfo.lib  %i/share/coot/lib/.
#
# move the coot executable and replace it with the coot.zsh schell script wrapper
#
mv %i/bin/coot %i/bin/coot.exe
cp coot.zsh %i/bin/coot
<<
License: GPL
Maintainer: W. G. Scott <wgscott@users.sourceforge.net> 
Homepage: http://www.ysbl.york.ac.uk/~emsley/coot/
