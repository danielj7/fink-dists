Package: upclient
Version: 4.2.1.23
Revision: 3
Maintainer: Sylvain Cuaz <zauc@users.sf.net>
#
Depends: daemonic
Source: http://uptimes.atomicvoid.net/files/%n-%v.tar.gz
Source-MD5: 4c23b4623ecd490b5d3e31ac67f20feb
PatchScript: <<
  cd conf ; mv upclient.conf upclient.conf.orig
  cd conf ; sed -e 's|/var/run/upclient.pid|%p/var/run/upclient.pid|' -e 's|data.uptimes.net|uptimes.wonko.com|' < upclient.conf.orig > upclient.conf
  cd src ; mv Makefile Makefile.orig
  cd src ; sed -e 's|CONFIGFILE = upclient.conf|CONFIGFILE = %p/etc/upclient.conf|' < Makefile.orig > Makefile
  patch -p1 < %a/%f.patch
<<
CompileScript: cd src ;  make darwin
InstallScript: <<
 mkdir %i/bin
 install -m 755 src/upclient %i/bin
 mkdir %i/etc
 install -m 600 conf/upclient.conf %i/etc
<<
DocFiles: AUTHORS COPYING FAQ HISTORY INSTALL README TODO
ConfFiles: %p/etc/%n.conf

DaemonicFile: <<
<service>
 <description>upclient</description>
 <message>upclient</message>

 <daemon name="upclient">
  <executable>%p/bin/upclient</executable>
  <configfile>%p/etc/%n.conf</configfile>
  <pidfile>%p/var/run/%n.pid</pidfile>
 </daemon>

</service>
<<
PostInstScript: <<
# update init script if necessary
daemonic update %n
<<
PreRmScript: <<
# clean up
if [ $1 != "upgrade" ]; then
  daemonic remove %n
fi
<<
#
Description: Collects system uptime and display it on http://uptimes.wonko.com
DescDetail: <<
 The Uptimes Project is an attempt to collect data on system uptime
 (the amount of time a computer has been running since its last reboot)
 from various operating system and hardware configurations.
<<
DescUsage:<<
	1. Create a user here : http://uptimes.wonko.com/newuser.php?
	2. add a host, this gives you an auth key,
	3. copy it to /sw/etc/upclient.conf
	4. run 'daemonic enable upclient' as root, this will install a Startup Item
	5. to start reporting your uptimes :
		a) either reboot (easy (-:)
		b) or else, if this is a first time installation (or if you know no instance of upclient is running), run '/Library/StartupItems/daemonic-upclient/daemonic-upclient start' as root.

	To discontinue reporting, run 'daemonic disable upclient' as root. This will
not kill a running instance at this time. Reboot the machine to get rid of it, or run " kill `cat /sw/var/run/upclient.pid` " as root.

 PS : the web site used to report the OS as 5.2,
 this is fixed since March 10th, 2002
<<
DescPackaging:<<
 set locations of files in compliance
 replace data.uptimes.net by uptimes.wonko.com, since the first one is terminated
<<
Homepage: http://uptimes.wonko.com/
License: GPL
