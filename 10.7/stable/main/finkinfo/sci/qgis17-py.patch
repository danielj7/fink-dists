diff -ruN qgis-1.7.1-orig/src/core/spatialindex/include/Tools.h qgis-1.7.1/src/core/spatialindex/include/Tools.h
--- qgis-1.7.1-orig/src/core/spatialindex/include/Tools.h	2011-10-11 08:30:37.000000000 +0900
+++ qgis-1.7.1/src/core/spatialindex/include/Tools.h	2011-10-11 08:33:49.000000000 +0900
@@ -407,19 +407,12 @@
     private:
       std::map<std::string, Variant> m_propertySet;
 
-#ifdef _MSC_VER
       // MSVC's friend function syntax differs slightly from everyone elses:
       // don't seem to need to qualify function name.
       friend std::ostream& operator<<(
         std::ostream& os,
         const Tools::PropertySet& p
       );
-#else
-      friend std::ostream& Tools::operator<<(
-        std::ostream& os,
-        const Tools::PropertySet& p
-      );
-#endif//_MSC_VER
   }; // PropertySet
 
   std::ostream& operator<<( std::ostream& os, const Tools::PropertySet& p );
@@ -620,19 +613,12 @@
       unsigned long long* m_a;
       unsigned long m_k;
 
-#ifdef _MSC_VER
       // MSVC's friend function syntax differs slightly from everyone elses
       // don't seem to need to qualify function name.
       friend std::ostream& operator<<(
         std::ostream& os,
         const Tools::UniversalHash& h
       );
-#else
-      friend std::ostream& Tools::operator<<(
-        std::ostream& os,
-        const Tools::UniversalHash& h
-      );
-#endif//_MSC_VER
   }; // UniversalHash
 
   std::ostream& operator<<( std::ostream& os, const Tools::UniversalHash& h );
diff -ruN qgis-1.7.1-orig/src/core/spatialite/spatialite.c qgis-1.7.1/src/core/spatialite/spatialite.c
--- qgis-1.7.1-orig/src/core/spatialite/spatialite.c	2011-10-11 08:30:37.000000000 +0900
+++ qgis-1.7.1/src/core/spatialite/spatialite.c	2011-10-11 08:57:58.000000000 +0900
@@ -57582,6 +57582,7 @@
 #endif
 
 /* #include <inttypes.h> */
+#include <stdint.h>
 typedef int8_t flex_int8_t;
 typedef uint8_t flex_uint8_t;
 typedef int16_t flex_int16_t;
