Package: pango1-xft2-ft219
Version: 1.22.0
Revision: 2
Description: GTK+ - i18n libs (for freetype >= 2.1.9)
License: LGPL
Maintainer: The Gnome Core Team <fink-gnome-core@lists.sourceforge.net>

Depends: <<
	%N-shlibs (= %v-%r),
	cairo-shlibs (>= 1.8-3),
	expat1-shlibs,
	fontconfig2-shlibs (>= 2.4.1-1),
	freetype219-shlibs (>= 2.3.7-4),
	glib2-shlibs (>= 2.18.0-1),
	glitz-shlibs,
	libgettext3-shlibs,
	libiconv,
	libpng3-shlibs (>= 1.2.5-4),
	pixman-shlibs (>= 0.12.0-1),
	x11-shlibs
<<
BuildDepends: <<
	cairo (>= 1.8-3),
	expat1,
	fink (>= 0.24.12-1),
	fontconfig2-dev (>= 2.4.1-1),
	freetype219 (>= 2.3.7-4),
	glib2-dev (>= 2.18.0-1),
	glitz,
	gtk-doc (>= 1.8-1),
	libdatrie,
	libgettext3-dev,
	libiconv-dev,
	libpng3 (>= 1.2.5-4),
	libthai-dev (>= 0.1.9-1),
	pixman (>= 0.12.0-1),
	pkgconfig (>= 0.23),
	x11-dev,
	xft2-dev (>= 2.1.2-5)
<<

Source: mirror:gnome:sources/pango/1.22/pango-%v.tar.bz2
Source-MD5: 37a185a3cb5c1a39ade7fdc3e6c75349
PatchFile: %n.patch
PatchFile-MD5: bc3d8653b65c62ab6021e66b148b16df
PatchScript: <<
	#!/bin/bash -ev
	perl -pi -e 's,(-dynamiclib)( +-single_module)*,$1 -single_module,g' configure
	# no need to patch aclocal.m4...causes regeneration of autotools
	#perl -pi -e 's,(-dynamiclib)( +-single_module)*,$1 -single_module,g' aclocal.m4
	SYSCONFDIR=%p/lib/pango-ft219/etc
	perl -p -e 'BEGIN{$s=shift} s|\@SYSCONFDIR\@|$s|' $SYSCONFDIR <%{PatchFile} | patch -p1
	sed -e 's|query|ft219-query|' update-pango-modules > update-pango-ft219-modules

	cat <<'END' >xrender.pc
prefix=/usr/X11R6
exec_prefix=/usr/X11R6/bin
libdir=/usr/X11R6/lib
includedir=/usr/X11R6/include

Name: Xrender
Description: X Render Library
Version: 0.8.4
Requires: 
Cflags: -I${includedir}  
Libs: -L${libdir} -lXrender -lX11 -lXext
END
<<

SetCPPFLAGS: -I%p/lib/fontconfig2/include
SetLDFLAGS: -L%p/lib/fontconfig2/lib -no-undefined -bind_at_load
SetCFLAGS: -Os
ConfigureParams: --mandir=%p/share/man --disable-dependency-tracking --includedir=%p/lib/pango-ft219/include --libdir=%p/lib/pango-ft219/lib --sysconfdir=%p/lib/pango-ft219/etc --x-includes=/usr/X11R6/include --x-libraries=/usr/X11R6/lib --disable-explicit-deps
CompileScript: <<
	#!/bin/bash -ev
	export PKG_CONFIG_PATH=%p/lib/fontconfig2/lib/pkgconfig:%p/lib/xft2/lib/pkgconfig
	if [ `uname -r | cut -d. -f1` = 8 ]; then
		# apple x11 ships lib but no .pc on 10.4, so hack a local one
		PKG_CONFIG_PATH=$PKG_CONFIG_PATH:`pwd`
	fi
	LD_TWOLEVEL_NAMESPACE=1 ac_cv_header_Carbon_Carbon_h=no ./configure %c
	make
	make check
<<

InstallScript: <<
	#!/bin/bash -ev
	make -j1 install DESTDIR=%d
	SYSCONFDIR=%i/lib/pango-ft219/etc
	mv %i/bin/pango-querymodules %i/bin/pango-ft219-querymodules
	mv %i/share/man/man1/pango-querymodules.1 %i/share/man/man1/pango-ft219-querymodules.1
	install -d -m 755 %i/sbin
	install -c -m 755 update-pango-ft219-modules %i/sbin/
	install -d -m 755 $SYSCONFDIR/pango
	if [ `uname -r | cut -d. -f1` = 8 ]; then
		install -c -m 644 xrender.pc %i/lib/pango-ft219/lib/pkgconfig/
	fi
<<
DocFiles: AUTHORS COPYING ChangeLog HACKING NEWS README THANKS
SplitOff: <<
	Package: %N-shlibs
	Description: GTK+ - i18n text shared libraries (for freetype >= 2.1.9)
	Depends: <<
		cairo-shlibs (>= 1.8-3),
		expat1-shlibs,
		fontconfig2-shlibs (>= 2.4.1-1),
		freetype219-shlibs (>= 2.3.7-4),
		glib2-shlibs (>= 2.18.0-1),
		libdatrie-shlibs,
		libgettext3-shlibs,
		libthai-shlibs (>= 0.1.9-1),
		x11-shlibs
	<<
	DocFiles: AUTHORS COPYING ChangeLog HACKING NEWS README THANKS
	Files: <<
		lib/pango-ft219/lib/libpango-1.0.*.dylib
		lib/pango-ft219/lib/libpangocairo-1.0.*.dylib
		lib/pango-ft219/lib/libpangoft2-1.0.*.dylib
		lib/pango-ft219/lib/libpangox-1.0.*.dylib
		lib/pango-ft219/lib/libpangoxft-1.0.*.dylib
		lib/pango-ft219/lib/pango/1.6.0/modules/*.la
		lib/pango-ft219/lib/pango/1.6.0/modules/*.so
	<<
	Shlibs: <<
		%p/lib/pango-ft219/lib/libpango-1.0.0.dylib      2201.0.0 %n (>= 1.22.0-1)
		%p/lib/pango-ft219/lib/libpangocairo-1.0.0.dylib 2201.0.0 %n (>= 1.22.0-1)
		%p/lib/pango-ft219/lib/libpangoft2-1.0.0.dylib   2201.0.0 %n (>= 1.22.0-1)
		%p/lib/pango-ft219/lib/libpangox-1.0.0.dylib     2201.0.0 %n (>= 1.22.0-1)
		%p/lib/pango-ft219/lib/libpangoxft-1.0.0.dylib   2201.0.0 %n (>= 1.22.0-1)
	<<
<<
SplitOff2: <<
	Package: %N-dev
	Description: GTK+ - i18n text development headers and libraries (for freetype >= 2.1.9)
	Depends: %N (= %v-%r), pkgconfig (>= 0.22-4)
	BuildDependsOnly: True
	Conflicts: pango1-dev, pango1-xft2-dev
	Replaces: pango1-dev, pango1-xft2-dev
	DocFiles: AUTHORS COPYING ChangeLog HACKING NEWS README THANKS
	Files: <<
		lib/pango-ft219/include
		lib/pango-ft219/lib
		share/gtk-doc
	<<
<<

PostInstScript: <<
	if [ configure = "$1" ]; then
		update-pango-ft219-modules
	fi
<<
PostRmScript: <<
	case "$1" in
		purge)
			SYSCONFDIR=%p/lib/pango-ft219/etc
			rm -f $SYSCONFDIR/pango/pango.modules
			rmdir $SYSCONFDIR/pango || true
			;;
	esac
<<
ConfFiles: %p/lib/pango-ft219/etc/pango/pangox.aliases

Homepage: http://www.pango.org
DescDetail: <<
System for layout and rendering of internationalized text.

These packages link against fink's freetype219 instead of the freetype
that comes as part of x11.  They also have cairo support.
<<
DescUsage: <<
Packages which install pango module(s) should call update-pango-ft219-modules
in their PostInstScript and PostRmScript to update the pango.modules file.
<<
DescPort: <<
	Instead of requiring xslt to build this package, we just manually
	patch the pregenerated manpage target that is included in the
	tarball.

	check uses some C++ but it doesn't leak out into the installed
	package

	Import ltmain.sh dependent-lib dependency handlers from
	libtool2 (prevents linking against installed lib instead of
	build-dir one). Thanks pogma!
<<
DescPackaging: <<
	Scrap testboundaries_ucd since it fails due to a glib2 bug.
	See: http://bugzilla.gnome.org/show_bug.cgi?id=554092

	Minimize propagation of InheritedBuildDepends

	Make sure we get cairo-1.8 after pdf got re-enabled in it

	Disable atsui because it gives poor font display sometimes
	(not doing subpixel rendering?)
<<
