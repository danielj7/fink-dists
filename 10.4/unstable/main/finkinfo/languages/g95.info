Package: g95
Version: 0.50
Revision: 20051215
Source: ftp://gcc.gnu.org/pub/gcc/releases/gcc-4.0.2/gcc-4.0.2.tar.bz2
Source-MD5: a659b8388cac9db2b13e056e574ceeb0
Source2: ftp://ftp.cdc.noaa.gov/Public/jsw/g95/g95-%v-%r.tgz
Source2-MD5: 2438d5918f33ad3a0f941bb2fa7d2bd8
NoSourceDirectory: True
NoSetCPPFLAGS: True
NoSetLDFLAGS: True
Depends: cctools (>= 576-1) | odcctools (>= 528-20041018), libiconv
BuildDepends: gmp (>= 4.1.4-1), libmpfr1, libiconv-dev
BuildConflicts: autogen-dev
PatchScript: <<
 #!/bin/sh -e
 cd g95-%v
 tar -xvzf libf95.a-%v.tar.gz
 # don't try to get darwin-fpsave.o from /usr/lib/libgcc.a, get instead
 # from gccdir (/usr/lib/libgcc.a doesn't exist in 10.4).
 perl -pi -e 's|ar x /usr/lib/libgcc.a darwin-fpsave.o|cp \@GCC_DIR\@/g95/gcc/libgcc/darwin-fpsave.o .|' Makefile.in
<<
CompileScript: <<
 #!/bin/sh -e
 gccver=4.0.2
 darwinvers=`uname -r|cut -f1 -d.`
 cd gcc-${gccver}
 mkdir g95
 cd g95
 ../configure --prefix=%p/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}  --with-gmp=%p --enable-languages=c `if test ! -f /usr/lib/libSystemStubs.a ; then echo -n "--with-as=%p/lib/odcctools/bin/as --with-ld=%p/lib/odcctools/bin/ld" ; fi` --disable-checking --with-included-gettext 
 make
 cd ../../g95-%v
 ./configure --prefix=%p --with-gmp-dir=%p --with-gcc-dir=%b/gcc-${gccver} --host=%m-apple-darwin${darwinvers}
 make 
 cd libf95.a-%v
 ./configure %c --host=%m-apple-darwin${darwinvers}
 make 
<<
InstallScript: <<
 #!/bin/sh -e
 gccver=4.0.2
 darwinvers=`uname -r|cut -f1 -d.`
 cd g95-%v
 mv Makefile Makefile.orig
 sed "s|%p/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}|%i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}|g" < Makefile.orig > Makefile
 make install prefix=%i 
 cd libf95.a-%v
 mv Makefile Makefile.orig
 # The gcc version number is hard coded in the 
 # g95-0.50/libf95.a-0.50/configure file, 
 sed "s|%p/lib/gcc-lib/%m-apple-darwin${darwinvers}/4.0.1|%i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}|g" < Makefile.orig > Makefile
 make install prefix=%i
 # if dylib built, remove it.
 if [[ -f %i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}/libgcc_s.1.0.dylib ]]; then
  #mkdir %i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}/lib
  #mv %i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}/libgcc_s.1.0.dylib %i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}/lib/libgcc_s.1.0.dylib
  #ln -fs %p/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}/lib/libgcc_s.1.0.dylib %i/lib/gcc-lib/powerpc-apple-darwin${darwinvers}/${gccver}/libgcc_s.dylib
  /bin/rm -f %i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}/*dylib
 fi
 ranlib %i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}/libf95.a
 ranlib %i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}/libgcc.a
 ranlib %i/lib/gcc-lib/%m-apple-darwin${darwinvers}/${gccver}/libgcc_eh.a
 ln -s %p/bin/%m-apple-darwin${darwinvers}-g95 %i/bin/g95
 /bin/rm -f %i/INSTALL
 mkdir -p %i/share/doc/%n
 mv %i/G95Manual.pdf %i/share/doc/%n
<<
License: GPL
DocFiles: g95-%v/COPYING
Description: Another GNU Fortran 95 compiler
DescDetail: <<
The goal of the g95 project is to create a free, open source 
Fortran 95 compiler and runtime libraries.

The 'gfortran' package is the official Fortran 95 compiler for the gcc
project, and will be included in gcc 4.0.  gfortran originated from
the g95 codebase.  At this time, g95 is a more fully-functional compiler 
than gfortran.
<<
DescPort: <<
 Requires that a compatible cctools be installed for Panther (provided by
 the odcctools package).
<<
Homepage: http://g95.org
Maintainer: Jeffrey Whitaker <jswhit@fastmail.fm>
