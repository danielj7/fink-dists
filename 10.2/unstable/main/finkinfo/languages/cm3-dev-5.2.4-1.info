Package: cm3-dev
Version: 5.2.4
Revision: 1
Maintainer: Matthias Neeracher <neeracher@mac.com>
Depends: cm3-shlibs (= %v-%r)
Source: http://www.elegosoft.com/cm3/cm3-src-all-5.2.4.tgz
Source-MD5: d7ce529bc6bffc87ade367c7c0d79256
Source2: http://www.elegosoft.com/cm3/cm3-min-POSIX-PPC_DARWIN-5.2.4.tgz
Source2-MD5: b12f68341a97f2af1eac0c77929af77a
NoSourceDirectory: true
PatchScript: <<
patch -p1 <%a/%f.patch
mkdir bootstrap
tar -C bootstrap -zxvf system.tgz
cp bootstrap.cm3.cfg bootstrap/bin/cm3.cfg
perl -i -pe 's|\@USE_ROOT\@|%b/bootstrap/|; s|\@INSTALL_ROOT\@|%i/|' bootstrap/bin/cm3.cfg
<<
CompileScript: <<
echo "We build and install at once, so all the work is in InstallScript"
<<
InstallScript: <<
cd scripts; PATH=%b/bootstrap/bin:$PATH M3GC_SIMPLE=yes ./do-cm3-core.sh buildship
cd scripts; PATH=%b/bootstrap/bin:$PATH M3GC_SIMPLE=yes ./do-pkg.sh buildship tcp

ln -s %p/lib/cm3/pkg/cm3/PPC_DARWIN/cm3 %i/bin/cm3
cp run.cm3.cfg %i/bin/cm3.cfg
perl -i -pe 's|\@USE_ROOT\@|%p/|; s|\@INSTALL_ROOT\@|%p/|' %i/bin/cm3.cfg

echo Fixing .M3EXPORT files...
find %i -name .M3EXPORTS -print -exec perl -i -pe 's|%d||' '{}' ';'
echo Fixing dynamic libraries...
find %i -name '*.[0-9].[0-9].dylib'|perl -pe '($i=$_)=~s|%d||;chomp($i);`install_name_tool -id $i $_`'
<<
SplitOff: <<
 Package: cm3-shlibs
 Files: <<
 lib/cm3/pkg/bitvector/PPC_DARWIN/libBitVector.*.dylib
 lib/cm3/pkg/digraph/PPC_DARWIN/libDiGraph.*.dylib
 lib/cm3/pkg/libm3/PPC_DARWIN/libm3.*.dylib
 lib/cm3/pkg/m3core/PPC_DARWIN/libm3core.*.dylib
 lib/cm3/pkg/m3gc-simple/PPC_DARWIN/libm3gcdefs.*.dylib
 lib/cm3/pkg/parseparams/PPC_DARWIN/libm3parseparams.*.dylib
 lib/cm3/pkg/realgeometry/PPC_DARWIN/libGeometry.*.dylib
 lib/cm3/pkg/set/PPC_DARWIN/libset.*.dylib
 lib/cm3/pkg/slisp/PPC_DARWIN/libm3slisp.*.dylib
 lib/cm3/pkg/sortedtableextras/PPC_DARWIN/libSortedTableExtras.*.dylib
 lib/cm3/pkg/table-list/PPC_DARWIN/libtable-list.*.dylib
 lib/cm3/pkg/tcp/PPC_DARWIN/libm3tcp.*.dylib
 lib/cm3/pkg/tempfiles/PPC_DARWIN/libTempFiles.*.dylib
 <<
 Shlibs: <<
 lib/cm3/pkg/bitvector/PPC_DARWIN/libBitVector.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 lib/cm3/pkg/digraph/PPC_DARWIN/libDiGraph.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 lib/cm3/pkg/libm3/PPC_DARWIN/libm3.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 lib/cm3/pkg/m3core/PPC_DARWIN/libm3core.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 lib/cm3/pkg/m3gc-simple/PPC_DARWIN/libm3gcdefs.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 lib/cm3/pkg/parseparams/PPC_DARWIN/libm3parseparams.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 lib/cm3/pkg/realgeometry/PPC_DARWIN/libGeometry.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 lib/cm3/pkg/set/PPC_DARWIN/libset.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 lib/cm3/pkg/slisp/PPC_DARWIN/libm3slisp.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 lib/cm3/pkg/sortedtableextras/PPC_DARWIN/libSortedTableExtras.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 lib/cm3/pkg/table-list/PPC_DARWIN/libtable-list.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 lib/cm3/pkg/tcp/PPC_DARWIN/libm3tcp.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 lib/cm3/pkg/tempfiles/PPC_DARWIN/libTempFiles.5.2.dylib 5.2.0 %n (>= 5.2.4-1)
 <<
 Description: Critical Mass Modula-3 Shared Libraries
 DescDetail: <<
 Shared libraries needed for programs built with Critical Mass Modula-3.
 <<	
 DocFiles: COPYRIGHT-CMASS COPYRIGHT-DEC
<<
Splitoff2: <<
 Package: cm3-shlibs-src
 Depends: cm3-shlibs
 Files: <<
 lib/cm3/pkg/libm3/src/arith/POSIX/*.[im]3
 lib/cm3/pkg/libm3/src/atom/*.[im]3
 lib/cm3/pkg/libm3/src/bundleintf/*.[im]3
 lib/cm3/pkg/libm3/src/etimer/*.[im]3
 lib/cm3/pkg/libm3/src/fmtlex/*.[im]3
 lib/cm3/pkg/libm3/src/formatter/*.[im]3
 lib/cm3/pkg/libm3/src/geometry/*.[im]3
 lib/cm3/pkg/libm3/src/os/Common/*.[im]3
 lib/cm3/pkg/libm3/src/os/POSIX/*.[im]3
 lib/cm3/pkg/libm3/src/params/*.[im]3
 lib/cm3/pkg/libm3/src/perftool/Common/*.[im]3
 lib/cm3/pkg/libm3/src/perftool/POSIX/*.[im]3
 lib/cm3/pkg/libm3/src/pickle/ver1/*.[im]3
 lib/cm3/pkg/libm3/src/pickle/ver2/*.[im]3
 lib/cm3/pkg/libm3/src/property/*.[im]3
 lib/cm3/pkg/libm3/src/random/Common/*.[im]3
 lib/cm3/pkg/libm3/src/random/IEEE/*.[im]3
 lib/cm3/pkg/libm3/src/rw/*.[im]3
 lib/cm3/pkg/libm3/src/statistics/*.[im]3
 lib/cm3/pkg/libm3/src/sx/*.[im]3
 lib/cm3/pkg/libm3/src/text/*.[im]3
 lib/cm3/pkg/libm3/src/types/*.[im]3
 lib/cm3/pkg/libm3/src/uid/Common/*.[im]3
 lib/cm3/pkg/libm3/src/uid/POSIX/*.[im]3
 lib/cm3/pkg/m3core/src/C/32BITS/*.[im]3
 lib/cm3/pkg/m3core/src/C/Common/*.[im]3
 lib/cm3/pkg/m3core/src/C/PPC_DARWIN/*.[im]3
 lib/cm3/pkg/m3core/src/convert/*.[im]3
 lib/cm3/pkg/m3core/src/fingerprint/*.[im]3
 lib/cm3/pkg/m3core/src/float/Common/*.[im]3
 lib/cm3/pkg/m3core/src/float/IEEE-be/*.[im]3
 lib/cm3/pkg/m3core/src/float/IEEE-default/*.[im]3
 lib/cm3/pkg/m3core/src/float/IEEE/*.[im]3
 lib/cm3/pkg/m3core/src/main/*.[im]3
 lib/cm3/pkg/m3core/src/runtime/POSIX/*.[im]3
 lib/cm3/pkg/m3core/src/runtime/PPC_DARWIN/*.[im]3
 lib/cm3/pkg/m3core/src/runtime/common/*.[im]3
 lib/cm3/pkg/m3core/src/runtime/ex_frame/*.[im]3
 lib/cm3/pkg/m3core/src/text/*.[im]3
 lib/cm3/pkg/m3core/src/thread/Common/*.[im]3
 lib/cm3/pkg/m3core/src/thread/POSIX/*.[im]3
 lib/cm3/pkg/m3core/src/time/Common/*.[im]3
 lib/cm3/pkg/m3core/src/time/POSIX/*.[im]3
 lib/cm3/pkg/m3core/src/time/Portable/*.[im]3
 lib/cm3/pkg/m3core/src/unix/darwin-generic/*.[im]3
 lib/cm3/pkg/m3core/src/unix/darwin-ppc/*.[im]3
 lib/cm3/pkg/m3core/src/weakref/*.[im]3
 lib/cm3/pkg/m3core/src/word/*.[im]3
 lib/cm3/pkg/m3front/src/builtinInfo/*.[im]3
 lib/cm3/pkg/m3front/src/builtinOps/*.[im]3
 lib/cm3/pkg/m3front/src/builtinTypes/*.[im]3
 lib/cm3/pkg/m3front/src/builtinWord/*.[im]3
 lib/cm3/pkg/m3front/src/exprs/*.[im]3
 lib/cm3/pkg/m3front/src/misc/*.[im]3
 lib/cm3/pkg/m3front/src/stmts/*.[im]3
 lib/cm3/pkg/m3front/src/types/*.[im]3
 lib/cm3/pkg/m3front/src/values/*.[im]3
 lib/cm3/pkg/m3middle/src/POSIX/*.[im]3
 lib/cm3/pkg/tcp/src/POSIX/*.[im]3
 lib/cm3/pkg/tcp/src/common/*.[im]3
 <<
 Description: Critical Mass Modula-3 Shared Library Sources
 DescDetail: <<
 Source code for installed Critical Mass Modula-3 shared libraries, useful
 for debugging but not needed for compiling.
 <<
 DocFiles: COPYRIGHT-CMASS COPYRIGHT-DEC
<<
DocFiles: COPYRIGHT-CMASS COPYRIGHT-DEC
Description: Critical Mass Modula-3 Compiler
DescDetail: <<
Critical Mass Modula-3 5.1 (CM3) is the latest release of the Modula-3
compiler produced by Critical Mass
<<
DescPort: <<
This port was mainly accomplished by reverse engineering the darwinports
version by Landon Fuller. 
<< 
License: Restrictive 
Homepage: http://www.m3.org

