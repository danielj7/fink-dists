Info3: <<
Package: automoc-%type_pkg[automoc]
Version: 0.9.88
Revision: 3
Type: automoc (x11 mac)
Description: Automatic moc for Qt4
License: LGPL
Maintainer: Benjamin Reed <automoc@fink.racoonfink.com>

BuildDepends: <<
	cmake (>= 2.6.1-2),
	fink (>= 0.28.0-1),
	kde4-buildenv,
	system-openssl-dev,
	qt4-%type_pkg[automoc] (>= 4.4.0-1)
<<
GCC: 4.0

CustomMirror: <<
	Primary: http://ranger.users.finkproject.org/distfiles
	eur-NL: http://ranger.users.finkproject.org/distfiles
	nam-US: http://ranger.befunk.com/fink
	nam-US: http://astrange.ithinksw.net/~astrange/ranger-fink
	nam-CA: http://www.southofheaven.net/befunk
<<
Source: mirror:kde:stable/automoc4/%v/automoc4-%v.tar.bz2
Source-MD5: 91bf517cb940109180ecd07bc90c69ec
PatchFile: automoc.patch
PatchFile-MD5: a02aec591b7b22b6bcbada05a46ab21f

CompileScript: <<
#!/bin/sh -ev

	export KDE4_PREFIX="%p" KDE4_TYPE="%type_pkg[automoc]" KDE4_INSTALL_PREFIX="%p/lib/%type_pkg[automoc]"
	. %p/sbin/kde4-buildenv.sh

	mkdir -p build
	pushd build
		cmake $KDE4_CMAKE_ARGS ..
		make VERBOSE=1
	popd
<<

InstallScript: <<
#!/bin/sh -ev

	pushd build
		make -j1 install DESTDIR="%d"
	popd
<<

PostInstScript: <<
	if [ configure = "$1" ]; then
		WEIGHT=100
		if [ "%type_pkg[automoc]" = "x11" ]; then
			WEIGHT=50
		fi
		for bin in automoc4; do
			update-alternatives --install %p/bin/$bin $bin %p/bin/$bin-%type_pkg[automoc] $WEIGHT
		done
	fi
<<
PostRmScript: <<
	if [ upgrade != "$1" ]; then
		for bin in automoc4; do
			update-alternatives --remove $bin %p/bin/$bin-%type_pkg[automoc]
		done
	fi
<<

DescDetail: <<
This package contains the automoc4 binary which is used to run moc on
the right binaries in a Qt 4 or KDE 4 application.

Moc is the meta object compiler which is a much used tool when using the Qt
toolkit.
<<
<<
