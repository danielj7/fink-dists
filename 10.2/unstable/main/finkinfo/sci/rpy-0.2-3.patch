--- rpy-0.2/src/rpymodule.c.orig	Fri Jul  5 06:39:22 2002
+++ rpy-0.2/src/rpymodule.c	Fri Jul  5 06:39:35 2002
@@ -473,6 +474,7 @@
   SEXP names, dim;
   int len, *integers, i;
   char *strings;
+  char *thislevel; 
   double *reals;
   Rcomplex *complexes;
 #ifdef WITH_NUMERIC
@@ -488,9 +490,6 @@
     return 1;			/* succeed */
   }
 
-  if (isFactor(robj))
-    robj = GET_LEVELS(robj);
-
   len = GET_LENGTH(robj);
   tmp = PyList_New(len);
 
@@ -499,8 +498,15 @@
     case LGLSXP:
     case INTSXP:
       integers = INTEGER(robj);
-      if (!(it = PyInt_FromLong(integers[i])))
-	return -1;
+      if(isFactor(robj)) { 
+       thislevel = CHAR(STRING_ELT(GET_LEVELS(robj), integers[i]-1)); 
+        if (!(it = PyString_FromString(thislevel))) 
+         return -1; 
+      } 
+      else { 
+      if (!(it = PyInt_FromLong(integers[i]))) 
+       return -1; 
+      } 
       break;
     case REALSXP:
       reals = REAL(robj);
