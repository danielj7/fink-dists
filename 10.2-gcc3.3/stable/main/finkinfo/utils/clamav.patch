--- clamav.orig/clamscan/manager.c	Tue Jun 15 06:36:54 2004
+++ clamav.new/clamscan/manager.c	Tue Aug 31 11:08:48 2004
@@ -818,6 +818,8 @@
 	return 54;
     }
 
+    mprintf("*Checking %s\n", filename);
+
     claminfo.files++;
 
     if((ret = cl_scandesc(fd, &virname, &claminfo.blocks, root, limits, options)) == CL_VIRUS) {
--- clamav.orig/clamscan/others.c	Tue Jun 15 06:35:37 2004
+++ clamav.new/clamscan/others.c	Tue Aug 31 11:17:15 2004
@@ -115,6 +115,17 @@
 
 int filecopy(const char *src, const char *dest)
 {
+
+#ifdef __APPLE_CC__
+    /* On Mac OS X use ditto and copy resource fork, too. */
+    char *ditto = (char *) mcalloc(strlen(src) + strlen(dest) + 30, sizeof(char));
+    sprintf(ditto,"/usr/bin/ditto --rsrc \"%s\" \"%s\"",src,dest);
+    if( system(ditto) ) {
+      mprintf("");   // dummy statement to work around gcc optimizer bug 
+      return -1;
+    }
+
+#else
 	char buffer[FILEBUFF];
 	int s, d, bytes;
 
@@ -133,6 +144,9 @@
 
     /* njh@bandsman.co.uk: check result of close for NFS file */
     return close(d);
+
+#endif //__APPLE_CC__
+
 }
 
 int isnumb(const char *str)
