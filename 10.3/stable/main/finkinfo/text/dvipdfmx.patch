--- dvipdfmx/src/pdfdoc.c~	2007-01-25 14:43:45.000000000 +0900
+++ dvipdfmx/src/pdfdoc.c	2007-01-25 15:57:37.000000000 +0900
@@ -494,7 +494,6 @@
   const time_t now = time(NULL);
   struct tm tm;
   struct tm local;
-  time_t gmtoff;
 
   localtime_r(&now, &local);
   gmtime_r(&now, &tm);
@@ -516,13 +515,15 @@
 #endif  /* not HAVE_TIMEZONE */
   time_t      current_time;
   struct tm  *bd_time;
+  ldiv_t       offset;
 
   time(&current_time);
   bd_time = localtime(&current_time);
+  offset = ldiv(-timezone / 60, 60);
   sprintf(date_string, "D:%04d%02d%02d%02d%02d%02d%+03ld'%02ld'",
 	  bd_time->tm_year + 1900, bd_time->tm_mon + 1, bd_time->tm_mday,
 	  bd_time->tm_hour, bd_time->tm_min, bd_time->tm_sec,
-	  (-timezone / 3600), (timezone % 3600) / 60);
+	  offset.quot, offset.rem);
 
   return strlen(date_string);
 }
--- dvipdfmx-20070409/data/config/dvipdfmx.cfg.orig	2005-07-20 19:41:54.000000000 +0900
+++ dvipdfmx-20070409/data/config/dvipdfmx.cfg	2007-04-21 19:44:54.000000000 +0900
@@ -135,7 +135,7 @@
 %% simply means large size paper)
 %%
 %% GhostScript (Unix/Linux):
-%D  "gs -q -dNOPAUSE -dBATCH -sPAPERSIZE=a0 -sDEVICE=pdfwrite -dCompatibilityLevel=1.3 -dAutoFilterGrayImages=false -dGrayImageFilter=/FlateEncode -dAutoFilterColorImages=false -dColorImageFilter=/FlateEncode -dUseFlateCompression=true -sOutputFile=%o %i -c quit"
+D "gs -q -dNOPAUSE -dBATCH -sPAPERSIZE=a0 -sDEVICE=pdfwrite -dCompatibilityLevel=1.3 -dAutoFilterGrayImages=false -dGrayImageFilter=/FlateEncode -dAutoFilterColorImages=false -dColorImageFilter=/FlateEncode -dUseFlateCompression=true -sOutputFile=%o -c '.setpdfwrite << /NeverEmbed [/Courier /Courier-Bold /Courier-Oblique /Courier-BoldOblique /Helvetica /Helvetica-Bold /Helvetica-Oblique /Helvetica-BoldOblique /Times-Roman /Times-Bold /Times-Italic /Times-BoldItalic /Symbol /ZapfDingbats /Ryumin-Light /GothicBBB-Medium] >> setdistillerparams' -f %i -c quit"
 
 %% GhostScript (Win32):
 %D  "gswin32c -q -dNOPAUSE -dBATCH -sPAPERSIZE=a0 -sDEVICE=pdfwrite -dCompatibilityLevel=1.3 -dAutoFilterGrayImages=false -dGrayImageFilter=/FlateEncode -dAutoFilterColorImages=false -dColorImageFilter=/FlateEncode -dUseFlateCompression=true -sOutputFile=%o %i -c quit"
@@ -190,4 +190,5 @@

 %% Put additonal fontmap files here

 f  cid-x.map
+f  kanjix.map
