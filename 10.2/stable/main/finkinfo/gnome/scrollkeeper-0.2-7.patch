diff -Naur scrollkeeper-0.2.old/cl/src/install.c scrollkeeper-0.2.new/cl/src/install.c
--- scrollkeeper-0.2.old/cl/src/install.c	Thu Mar 15 20:10:33 2001
+++ scrollkeeper-0.2.new/cl/src/install.c	Wed Nov 21 22:22:32 2001
@@ -19,6 +19,7 @@
 #include <config.h>
 #include <tree.h>
 #include <parser.h>
+#include <limits.h>
 #include <stdlib.h>
 #include <string.h>
 #include <locale.h>
@@ -228,12 +229,22 @@
 			    char *category, *token, *rest;
 			
 			    category = strdup(c_node->childs->content);
+#ifdef HAVE_STRTOK_R
 			    token = strtok_r(category, SEP, &rest);
+#else
+			    token = strtok(category, SEP);
+			    rest = token ? (category + strlen(category) + 1) : NULL;
+#endif
     	                    add_doc_to_content_list(cl_doc->root->childs, token, &rest,
 			    		docpath, omf_name, title, format, unique_id, 0);
 			    free((void *)category);
 			    category = strdup(c_node->childs->content);
+#ifdef HAVE_STRTOK_R
 			    token = strtok_r(category, SEP, &rest);
+#else
+			    token = strtok(category, SEP);
+			    rest = token ? (category + strlen(category) + 1) : NULL;
+#endif
 	                    add_doc_to_content_list(cl_ext_doc->root->childs, token, &rest,
 			    		docpath, omf_name, title, format, unique_id, 1);
 			    free((void *)category);
@@ -420,7 +431,12 @@
 	        node->childs->childs->type == XML_TEXT_NODE &&
 	        !strcmp(cat_token, node->childs->childs->content))
 	    {
+#ifdef HAVE_STRTOK_R
 	        cat_token = strtok_r(NULL, SEP, rest);
+#else
+	        cat_token = strtok(*rest, SEP);
+	        *rest = (cat_token) ? (*rest + strlen(*rest) + 1) : 0;
+#endif
 		if (cat_token == NULL)
 		{
 		    /* we have a match so create a node */
@@ -527,7 +543,7 @@
 	else /* link the directory */
 	{
 	    char *target_locale;
-	    char aux_path[PATHLEN];
+	    char aux_path[PATH_MAX];
 	    
 	    /* TODO this has to be changed for Solaris as the routine
 	       with this name does not do the same stuff
@@ -608,7 +624,7 @@
     
     sprintf(toc_dir, "%s/TOC", scrollkeeper_dir);
     stat(toc_dir, &buf);
-    if (!S_ISDIR(buf.st_mode))
+    if (!S_ISDIR(buf.st_mode) || errno == ENOENT)
     {
         sprintf(command, "mkdir %s", toc_dir);
 	system(command);
diff -Naur scrollkeeper-0.2.old/doc/scrollkeeper_manual/C/Makefile.in scrollkeeper-0.2.new/doc/scrollkeeper_manual/C/Makefile.in
--- scrollkeeper-0.2.old/doc/scrollkeeper_manual/C/Makefile.in	Wed Mar 28 21:23:00 2001
+++ scrollkeeper-0.2.new/doc/scrollkeeper_manual/C/Makefile.in	Wed Nov 21 22:22:32 2001
@@ -301,7 +301,9 @@
 install-data-am: index.html omf
 	-$(mkinstalldirs) $(DESTDIR)$(docdir)/stylesheet-images
 	-$(mkinstalldirs) $(DESTDIR)$(docdir)/figures
-	-cp $(srcdir)/$(sgml_files) $(DESTDIR)$(docdir)
+	-for file in $(sgml_files); do \
+	  cp $(srcdir)/$$file $(DESTDIR)$(docdir); \
+	done
 	-for file in $(srcdir)/$(docname)/*.html $(srcdir)/$(docname)/*.css; do \
 	  basefile=`echo $$file | sed -e 's,^.*/,,'`; \
 	  $(INSTALL_DATA) $$file $(DESTDIR)$(docdir)/$$basefile; \
diff -Naur scrollkeeper-0.2.old/libs/error.c scrollkeeper-0.2.new/libs/error.c
--- scrollkeeper-0.2.old/libs/error.c	Thu Mar 15 23:36:55 2001
+++ scrollkeeper-0.2.new/libs/error.c	Wed Nov 21 22:26:37 2001
@@ -32,11 +32,11 @@
     struct stat buf;
     FILE *fid;
     
-    if (stat("/var/log/scrollkeeper.log", &buf) == -1)
+    if (stat("@PREFIX@/var/log/scrollkeeper.log", &buf) == -1)
     {
     	if (errno == ENOENT)
 	{
-	    fid = fopen("/var/log/scrollkeeper.log", "w");
+	    fid = fopen("@PREFIX@/var/log/scrollkeeper.log", "w");
 	    if (fid == NULL)
 	        return;
 	}
@@ -47,14 +47,14 @@
     {
         if (buf.st_size < (1<<24))
 	{
-	    fid = fopen("/var/log/scrollkeeper.log", "a");
+	    fid = fopen("@PREFIX@/var/log/scrollkeeper.log", "a");
 	    if (fid == NULL)
 	        return;
 	}
 	else
 	{
-	    rename("/var/log/scrollkeeper.log", "/var/log/scrollkeeper.log.1");
-	    fid = fopen("/var/log/scrollkeeper.log", "w");
+	    rename("@PREFIX@/var/log/scrollkeeper.log", "@PREFIX@/var/log/scrollkeeper.log.1");
+	    fid = fopen("@PREFIX@/var/log/scrollkeeper.log", "w");
 	    if (fid == NULL)
 	        return;
 	}
diff -Naur scrollkeeper-0.2.old/toc/src/toc-extract.c scrollkeeper-0.2.new/toc/src/toc-extract.c
--- scrollkeeper-0.2.old/toc/src/toc-extract.c	Thu Oct 12 23:53:39 2000
+++ scrollkeeper-0.2.new/toc/src/toc-extract.c	Wed Nov 21 22:22:32 2001
@@ -97,10 +97,15 @@
 
 		stack_el = find_first_element (context, element_list);
 
-		if (!stack_el->ignore)
+		list_free (element_list);
+
+		if (stack_el)
 		{
-			print_indent(context->depth);
-			printf("</tocsect%d>\n", context->depth-1);
+			if (!stack_el->ignore)
+			{
+				print_indent(context->depth);
+				printf("</tocsect%d>\n", context->depth-1);
+			}
 		}
 	}
 
@@ -190,11 +195,11 @@
 
 	stack_el = find_first_element (context, element_list);
 	
+	list_free (element_list);
+	if (!stack_el)
+		return;
 	if (stack_el->title_output)
-	{
-		list_free (element_list);
 		return;
-	}
 
 	temp = (char *)calloc(len+1, sizeof(char));
 	strncpy(temp, chars, len);
@@ -220,8 +225,6 @@
 	};
 	
 	free(temp);
-
-	list_free (element_list);
 }
 
 static void print_indent(int depth)
