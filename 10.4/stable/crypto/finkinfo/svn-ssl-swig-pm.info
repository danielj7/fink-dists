Info2: <<
Package: svn-ssl-swig-pm%type_pkg[perl]
Version: 1.1.4
Revision: 1011
Architecture: powerpc
Description: Subversion - Swig Perl bindings (with SSL)
Type: perl (5.8.1 5.8.6)
DescPackaging: <<
 Although this package has a BSD license, it is marked Restrictive since
 it depends on a Restrictive package (neon24-ssl).
<<
License: Restrictive
Maintainer: Christian Schaffner <chris01@users.sourceforge.net>

# Dependencies:
Depends: perl%type_pkg[perl]-core, svn-ssl-shlibs (>= %v-11), swig-shlibs (>= 1.3.20-2)
BuildDepends: fink (>= 0.21.1-1), svn-ssl-dev (>= %v-11), apr-ssl (>= 0.9.5-15), apr-ssl-common (>= 0.9.5-15), db42-ssl (>= 4.2.52-1017), gdbm3, expat (>= 1.95.6-2), libxml2 (>= 2.5.10-12), neon24-ssl (>= 0.24.7-11), openldap-ssl-dev (>= 2.1.22-24), cyrus-sasl2-dev (>= 2.1.15-23), openssl097-dev, swig (>= 1.3.20-2), libiconv-dev (>= 1.9.1-11), gettext-bin, gettext-tools, gettext-dev, io-string-pm, libtool14 (>= 1.5.10-1), autoconf2.5, automake1.9, gcc3.3
Conflicts: %{Ni}581, %{Ni}584, %{Ni}586
Replaces: %{Ni}581, %{Ni}584, %{Ni}586

# Unpack Phase:
Source: http://subversion.tigris.org/tarballs/subversion-%v.tar.bz2
Source-MD5: 6e557ae65b6b8d7577cc7704ede85a23

# Patch Phase:
Patch: svn-ssl.patch

# Compile Phase:
SetCPPFLAGS: -I%p/include/db4 -no-cpp-precomp
GCC: 3.3
CompileScript: <<
#! /bin/sh -e
 ### Remove packages that are installed by fink
 rm -rf neon
 rm -rf apr
 rm -rf apr-util

 # recreate configure with libtool 1.5
 ./autogen.sh
 ### Recreate build-outputs.mk to not include already installed libs
 ./gen-make.py --installed-libs libsvn_client,libsvn_delta,libsvn_diff,libsvn_fs,libsvn_ra,libsvn_repos,libsvn_subr,libsvn_wc
 ### Configure shared
 export CC=gcc-3.3; export CXX=g++-3.3; export F77=no; ./configure --prefix=%p --libexecdir='${prefix}/lib/svn' --mandir='${prefix}/share/man' --infodir='${prefix}/share/info' --with-neon=%p --with-apr=%p --with-apr-util=%p --enable-shared --without-apxs --without-apache --disable-mod-activation --without-jdk --disable-javahl --with-jikes=no --enable-swig-bindings=perl --with-swig=%p --without-python --with-perl=perl%type_raw[perl]

 ### force SWIG to use gcc 3.3 too
 perl -pi.bak -e 's|(SWIG.*)gcc|${1}gcc-3.3|g' Makefile

 ### Build swig perl bindings
 make CC=gcc-3.3 CXX=g++-3.3 swig-pl-lib

 # make swig-pl
 (cd subversion/bindings/swig/perl/native && %{default_script})
<<

# Install Phase:
UpdatePOD: true
DocFiles: COPYING HACKING INSTALL.swig NOTES.swig
InstallScript: <<
 ### Install swig perl bindings
 make install-swig-pl DESTDIR=%d
 cp subversion/bindings/swig/INSTALL INSTALL.swig
 cp subversion/bindings/swig/NOTES NOTES.swig

 ### Remove unneeded archives
 rm %i/lib/*.a
 rm %i/lib/*.la
<<
Shlibs: <<
  %p/lib/libsvn_swig_perl-1.0.dylib 1.0.0 %n (>= 0.37.0-11)
<<

# Additional Info
DescDetail: <<
  Subveresion Bindings to call svn functions from perl.
<<
DescUsage: <<
  Please read the files in '%p/share/doc/svn-ssl-swig-pm%type_pkg[perl]/'.
<<
DescPort: <<
 Patches applied to be able to not rebuild already installed libraries
 from the svn-ssl-shlibs package. Borrowed from the netbsd 
 pkgsrc/devel/subversion/ package
 
 Patched Makefile.PL.in to use the correct perl binary.

 Added 'export F77=no;' to configure in order not to fail if the 
 fort77 package is installed.
<<
Homepage: http://subversion.tigris.org/
<<
