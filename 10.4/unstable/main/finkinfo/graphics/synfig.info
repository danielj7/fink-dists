Package: synfig
Version: 0.61.09

Revision: 3

# Source: http://www.i8u.org/~htodd/finksrc/%n-%v.tar.bz2
Source: mirror:sourceforge:synfig/synfig-%v.tar.gz
Source-MD5: 0330521fe46b9e8a39df7081ec64c5d5

# SourceDirectory: synfig-core

Maintainer: Hisashi T Fujinaka <htodd@users.sourceforge.net>

Depends: <<
	%N-shlibs (=%v-%r),
	glib2-shlibs (>=2.18.0-1),
	glibmm2.4-shlibs (>=2.18.0-1),
	libgettext3-shlibs (>=0.14.5-2),
	libiconv (>=1.12-3),
	libsigc++2-shlibs (>=2.2.3-1),
	libxml++2-shlibs (>=2.24.0-1),
	libxml2-shlibs (>=2.6.30-1)
<<
BuildDepends: <<
	bzip2-dev,
	etl (>= 0.04.12-1),
	expat1,
	fontconfig2-dev (>= 2.4.1-1),
	freetype219 (>= 2.3.7-7),
	glib2-dev (>=2.18.0-1),
	glibmm2.4-dev (>=2.18.0-1),
	imagemagick1-dev (>= 6.4.1-1011),
	lcms,
	libgettext3-dev (>=0.14.5-2),
	libiconv-dev (>=1.12-3),
	libjpeg,
	libmng2,
	libpng3,
	libsigc++2 (>=2.2.3-1),
	libtiff,
	libxml++2 (>=2.24.0-1),
	libxml2 (>=2.6.30-1),
	openexr-dev,
	pkgconfig (>= 0.23)
<<

GCC: 4.0

Description: Vector-based 2D animation renderer
Homepage: http://synfig.sourceforge.net/
License: GPL

PatchScript: <<
	perl -pi -e 's/-lMagick(?!\+\+)/-lMagickCore/' configure
	perl -ni -e 'print unless /mod_libavcodec/' src/modules/synfig_modules.cfg.in
<<

SetCPPFLAGS: -I%p/include/ImageMagick -I%p/lib/fontconfig2/include
SetLDFLAGS: -L%p/lib/fontconfig2/lib
ConfigureParams: --without-libavcodec PKG_CONFIG_PATH="%p/lib/fontconfig2/lib/pkgconfig:$PKG_CONFIG_PATH"

# CompileScript: <<
# 	#!/bin/sh -ev
# 	libtoolize --ltdl --copy -f
# 	autoreconf -if
# 	./configure %c
# 	make
# <<

InstallScript: <<
#	find %d -name "*.la" -exec perl -pi.bak -e 's| .*root-%f.* | |g' {} \;
	make install prefix=%i
	mkdir -p %i/share/doc/%n/examples/walk
	install -p -m644 examples/*.sifz %i/share/doc/%n/examples
	install -p -m644 examples/walk/*.lst %i/share/doc/%n/examples/walk
	install -p -m644 examples/walk/*.jpg %i/share/doc/%n/examples/walk
	install -p -m644 examples/walk/*.sifz %i/share/doc/%n/examples/walk
<<

SplitOff: <<
	Package: %N-shlibs
	Depends: <<
		bzip2-shlibs,
		expat1-shlibs,
		fontconfig2-shlibs (>= 2.4.1-1),
		freetype219-shlibs (>= 2.3.7-7),
		glib2-shlibs (>= 2.18.0-1),
		glibmm2.4-shlibs (>= 2.18.0-1),
		imagemagick,
		imagemagick1-shlibs (>= 6.4.1-1011),
		lcms-shlibs,
		libgettext3-shlibs,
		libiconv,
		libjpeg-shlibs,
		libmng2-shlibs,
		libpng3-shlibs,
		libsigc++2-shlibs (>=2.2.3-1),
		libtiff-shlibs,
		libxml++2-shlibs (>= 2.24.0-1),
		libxml2-shlibs (>= 2.6.30-1)
	<<
	Files: lib/libsynfig.0.0.0.dylib lib/libsynfig.0.dylib lib/synfig
	# move share/locale from %N? (rename with libmajorversion?)
	DocFiles: AUTHORS COPYING INSTALL NEWS README
	Shlibs: %p/lib/libsynfig.0.dylib 1.0.0 %n (>= 0.61.08-1001)
<<

SplitOff2: <<
	Package: %N-dev
	Depends: %N-shlibs (= %v-%r)
	Replaces: %N (<< 0.61.08-1001), %N-shlibs (<< 0.61.08-1001)
	Files: <<
		bin/synfig-config
		include
		lib
	<<
	DocFiles: AUTHORS COPYING INSTALL NEWS README
	BuildDependsOnly: true
<<

DocFiles: AUTHORS COPYING INSTALL NEWS README

DescDetail: <<
synfig is a vector based 2D animation renderer. It is designed to be capable of
producing feature-film quality animation.

This package contains the command-line renderer, the GUI animation editor is in
synfigstudio.
<<
DescPackaging: <<
	Disable libavcodec because it's a newer version in fink
	incompatible with synfig. See:
	http://synfig.org/forums/viewtopic.php?f=13&t=5
	Older libavcoded has no .pc so synfig doesn't even find it.

	Remove libavcodec from config file (list of active mods)
	because it won't exist (silences runtime warnings). Why isn't
	this list auto-generated during pkg build process?

	Doesn't use Magick's native flag detector:

		Need to pass -I globally so that configure finds it.

		Main lib is now MagickCore not Magick.

	Links magick libs and also uses magick's "convert" program.

	Major shuffling of package layout for pangocairo and shlibs
	policy as of 0.61.08-1001, and then again as of 0.61.09-3
<<
