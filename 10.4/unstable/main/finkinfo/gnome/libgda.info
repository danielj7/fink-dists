Package: libgda
Version: 4.0.4
Revision: 1
BuildDepends: <<
	gettext-bin,
	gettext-tools,
	fink (>= 0.24.12-1),
	glib2-dev (>= 2.20.0-1),
	gtk-doc (>= 1.8-1),
	gnutls26 (>= 2.8.0-1),
	intltool40,
	libgcrypt (>= 1.4.4-1),
	libgettext3-dev,
	libiconv-dev,
	libncurses5,
	libgpg-error-shlibs,
	libsoup2.4.1-ssl (>= 2.26.0-1),
	libtasn1-3 (>= 2.2-2),
	libxml2 (>= 2.6.30-1),
	libxslt (>= 1.1.22-1),
	pkgconfig (>= 0.23),
	readline5
<<
Depends: <<
	%N4.0-bin (>= %v-%r)
<<
Source: mirror:gnome:sources/%n/4.0/%n-%v.tar.bz2
Source-MD5: 14a6f176763cda5270f1ac23699c42ab
PatchFile: %n.patch
PatchFile-MD5: c1ee35e529dd6fd3342961ad97c09352
PatchScript: <<
	%{default_script}
	perl -pi -e 's,/usr/share/gtk-doc/html,%p/share/gtk-doc/html,g' doc/C/html/*.html
<<
ConfigureParams: <<
	--mandir='%p/share/man' --libexecdir=%p/lib/libgda-4.0.4 \
	--disable-gtk-doc \
	PERL=/usr/bin/perl \
	--without-bdb --without-odbc --without-mysql --without-msql --without-postgres --without-tds --without-ibmdb2 --without-sybase --without-oracle --without-firebird --without-xbase --without-mdb --without-ldap --without-java \
	--disable-dependency-tracking --disable-static
<<
CompileScript: <<
	autoreconf -f -i
	./configure %c
	make
<<
#InfoTest: <<
#	TestDepends: check
#	# fails "sometimes"
#	TestScript: make check || exit 2
#<<
InstallScript: make -j1 install DESTDIR=%d
SplitOff: <<
	Package: %N4.0.4-shlibs
	Depends: <<
		glib2-shlibs (>= 2.20.0-1),
		libgettext3-shlibs,
		libiconv,
		libxml2-shlibs (>= 2.6.30-1),
		libxslt-shlibs (>= 1.1.22-1)
	<<
	Replaces: %N, %N-shlibs
	Files: <<
		lib/libgda*-4.0.4*
		lib/libgda-4.0/providers
		share/locale
	<<
	Shlibs: <<
		%p/lib/libgda-4.0.4.dylib		5.0.0 %n (>= 4.0.2-1)
		%p/lib/libgda-report-4.0.4.dylib	5.0.0 %n (>= 4.0.2-1)
		%p/lib/libgda-xslt-4.0.4.dylib		5.0.0 %n (>= 4.0.2-1)
	<<
	DocFiles: AUTHORS COPYING COPYING.LIB ChangeLog po/ChangeLog:ChangeLog.po NEWS README
	Description: Shared libraries for libgda package
<<
SplitOff2: <<
	Package: %N4.0.4-dev
	Depends: %N4.0-bin (>= %v-%r), %N4.0.4-shlibs (= %v-%r)
	Conflicts: %N-dev, %N3-dev, %N4-dev
	Replaces: %N-dev, %N3-dev, %N4-dev
	BuildDependsOnly: True
	Files: <<
		include
		lib
		share/gtk-doc
	<<
	DocFiles: AUTHORS COPYING COPYING.LIB ChangeLog po/ChangeLog:ChangeLog.po NEWS README
	Description: Developer files for libgda package
<<
SplitOff3: <<
	Package: %N4.0-bin
	Depends: <<
		%N4.0.4-shlibs (>= %v-%r),
		glib2-shlibs (>= 2.20.0-1),
		gnutls26-shlibs (>= 2.8.0-1),
		libgcrypt-shlibs (>= 1.4.4-1),
		libgettext3-shlibs,
		libgpg-error-shlibs,
		libncurses5-shlibs,
		libsoup2.4.1-ssl-shlibs (>= 2.26.0-1),
		libtasn1-3-shlibs (>= 2.2-2),
		libxml2-shlibs,
		readline5-shlibs
	<<
	Files: <<
		bin/*-4.0
		etc
		share/libgda-4.0
		share/man/man1/gda-sql-4.0.1
	<<
	Replaces: %N (<< 4.0.2-3)
	DocFiles: AUTHORS COPYING COPYING.LIB ChangeLog po/ChangeLog:ChangeLog.po NEWS README
<<
DocFiles: AUTHORS COPYING COPYING.LIB ChangeLog po/ChangeLog:ChangeLog.po NEWS README
DescPackaging: <<
	Regenerating gtk-doc files The Right Way (--enable-gtk-doc) is
	very slow, so just patch the prefix in the bad URLs in the
	existing generated files.

	Fix installation of trml2* python scripts. Move to to libdir
	and rename to include install_name versioning. See:
	http://bugzilla.gnome.org/show_bug.cgi?id=579458

	Use embedded sqlite3 per upstream recommendation (to get
	function metadata)

	Lots of files (plugins, data, gettext catalogs) are in *4.0
	(less versioned than install_name) dirs. Need to hack those
	dirnames if we get another shlibs package with install_name
	4.0.[^4]. Apparently it's mostly runtime stuff where user at
	least might want 4.0's and 3.0's programs concurrently to
	control both versions' databases. So as of 4.0.2-3, move
	versioned binaries into new major-versioned package
	libgda4.0-bin (which also includes related data files).
<<
DescPort: <<
	Try to make sure local libs are linked first: very important
	since there are wrappers in the nascent libgda-sqlite.la that
	need to mask and intercept calls to those in the global
	libsqlite3.dylib. NB: still not fixed, or may be cured now
	that using libtool2.

	Make sure -framework flag is passed safely into .la
<<
DescUsage: <<
	This is just the basic library and sqlite support. Most
	databases are explicitly disabled to avoid a *huge* package
	that has "N-1" database types that any one user doesn't need.
	Othre database support modules appear to be plugins that could
	be built as stand-alone packages.
<<
Description: Uniform access to various data sources
License: GPL/LGPL
Maintainer: The Gnome Core Team <fink-gnome-core@lists.sourceforge.net>
Homepage: http://www.gnome-db.org
