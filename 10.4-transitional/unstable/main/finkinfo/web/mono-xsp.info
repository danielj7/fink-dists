Package: mono-xsp
Version: 1.0.2
Revision: 1
Source: http://www.go-mono.com/archive/%v/xsp-%v.tar.gz
Source-MD5: f6c4699db4a3700ce576cd9847bec28c
DocFiles: AUTHORS COPYING* ChangeLog INSTALL NEWS README
Depends: mono (>= %v-1)
BuildDepends: mono (>= %v-1)
Homepage: http://go-mono.com/
Maintainer: Benjamin Reed <mono-xsp@fink.racoonfink.com>
Description: Mono ASP.Net web server
SetMAKEFLAGS: -j1
NoSetMAKEFLAGS: true
ConfigureParams: --mandir=%p/share/man
CompileScript: <<
#!/bin/sh

  export MONO_PATH=%b/server:%b/test:$MONO_PATH
  ./configure %c
  make
<<
InstallScript: <<
#!/bin/sh
  make install DESTDIR=%d
  install -d -m 755 %i/lib/%n
  install -d -m 755 %i/etc/%n
  install -d -m 755 %i/share/doc/%n
  install -d -m 755 %i/var/lib/%n
  touch %i/var/lib/%n/.turd

  mv %i/share/doc/xsp/* %i/share/doc/%n/
  mv %i/bin/*.exe %i/lib/%n/
  mv %i/bin/*.exe.config %i/etc/%n/

  for file in asp_state.exe dbsessmgr.exe mod-mono-server.exe xsp.exe; do
    cat <<END >%i/bin/${file/.exe/}
#!/bin/sh

export MONO_PATH="%p/etc/%n:%p/lib/%n:\$MONO_PATH"
%p/bin/mono %p/lib/%n/$file "\$@"
END
  done
  chmod 755 %i/bin/*

  cat <<END >%i/etc/%n/xsp.exe.config
<?xml version="1.0" encoding="utf-8"?>
<configuration>
 <appSettings>
  <add key="MonoServerPort" value="8080"/>
  <add key="MonoApplications" value="/:%p/share/doc/%n/test" />
  <add key="MonoServerRootDir" value="%p/var/lib/%n" />
  
  <!-- MonoServerDefaultIndexFiles is set in web.config -->
 </appSettings>
</configuration>
END

  for file in asp_state.exe.config dbsessmgr.exe.config xsp.exe.config; do
    ln -sf %p/etc/%n/$file %i/lib/%n/
  done
<<
ConfFiles: <<
  %p/etc/mono-xsp/asp_state.exe.config
  %p/etc/mono-xsp/dbsessmgr.exe.config
  %p/etc/mono-xsp/xsp.exe.config
<<
DescDetail: <<
The XSP server is a small web server that hosts the Mono
System.Web classes for running what is commonly known as ASP.NET.
<<
License: GPL
