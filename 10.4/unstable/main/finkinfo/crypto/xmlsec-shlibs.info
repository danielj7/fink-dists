Package: xmlsec-shlibs
Version: 1.2.12
Revision: 3
###
Source: http://www.aleksey.com/xmlsec/download/xmlsec1-%v.tar.gz
Source-MD5: 195d042623bcc2e1668ab8370de6dc2a
BuildDepends: <<
  fink (>= 0.24.12), fink-package-precedence,
  libiconv-dev, libgettext8-dev,
  libxml2, libxslt,
  libgcrypt (>= 1.2.4-2), gnutls26, libgpg-error, libtasn1-3,
  openssl098-dev
<<
Depends: <<
  libiconv, libgettext8-shlibs,
  libxml2-shlibs, libxslt-shlibs,
  libgcrypt-shlibs (>= 1.2.4-2), gnutls26-shlibs, libgpg-error-shlibs, libtasn1-3-shlibs,
  openssl098-shlibs
<<
###
GCC: 4.0
###
ConfigureParams: --infodir=%i/share/info --enable-aes --with-libxml=%p --with-libxslt=%p --mandir=%i/share/man  --disable-apps-crypto-dl --with-html-dir=%i/share/doc/xmlsec --with-pic --enable-xkms --without-nss --enable-dependency-tracking

PatchScript: <<
  mv INSTALL INSTALL.txt
  perl -pi.bak -e 's|-flat_namespace -undefined suppress|-twolevel_namespace -undefined dynamic_lookup|g' configure
<<

CompileScript: <<
  ./configure %c 
  perl -pi.bak -e 's|#define LTDL_SHLIB_EXT ".so"|#define LTDL_SHLIB_EXT ".dylib"|' config.h
  perl -pi -e 's/-lgnutls/-lgnutls -lgcrypt/' src/gnutls/Makefile
  make
  fink-package-precedence --prohibit-bdep=xmlsec-dev .
<<

InstallScript: <<
  make install prefix=%i
<<

Shlibs: <<
  %p/lib/libxmlsec1.1.dylib 4.0.0 %n (>= 1.2.5-13)
  %p/lib/libxmlsec1-openssl.1.dylib 4.0.0 %n (>= 1.2.4-13)
  %p/lib/libxmlsec1-gnutls.1.dylib 4.0.0 %n (>= 1.2.5-13)
<<
DocFiles: AUTHORS COPYING ChangeLog Copyright INSTALL.txt NEWS README

Splitoff2: <<
  Package: xmlsec-bin
  Depends: <<
    %N (>= %v-%r),
    libiconv,
    libxml2-shlibs, libxslt-shlibs,
    openssl098-shlibs
  <<
  Files: <<
    bin/xmlsec1
    share/man/man1/xmlsec1.1
  <<
  Description: xmlsec binary and config program for devels
  DescDetail: <<
    NOTE: You NEED to also install this package when you wish to develop
    with xmlsec.
  <<
  DocFiles: AUTHORS COPYING ChangeLog Copyright INSTALL.txt NEWS README
<<

Splitoff3: <<
  Package: xmlsec-dev
  BuildDependsOnly: True
  Replaces: xmlsec-bin (<< 1.2.9-12), xmlsec (<< 1.2.12-2)
  Files: <<
    bin/xmlsec1-config
    include
    lib/libxmlsec1.{a,la,dylib}
    lib/libxmlsec1-openssl.{a,la,dylib}
    lib/libxmlsec1-gnutls.{a,la,dylib}
    lib/pkgconfig
    lib/xmlsec1Conf.sh
    share/aclocal
    share/doc/xmlsec
    share/man/man1
  <<
  Description: xmlsec development headers
  Depends: xmlsec-bin, %N (= %v-%r)
  DescDetail: <<
    NOTE: You need to install this package when you wish to develop with xmlsec. 
  <<
  DocFiles: AUTHORS COPYING ChangeLog Copyright INSTALL.txt NEWS README
<<
###
Description: XML Security Library
DescDetail: <<
  Shared libraries needed to run and link against the xmlsec framework.
<<
DescPort: <<
  Fixed dlopen() extension to be .dylib

  dmacks moved xmlsec1-config script from xmlsec-bin to xmlsec-dev and
  manpages from xmlsec to the packages containing the bin/* that they
  document starting in 1.2.9-12

  dmacks moved xmlsec1.m4 and doc html from xmlsec to xmlsec-dev as of
  1.2.12-2 (and moved the doc html from share/doc to share/doc/xmlsec)

  dmacks fixed dynamic linking to have all symbols resolved (used to
  happen automatically via .la dependencies)
<<
###
License: OSI-Approved
Maintainer: Darian Lanx <dmalloc@users.sourceforge.net>
Homepage: http://www.aleksey.com/xmlsec/
