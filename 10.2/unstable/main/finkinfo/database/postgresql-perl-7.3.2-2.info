Package: postgresql-perl
Version: 7.3.2
Revision: 2
GCC: 3.1
Source: http://www.postgresql.org/ftpsite/source/v%v/postgresql-%v.tar.gz
Source-MD5: 23d2762571e8c5bb21eee08aab968ccb
Source2: ftp://gborg.postgresql.org/pub/pgperl/stable/pgperl-2.0.2.tar.gz
Source2-MD5: 0813c5ab151dd37ad8938634550e6c1a
BuildDepends: postgresql73-dev (>= %v)
Depends: postgresql73-shlibs (>= %v), postgresql73 (>= %v)
NoSetCPPFLAGS: true
SetCPPFLAGS: -I%p/include
NoSetLDFLAGS: true
SetLIBS: -L%p/lib -lpq
Conflicts: postgresql-ssl-perl
Replaces: postgresql-ssl-perl, postgresql (<< %v)
PatchScript: sed 's|@PREFIX@|%p|g' < %a/postgresql-%v-%r.patch | patch -p1
ConfigureParams: --prefix=%p --docdir=%p/share/doc --mandir=%p/share/man --enable-multibyte --enable-recode --with-CXX --with-perl --without-python --without-openssl --with-libraries=%p/lib --with-includes=%p/include --without-tcl --without-java --enable-odbc --with-pam
CompileScript: <<
#!/bin/sh
  ./configure %c

  # pl/perl
  pushd src/pl/plperl
  make
  popd

  # Pg perl module
  pushd ../Pg-2.0.2
  POSTGRES_INCLUDE=%p/include/postgresql POSTGRES_LIB=%p/lib INC="-I%i/include/postgresql -I%i/include -I%p/include/postgresql -I%p/include" LIBS="-L%p/lib" perl Makefile.PL PREFIX=%p INSTALLPRIVLIB=%p/lib/perl5 INSTALLARCHLIB=%p/lib/perl5/darwin INSTALLSITELIB=%p/lib/perl5 INSTALLSITEARCH=%p/lib/perl5/darwin INSTALLMAN1DIR=%p/share/man/man1 INSTALLMAN3DIR=%p/share/man/man3
  make
  popd

<<
InstallScript: <<
#!/bin/sh

  # pl/perl
  (cd src/pl/plperl; make install DESTDIR=%d INSTALLSITEMAN3DIR=%i/share/man/man3)

  # Pg perl module
  pushd ../Pg-2.0.2
  make install PREFIX=%i INSTALLPRIVLIB=%i/lib/perl5 INSTALLARCHLIB=%i/lib/perl5/darwin INSTALLSITELIB=%i/lib/perl5 INSTALLSITEARCH=%i/lib/perl5/darwin INSTALLMAN1DIR=%i/share/man/man1 INSTALLMAN3DIR=%i/share/man/man3
  mkdir -p %i/share/podfiles
  cat %i/lib/perl5/darwin/perllocal.pod | sed -e s,%i/lib/perl5,%p/lib/perl5, > %i/share/podfiles/perllocal.%n.pod
  rm -rf %i/lib/perl5/darwin/perllocal.pod
  popd

<<
DocFiles: COPYRIGHT HISTORY INSTALL src/pl/plperl/README register.txt
Description: PostgreSQL Perl tools
License: BSD
Maintainer: Benjamin Reed <ranger@befunk.com>
Homepage: http://www.postgresql.org/
