Package: gpsdrive
Version: 2.01
Revision: 1
Description: GPS-based navigation tool
DescDetail: <<
GpsDrive is a car (bike, ship, plane) navigation system. GpsDrive
displays your position provided from your NMEA capable GPS receiver on
a zoomable map, the map file is autoselected depending of the position
and prefered scale. Speech output is supported if the "festival"
software is running. The maps are autoselected for best resolution
depending of your position and can be downloaded from Internet. All
Garmin GPS reveiver with a serial output should be usable, also other
GPS receiver which supports NMEA protocol.

For optional MySQL support, install 'mysql-shlibs'.

Note that this is a beta release, so some things may not be working.
<<
DescUsage: <<
'man gpsdrive' to get started.

You may have to adjust the /dev path for communication with Garmin.

There are reports that mouse buttons do not work correctly. The
following was posted to the gpsdrive mailing list:

  From: Eduo <eduo@titan.ciateq.mx>
  Date: Sun, 15 Jun 2003 02:03:40 -0500 (CDT)
  Subject: Re: mac OS X: no right click
  
  On Sat, 14 Jun 2003, Stephen Proulx wrote:
  >
  > Since there's been a string of messages about compiling, I thought I'd
  > see if any of the mac users have the same problem as me with using
  > gpsdrive.
  >
  > I've compiled it for OS X 10.2 and can run it under Macintosh's X11
  > server, but using Option+click and Command+click does nothing.
  
  I had this problem and haven't been able to fix it, but I have found that
  with a two-button mouse you can actually duplicate the right and left
  button behaviours in a strange way: you have to click both buttons first
  the mouse clicking the one you want and without relasing clicking the
  second one, thus:
  
  left-click-hold, right click-release: left click
  right-click-hold, left click-release: right click
<<
DescPort: <<
Have to move doc files by hand (./configure putting doc files in
--datadir along with pix (DATADIR gets hard-coded; prog looks for
DATADIR/gpsdrive/filename.ext). Should doc files go in DATADIR/doc?

At run-time, gpsdrive checks if the MySQL client library is available,
and enables MySql support if so (mysql version 3/libversion 10).
Besides patching in the Fink mysql lib path, we patch out any mysql
lib paths that are not libversion-specific, just to be safe.

Need a way (--with-mysql-client= ?) to pass non-standard mysql lib
(path and filename (but could guess default filenames if passed a
path?>). Maybe --with-mysql-headers= path to dir of .h so could use
matching headers to installed lib to over-ride  the dist -Imysql?

gpsd.c may not compile under ccache, so the Fink ccache-default
package must not be installed while gpsdrive is being built. There's
no BuildConflicts field, so I'll just leave this note, figuring anyone
who gets into trouble will look here and find it.

The -version-info patch for the libraries should be rolled into
the .patch for Makefile.in, but for now we need to rerun auto* first so
would have to put it in Makefile.am; this isn't something for
non-Darwin platforms, so I'd rather make it obvious to myself that
this isn't something to be incorporated into the program but instead I
must remember to keep this in the Fink patch (or until I figure out
what token to use for an if...else in Makefile.am).

--with-debug may allow some optimization flags to leak through.

Plugins are disabled because module linking seems broken. The names
are extensionless (gmodule* wants them .so) but could patch around
that. The files are of the wrong type (-module (as for 1.32-1) or
-bundle (as per ld manpage) give "Mach-O dynamically linked shared
library ppc", while gmodule* needs "Mach-O bundle ppc" (1.32-1 (as
patched) gets this correct!).

Garmin disabled (lots of prototyping non-portability...should just
use sys/types.h for everyone, etc., but haven't fixed it yet).

-Ddlsym= (if needed) seems to be needed *very* early in ./configure
(it takes effect late, but apparently has some side-effect on some AC_
or AM_ macro and if not given early gpsdrive finds MySQL but then
segfaults). So we'll just use the CFLAGS env until someone figures out
what's going on.

If MySQL dlopen succeeds by dlsym fails (i.e., -Ddlsym= omitted),
segfault during startup (EXC_BAD_ACCESS/KERN_INVALID_ADDRESS in
gtk_box_pack_start in _start (crt.c:267) in start) (during or just
after splash-screen; before main window is created.

Fink's dlcompat-shlibs-20030629-1 has a broken dlopen() in libdl.dylib. 
Fixed in -2 (and not broken in older versions).

Often the Quit button causes a segfault.
<<
Homepage: http://www.kraftvoll.at/software/index.shtml
License: GPL
Maintainer: Daniel Macks <dmacks@netspace.org>
Depends: x11, glib-shlibs, gtk+2-shlibs (>= 2.1-1), freetype2-shlibs, dlcompat-shlibs, pcre-shlibs (>= 3-1), pango1-shlibs, atk1-shlibs
BuildDepends: glib, gtk+2 (>= 2.1-1), gtk+2-dev (>= 2.1-1), freetype2, dlcompat-dev, mysql-dev, pcre (>= 3-1), pcre-bin (>= 3-1), pkgconfig, pango1-dev, atk1
#BuildDepends: autoconf2.5, automake1.7, libtool14 (>= 1.5-1)
#Depends: libgnugetopt-shlibs
#BuildDepends: libgnugetopt
Conflicts: dlcompat-shlibs (= 20030629-1)
# mysql-shlibs is libmysqlclient.10.dylib
Suggests: mysql-shlibs
# Garmin is C++
#GCC: 3.1
Source: mirror:custom:%n-%v.tar.gz
Source-MD5: 4d0915c5b4805a8bc01c31a9e50be465
CustomMirror: <<
eur-DE: http://gpsdrive.dotdeguy.de/
eur-DE: http://gpsdrive.spoiledmeat.net/
eur-DE: http://gpsdrive.flugfunk.de/
eur-ES: http://gpsdrive.alumnosfdi.org/
nam-US: http://gpsdrive.teachlinux.com/
Primary: http://www.kraftvoll.at/software/
<<
#Patch: %n.patch
# PatchScript may need to 
#   cp %p/share/automake-1.7/compile
# before autoreconf
# PatchScript may need to 
#   autoreconf -f
# after lowest-level patches (and if so BuildDepends on auto* tools)
PatchScript: <<
  perl -pi.BAK -e 's|\@PREFIX\@|%p|' src/gpsdrive.c
  cp src/Makefile.in src/Makefile.in.old
  sed -e 's/-version-info 2:0:0/-bundle -avoid-version/' src/Makefile.in.old > src/Makefile.in
<<
SetCFLAGS: -Ddlsym=dlsym_prepend_underscore
SetCPPFLAGS: -I/usr/X11R6/include -Wall
#SetCPPFLAGS: -I%p/include/gnugetopt
#SetLDFLAGS: -lgnugetopt
SetMACOSX_DEPLOYMENT_TARGET: 10.2
ConfigureParams: --mandir='${prefix}/share/man' --libdir='${prefix}/lib' --disable-garmin --disable-plugins
CompileScript: <<
  ./configure %c
  make
<<
# InstallScript should do
#   rm %i/lib/%n/*.a %i/lib/%n/*.la
# when plugins are enabled
InstallScript: <<
  make prefix=%i install
  install -d -m 755 %i/share/doc/%n
  mv %i/share/%n/[A-Zcw]* %i/share/doc/%n
<<
