Package: gnome-vfs2-ssl
Version: 2.10.1
Revision: 5
Depends: <<
	%N-shlibs (>= %v-%r), 
	gconf2 (>= 2.8.0-1), 
	glib2 (>= 2.6.0-1), 
	libbonobo2 (>= 2.6.0-1), 
	libgettext3-shlibs, 
	libiconv, 
	orbit2 (>= 2.10.0-1)
<<
BuildDepends: <<
	fink (>= 0.24.8-1), 
	bzip2-dev, 
	gconf2-dev (>= 2.8.0-1), 
	gettext-bin, 
	gettext-tools, 
	glib2-dev (>= 2.6.0-1), 
	gtk-doc (>= 1.2-1), 
	intltool (>= 0.30-1), 
	libbonobo2-dev (>= 2.8.0-1), 
	libgettext3-dev, 
	libiconv-dev, 
	libxml2 (>= 2.6.7-1), 
	libxslt, 
	(%N = gnome-vfs2-ssl) openssl097-dev, 
	orbit2-dev (>= 2.10.0-1), 
	pkgconfig, 
	popt
<<
BuildConflicts: libcdparanoia0-dev
Conflicts: gnome-vfs2, gnome-vfs2-ssl
Replaces: gnome-vfs2, gnome-vfs2-ssl, libgnome2 (<< 2.6.0-6)
Source: mirror:gnome:sources/gnome-vfs/2.10/gnome-vfs-%v.tar.bz2
Source-MD5: 88b520e5de748a310a2aef62fc095c8b
Patch: %n.patch
PatchScript: <<
  perl -pi.bak -e 's|open64|||g; s|posix_fadvise||g' configure
  perl -pi.bak -e 's|data_dirs = "/usr|data_dirs = "%p/share:/usr|g' \
    libgnomevfs/xdgmime.c libgnomevfs/gnome-vfs-mime-info.c
  perl -pi.bak -e 's|/etc/fstab|/etc/fstab.hd|g' libgnomevfs/gnome-vfs-unix-mounts.c
<<
SetCPPFLAGS: -flat_namespace -undefined suppress
SetCFLAGS: -O3 -funroll-loops -fstrict-aliasing -flat_namespace -undefined suppress
SetLDFLAGS: -lresolv
SetLIBS: -L%p/lib
ConfigureParams: --enable-ipv6 --disable-howl (%N = gnome-vfs2-ssl) --with-openssl-libs=%p (%N != gnome-vfs2-ssl) --disable-openssl --disable-gnutls --libexecdir=%p/sbin --enable-static --enable-shared --disable-dependency-tracking
CompileScript: <<
  ./configure %c
  perl -pi.bak -e 's/-lkrb5support//g' `find . -name Makefile`
  make
  sed -e 's/-lssl//g' -e 's/-lcrypto//g' <libgnomevfs/.libs/libgnomevfs-2.lai >libgnomevfs-2.la
<<
InstallScript: <<
  GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1 make install DESTDIR=%d
  rm -rf %i/doc
  install -c -m 644 libgnomevfs-2.la %i/lib/
  install -d -m 755 %i/lib/%N
  ln -s %p/sbin/gnome-vfs-daemon %i/lib/%N
<<
PostInstScript: <<
  if [ configure = "$1" ]; then
    export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
    for i in desktop_default_applications desktop_gnome_url_handlers \
      system_dns_sd system_http_proxy system_smb; do
        gconftool-2 --makefile-install-rule %p/etc/gconf/schemas/$i.schemas >/dev/null
    done
  fi
<<
SplitOff: <<
  Package: %N-shlibs
  Depends: <<
	bzip2-shlibs,
	gconf2-shlibs (>= 2.8.0-1),
	glib2-shlibs (>= 2.6.0-1),
	gnome-mime-data (>= 2.4.0-1),
	libbonobo2-shlibs (>= 2.8.0-1),
	libgettext3-shlibs,
	libiconv,
	libxml2-shlibs (>= 2.6.7-1),
	(%N = gnome-vfs2-ssl) openssl097-shlibs, 
	orbit2-shlibs (>= 2.10.0-1), 
	popt-shlibs
  <<
  DescPackaging: <<
    share/locale was in %N until 2.10.0-5
  <<
  Conflicts: gnome-vfs2-shlibs, gnome-vfs2-ssl-shlibs
  Replaces: gnome-vfs2-shlibs, gnome-vfs2-ssl-shlibs, gnome-vfs2 (<< 2.10.1-5), gnome-vfs2-ssl (<< 2.10.1-5)
  Files: lib/libgnomevfs-2.*.dylib lib/gnome-vfs-2.0/modules/*.so share/locale
  Shlibs: %p/lib/libgnomevfs-2.0.dylib 1001.0.0 gnome-vfs2-shlibs (>= 2.10.1-5) | gnome-vfs2-ssl-shlibs (>= 2.10.1-5)
  DocFiles: AUTHORS COPYING* ChangeLog NEWS README
<<
SplitOff2: <<
  Package: %N-dev
  Depends: %N-shlibs (= %v-%r)
  DescPackaging: <<
    Uses pkgconfig.
    Any package which BuildDepends on this one must also BuildDepend on:
      glib2-dev (>= 2.6.0-1), libxml2 (>= 2.6.7-1), orbit2-dev (>= 2.10.0-1)

    modules/lib*.{a,la} were in %N-shlibs until 2.10.0-5
    bonobo/monikers/lib*.{a,la} were in %N until 2.10.0-5
  <<
  Conflicts: gnome-vfs2-dev, gnome-vfs2-ssl-dev
  Replaces: gnome-vfs2-dev, gnome-vfs2-ssl-dev, gnome-vfs2 (<< 2.10.1-5), gnome-vfs2-ssl (<< 2.10.1-5), gnome-vfs2-shlibs (<< 2.10.0-5), gnome-vfs2-ssl-shlibs (<< 2.10.0-5)
  BuildDependsOnly: True
  Files: <<
    include lib/gnome-vfs-2.0 lib/pkgconfig share/gtk-doc
    lib/libgnomevfs-2.*a lib/libgnomevfs-2.dylib
    lib/bonobo/monikers/*a
  <<
  DocFiles: AUTHORS COPYING* ChangeLog NEWS README
<<
ConfFiles: <<
  %p/etc/gnome-vfs-2.0/modules/default-modules.conf
  %p/etc/gnome-vfs-2.0/modules/ssl-modules.conf
  %p/etc/gconf/schemas/desktop_default_applications.schemas
  %p/etc/gconf/schemas/desktop_gnome_url_handlers.schemas
  %p/etc/gconf/schemas/system_dns_sd.schemas
  %p/etc/gconf/schemas/system_http_proxy.schemas
  %p/etc/gconf/schemas/system_smb.schemas
<<
DocFiles: AUTHORS COPYING* ChangeLog NEWS README
Description: The GNOME virtual file-system libraries
DescDetail: <<
GNOME VFS is the GNOME virtual file system. It is the foundation of the
Nautilus file manager. It provides a modular architecture and ships with
several modules that implement support for file systems, http, ftp and others.
It provides a URI-based API, a backend supporting asynchronous file operations,
a MIME type manipulation library and other features.
<<
DescPackaging: <<
  Although this package has a GPL/LGPL license, it is marked Restrictive since
  it links to openssl.

  Remove -lssl and -lcrypto flags from *.la files to make dependent
  programs depends on those crypto libraries directly and pass their
  own flags.  (makes %n and %n-ssl more interchangeable at runtime)

  v2.6 had libexecdir as %p/lib/%n so switching to/from -ssl changed
  where the daemon was. Now always put in %p/sbin in both packages,
  where one expects to find daemons, and add symlinks to support
  scripts that still use the old location.
<<
License: Restrictive
Maintainer: The Gnome Core Team <fink-gnome-core@lists.sourceforge.net>
Homepage: http://www.gnome.org/
