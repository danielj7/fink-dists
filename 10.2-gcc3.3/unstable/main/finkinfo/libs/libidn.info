Package: libidn
Version: 0.5.1
Revision: 2
Source: ftp://alpha.gnu.org/pub/gnu/%n/%n-%v.tar.gz
Source-MD5: 2fd747e73aa974b29fce7451d8ca456c
Patch: %n.patch
NoSetCPPFLAGS: true
NoSetLDFLAGS: true
BuildDepends: gtk-doc, libiconv-dev, pkgconfig, system-java14-dev
Depends: %N-shlibs (>= %v-%r)
ConfigureParams: --mandir=%p/share/man --infodir=%p/share/info --enable-gtk-doc --enable-java
InfoDocs: libidn.info
CompileScript: <<
#!/bin/sh -ex

  JAVAVER=`find /System/Library/Frameworks/JavaVM.framework/Versions -name include 2>/dev/null | perl -p -e 's,.*Versions/(.*?)/.*,$1,g' | grep -E '^1.4' | tail -1`
  export JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Versions/$JAVAVER/Home
  export PATH="$JAVA_HOME/bin:$PATH"

  export ac_cv_prog_JAVAC=javac
  ./configure %c
  make
  DYLD_LIBRARY_PATH=%b/lib/.libs make check
  rm -rf %i/share/java
  # don't want to builddepend on emacs just for some elc's  :P
  rm -rf %i/share/emacs
<<
InstallScript: <<
#!/bin/sh -ex

  make -j1 install DESTDIR="%d"
<<
SplitOff: <<
  Package: %N-shlibs
  Depends: libiconv
  Description: Shared libraries for libidn
  Files: lib/libidn.*.dylib
  Shlibs: %p/lib/libidn.11.dylib 16.0.0 %N-shlibs (>= 0.5.1-1)
<<
SplitOff2: <<
  Package: %N-java
  Depends: system-java14 | system-java15
  Description: Java implementation of libidn
  JarFiles: java/%N-%v.jar
<<
DocFiles: AUTHORS COPYING* ChangeLog FAQ INSTALL NEWS README* THANKS TODO
Description: Internationalized domain names
Maintainer: Benjamin Reed <ranger@befunk.com>
Homepage: http://www.gnu.org/software/libidn/
License: LGPL
