diff -ruN node-v0.8.1.orig/fink/node-waf.1 node-v0.8.1/fink/node-waf.1
--- node-v0.8.1.orig/fink/node-waf.1	1969-12-31 17:00:00.000000000 -0700
+++ node-v0.8.1/fink/node-waf.1	2012-07-04 18:17:03.000000000 -0600
@@ -0,0 +1,43 @@
+.TH node-waf 1 "11 July 2010"
+.
+.SH NAME
+.
+node-waf - WAF helper for building node modules
+.
+.SH SYNOPSIS
+.B node-waf [\fICOMMAND\fR]
+.
+.SH DESCRIPTION
+.PP
+Helper for the waf build system that is included in nodejs-dev package.
+.P
+Typical usage is :
+\fInode-waf\fP \fBconfigure\fR \fBbuild\fR
+.
+.SH ENVIRONMENT VARIABLE
+.P
+\fBNODE_PATH\fR sets the path where the module is installed.
+This environment variable may be set when calling \fBconfigure\fR command.
+If $HOME is set, it defaults to $HOME/.node_libraries, else to @FINKPREFIX@/lib/nodejs.
+.
+.SH COMMANDS
+.TP
+\fBdistclean\fR
+Removes all files created by \fInode-waf\fP.
+This may be useful when using a new node release.
+.TP
+\fBclean\fR
+.TP
+\fBconfigure\fR
+.TP
+\fBbuild\fR
+.TP
+\fBinstall\fR
+Install to NODE_PATH.
+.TP
+\fBuninstall\fR
+Uninstall module from NODE_PATH.
+.
+.SH "SEE ALSO"
+.
+.BR node(1)
diff -ruN node-v0.8.1.orig/fink/node-waf.bash-completion node-v0.8.1/fink/node-waf.bash-completion
--- node-v0.8.1.orig/fink/node-waf.bash-completion	1969-12-31 17:00:00.000000000 -0700
+++ node-v0.8.1/fink/node-waf.bash-completion	2012-07-04 18:16:25.000000000 -0600
@@ -0,0 +1,9 @@
+have node-waf &&
+_node_waf()
+{
+    cur=${COMP_WORDS[COMP_CWORD]}
+    if [ $COMP_CWORD -ge 1 ]; then
+        COMPREPLY=( $( compgen -W "distclean clean configure build install uninstall" $cur ) )
+    fi
+}
+complete -F _node_waf node-waf
diff -ruN node-v0.8.1.orig/fink/patches/FHS_paths_for_nodejs.patch node-v0.8.1/fink/patches/FHS_paths_for_nodejs.patch
--- node-v0.8.1.orig/fink/patches/FHS_paths_for_nodejs.patch	1969-12-31 17:00:00.000000000 -0700
+++ node-v0.8.1/fink/patches/FHS_paths_for_nodejs.patch	2012-07-04 22:46:26.000000000 -0600
@@ -0,0 +1,56 @@
+Description: FHS paths for nodejs
+ Use /usr/lib/nodejs for packaged modules.
+ Add /usr/local/lib/nodejs for user-installed modules.
+ Use /usr/include/nodejs for headers.
+ 
+Forwarded: not-needed
+Author: Jérémy Lal <kapouer@melix.org>
+Last-Update: 2011-09-11
+--- a/lib/module.js	2012-06-29 03:11:19.000000000 -0600
++++ b/lib/module.js	2012-07-04 22:44:32.000000000 -0600
+@@ -488,7 +488,7 @@
+ };
+ 
+ Module._initPaths = function() {
+-  var paths = [path.resolve(process.execPath, '..', '..', 'lib', 'node')];
++  var paths = ['@FINKPREFIX@/lib/nodejs'];
+ 
+   if (process.env['HOME']) {
+     paths.unshift(path.resolve(process.env['HOME'], '.node_libraries'));
+--- a/tools/node-waf	2012-06-29 03:11:19.000000000 -0600
++++ b/tools/node-waf	2012-07-04 22:43:22.000000000 -0600
+@@ -3,9 +3,11 @@
+ 
+ 
+ join = os.path.join
+-bindir = os.path.dirname(os.path.realpath(__file__))
+-prefix = join(bindir, "..")
+-wafdir = join(prefix, "lib", "node")
++if os.environ.has_key('PREFIX_NODE'):
++	prefix = os.environ['PREFIX_NODE']
++else:
++	prefix = "@FINKPREFIX@"
++wafdir = join(prefix, "share", "nodejs")
+ 
+ w = join(wafdir, 'wafadmin')
+ t = join(w, 'Tools')
+--- a/tools/wafadmin/Tools/node_addon.py	2012-06-29 03:11:19.000000000 -0600
++++ b/tools/wafadmin/Tools/node_addon.py	2012-07-04 22:42:33.000000000 -0600
+@@ -29,7 +29,7 @@
+   nodebin = join(prefix, 'bin', 'node')
+ 
+   conf.env['LIBPATH_NODE'] = lib
+-  conf.env['CPPPATH_NODE'] = join(prefix, 'include', 'node')
++  conf.env['CPPPATH_NODE'] = join(prefix, 'include', 'nodejs')
+ 
+   conf.env.append_value('CPPFLAGS_NODE', '-D_GNU_SOURCE')
+ 
+@@ -70,7 +70,7 @@
+     nodePath = None
+     if not os.environ.has_key('NODE_PATH'):
+         if not os.environ.has_key('HOME'):
+-            nodePath = join(get_prefix(), 'lib', 'node')
++            nodePath = join(get_prefix(), 'lib', 'nodejs')
+         else:
+             nodePath = join(os.environ['HOME'], '.node_libraries')
+     else:
diff -ruN node-v0.8.1.orig/fink/patches/expected_failing_tests.patch node-v0.8.1/fink/patches/expected_failing_tests.patch
--- node-v0.8.1.orig/fink/patches/expected_failing_tests.patch	1969-12-31 17:00:00.000000000 -0700
+++ node-v0.8.1/fink/patches/expected_failing_tests.patch	2012-07-05 09:03:25.000000000 -0600
@@ -0,0 +1,45 @@
+Description: Expected failing tests
+ There are three categories of failing tests:
+ 1 - because of build server without external network access
+ 2 - the test itself is buggy (race condition under heavy load,
+     problem with the external command that is called)
+ 3 - the test is legitimately failing, but no one knows why and
+     that prevents the package from being updated.
+ That last type was #660802 and has been fixed.
+ 
+Forwarded: not-needed
+Author: Jérémy Lal <kapouer@melix.org>
+Last-Update: 2012-06-06
+--- a/test/simple/simple.status
++++ b/test/simple/simple.status
+@@ -1 +1,30 @@
+ prefix simple
++
++# only fail when some network resources are not available
++test-http-dns-fail: PASS || FAIL
++test-net-connect-timeout: PASS || FAIL
++test-dgram-multicast-multi-process: PASS || FAIL
++test-dgram-broadcast-multi-process: PASS || FAIL
++
++# sometimes these tests TIMEOUT or FAIL
++test-dgram-pingpong: PASS || FAIL || TIMEOUT
++test-stream-pipe-multi: PASS || TIMEOUT
++
++# 512 bits keys fail with openssl 1.0.1 - node tests will use 1024 bits
++# keys : https://github.com/joyent/node/commit/ef046bf4
++# Meanwhile, allow this test to fail
++test-tls-passphrase: PASS || FAIL || CRASH
++test-tls-server-verify: PASS || FAIL || CRASH
++test-tls-session-cache: PASS || FAIL || CRASH
++
++# build as nobody fails, no perms to create files
++test-child-process-customfd-bounded: PASS || FAIL
++test-memory-usage-emfile: PASS || FAIL
++
++# malloc issue, SSL related??
++test-crypto: PASS || FAIL
++test-https-foafssl: PASS || FAIL || CRASH
++test-https-pfx: PASS || FAIL || CRASH
++
++# Not sure why this one fails
++test-zlib-random-byte-pipes: PASS || FAIL || CRASH
diff -ruN node-v0.8.1.orig/fink/patches/fixjs-before-test.patch node-v0.8.1/fink/patches/fixjs-before-test.patch
--- node-v0.8.1.orig/fink/patches/fixjs-before-test.patch	1969-12-31 17:00:00.000000000 -0700
+++ node-v0.8.1/fink/patches/fixjs-before-test.patch	2012-07-05 10:48:40.000000000 -0600
@@ -0,0 +1,18 @@
+--- a/Makefile	2012-06-29 03:11:19.000000000 -0600
++++ b/Makefile	2012-07-05 10:46:42.000000000 -0600
+@@ -53,6 +53,7 @@
+ 
+ test: all
+ 	$(PYTHON) tools/test.py --mode=release simple message
++	PYTHONPATH=tools/closure_linter/ $(PYTHON) tools/closure_linter/closure_linter/fixjsstyle.py --strict --nojsdoc -r lib/ -r src/ --exclude_files lib/punycode.js
+ 	PYTHONPATH=tools/closure_linter/ $(PYTHON) tools/closure_linter/closure_linter/gjslint.py --unix_mode --strict --nojsdoc -r lib/ -r src/ --exclude_files lib/punycode.js
+ 
+ test-http1: all
+@@ -262,6 +263,7 @@
+ 	./node benchmark/idle_clients.js &
+ 
+ jslint:
++	PYTHONPATH=tools/closure_linter/ $(PYTHON) tools/closure_linter/closure_linter/fixjsstyle.py --strict --nojsdoc -r lib/ -r src/ --exclude_files lib/punycode.js
+ 	PYTHONPATH=tools/closure_linter/ $(PYTHON) tools/closure_linter/closure_linter/gjslint.py --unix_mode --strict --nojsdoc -r lib/ -r src/ --exclude_files lib/punycode.js
+ 
+ cpplint:
