# -*- coding: ascii; tab-width: 4; x-counterpart: cvs-fast-export.patch -*-
Package: cvs-fast-export
Version: 1.20
Revision: 1
Description: Export CVS to fast-import stream
DescDetail: <<
Export an RCS or CVS history as a fast-import stream. This program
analyzes a collection of RCS files in a CVS repository (or outside of
one) and, when possible, emits an equivalent history in the form of a
fast-import stream. Not all possible histories can be rendered this way;
the program tries to emit useful warnings when it can't. The program can
also produce a visualization of the resulting commit DAG in the DOT
format handled by the graphviz suite.
<<
Homepage: http://www.catb.org/~esr/cvs-fast-export/
License: GPL2
Maintainer: Daniel Johnson <daniel@daniel-johnson.org>

#Source: http://www.catb.org/~esr/%n/%n-%v.tar.gz
# Release tarball is missing some files. Use snapshot from
# gitorious instead.
# But the hash of that tarball is inconsistent so make our own copy.
#Source: https://gitorious.org/cvs-fast-export/cvs-fast-export/archive/898f051b81bb64e9f928c128aae05844768500d6.tar.gz
Source: https://dl.dropboxusercontent.com/u/9988666/cvs-fast-export-1.20.tar.gz
SourceRename: %n-%v.tar.gz
SourceDirectory: %n-%n
Source-MD5: cfb4c7d2a819bab96c9dd0d29af1fcd8

PatchFile: %n.patch
PatchFile-MD5: 0bd4a5efd90a8b6b0e1a0661dc6586d4
PatchScript: <<
	%{default_script}
	# Fix hardcoded path in test.
	perl -pi -e 's|/home/esr/public_html/cvs-fast-export|%b|' tests/t9603.err
	# Replace 'echo -n' with 'printf' in tests/Makefile
	perl -pi -e 's/echo -n/printf/' tests/Makefile
<<

# These are needed to build the manpage.
BuildDepends: <<
	bison,
	asciidoc-a2x,
	docbook-dtd,
	docbook-xsl,
	libxml2-bin
<<

CompileScript: make prefix=%p EXTRA_CFLAGS='-D_DARWIN_C_SOURCE=1'

InfoTest: <<
	TestDepends: cvs, rcs
	TestScript: make -j1 check || exit 2
<<

InstallScript: <<
	make cvs-fast-export.html cvssync.html install prefix=%p DESTDIR=%d
<<

DocFiles: AUTHORS COPYING NEWS README cvs-fast-export.html cvssync.html
