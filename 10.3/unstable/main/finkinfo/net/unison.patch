diff -Pur unison-2.10.2-orig/Makefile.OCaml unison-2.10.2/Makefile.OCaml
--- unison-2.10.2-orig/Makefile.OCaml	Tue Jul 19 08:50:23 2005
+++ unison-2.10.2/Makefile.OCaml	Tue Jul 19 08:50:44 2005
@@ -60,7 +60,7 @@
 # to Unix '/' separators, and extraneous control-M's are deleted.
 # Unfortunately there is a literal control-M buried in this, I'd rather
 # get rid of it...
-OCAMLLIBDIR=$(shell ocamlc -v | tail -1 | sed -e 's/.* //g' | sed -e 's/\\/\//g' | sed -e 's///g')
+OCAMLLIBDIR=$(shell ocamlc -v | tail -n -1 | sed -e 's/.* //g' | sed -e 's/\\/\//g' | sed -e 's///g')
 
 # User interface style: 
 #   Legal values are
@@ -450,7 +450,7 @@
            >>dot.tmp
 	echo '{ rank = same; "Tree"; "Safelist"; }'>>dot.tmp
 	echo '{ rank = same; "Uarg"; "Prefs"; }'>>dot.tmp
-	ocamldot .depend | tail +2 >> dot.tmp
+	ocamldot .depend | tail -n +2 >> dot.tmp
 	-dot -Tps -o DEPENDENCIES.ps dot.tmp
 endif
 
diff -Pur unison-2.10.2-orig/osxsupport.c unison-2.10.2/osxsupport.c
--- unison-2.10.2-orig/osxsupport.c	Tue Jul 19 08:50:23 2005
+++ unison-2.10.2/osxsupport.c	Fri Jul 22 11:37:49 2005
@@ -6,6 +6,8 @@
 #include <caml/alloc.h>
 #include <caml/memory.h>
 #ifdef __APPLE__
+#include <sys/types.h>
+#include <sys/stat.h>
 #include <sys/attr.h>
 #include <unistd.h>
 #include <stdio.h>
@@ -115,6 +117,20 @@
   retcode = setattrlist(String_val (path), &attrList, attrBuf.finderInfo,
                         sizeof attrBuf.finderInfo, options);
 
+  if (retcode == -1 && errno == EACCES) {
+    /* Unlike with normal Unix attributes, we cannot set OS X attributes 
+       if file is read-only.  Try making it writable temporarily. */
+    struct stat st;
+    int r = stat(String_val(path), &st);
+    if (r == -1) uerror("setattrlist", path);
+    r = chmod(String_val(path), st.st_mode | S_IWUSR);
+    if (r == -1) uerror("setattrlist", path);
+    /* Try again */
+    retcode = setattrlist(String_val (path), &attrList, attrBuf.finderInfo,
+                          sizeof attrBuf.finderInfo, options);
+    /* Whether or not that worked, we should try to set the mode back. */
+    chmod(String_val(path), st.st_mode);
+  }
   if (retcode == -1) uerror("setattrlist", path);
 
   CAMLreturn (Val_unit);
