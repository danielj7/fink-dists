diff -ru xchat-2.0.6/configure xchat-2.0.6-patched/configure
--- xchat-2.0.6/configure	2003-11-28 04:08:56.000000000 +0100
+++ xchat-2.0.6-patched/configure	2003-12-29 20:39:32.000000000 +0100
@@ -23466,7 +23466,7 @@
 echo "${ECHO_T}ok" >&6
 
 		oldLIBS=$LIBS
-		LIBS="$LIBS $PERL_LDFLAGS"
+		LIBS="$PERL_LDFLAGS $LIBS"
 		echo "$as_me:$LINENO: checking for eval_pv" >&5
 echo $ECHO_N "checking for eval_pv... $ECHO_C" >&6
 if test "${ac_cv_func_eval_pv+set}" = set; then
@@ -23731,7 +23731,7 @@
                         PY_PREFIX=`$pythonpath -c 'import sys; print sys.prefix'`
                         PY_EXEC_PREFIX=`$pythonpath -c 'import sys; print sys.exec_prefix'`
                         if test -f $PY_INC/Python.h; then
-                                PY_LIBS="-L$PY_LIB/config -lpython$PY_VER -lpthread -lutil"
+                                PY_LIBS="-L$PY_LIB/config -lpython$PY_VER"
                                 PY_CFLAGS="-I$PY_INC"
                                 echo "$as_me:$LINENO: result: ok" >&5
 echo "${ECHO_T}ok" >&6
diff -ru xchat-2.0.6/src/common/dcc.c xchat-2.0.6-patched/src/common/dcc.c
--- xchat-2.0.6/src/common/dcc.c	2003-11-28 04:06:57.000000000 +0100
+++ xchat-2.0.6-patched/src/common/dcc.c	2003-12-29 20:39:06.000000000 +0100
@@ -1659,9 +1659,15 @@
 			 * sending file.
 			 */
 			dcc = find_dcc_from_id (pasvid, TYPE_SEND);
-			dcc->addr = addr;
-			dcc->port = port;
-			dcc_connect(dcc);
+			if (dcc)
+			{
+				dcc->addr = addr;
+				dcc->port = port;
+				dcc_connect (dcc);
+			} else
+			{
+				dcc_malformed (sess, nick, word_eol[4] + 2);
+			}
 			return;
 		}
 
