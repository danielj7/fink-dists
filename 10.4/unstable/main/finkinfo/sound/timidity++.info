Info2: <<
Package: timidity++%type_pkg[uitype]
Version: 2.13.2
Revision: 2
Type: uitype (-nox -gtk -tcltk -motif)
Description: Software MIDI synthesizer
License: GPL
Homepage: http://timidity.sourceforge.net/
Maintainer: Todai Fink Team <fink@sodan.ecc.u-tokyo.ac.jp>

Source: mirror:sourceforge:timidity/TiMidity++-%v.tar.bz2
Source-MD5: a82ceeb2245e22f4de2b41da21eaee32

Provides:  timidity
Conflicts: timidity++-nox, timidity++-gtk, timidity++-tcltk, timidity++-motif
Replaces:  timidity++-nox, timidity++-gtk, timidity++-tcltk, timidity++-motif

BuildDepends: <<
  audiofile,
  emacsen,
  esound,
  libogg,
  libvorbis0,
  libncurses5,
  libpng3,
  slang,
  (%type_raw[uitype] = -gtk) gtk+2-dev,
  (%type_raw[uitype] = -gtk) glib2-dev,
  (%type_raw[uitype] = -gtk) libgettext3-dev,
  (%type_raw[uitype] = -gtk) atk1,
  (%type_raw[uitype] = -gtk) cairo,
  (%type_raw[uitype] = -gtk) fontconfig2-dev,
  (%type_raw[uitype] = -gtk) freetype219,
  (%type_raw[uitype] = -gtk) glitz,
  (%type_raw[uitype] = -gtk) libiconv-dev,
  (%type_raw[uitype] = -gtk) pango1-xft2-ft219-dev,
  (%type_raw[uitype] = -gtk) pixman,
  (%type_raw[uitype] = -tcltk) tcltk-dev,
  (%type_raw[uitype] = -motif) openmotif3,
  (%type_raw[uitype] != -nox) x11-dev
<<

Depends: <<
  timidity-patches,
  libogg-shlibs,
  libvorbis0-shlibs,
  esound-shlibs,
  libncurses5-shlibs,
  libpng3-shlibs,
  slang-shlibs,
  (%type_raw[uitype] = -gtk) gtk+2-shlibs,
  (%type_raw[uitype] = -tcltk) tcltk-shlibs,
  (%type_raw[uitype] = -motif) openmotif3-shlibs
<<

SetCPPFLAGS: -I%p/lib/freetype219/include -I%p/include/libpng12
SetLDFLAGS:  -L%p/lib/freetype219/lib -L%p/lib/fontconfig2/lib
ConfigureParams: <<
  --bindir=%p/lib/timidity --mandir=%p/share/man \
  --enable-audio=darwin,esd,vorbis --with-default-output=darwin \
  --enable-server --enable-network --enable-slang --enable-spline=gauss \
  --enable-emacs --with-lispdir=%p/share/emacs/site-lisp \
  --with-default-path=%p/etc \
  --disable-dependency-tracking
<<

CompileScript: <<
  #!/bin/bash -ev
  if [ "%type_raw[uitype]" == "-nox" ]; then
    ./configure %c --enable-interface=ncurses --without-x
  else
    uitype="%type_raw[uitype]"
    PKG_CONFIG_PATH=%p/lib/pango-ft219/lib/pkgconfig:$PKG_CONFIG_PATH \
    ./configure %c --enable-interface=ncurses,xskin,${uitype/-/} \
                   --enable-wrd --enable-spectrogram
  fi
  make

  /bin/mkdir fink
  /bin/cat <<-EOF > fink/timidity || exit 1
	#!/bin/sh
	if [ -z "\$TIMIDITY_CFG" ]; then
	  %p/lib/timidity/timidity "\$@"
	else
	  %p/lib/timidity/timidity --config-file="\$TIMIDITY_CFG" "\$@"
	fi
	EOF

  /bin/cat <<-EOF > fink/timidity.cfg || exit 1
	# This file is a config file of TiMidity++, generated by Fink.
	# You don't have to modify this file manually,
	# if you use patches provided by fink.
	EOF
<<

InstallScript: <<
  make install DESTDIR=%d

  install -m 755 -d                %i/bin
  install -m 755 fink/timidity     %i/bin
  install -m 755 -d                %i/etc
  install -m 644 fink/timidity.cfg %i/etc

  install -m 755 -d                           %i/share/doc/%n/{C,ja_JP.eucJP}
  install -m 644 doc/C/{CHANGES.02i,README.*} %i/share/doc/%n/C
  install -m 644 doc/ja_JP.eucJP/README.*     %i/share/doc/%n/ja_JP.eucJP

  # included in timidity-el package.
  rm -rf %i/share/emacs
<<

DocFiles: AUTHORS COPYING ChangeLog ChangeLog.1 INSTALL INSTALL.ja NEWS README README.ja TODO

ConfFiles: %p/etc/timidity.cfg

DescDetail: <<
TiMidity++ is a software synthesizer. It can play MIDI files by
converting them into PCM waveform data; give it a MIDI data along with
digital instrument data files, then it synthesizes them in real-time,
and plays. It can not only play sounds, but also can save the
generated waveforms into hard disks as various audio file formats.
<<

DescPackaging: <<
The patches (i.e. Eawpatches, Izumo patches, etc.) should be installed in
/sw/share/timidity/PATCH_NAME (i.e. /sw/share/timidity/eawpatches etc.).
The patches can use TIMIDITY_CFG environment variable for an easy setup.
<<

<<
