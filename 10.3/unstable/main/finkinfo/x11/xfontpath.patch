diff -Naur xfontpath-0.4.orig/fink/xfontpath.csh.in xfontpath-0.4/fink/xfontpath.csh.in
--- xfontpath-0.4.orig/fink/xfontpath.csh.in	Fri Oct  5 13:13:33 2001
+++ xfontpath-0.4/fink/xfontpath.csh.in	Wed Apr  5 16:40:24 2006
@@ -1,6 +1,8 @@
 # xfontpath.csh
 
 if ( -x @XFONTPATH@ && $?DISPLAY ) then
-	@XFONTPATH@ enable >& /dev/null
+	if ( "x$DISPLAY" = x:0.0 ) then
+                ( @XFONTPATH@ enable & ) >& /dev/null
+	endif
 endif
 
diff -Naur xfontpath-0.4.orig/fink/xfontpath.sh.in xfontpath-0.4/fink/xfontpath.sh.in
--- xfontpath-0.4.orig/fink/xfontpath.sh.in	Fri Oct  5 13:13:34 2001
+++ xfontpath-0.4/fink/xfontpath.sh.in	Wed Apr  5 16:07:43 2006
@@ -1,6 +1,6 @@
 # xfontpath.sh
 
-if [ -x @XFONTPATH@ -a -n "$DISPLAY" ]; then
-	@XFONTPATH@ enable >/dev/null 2>&1
+if [ -x @XFONTPATH@ -a "x$DISPLAY" = x:0.0 ]; then
+	( @XFONTPATH@ enable & ) >/dev/null 2>&1
 fi
 
diff -Naur xfontpath-0.4.orig/xfontpath.in xfontpath-0.4/xfontpath.in
--- xfontpath-0.4.orig/xfontpath.in	Sat Oct  6 09:09:17 2001
+++ xfontpath-0.4/xfontpath.in	Wed Apr  5 15:36:19 2006
@@ -1,4 +1,5 @@
 #!/usr/bin/perl -w
+use POSIX qw(:errno_h);
 
 $CONFFILE = '@CONFFILE@';
 $FONTBASE = '@FONTBASE@';
@@ -136,7 +137,14 @@
 	my ($newconf) = $CONFFILE . '.new';
 
 	open (FP, ">$newconf") or &dief ("can't open `%s'\n", $newconf);
-	flock (FP, 2) or &dief ("can't lock `%s'\n", $newconf);
+	if (!flock (FP, 2)) {
+		if ($! == EOPNOTSUPP || $! == ENOLCK) {
+			print STDERR "WARNING: No locking is available on this filesystem.\n";
+			print STDERR "WARNING: Creating $newconf without locking...\n";
+		} else {
+			&dief ("can't lock `%s'\n", $newconf);
+		}
+	}
 
 	print FP "# This file was automaticaly generated by $0.\n";
 	print FP "# Don't edit!\n";
