Package: fpc
Version: 2.2.0
Revision: 3
Architecture: powerpc, i386
BuildDepends: fink (>= 0.24.12)
# Reason for fink (>= 0.24.12): Use of PatchFile: field
Recommends: fpc-doc
CustomMirror: <<
aus-AU: http://fpc.planetmirror.com/pub/fpc/
eur-AT: ftp://gd.tuwien.ac.at/languages/pascal/fpc/
eur-BE: ftp://ftp.freepascal.org/pub/fpc/
eur-HU: ftp://ftp.hu.freepascal.org/pub/fpc/
eur-IL: http://mirror.mirimar.net/freepascal/
eur-NL: ftp://freepascal.stack.nl/pub/fpc/
eur-NO: ftp://ftp.no.freepascal.org/pub/fpc/
eur-RU: ftp://ftp.chg.ru/pub/lang/pascal/fpc/
Primary: ftp://ftp.freepascal.org/pub/fpc/
<<
Source: mirror:custom:dist/%v/source/fpcbuild-%v.tar.gz
Source-MD5: 0869cfd07d012b702ff08c0a4196624b
Source2: mirror:custom:dist/%v/source/fpc-%v-2.universal-darwin.bootstrap.tar.bz2
Source2-MD5: aad6102fe1a773ea1d0b8e7c1b05f828
SourceDirectory: fpcbuild-%v/fpcsrc
PatchFile: %n.patch
PatchFile-MD5: 08facd944cdf940250e8d987bf6af682
Patchscript: <<
#!/bin/sh -ev
# The patch resolves a bug, when ginstall is used instead of install
# It concerns rtl/darwin/Makefile.fpc, line 14
# types sysctl are put there for the second time
#     variants types sysctl dateutils 
# should therefore be: 
#     variants dateutils
# The same applies to several places in the resulting Makefile
# The bug has been fixed in FIXES_2_2 as well as in trunk.
# So, any higher version than 2.2.0 should not need this patch script.
  sed -i.bak 's|variants types sysctl dateutils|variants dateutils|g' rtl/darwin/Makefile.fpc
  sed -i.bak 's|variants types sysctl dateutils|variants dateutils|g' rtl/darwin/Makefile
#  mv compiler/cfileutils.pas compiler/cfileutils.orig.pas
#  sed 's|@PREFIX@|%p|g' < %{PatchFile} | patch -p1
  patch -p1 < %{PatchFile}
<<
CompileScript: <<
#!/bin/sh -ev
# create the default fpc.cfg file
cat >%b/../../fpc.cfg <<EOFCFG
-Fu%p/lib/fpc/%v/units/%m-darwin/
-Fu%p/lib/fpc/%v/units/%m-darwin/*
-Fu%p/lib/fpc/%v/units/%m-darwin/rtl
-Fl/usr/lib
-Fl%p/lib
-O1
-vim
EOFCFG
# compile the stuff
  if [ "%m" = "powerpc" ]; then ppcarch="ppcppc" ; else ppcarch="ppc386" ; fi
  make all     PP=%b/../../ppcuniversal OPT="-gl -g"
  make fv ide  PP=%b/compiler/$ppcarch  OPT="-gl -g"
<<
InstallScript: <<
#!/bin/sh -ev
  if [ "%m" = "powerpc" ]; then ppcarch="ppcppc" ; else ppcarch="ppc386" ; fi
  make install                 INSTALL_PREFIX=%i PP=%b/compiler/$ppcarch FPCMAKE=%b/utils/fpcm/fpcmake
  ln -sf ../lib/fpc/%v/$ppcarch %i/bin/$ppcarch
  make fv_install ide_install  INSTALL_PREFIX=%i PP=%b/compiler/$ppcarch FPCMAKE=%b/utils/fpcm/fpcmake
  make -C ../install/man       INSTALL_PREFIX=%i/share
  make -C ../install/doc       INSTALL_PREFIX=%i/share PP=%b/compiler/$ppcarch 
  mkdir %i/etc
  install -c -m 644 %b/../../fpc.cfg %i/etc/
<<
ConfFiles: %p/etc/fpc.cfg
License: GPL/LGPL
Description: Free Pascal (aka FPK Pascal) compiler
DescDetail: <<
Free Pascal (aka FPK Pascal) is a 32 and 64 bit professional Pascal
compiler. Supported processors: Intel x86, Amd64/x86 64, PowerPC, Sparc.
Supported operating systems: Linux, FreeBSD, Mac OS X/Darwin, Mac OS
classic, DOS, Win32, OS/2, Netware (libc and classic) and MorphOS.

The language syntax has excellent compatibility with TP 7.0 as well as with
most versions of Delphi (classes, rtti, exceptions, ansistrings,
widestrings, interfaces). A Mac Pascal compatibility mode is also provided
to assist Apple users. Furthermore, Free Pascal supports function
overloading, operator overloading, global properties and other such
features.
<<
DescUsage: <<
 This Pascal compiler produces PowerPC and x86 executables, which run natively 
 on PowerPC and x86 Macs. PowerPC executables also runs in Rosetta emulation 
 on x86 Macs. 
 Use lipo to combine PowerPC and x86 binaries to universal binaries.
 get help with: fpc -?
 compile and link a Pascal file with: fpc FILENAME
 For setting up the Free Pascal IDE see: 
    http://www.freepascal.org/wiki/index.php/Textmode_IDE
 For using Free Pascal with Xcode see:
    http://www.freepascal.org/xcode.html
 For more documentation about Free Pascal in HTML and pdf, install fpc-doc
<<
DescPort: <<
 Nothing special, yet. ToDo: lazarus, universal binaries and extra package 
 with dependent C libraries (gtk ...) .
<<
Homepage: http://www.freepascal.org
Maintainer: Karl-Michael Schindler <karl-michael.schindler@physik.uni-halle.de>
