Package: sqlite3
Version: 3.2.7
Revision: 1
Description: Embedded SQL database (binary)
License: Public Domain 
Homepage: http://www.sqlite.org/
Maintainer: Dave Vasilevsky <vasi@users.sourceforge.net>

# Dependencies.
# This package does not conflict with sqlite.
Depends: %N-shlibs (= %v-%r), readline5-shlibs, tcltk-shlibs
BuildDepends: libncurses5, readline5, tcltk, tcltk-dev

# Unpack Phase.
Source: http://sqlite.org/sqlite-%v.tar.gz
Source-MD5: 34c92821b3b46380f192c0aaf2b2b217
SourceDirectory: sqlite-%v

# Patch Phase:
PatchScript: <<
#!/bin/sh -ex
  sed 's|@PREFIX@|%p|g' < %a/%n.patch | patch -p1
  head -n 10 src/sqlite.h.in > LICENSE
  perl -pi.bak -e "s/-flat_namespace -undefined suppress//g" configure
<<

# Compile Phase.
SetCFLAGS: -Os -I. -I./src -I%p/include -L%p/lib
ConfigureParams: --with-tcl=%p/lib --enable-threadsafe --disable-maintainer-mode
CompileScript: <<
#!/bin/sh -ex
  ./configure %c
  make
  make libtclsqlite3.la
  make doc
<<

# Install Phase.
InstallScript: <<
  make install prefix=%i
  ./libtool --mode=install install libtclsqlite3.la %i/lib
<<
DocFiles: LICENSE README

SplitOff: << 
  Package: %N-shlibs
  Description: Embedded SQL database (libraries)
  Shlibs: %p/lib/libsqlite3.0.dylib 9.0.0 %n (>= 3.0.8-1)
  Files: <<
    lib/libsqlite3.0.dylib
    lib/libsqlite3.0.8.6.dylib
  <<
  DocFiles: LICENSE README
<<

SplitOff2: << 
  Package: %N-tcltk
  Description: Embedded SQL database (Tcl/Tk bindings)
  Depends: %N-shlibs (= %v-%r)
  Shlibs: %p/lib/libtclsqlite3.0.dylib 9.0.0 %n (>= 3.2.7-1)
  Files: <<
    lib/libtclsqlite3.0.dylib
    lib/libtclsqlite3.0.8.6.dylib
  <<
  DocFiles: LICENSE README
<<

SplitOff3: << 
  Package: %N-dev
  Description: Embedded SQL database (header files and libraries)
  Depends: %N-shlibs (= %v-%r)
  BuildDependsOnly: True
  Files: <<
    include
    lib/libsqlite3.a
    lib/libsqlite3.dylib
    lib/libsqlite3.la
    lib/libtclsqlite3.a
    lib/libtclsqlite3.dylib
    lib/libtclsqlite3.la
    lib/pkgconfig
  <<
  DocFiles: LICENSE README
<<

SplitOff4: << 
  Package: %N-doc
  Description: Embedded SQL database (HTML documentation)
  DocFiles: doc/* LICENSE README
<<

DescDetail: <<
SQLite is a C library that implements an embeddable SQL database
engine.  Programs that link with the SQLite library can have SQL
database access without running a separate RDBMS process. The
distribution comes with a standalone command-line access program
(sqlite) that can be used to administer an SQLite database and which
serves as an example of how to use the SQLite library.
<<

DescPort: <<
Patch configure to find the Fink readline headers.  This package
requires readline5 present to build due to issues with the default
sqlite configure script when run on OS X.
<<
