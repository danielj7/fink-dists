Package: xfree86-base-threaded
Version: 4.2.0.1
Revision: 2
Depends: dlcompat
Provides: x11, rman
Conflicts: x11, xfree86-base
Replaces: x11
GCC: 3.1
Suggests: xfree86-rootless-threaded (= %v-%r)
Source: mirror:sourceforge:fink/X4201src.tar.bz2
SourceDirectory: xc
Patch: %f.patch
PatchScript: <<
 echo '#define ExtraIncDir	%p/include' > config/cf/host.def
 echo '#define EtcX11Directory	ProjectRoot/etc' >> config/cf/host.def
 echo '#define HasPosixThreads       YES' >>config/cf/host.def
 echo '#define HasThreadSafeAPI      NO' >>config/cf/host.def
<<
CompileScript: <<
 make MAKE=/usr/bin/gnumake World WORLDOPTS=-S
<<
SplitOff: <<
 Package: xfree86-rootless-threaded
 Depends: xfree86-base-threaded (= %v-%r)
 Conflicts: xfree86-rootless
 Provides: libgl
 Files: <<
 /Applications
 /usr/X11R6/bin/X
 /usr/X11R6/bin/XDarwin
 /usr/X11R6/bin/XDarwinQuartz
 /usr/X11R6/bin/XDarwinStartup
 /usr/X11R6/bin/dumpkeymap
 /usr/X11R6/bin/glxgears
 /usr/X11R6/bin/glxinfo
 /usr/X11R6/include/GL
 /usr/X11R6/lib/libGL*
 /usr/X11R6/lib/X11/doc/html/XDarwin.1.html
 /usr/X11R6/lib/X11/doc/html/XFree86.1.html
 /usr/X11R6/lib/X11/doc/html/dumpkeymap.1.html
 /usr/X11R6/lib/X11/doc/html/GL*.html
 /usr/X11R6/lib/X11/doc/html/gl*.html
 /usr/X11R6/man/man1/XDarwin.1
 /usr/X11R6/man/man1/XFree86.1
 /usr/X11R6/man/man1/dumpkeymap.1
 /usr/X11R6/man/man1/glx*.1
 /usr/X11R6/man/man3/GL*.3
 /usr/X11R6/man/man3/gl*.3
 <<
<<
InstallScript: <<
 make MAKE=/usr/bin/gnumake install install.man WORLDOPTS=-S DESTDIR=%d
<<
#
PreInstScript: <<
case "$1" in
  install)
    if [ -e /usr/X11R6/bin/xterm -o -e /usr/X11R6/bin/xrdb -o \
	 -e /etc/X11 -o -L /etc/X11 ]; then
      echo
      echo "You have an existing X11 installation in /usr/X11R6 and /etc/X11."
      echo "This package refuses to overwrite these. Remove them, then tell Fink to"
      echo "install xfree86-base again. (The package won't be recompiled.) If you want"
      echo "to keep your X11 installation, install system-xfree86 resp. system-xtools"
      echo "instead to make this known to Fink's package system."
      echo
      echo "Press Return to continue."
      read
      exit 1
    fi
    ;;
  upgrade)
    # deal with a file that changed in case only
    rm -f /usr/X11R6/man/man3/XtAddTime?ut.3
    rm -f /usr/X11R6/lib/X11/doc/html/XtAddTime?ut.3.html

    # deal with font listings (we no longer use xfont-base, font
    #  packages install their fonts in the Fink directories)
    for dir in 100dpi 75dpi CID cyrillic local misc Speedo Type1 ; do
      rm -f /usr/X11R6/lib/X11/fonts/$dir/fonts.dir /usr/X11R6/lib/X11/fonts/$dir/fonts.scale /usr/X11R6/lib/X11/fonts/$dir/fonts.scale.bak
    done
    ;;
esac
<<
PostInstScript: <<
if [ -L /etc/X11 ]; then
  rm -f /etc/X11
else
  if [ -e /etc/X11 ]; then
    echo "ERROR: /etc/X11 exists, but is not a symlink to /usr/X11R6/etc."
    exit 1
  fi
fi
ln -s /usr/X11R6/etc /etc/X11
<<
PreRmScript: <<
case "$1" in
  remove|purge)
    if [ -L /etc/X11 ]; then
      rm -f /etc/X11
    fi
    ;;
esac
<<
#
Description: XFree86 libraries, utilities, clients and data.
DescDetail: <<
XFree86 is a free X11 implementation that supports Darwin and Mac OS X.
This will let you run X11 applications and desktop environments.
This version is patched to use threads (needed for some apps).

If you already have xfree86-base installed, you must remove it
manually first using "sudo dpkg -r --force-depends".
<<
DescPackaging: <<
This package builds the libraries, common clients (e.g. xterm), fonts
and other data, but not the X server. The server is in a separate
package (xfree86-rootless). You can install a server manually if you prefer.

WARNING: This package will not honor the prefix you installed Fink
in. It will always install into /usr/X11R6. This is by design. The
preinst script checks to make sure it doesn't overwrite existing
files.

This version is patched to use threads.

Previous versions by Christoph Pfisterer.
<<
DescPort: <<
OpenGL stuff is disabled. "libgl" is provided by the xfree86-rootless package
in order to preserve an upgrade path from the xfree86 v4.1 packages.
<<
License: BSD
Homepage: http://www.xfree86.org/
Maintainer: Jeffrey Whitaker <jsw@cdc.noaa.gov>
