Package: libapreq2
Version: 2.07
Revision: 1000
DocFiles: Changes FAQ.pod INSTALL LICENSE MANIFEST META.yml NOTICE PREREQUISITES README STATUS
Description: Library for parsing HTTP data
License: OSI-Approved
Maintainer: Dave Vasilevsky <vasi@users.sourceforge.net>
Homepage: http://httpd.apache.org/apreq/

# Does not use any C++ symbols
BuildDepends: apr-ssl (>= 0.9.7-1011) | apr (>= 0.9.7-1011), openldap23-dev, libiconv-dev, cyrus-sasl2-dev (>= 2.1.21-1), gdbm3, expat (>= 1.95.3-1), db43-ssl (>= 4.3.29-1001) | db43 (>= 4.3.29-1001), apache2-ssl-dev (>= 2.0.55-1010) | apache2-dev (>= 2.0.55-1010)
Depends: %N-shlibs (= %v-%r)
BuildDependsOnly: true

Source: mirror:apache:httpd/libapreq/libapreq2-%v.tar.gz
Source-MD5: 6f2e5e4a14e8b190dead0fe91fc13080

PatchScript: <<
	#!/bin/sh -ev
	
	# Tests break with optimization
	perl -i -pe 's/^(CFLAGS\s*=.*)/$1 -O0/' library/t/Makefile.in
	
	# Don't test the module. It requires mod-perl2-pm5*, and we don't want to
	# force any particular variant of it.
	perl -i -pe 's/^(test:.*)module_test/$1/' Makefile.in
<<
DescPackaging: <<
User may see an error about missing Apache::Test, it's harmless.
<<
DescDetail: <<
libapreq is a safe, standards-compliant, high-performance library 
used for parsing HTTP cookies, query-strings and POST data.  The 
original version (libapreq-1.X) was designed by Lincoln Stein and Doug 
MacEachern.
<<
DescUsage: <<
To enable mod_apreq, run as root:
  
  apxs -a -e -n apreq %p/lib/apache2/modules/mod_apreq2.so

Use -A instead of -a to disable it.

The perl APIs Apache::Request and Apache::Cookie are available in the packages
libapreq2-pm581, libapreq2-pm584, libapreq2-pm586.
<<

ConfigureParams: --disable-perl-glue
CompileScript: <<
	./configure %c
	make
	make test
<<
InstallScript: make install DESTDIR=%d

SplitOff: <<
	Package: %N-shlibs
	Files: lib/libapreq2.*.dylib
	Depends: apr-ssl-shlibs (>= 0.9.7-1011) | apr-shlibs (>= 0.9.7-1011)
	DocFiles: LICENSE
	Shlibs: %p/lib/libapreq2.2.dylib 8.0.0 %n (>= 2.07-1000)
<<
SplitOff2: <<
	Package: libapache2-mod-apreq2
	Files: lib/apache2/modules/mod_apreq2.so
	Depends: apache2-ssl (>= 2.0.55-1010) | apache2 (>= 2.0.55-1010), %N-shlibs (= %v-%r)
	DocFiles: LICENSE
	
	PostInstScript: <<
		echo "To enable mod_apreq, run the following command as root:"
		echo "  apxs -a -e -n apreq %p/lib/apache2/modules/mod_apreq2.so"
	<<
	PreRmScript: <<
		if [ $1 = "remove" ]; then
			echo "Automatically disabling mod_apreq!"
			apxs -A -e -n apreq %p/lib/apache2/modules/mod_apreq2.so
		fi
	<<
<<
