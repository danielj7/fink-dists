Package: sbcl
Version: 0.8.11
Revision: 1
Description: Steel Bank Common Lisp
License: BSD
Maintainer: Lars Rosengreen <lars@margay.org>

# NOTE: The version of the bootstrap binary does not automatically
# change when the version field is updated!  CompileScript and Source2
# need to be updated by hand when moving to a new version of the
# bootstap binary

# Dependencies
Depends: gnupg
BuildDepends: texinfo

# Unpack Phase
Source: mirror:sourceforge:%n/%n-%v-source.tar.bz2
Source2: mirror:sourceforge:%n/%n-0.8.9-ppc-darwin-binary.tar.bz2

SourceDirectory: %n-%v

Source-MD5: 2fcf2ff8703249af465a05158911b65e
Source2-MD5: 11035de9d5c82a0fde4e610198c6d2e1

# Patch Phase

# Compile Phase

CompileScript: <<
  unset LD_PREBIND ; sh make.sh "../%n-0.8.9-ppc-darwin/src/runtime/sbcl --core ../%n-0.8.9-ppc-darwin/output/sbcl.core --disable-debugger --sysinit /dev/null --userinit /dev/null"
  cd doc/manual ; make
<<

# Install Phase

# sbcl.info is moved out of the way before install.sh is called so
# that the script doesn't invoke install-info and attempt to install
# the info file on its own.  Wouldn't want to do an end-run around
# fink!
InstallScript: <<
  find . -type d -name CVS -depth -exec rm -rf {} \;
  mkdir doc/manual/fink-tmp
  cp doc/manual/sbcl.info* doc/manual/fink-tmp
  rm doc/manual/sbcl.info*
  unset SBCL_HOME ; INSTALL_ROOT=%i sh install.sh
  cp doc/manual/fink-tmp/sbcl.info* doc/manual
<<

InfoDocs: doc/manual/sbcl.info

DocFiles: BUGS COPYING CREDITS NEWS README

RuntimeVars: <<
  SBCL_HOME: %p/lib/%n/
<<

PostInstScript: <<
  echo "**"
  echo "** IMPORTANT: the environmental variable SBCL_HOME must be set to" 
  echo "** %p/lib/%n/ for SBCL to function correctly.  Fink will take care of" 
  echo "** this for you in new shell sessions, but if you would like to run"
  echo "** SBCL right now from this shell session, you need to type the" 
  echo "** following at the shell prompt first: export SBCL_HOME=%p/lib/%n/"
  echo "**"
<<

# Additional Data

Homepage: http://www.sbcl.org/

DescDetail: <<
Steel Bank Common Lisp (SBCL) is an open source development system for
ANSI Common Lisp.  It provides an interactive environment including an
integrated high quality native compiler, interpreter, and a debugger.
SBCL is derived from Carnegie-Mellon University Common Lisp (CMUCL).
<< 

DescUsage: <<
The environmental variable SBCL_HOME must be set to
'finkroot/lib/sbcl/' where 'finkroot' is the root directory of you
fink installation (in most cases '/sw') for SBCL to function
correctly.  Fink should take care of this for you in terminal
sessions, but you may also want to set this variable in your
.MacOSX/environment.plist file, if you have one, so SBCL can be run
from carbon Emacs and other Mac applications that are not launched via
the terminal.  For more information about setting up a
~/.MacOSX/environment.plist file, see the following Apple tech note:
http://developer.apple.com/qa/qa2001/qa1067.html
<<

Descport: << 
Uses a binary version of SBCL for bootstrapping.  gnupg is needed to
validate common lisp packages downloaded with asdf-install.  Texinfo is
used to build the manual.
<<
