Package: tetex-base
Version: 1.0
Revision: 13
GCC: 3.1
Depends: libpng-shlibs, libwww-bin, libtiff-bin, ghostscript | ghostscript6 | ghostscript-nox | ghostscript6-nox, tetex-texmf, fink (>= 0.9.3)
BuildDepends: libpng (>= 1.0.12-3), libtiff (>= 3.5.7-5), libwww
Conflicts: system-tetex
Provides: dialog
Source: mirror:ctan:systems/unix/teTeX/current/distrib/sources/teTeX-src-%v.tar.gz
Source-MD5: 2c6da2a45096c2fdc41b8de6a8af1a52
SourceDirectory: teTeX-%v
Source2: mirror:ctan:systems/unix/teTeX/current/distrib/sources/LICENSE
Source2-MD5: 712ee2a5dced37456f5f984861b0c609
NoSource2Directory: true
Source2Rename: tetex-LICENSE
Source3: mirror:ctan:systems/unix/teTeX/current/distrib/sources/ChangeLog
Source3-MD5: 237384d509388c51d8b9c94aecb4ad5d
NoSource3Directory: true
Source3Rename: tetex-ChangeLog
Patch: %f.patch
PatchScript: <<
mv ../tetex-LICENSE ../LICENSE
mv ../tetex-ChangeLog ../ChangeLog
<<
UpdateConfigGuessInDirs: . config texinfo texk libs/ncurses
SetCPPFLAGS: -no-cpp-precomp
SetLDFLAGS: -flat_namespace
ConfigureParams: --without-pdftex --without-pdfetex --datadir='${prefix}/share' --infodir='${prefix}/share/info' --mandir='${prefix}/share/man' --without-texinfo --disable-multiplatform --with-system-zlib --with-system-ncurses --with-system-pnglib --with-system-wwwlib --without-x --with-system-tifflib
InstallScript: <<
 make install prefix=%i texmf=%i/share/texmf

 ranlib %i/lib/libkpathsea.a

echo "move the dialog man page to the correct location"
 mkdir -p %i/share/man/man1
 mv %i/man/man1/dialog.1 %i/share/man/man1
 rm -Rf %i/man

echo "modify mktex.opt to force the use of varfonts"
 mv %i/share/texmf/web2c/mktex.opt mktex.opt.orig
 sed 's|MT_FEATURES=appendonlydir|MT_FEATURES=appendonlydir:varfonts|g' < mktex.opt.orig > %i/share/texmf/web2c/mktex.opt

echo "rename dialog to tcdialog"
 mkdir -p %i/bin
 ln -s %p/bin/dialog %i/bin/tcdialog

echo "the ls-R file is supplied in tetex-texmf"
 rm -f %i/share/texmf/ls-R

echo "readlink is a different package"
 rm -f %i/bin/readlink
 rm -f %i/share/man/man1/readlink.1

echo "modify fmtutil.cnf to be prepared for a later installation of pdftex"
 mv %i/share/texmf/web2c/fmtutil.cnf fmtutil.cnf.orig
 sed 's|#P#pdf|pdf|g' < fmtutil.cnf.orig > %i/share/texmf/web2c/fmtutil.cnf

echo "create a local texmf tree"
 mkdir -p %i/etc/texmf.local/web2c
 chmod 775 %i/etc/texmf.local
 chmod 775 %i/etc/texmf.local/web2c
 %i/bin/mktexlsr %i/etc/texmf.local
 mkdir -p %i/etc/ls-R
 mv %i/etc/texmf.local/ls-R %i/etc/ls-R/texmf.local
 ln -s %p/etc/ls-R/texmf.local %i/etc/texmf.local/ls-R
 mkdir -p %i/share
 ln -s %p/etc/texmf.local %i/share/texmf.local

echo "create the texmf.macosx tree"
 mkdir -p %i/share/texmf.macosx/web2c
 chmod 755 %i/share/texmf.macosx
 chmod 755 %i/share/texmf.macosx/web2c
 %i/bin/mktexlsr %i/share/texmf.macosx
 mkdir -p %i/etc/ls-R
 mv %i/share/texmf.macosx/ls-R %i/etc/ls-R/texmf.macosx
 ln -s %p/etc/ls-R/texmf.macosx %i/share/texmf.macosx/ls-R
 mkdir -p %i/share
 ln -s %p/share/texmf.macosx %i/share/texmf.os

echo "remove 'context' binaries"
rm -f %i/bin/texexec
rm -f %i/bin/texshow
rm -f %i/bin/texutil

mv %i/bin/texi2html %i/bin/texi2html.tetex-base
mv %i/share/man/man1/texi2html.1 %i/share/man/man1/texi2html.1.tetex-base

<<
InfoDocs: kpathsea.info web2c.info dvips.info latex.info
DocFiles: ../LICENSE ../ChangeLog INSTALL PROBLEMS README QuickInstall
License: OSI-Approved
PostInstScript: <<
update-alternatives --install %p/bin/texi2html texi2html %p/bin/texi2html.tetex-base 40
update-alternatives --install %p/share/man/man1/texi2html.1 texi2html.1 %p/share/man/man1/texi2html.1.tetex-base 40
mktexlsr
texconfig init
fmtutil --byfmt tex
fmtutil --byfmt latex
fmtutil --byfmt etex
fmtutil --byfmt elatex
fmtutil --byfmt omega
fmtutil --byfmt lambda
mktexlsr
<<
PreRmScript: <<
if [ $1 != "upgrade" ]; then
  update-alternatives --remove texi2html %p/bin/texi2html.tetex-base
  update-alternatives --remove texi2html.1 %p/share/man/man1/texi2html.1.tetex-base
fi
rm -f %p/etc/texmf.local/web2c/*.efmt
rm -f %p/etc/texmf.local/web2c/*.fmt
rm -f %p/etc/texmf.local/web2c/*.log
rm -f %p/etc/texmf.local/web2c/*.cnf
rm -f %p/etc/texmf.local/web2c/*.base
rm -f %p/etc/texmf.local/web2c/*.mem
rm -f %p/etc/texmf.local/tex/generic/config/language.dat
rm -f %p/etc/texmf.local/pdftex/config/pdftex.cfg
rm -f %p/etc/texmf.local/etex/plain/config/language.def
rm -f %p/etc/texmf.local/dvips/config/config.ps
rm -f %p/etc/texmf.local/xdvi/Xdvi
rm -f %p/share/texmf/web2c/*.efmt
rm -f %p/share/texmf/web2c/*.log
rm -f %p/share/texmf/web2c/*.fmt
rm -f %p/share/texmf/web2c/*.base
rm -f %p/share/texmf/web2c/*.mem
rm -Rf %p/share/texmf/tex/context
<<
Description: TeTeX is an implementation of TeX for UNIX
DescDetail: <<
TeX takes a text file and a set of formatting commands as input and 
creates a typesetter independent .dvi (DeVice Independent) file as output.
TeTeX includes higher level formatting packages such as LaTeX, since
TeX by itself is not very user-friendly.
<<
DescPort: <<
Lots of linker warnings are removed by 
   SetLDFLAGS: -flat_namespace
The Makefile is patched to prevent texconfig from running during the install 
 phase. 
Patches to cpascal.h and eofeoln.c from Gerben Wierda which allow TeX to 
 recognize Macintosh line breaks in input files.
A new texconfig script, by Gerben Wierda, is brought in via a patch.
The dialog man page is moved to the correct location after installation.
dialog is linked to tcdialog to be compatible with the new texconfig script
(this will go away after tetex-base is updated to a more recent version)
Now using update-alternatives for texi2html to allow users to install a
more up-to-date version if they choose.
<<
DescPackaging: <<
 Updates are made to this package in the pdftex, context, and hyperref
  packages (part of the bundle-tetex package).
 Other TeX related packages, not contained in bundle-tetex, should use 
  %p/etc/texmf.local/ as their texmf tree for storing files, rather than
  %p/share/texmf/.  In this way, the original texmf tree will be preserved.
 Does not require X11.
 texinfo and xdvi are separate packages.
 readlink and its manpage are removed since they conflict with debianutils,
  an essential package.
 Many thanks to the original teTeX maintainer Jeff Whitaker.
<<
Maintainer: Dave Morrison <dmrrsn@users.sourceforge.net>
Homepage: http://www.tug.org/teTeX
