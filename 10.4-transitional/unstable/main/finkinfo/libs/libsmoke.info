Package: libsmoke
Version: 3.009
Revision: 23
Depends: %N-shlibs (>= %v-%r)
# GOD I hate this, it needs all these stupid kde tools, even though they're not used  :P
BuildDepends: arts-dev (>= 1.4.0-21), autoconf2.5 (>= 2.58-1), automake1.7, glut (>= 3.7-3), kdelibs3-unified-dev, libpng3 (>= 1.2.5-1), libtool14 (>= 1.5.10-1), qt3 (>= 3.3.5-21), x11-dev, gcc3.3
BuildDependsOnly: true
Maintainer: Benjamin Reed <libsmoke@fink.racoonfink.com>

CustomMirror: <<
	nam-US: http://ranger.befunk.com/fink
	nam-US: http://astrange.ithinksw.net/ranger-fink
	nam-CA: http://www.southofheaven.net/befunk
<<
Source: mirror:custom:PerlQt-3-20051212.tar.bz2
Source-MD5: 823632f2396c4d132945942c16ae7437
SourceDirectory: PerlQt-3
Source2: mirror:custom:kde-admindir-full-3.5.0.tar.bz2
Source2-MD5: 10ae9df3230b97207ea200a2fd59612f
Source2ExtractDir: PerlQt-3
PatchScript: <<
	patch -p1 < %a/%n.patch
	perl -pi.bak -e 's,-O2,-Os,g; s,doc/HTML,doc/kde,g; s,/usr/share/doc/packages/qt3/html,%p/share/doc/qt3/html,g;' admin/*
	perl -pi.bak -e 's,if \"\$kde,if test "\$kde,' configure.in
<<
GCC: 3.3

DocFiles: AUTHORS COPYING ChangeLog* INSTALL README TODO smoke/README:README.smoke

ConfigureParams: --prefix=%p --with-qt-dir=%p --with-qt-includes=%p/include/qt --with-extra-libs=%p/lib --with-extra-includes=%p/include --enable-mt --with-pic --disable-rpath --enable-shared=yes --enable-static=no --mandir=%i/share/man --with-xinerama --disable-final --disable-dependency-tracking --with-threshold=12 --enable-smoke --with-smoke=qt
CompileScript: <<
#!/bin/sh -e

	export HOME=/tmp PREFIX="%p" lt_cv_sys_max_cmd_len=65536 QTDOCDIR="%p/share/doc/qt3/html"
	. ./environment-helper.sh

	PRODUCT_VERSION=`uname -r`

	case $PRODUCT_VERSION in 
		6*|7*)
			export CPPFLAGS="$CPPFLAGS -DHAVE_SYS_EXEC_H=1"
			;; 
	esac

	export CPPFLAGS="-I/usr/include/gssapi $CPPFLAGS"
	export CC=gcc-3.3 CXX=g++-3.3

	./build-helper.sh cvs       %N %v %r make -f admin/Makefile.common cvs
	./build-helper.sh configure %N %v %r ./configure %c
	pushd smoke
	../build-helper.sh make     %N %v %r make all all_libraries="$ALL_LIBRARIES"
	popd
<<
InstallScript: <<
#!/bin/sh -e

	export PREFIX="%p"
	. ./environment-helper.sh

	pushd smoke
	../build-helper.sh install %N %v %r make -j1 install DESTDIR=%d
<<
Description: Library for Qt language bindings
DescDetail: <<
libsmoke is actually being developed for PerlQt, but is used
by other projects as well, so it has been split out into a
separate package.
<<
SplitOff: <<
	Package: %N-shlibs
	Description: Shared libraries for the smoke bindings
	Depends: glut-shlibs (>= 3.7-3), qt3-shlibs (>= 3.3.5-21)
	Files: lib/libsmokeqt.*.dylib
	Shlibs: %p/lib/libsmokeqt.1.dylib 4.0.0 %N-shlibs (>= 3.009-1)
<<
