Package: rrdtool
Version: 1.0.48
Revision: 2
Conflicts: %N-bin
Replaces: %N-bin
Depends: %N-shlibs (>= %v-%r)
BuildDepends: tcltk, tcltk-dev, dlcompat-dev, perl580-core | perl581-core | perl584-core | perl585-core
BuildDependsOnly: true
Patch: %n.patch
Source: http://people.ee.ethz.ch/~oetiker/webtools/%n/pub/%n-%v.tar.gz
Source-MD5: b38a3b04d2540f2f2bf4ca072b8eb229
NoSetLDFLAGS: true
SetCPPFLAGS: -fno-common
CompileScript: <<
#!/bin/sh -ex

 for file in %p/bin/perl5.8* /usr/bin/perl5.8*; do
  [ -z "$PERLBIN" ] && PERLBIN="$file"
 done
 [ -z "$PERLBIN" ] && exit 1

 chmod 755 %p/lib/tclConfig.sh
 perl -e "s,pod2,$PERLBIN /usr/bin/pod2,g" doc/Makefile.in
 ./configure --prefix=%p --enable-shared --with-tcllib=%p/lib --mandir=%p/share/man
 make || make
<<
InstallScript: <<
#!/bin/sh -ex

 make install DESTDIR="%d" imandir="%p/share/man/man1" examplesdir="%p/share/doc/%n/examples" idocdir="%p/share/doc/%n/doc" ihtmldir="%p/share/doc/%n/html" contribdir="%p/share/doc/%n/contrib"
 make site-tcl-install DESTDIR="%d" TCL_PACKAGE_PATH='%i/lib'
 ranlib "%i/lib/librrd.a"
 touch "%i/share/doc/rrdtool/.turd"
 rm -rf %i/lib/perl %i/share/man/man1/RRDp.1 %i/share/man/man1/RRDs.1
<<
SplitOff: <<
 Package: %N-shlibs
 Suggests: %N
 Description: Fixed-size "round-robin" database storage shared libraries
 Files: lib/librrd.%v.dylib lib/librrd.1.dylib
 Shlibs: %p/lib/librrd.1.dylib 2.0.0 %n (>= 1.0.39-1)
<<
SplitOff2: <<
 Package: %N-dev
 Description: Utilities for round-robin databases
 BuildDependsOnly: true
 Depends: %N (>= %v-%r)
 Replaces: %N (<< 1.0.48-1)
 Files: include lib/*.a lib/*.la lib/librrd.dylib
<<
SplitOff3: <<
 Package: %N-tcl
 Description: TCL scripting module for round-robin databases
 Depends: %N-shlibs (>= %v-%r), tcltk-shlibs
 Enhances: %N-shlibs
 Files: lib/tclrrd.%v lib/tclrrd.%v.dylib
<<
DocFiles: CHANGES CONTRIBUTORS COPYING COPYRIGHT NT-BUILD-TIPS.txt README TODO
Description: Fixed-size "round-robin" database storage
DescDetail: <<
RRD is a system to store and display time-series data (i.e. network bandwidth,
machine-room temperature, server load average).  It stores the data in a very
compact way that will not expand over time, and it presents useful graphs by
processing the data to enforce a certain data density.  It can be used either
via simple wrapper scripts (from shell or Perl) or via frontends that poll
network devices and put a friendly user interface on it.
<<
DescPort: <<
Had to do a lot of fiddling with libtool options to get it to build as a shared
library.  Also had to patch gifsize.c to fix a duplicate symbol conflict.
Without the libtool/autoconf updates, it does not understand doing shared libs
on OSX.
<<
License: GPL
Maintainer: Benjamin Reed <ranger@befunk.com>
Homepage: http://people.ee.ethz.ch/~oetiker/webtools/rrdtool/
