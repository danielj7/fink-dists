Package: rhino
Version: 1.6r4
Revision: 1
Type: java(1.4)

Source: ftp://ftp.mozilla.org/pub/mozilla.org/js/rhino1_6R4.zip
Source-MD5: f1f4646601e88d745c3e2d9b188e3231

Source2: http://java.sun.com/products/jfc/tsc/articles/treetable2/downloads/src.zip
Source2-MD5: ab016c8f81812bb930fc0f7a69e053c5
Source2ExtractDir: %n1_6R4/toolsrc/org/mozilla/javascript/tools/debugger/downloaded

BuildDepends: ant-base, fink (>= 0.24.12), system-java-dev (>= 1.4)
Depends: system-java (>= 1.4), xmlbeans

PatchFile: %n.patch
PatchFile-MD5: 2004a3cea4a32bf193622258425d2cfc
PatchScript: sed -e 's|@PREFIX@|%p|g' < %{PatchFile} | patch -p1

CompileScript: <<

  # Remove the files from Source2 that Rhino doesn't want
  rm -f toolsrc/org/mozilla/javascript/tools/debugger/downloaded/AbstractTreeTableModel.java
  rm -f toolsrc/org/mozilla/javascript/tools/debugger/downloaded/FileSystemModel2.java
  rm -f toolsrc/org/mozilla/javascript/tools/debugger/downloaded/MergeSort.java
  rm -f toolsrc/org/mozilla/javascript/tools/debugger/downloaded/TreeTableExample2.java

  ant dist
<<

InstallScript: <<
#!/bin/sh -ex

  # Documentation
  mkdir -p %i/share/doc/%n
  cp -R docs/* %i/share/doc/%n

  # Examples
  mkdir -p %i/share/doc/%n/examples/
  cp -R examples/* %i/share/doc/%n/examples/

  # Fix permissions
  find %i/share/doc/%n -type d -print0 | xargs -0 chmod 755
  find %i/share/doc/%n -type f -print0 | xargs -0 chmod 644
<<

JarFiles: js.jar

Homepage: http://www.mozilla.org/rhino/
Maintainer: Trevor Harmon <trevor@vocaro.com>
Description: JavaScript for Java

DescDetail: <<
Rhino is an open-source implementation of JavaScript written entirely in Java.
It is typically embedded into Java applications to provide scripting to end
users.
<<

DescPackaging: <<
The Rhino build file tries to download external JAR files; this is against
Fink policy. Because these JARs are already available through dependencies,
the patch file adjusts the build properties so that the dependent JARs are
used, thus preventing the attempt to download them.

A sub-build file also attempts to download a ZIP file from java.sun.com. The
patch prevents this, as well. However, because the ZIP file is not available
as a dependency, it is downloaded separately via the Source2 field. The last
half of the patch adjusts the sub-build file to ensure that the the necessary
search-and-replace operations are performed on the extracted Source2 files.
<<

License: OSI-Approved
