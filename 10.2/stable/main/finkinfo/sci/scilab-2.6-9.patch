--- scilab-2.6/imp/Slatexpr2.c	Fri Apr 16 09:03:50 1999
+++ scilab-2.6/imp/Slatexpr2.c	Tue Jul 24 09:54:53 2001
@@ -4,7 +4,9 @@
 #include <string.h>
 #include <ctype.h>
 #ifndef __STDC__
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif 
 #include <stdio.h>
 
--- scilab-2.6/imp/Slatexprs.c	Fri Apr 16 09:03:50 1999
+++ scilab-2.6/imp/Slatexprs.c	Tue Jul 24 09:54:54 2001
@@ -3,7 +3,9 @@
 #include <string.h>
 #include <ctype.h>
 #ifndef __STDC__
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif 
 #include <stdio.h>
 
--- scilab-2.6/imp/Slpr.c	Mon Feb  5 05:34:01 2001
+++ scilab-2.6/imp/Slpr.c	Tue Jul 24 09:54:54 2001
@@ -4,7 +4,9 @@
 #include <string.h>
 #include <ctype.h>
 #ifndef __STDC__
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif 
 #include <stdio.h>
 
--- scilab-2.6/intersci/intersci-n.h	Mon Feb  5 05:34:58 2001
+++ scilab-2.6/intersci/intersci-n.h	Tue Jul 24 09:54:54 2001
@@ -25,7 +25,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else 
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 /* FORTRAN variable types */ 
--- scilab-2.6/intersci/intersci.h	Mon Feb  5 05:34:58 2001
+++ scilab-2.6/intersci/intersci.h	Tue Jul 24 09:54:54 2001
@@ -25,7 +25,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else 
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 /* FORTRAN variable types */ 
--- scilab-2.6/routines/calelm/sci_tools.c	Mon Jul 10 02:12:40 2000
+++ scilab-2.6/routines/calelm/sci_tools.c	Tue Jul 24 10:01:50 2001
@@ -39,8 +39,13 @@
 
 ***/
 #include "../machine.h"
+#ifdef __APPLE__
+#include <sys/types.h>
+#endif
 #ifndef __ABSC__
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #else
 #include <stdlib.h>
 #endif
--- scilab-2.6/routines/comm/messages.c	Thu Jan 28 03:00:31 1999
+++ scilab-2.6/routines/comm/messages.c	Tue Jul 24 09:56:40 2001
@@ -3,7 +3,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 #include <stdio.h>
 #include <string.h>
--- scilab-2.6/routines/default/Funtab.c	Mon Feb  5 05:19:39 2001
+++ scilab-2.6/routines/default/Funtab.c	Tue Jul 24 09:56:20 2001
@@ -9,7 +9,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #include "../machine.h"
--- scilab-2.6/routines/default/scimem.c	Fri May  7 03:00:38 1999
+++ scilab-2.6/routines/default/scimem.c	Tue Jul 24 09:56:20 2001
@@ -4,7 +4,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #include "../machine.h"
--- scilab-2.6/routines/graphics/Math.h	Mon Feb  5 05:19:43 2001
+++ scilab-2.6/routines/graphics/Math.h	Tue Jul 24 09:56:21 2001
@@ -11,7 +11,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #ifdef WIN32 
--- scilab-2.6/routines/graphics/periFig.c	Mon Feb  5 05:19:37 2001
+++ scilab-2.6/routines/graphics/periFig.c	Tue Jul 24 09:56:21 2001
@@ -16,7 +16,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 
--- scilab-2.6/routines/graphics/periGif.c	Mon Feb  5 05:19:36 2001
+++ scilab-2.6/routines/graphics/periGif.c	Tue Jul 24 09:56:22 2001
@@ -38,7 +38,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 extern  char  *getenv();
 #endif
 
--- scilab-2.6/routines/graphics/periPos.c	Mon Feb  5 05:19:36 2001
+++ scilab-2.6/routines/graphics/periPos.c	Tue Jul 24 09:56:23 2001
@@ -16,7 +16,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 
--- scilab-2.6/routines/graphics/RecLoad.c	Mon Feb  5 08:16:26 2001
+++ scilab-2.6/routines/graphics/RecLoad.c	Tue Jul 24 09:56:21 2001
@@ -12,7 +12,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #ifdef macintosh
--- scilab-2.6/routines/libcomm/gest_memoire.c	Tue Apr 14 04:22:51 1998
+++ scilab-2.6/routines/libcomm/gest_memoire.c	Tue Jul 24 09:56:23 2001
@@ -8,7 +8,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #include "gestion_memoire.h"
--- scilab-2.6/routines/metanet/connex.c	Mon Jun 22 05:13:00 1998
+++ scilab-2.6/routines/metanet/connex.c	Tue Jul 24 09:56:23 2001
@@ -2,7 +2,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 extern void cerro();
--- scilab-2.6/routines/metanet/dmtree.c	Mon Jun 22 05:13:00 1998
+++ scilab-2.6/routines/metanet/dmtree.c	Tue Jul 24 09:56:23 2001
@@ -3,7 +3,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 extern void cerro();
--- scilab-2.6/routines/metanet/files.c	Tue Nov  9 06:25:56 1999
+++ scilab-2.6/routines/metanet/files.c	Tue Jul 24 09:56:23 2001
@@ -9,7 +9,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 
--- scilab-2.6/routines/metanet/loadg.c	Tue Nov  9 06:25:56 1999
+++ scilab-2.6/routines/metanet/loadg.c	Tue Jul 24 09:56:24 2001
@@ -9,7 +9,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #if (defined __MSC__) || (defined __ABSC__)
--- scilab-2.6/routines/metanet/metanet.c	Tue Nov  9 06:57:24 1999
+++ scilab-2.6/routines/metanet/metanet.c	Tue Jul 24 09:56:24 2001
@@ -13,7 +13,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #include "../libcomm/libCalCom.h"
--- scilab-2.6/routines/metanet/myhsearch.c	Mon Jun 22 05:13:01 1998
+++ scilab-2.6/routines/metanet/myhsearch.c	Tue Jul 24 09:56:24 2001
@@ -21,7 +21,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 
--- scilab-2.6/routines/metanet/paths.c	Mon Jun 22 05:13:00 1998
+++ scilab-2.6/routines/metanet/paths.c	Tue Jul 24 09:56:24 2001
@@ -4,7 +4,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 
--- scilab-2.6/routines/metanet/saveg.c	Tue Nov  9 06:25:56 1999
+++ scilab-2.6/routines/metanet/saveg.c	Tue Jul 24 09:56:24 2001
@@ -9,7 +9,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #if (defined __MSC__) || (defined __ABSC__) 
--- scilab-2.6/routines/metanet/show.c	Tue Nov  9 06:25:56 1999
+++ scilab-2.6/routines/metanet/show.c	Tue Jul 24 09:56:25 2001
@@ -4,7 +4,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #ifdef __ABSC__
--- scilab-2.6/routines/metanet/transc.c	Mon Jun 22 05:13:00 1998
+++ scilab-2.6/routines/metanet/transc.c	Tue Jul 24 09:56:25 2001
@@ -2,7 +2,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 
--- scilab-2.6/routines/pvm/sci_tools.c	Tue Nov  9 06:25:57 1999
+++ scilab-2.6/routines/pvm/sci_tools.c	Tue Jul 24 09:56:25 2001
@@ -40,7 +40,9 @@
 ***/
 #include "../machine.h"
 #ifndef __ABSC__
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #else
 #include <stdlib.h>
 #endif
--- scilab-2.6/routines/sound/fileio.c	Tue Feb 13 07:42:17 2001
+++ scilab-2.6/routines/sound/fileio.c	Tue Jul 24 09:56:26 2001
@@ -14,7 +14,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else 
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 #include <string.h>
 
--- scilab-2.6/routines/sparse/spDefs.h	Tue Nov  9 06:25:58 1999
+++ scilab-2.6/routines/sparse/spDefs.h	Tue Jul 24 09:56:26 2001
@@ -441,7 +441,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #define ALLOC(type,number)  ((type *)malloc((unsigned)(sizeof(type)*(number))))
--- scilab-2.6/routines/sun/addinter.c	Wed Feb 28 03:10:14 2001
+++ scilab-2.6/routines/sun/addinter.c	Tue Jul 24 09:56:26 2001
@@ -21,7 +21,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #define OK 1
--- scilab-2.6/routines/sun/h_help_data.c	Mon Feb  5 05:19:34 2001
+++ scilab-2.6/routines/sun/h_help_data.c	Tue Jul 24 09:56:26 2001
@@ -13,7 +13,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 extern  char  *getenv();
 #endif
 
--- scilab-2.6/routines/sun/link.c	Mon Feb  5 05:19:34 2001
+++ scilab-2.6/routines/sun/link.c	Tue Jul 24 09:56:27 2001
@@ -18,7 +18,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 static void Underscores __PARAMS((int isfor,char *ename,char *ename1));
--- scilab-2.6/routines/sun/men_Sutils.c	Mon Feb  5 05:19:33 2001
+++ scilab-2.6/routines/sun/men_Sutils.c	Tue Jul 24 09:56:27 2001
@@ -6,7 +6,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #define MALLOC(x) malloc(((unsigned) x))
--- scilab-2.6/routines/wsci/runscilab.c	Fri Mar  9 03:40:04 2001
+++ scilab-2.6/routines/wsci/runscilab.c	Tue Jul 24 09:56:27 2001
@@ -24,7 +24,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #ifdef __MSC__
--- scilab-2.6/routines/wsci/winmain.c	Mon Oct 23 03:16:30 2000
+++ scilab-2.6/routines/wsci/winmain.c	Tue Jul 24 09:56:27 2001
@@ -39,7 +39,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #ifdef __MSC__
--- scilab-2.6/routines/wsci/wmprint.c	Mon Feb  5 05:19:33 2001
+++ scilab-2.6/routines/wsci/wmprint.c	Tue Jul 24 09:56:28 2001
@@ -5,7 +5,9 @@
 #include <string.h>
 #include <ctype.h>
 #ifndef __STDC__
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 #include <stdio.h>
 
--- scilab-2.6/routines/wsci/wmtex.c	Mon Feb  5 05:19:33 2001
+++ scilab-2.6/routines/wsci/wmtex.c	Tue Jul 24 09:56:28 2001
@@ -3,7 +3,9 @@
 #include <string.h>
 #include <ctype.h>
 #ifndef __STDC__
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 #include <stdio.h>
 
--- scilab-2.6/routines/xsci/jpc_coloredit.c	Mon Feb  5 05:19:33 2001
+++ scilab-2.6/routines/xsci/jpc_coloredit.c	Tue Jul 24 09:56:29 2001
@@ -9,7 +9,9 @@
 #include "wf_w_setup.h"
 
 #include <string.h> /* in case of dmalloc */ 
+#ifndef __APPLE__
 #include <malloc.h>  /* in case of dmalloc */ 
+#endif
 
 #include "../machine.h"
 #include "All-extern.h"
--- scilab-2.6/routines/xsci/jpc_command.c	Mon Feb  5 05:19:32 2001
+++ scilab-2.6/routines/xsci/jpc_command.c	Tue Jul 24 09:56:29 2001
@@ -35,7 +35,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #include "jpc_global.h"
--- scilab-2.6/routines/xsci/jpc_SGraph.c.in	Mon Feb  5 05:29:03 2001
+++ scilab-2.6/routines/xsci/jpc_SGraph.c.in	Tue Jul 24 09:56:29 2001
@@ -23,7 +23,9 @@
 #include <X11/@XAW@/ViewportP.h>
 
 #include <string.h>
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 /** getpid **/
 #ifdef __STDC__
 #include <stdlib.h>
--- scilab-2.6/routines/xsci/jpc_SGraph.c	Tue Apr 24 07:49:17 2001
+++ scilab-2.6/routines/xsci/jpc_SGraph.c	Tue Jul 24 09:56:28 2001
@@ -23,7 +23,9 @@
 #include <X11/Xaw/ViewportP.h>
 
 #include <string.h>
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 /** getpid **/
 #ifdef __STDC__
 #include <stdlib.h>
--- scilab-2.6/routines/xsci/jpc_utils.c	Tue May  5 07:17:05 1998
+++ scilab-2.6/routines/xsci/jpc_utils.c	Tue Jul 24 09:56:29 2001
@@ -44,7 +44,9 @@
 
 #include "jpc_global.h"
 #include <string.h> /* in case of dmalloc */ 
+#ifndef __APPLE__
 #include <malloc.h>  /* in case of dmalloc */ 
+#endif
 
 void DisableWindowResize(w)
 Widget w;
--- scilab-2.6/routines/xsci/jpc_Xloop.c	Mon Feb  5 05:19:33 2001
+++ scilab-2.6/routines/xsci/jpc_Xloop.c	Tue Jul 24 09:56:29 2001
@@ -17,7 +17,9 @@
 #ifdef __STDC__
 #include <stdlib.h>
 #else
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #include "../graphics/Math.h"
--- scilab-2.6/routines/xsci/wf_e_edit.c	Tue May  5 07:17:54 1998
+++ scilab-2.6/routines/xsci/wf_e_edit.c	Tue Jul 24 09:56:30 2001
@@ -20,7 +20,9 @@
 #include "wf_w_util.h"
 
 #include <string.h> /* in case of dmalloc */ 
+#ifndef __APPLE__
 #include <malloc.h>  /* in case of dmalloc */ 
+#endif
 
 DeclareArgs(1);
 
--- scilab-2.6/routines/xsci/wf_w_dir.c	Mon Feb  5 05:19:32 2001
+++ scilab-2.6/routines/xsci/wf_w_dir.c	Tue Jul 24 09:56:30 2001
@@ -56,7 +56,9 @@
 #endif
 
 #if !defined(freebsd)
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #endif
 
 #include "../machine.h"
--- scilab-2.6/routines/xsci/wf_w_file.c	Mon Feb  5 05:19:32 2001
+++ scilab-2.6/routines/xsci/wf_w_file.c	Tue Jul 24 09:56:30 2001
@@ -24,7 +24,9 @@
 #include "wf_w_util.h"
 #include "wf_w_setup.h"
 
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 
 #include "../machine.h"
 #include "All-extern.h"
--- scilab-2.6/routines/xsci/x_button.c	Mon Feb  5 05:19:32 2001
+++ scilab-2.6/routines/xsci/x_button.c	Tue Jul 24 09:56:31 2001
@@ -44,7 +44,9 @@
 #include "All-extern-x.h"
 
 #include <string.h> /* in case of dbmalloc */
+#ifndef __APPLE__
 #include <malloc.h> 
+#endif
 
 
 #define KeyState(x) (((x) & (ShiftMask|ControlMask)) + (((x) & Mod1Mask) ? 2 : 0))
--- scilab-2.6/routines/xsci/x_charproc.c	Mon Feb  5 05:19:32 2001
+++ scilab-2.6/routines/xsci/x_charproc.c	Tue Jul 24 09:56:31 2001
@@ -59,7 +59,9 @@
 #endif
 
 #include <string.h> /* in case of dmalloc */ 
+#ifndef __APPLE__
 #include <malloc.h>  /* in case of dmalloc */ 
+#endif
 
 #ifdef WITH_TK
 #include "../tksci/tksci.h"
--- scilab-2.6/routines/xsci/x_screen.c	Tue Jul 24 09:58:14 2001
+++ scilab-2.6/routines/xsci/x_screen.c	Tue Jul 24 10:01:41 2001
@@ -27,7 +27,12 @@
 
 /* screen.c */
 
+#ifdef __APPLE__
+#include "sys/types.h"
+#endif
+#ifndef __APPLE__
 #include "malloc.h"
+#endif
 
 #include "x_ptyxP.h"
 #include "x_error.h"
--- scilab-2.6/routines/xsci/x_screen.nok.c	Tue May  5 07:23:45 1998
+++ scilab-2.6/routines/xsci/x_screen.nok.c	Tue Jul 24 09:56:31 2001
@@ -33,7 +33,9 @@
 
 #include <stdio.h>
 
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 
 /*
    allocates memory for a 2-dimensional array of chars and returns a pointer
--- scilab-2.6/routines/xsci/x_scrollbar.c	Tue May  5 07:23:57 1998
+++ scilab-2.6/routines/xsci/x_scrollbar.c	Tue Jul 24 09:56:32 2001
@@ -29,7 +29,9 @@
 
 #include <stdio.h>
 #include <ctype.h>
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #ifdef __STDC__
 #include <stdlib.h>
 #endif
--- scilab-2.6/routines/xsci/x_test_loop.c	Mon Feb  5 05:19:31 2001
+++ scilab-2.6/routines/xsci/x_test_loop.c	Tue Jul 24 09:56:32 2001
@@ -39,7 +39,9 @@
 extern int demo_menu_activate;
 
 #include <string.h> /* in case of dmalloc */ 
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 
 
 int main(argc, argv)
--- scilab-2.6/xless/xless.h	Tue Apr 21 09:00:53 1998
+++ scilab-2.6/xless/xless.h	Tue Jul 24 09:54:55 2001
@@ -63,7 +63,9 @@
 #  include <X11/Xaw/Paned.h>
 #  include <X11/Xaw/Form.h>
 
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 
 /* Useful defines */
 
--- scilab-2.6/xmetanet/comm.c	Wed Aug 26 05:15:14 1998
+++ scilab-2.6/xmetanet/comm.c	Tue Jul 24 09:54:55 2001
@@ -2,7 +2,9 @@
 #include <X11/Intrinsic.h>
 #include <stdio.h>
 #include <string.h>
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 
 #include "defs.h"
 #include "metaconst.h"
--- scilab-2.6/xmetanet/dialog.c	Mon May  4 09:51:58 1998
+++ scilab-2.6/xmetanet/dialog.c	Tue Jul 24 09:54:55 2001
@@ -8,7 +8,9 @@
 #include <X11/Xaw/Label.h>
 #include <X11/Xaw/Viewport.h>
 
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #include <stdio.h>
 
 #include "metaconst.h"
--- scilab-2.6/xmetanet/file.c	Mon May  4 09:52:03 1998
+++ scilab-2.6/xmetanet/file.c	Tue Jul 24 10:02:38 2001
@@ -1,6 +1,11 @@
 /* Copyright INRIA */
 #include <string.h>
+#ifdef __APPLE__
+#include <sys/types.h>
+#endif
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 
 char *StripGraph(name)
 char *name;
--- scilab-2.6/xmetanet/graph.c	Sun Mar 21 09:45:00 1999
+++ scilab-2.6/xmetanet/graph.c	Tue Jul 24 09:54:56 2001
@@ -1,7 +1,9 @@
 /* Copyright INRIA */
 #include <X11/Intrinsic.h>
 #include <string.h>
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #include <stdio.h>
 
 #include "defs.h"
--- scilab-2.6/xmetanet/graphics.c	Sat Mar 20 11:03:15 1999
+++ scilab-2.6/xmetanet/graphics.c	Tue Jul 24 09:54:56 2001
@@ -1,7 +1,9 @@
 /* Copyright INRIA */
 #include <X11/Intrinsic.h>
 #include <math.h>
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #include <string.h>
 #include <stdio.h>
 
--- scilab-2.6/xmetanet/list.c	Mon May  4 09:52:15 1998
+++ scilab-2.6/xmetanet/list.c	Tue Jul 24 10:03:19 2001
@@ -1,6 +1,11 @@
 /* Copyright INRIA */
 #include <string.h>
+#ifdef __APPLE__
+#include <sys/types.h>
+#endif
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 
 #include "list.h"
 #include "graph.h"
--- scilab-2.6/xmetanet/load.c	Sun Mar 21 09:43:07 1999
+++ scilab-2.6/xmetanet/load.c	Tue Jul 24 09:54:56 2001
@@ -3,7 +3,9 @@
 #include <dirent.h>
 #include <stdio.h>
 #include <string.h>
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #include <math.h>
 
 #include "mysearch.h"
--- scilab-2.6/xmetanet/myhsearch.c	Mon May  4 09:52:24 1998
+++ scilab-2.6/xmetanet/myhsearch.c	Tue Jul 24 10:03:55 2001
@@ -19,7 +19,12 @@
 Cambridge, MA 02139, USA.  */
 
 #include <string.h>
+#ifdef __APPLE__
+#include <sys/types.h>
+#endif
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 
 #include "mysearch.h"
 
--- scilab-2.6/xmetanet/name.c	Sat Mar 20 10:36:12 1999
+++ scilab-2.6/xmetanet/name.c	Tue Jul 24 09:54:57 2001
@@ -1,6 +1,8 @@
 /* Copyright INRIA */
 #include <X11/Intrinsic.h>
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 
 #include "metaconst.h"
 #include "list.h"
diff -r -u scilab-2.6/Makefile.incl.in scilab-2.6/Makefile.incl.in
--- scilab-2.6/Makefile.incl.in	Fri Aug 18 13:12:14 2000
+++ scilab-2.6/Makefile.incl.in	Wed Apr 18 23:41:00 2001
@@ -12,8 +12,9 @@
 
 RANLIB = @RANLIB@
 
-TERMCAPLIB = @TERMCAPLIB@
-
+# MacOSX
+# TERMCAPLIB = @TERMCAPLIB@
+TERMCAPLIB =
 ##################################################################
 # NOTE: the following schemes for compiling and linking are not  #
 #       exactly used for the main executable scilex; for it, see #
@@ -67,7 +68,9 @@
 XAW_LOCAL_LIB = @XAW_LOCAL_LIB@
 XFLAGS = @X_CFLAGS@ @XAW_LOCAL_INCLUDES@
 X_EXTRA_LIBS = @X_EXTRA_LIBS@
-XLIBS = @X_LIBS@ $(XAWLIB) $(XMULIB) -lXt -lXext @X_PRE_LIBS@ -lX11 $(X_EXTRA_LIBS)
+# MacOSX
+# XLIBS = @X_LIBS@ $(XAWLIB) $(XMULIB) -lXt -lXext @X_PRE_LIBS@ -lX11 $(X_EXTRA_LIBS)
+XLIBS = -force_flat_namespace @X_LIBS@ $(XAWLIB) $(XMULIB) -lXpm -lXt -lXext @X_PRE_LIBS@ -lX11 $(X_EXTRA_LIBS)
 
 #####################
 # TCL/TK
diff -r -u scilab-2.6/routines/sound/st.h scilab-2.6/routines/sound/st.h
--- scilab-2.6/routines/sound/st.h	Mon Feb  5 13:19:40 2001
+++ scilab-2.6/routines/sound/st.h	Wed Apr 18 23:41:01 2001
@@ -11,7 +11,7 @@
  * Lance Norskog And Sundry Contributors are not responsible for 
  * the consequences of using this software.
  */
-#if (defined(netbsd) || defined(freebsd)) && !defined(unix) 
+#if (defined(netbsd) || defined(freebsd) || defined(__APPLE__)) && !defined(unix) 
 #define unix
 #endif
 
diff -r -u scilab-2.6/routines/sparse/spConfig.h scilab-2.6/routines/sparse/spConfig.h
--- scilab-2.6/routines/sparse/spConfig.h	Thu Jan 28 10:59:11 1999
+++ scilab-2.6/routines/sparse/spConfig.h	Wed Apr 18 23:41:01 2001
@@ -413,8 +413,8 @@
  */
 
 /* Begin machine constants. */
-
-#ifdef notdef /* __STDC__ */
+/* MacOSX has working __STDC__ */
+#ifdef __APPLE__ /* notdef*/ /* __STDC__ */
 /*
  * This code is currently deleted because most ANSI standard C compilers
  * do not provide the standard header files yet.
diff -r -u scilab-2.6/routines/xsci/wf_fig.h scilab-2.6/routines/xsci/wf_fig.h
--- scilab-2.6/routines/xsci/wf_fig.h	Thu Jan 28 11:00:16 1999
+++ scilab-2.6/routines/xsci/wf_fig.h	Wed Apr 18 23:41:01 2001
@@ -51,7 +51,7 @@
 #if !defined(__bsdi__) && !defined(__NetBSD__)
 extern int	errno;
 extern int	sys_nerr;
-#if (! (defined(BSD) && (BSD >= 199306))) && !defined(freebsd)
+#if (! (defined(BSD) && (BSD >= 199306))) && !defined(freebsd) && !defined(__APPLE__)
 extern char    *sys_errlist[];
 #endif
 #endif
diff -r -u scilab-2.6/routines/xsci/x_misc.c scilab-2.6/routines/xsci/x_misc.c
--- scilab-2.6/routines/xsci/x_misc.c	Tue Aug 17 10:46:52 1999
+++ scilab-2.6/routines/xsci/x_misc.c	Wed Apr 18 23:41:01 2001
@@ -512,7 +512,7 @@
 #if !defined(__bsdi__) && !defined(__NetBSD__)
 extern int	errno;
 extern int	sys_nerr;
-#if (! (defined(BSD) && (BSD >= 199306))) && !defined(freebsd)
+#if (! (defined(BSD) && (BSD >= 199306))) && !defined(freebsd) && !defined(__APPLE__)
 extern char    *sys_errlist[];
 #endif
 #endif
--- scilab-2.6/Makefile.in	Tue Jul 24 10:58:26 2001
+++ scilab-2.6/Makefile.in	Tue Jul 24 11:00:31 2001
@@ -147,28 +147,14 @@
 	cd .. ; tar cvf $(SCIDIR)/$(SCIBASE)-bin.tar $(BINDISTFILES)
 	$(RM) .binary
 
-LIBPREFIX = @prefix@/lib
-
 install:
-	@if test `pwd` != ${LIBPREFIX}/$(SCIBASE); then \
+	@if test `pwd` != $(LIBPREFIX)/$(SCIBASE); then \
 		touch .binary; \
 		strip $(SCIDIR)/bin/scilex; \
 		(cd tests; make distclean); \
 		(cd examples; make distclean); \
-		(cd .. ; tar cf - $(BINDISTFILES) | (cd ${LIBPREFIX}; tar xf -)); \
-		(cd ${LIBPREFIX}/$(SCIBASE); make); \
+		(cd .. ; tar cf - $(BINDISTFILES) | (cd $(LIBPREFIX); tar xf -)); \
+		(cd $(LIBPREFIX)/$(SCIBASE); make); \
 		$(RM) .binary; \
 	fi
-	$(RM) /usr/bin/scilab
-	ln -fs ${LIBPREFIX}/$(SCIBASE)/bin/scilab /usr/bin/scilab
-	$(RM) /usr/bin/intersci
-	ln -fs ${LIBPREFIX}/$(SCIBASE)/bin/intersci /usr/bin/intersci
-	$(RM) /usr/bin/intersci-n
-	ln -fs ${LIBPREFIX}/$(SCIBASE)/bin/intersci-n /usr/bin/intersci-n
-
-uninstall:
-	$(RM) -r ${LIBPREFIX}/$(SCIBASE)
-	$(RM) /usr/bin/scilab
-	$(RM) /usr/bin/intersci
-	$(RM) /usr/bin/intersci-n
 
--- scilab-2.6/xmetanet/save.c	Mon Jul 30 05:45:13 2001
+++ scilab-2.6/xmetanet/save.c	Mon Jul 30 05:44:59 2001
@@ -1,6 +1,11 @@
 /* Copyright INRIA */
+#ifdef __APPLE__
+#include <sys/types.h>
+#endif
 #include <dirent.h>
+#ifndef __APPLE__
 #include <malloc.h>
+#endif
 #include <stdio.h>
 #include <string.h>
 
--- scilab-2.6/configure	Mon Mar 26 05:10:37 2001
+++ scilab-2.6/configure	Thu Jun 13 10:57:17 2002
@@ -2525,6 +2525,35 @@
     WINXFLAGS='-I../xdr'
     MAKEFILE_TARGET=Makefile.gcwin32
     ;;
+
+# Darwin/MacOSX (Not supported by INRIA)
+  *-*-darwin*)
+     GCC=yes
+     CC=cc
+     CC_OPTIONS='-no-cpp-precomp -O2'
+     CC_LDFLAGS=
+     CC_PICFLAGS='-fPIC'
+     # script shell f77 have bugs, get ours
+     FC=g77
+     FC_OPTIONS='-O2'
+     FC_OPTIONS_O0=
+     FC_LDFLAGS=
+     FC_PICFLAGS='-fPIC'
+     LD=ld
+     LD_LDFLAGS=
+     if test "$enable_debug" = yes; then
+       CC_OPTIONS='-g '
+       FC_OPTIONS=-g
+     fi
+     if test "$G77" = yes; then
+       FC=g77
+     fi
+   # Dyn. loading - ????
+   # DLDLIB=
+   # DLD_SUBDIR= 
+    MAKEFILE_TARGET=Makefile.darwin
+    ;;
+
 # FreeBSD  systems (not supported by INRIA)
   *-*-freebsd*)
      GCC=yes
@@ -4817,7 +4846,7 @@
 TCL_LIB_OK=0
 
 dirs="$USER_TCL_LIB_PATH /lib /usr/lib /usr/lib/tcl /usr/lib/tcl8.* /shlib /shlib/tcl /shlib/tcl8.* /usr/shlib /shlib/tcl /usr//shlib/tcl8.* /usr/local/lib /usr/local/lib/tcl /usr/local/lib/tcl8.* /usr/local/shlib /usr/X11/lib/tcl /usr/X11/lib/tcl8.* /usr/lib/X11 /usr/lib/X11/tcl /usr/lib/X11/tcl8.* ../lib ../../lib  /usr/local/tcl /usr/tcl /usr/tcl/lib /usr/local/tcl/lib ."
-libexts="so so.1.0 sl a"
+libexts="dylib so so.1.0 sl a"
 libnames="tcl$CHK_TCL_MAJ.$CHK_TCL_MIN tcl.$CHK_TCL_MAJ.$CHK_TCL_MIN tcl$CHK_TCL_MAJ$CHK_TCL_MIN tcl.$CHK_TCL_MAJ$CHK_TCL_MIN"
 for e in $libexts; do
 for j in $dirs; do
@@ -5032,7 +5061,7 @@
 CHK_TK_MAJ=$tkmajor
 CHK_TK_MIN=$tkminor
 dirs="$USER_TK_LIB_PATH /lib /usr/lib /usr/lib/tk /usr/lib/tk8.* /shlib /shlib/tk /shlib/tk8.* /usr/shlib /shlib/tk /usr/shlib/tk8.* /usr/local/lib /usr/local/lib/tk /usr/local/lib/tk8.* /usr/local/shlib /usr/X11/lib/tk /usr/X11/lib/tk8.*  /usr/lib/X11 /usr/lib/X11/tk /usr/lib/X11/tk8.* ../lib ../../lib /usr/tk /usr/local/tk /usr/local/tk/lib /usr/tk/lib /usr/local/tcl /usr/tcl /usr/local/tcl/lib /usr/tcl/lib"
-libexts="so so.1.0 sl a"
+libexts="dylib so so.1.0 sl a"
 libnames="tk$CHK_TK_MAJ.$CHK_TK_MIN tk.$CHK_TK_MAJ.$CHK_TK_MIN tk$CHK_TK_MAJ$CHK_TK_MIN tk.$CHK_TK_MAJ$CHK_TK_MIN"
 for e in $libexts; do
 for j in $dirs ; do
--- scilab-2.6/routines/xsci/wf_fig.h.orig	Mon Sep  2 17:37:12 2002
+++ scilab-2.6/routines/xsci/wf_fig.h	Mon Sep  2 17:39:46 2002
@@ -48,7 +48,7 @@
 #include <errno.h>
 
 #ifndef linux 
-#if !defined(__bsdi__) && !defined(__NetBSD__)
+#if !defined(__bsdi__) && !defined(__NetBSD__) && !defined(__APPLE__)
 extern int	errno;
 extern int	sys_nerr;
 #if (! (defined(BSD) && (BSD >= 199306))) && !defined(freebsd) && !defined(__APPLE__)
--- scilab-2.6/routines/xsci/x_misc.c.orig	Mon Sep  2 17:43:38 2002
+++ scilab-2.6/routines/xsci/x_misc.c	Mon Sep  2 17:45:03 2002
@@ -509,7 +509,7 @@
 
 /* #include "wf_fig.h" */ /** for sys_errlist **/
 #ifndef linux 
-#if !defined(__bsdi__) && !defined(__NetBSD__)
+#if !defined(__bsdi__) && !defined(__NetBSD__) && !defined(__APPLE__)
 extern int	errno;
 extern int	sys_nerr;
 #if (! (defined(BSD) && (BSD >= 199306))) && !defined(freebsd) && !defined(__APPLE__)
@@ -523,7 +523,7 @@
 char *SysErrorMsg(n)
   int n;
 {
-  extern int sys_nerr;
+/* extern int sys_nerr; */
   return ((n >= 0 && n < sys_nerr) ? sys_errlist[n] : UE );
 }
 
