Info2: <<
Package: postgresql-python-py%type_pkg[python]
Version: 8.2.11
Revision: 1
Distribution: (%type_pkg[python] = 23) 10.3, (%type_pkg[python] = 23) 10.4
Description: PostgreSQL Python tools
Type: python(2.3 2.4 2.5 2.6)
License: BSD
Maintainer: Benjamin Reed <postgresql-python-py@fink.racoonfink.com>

Depends: <<
	postgresql82-shlibs (>= %v-1),
	python%type_pkg[python],
	python-mx-py%type_pkg[python],
	readline5-shlibs
<<
BuildDepends: <<
	fink (>= 0.28.0-1),
	postgresql82-dev (>= %v-1),
	python%type_pkg[python],
	bison,
	readline5,
	system-openssl-dev
<<
Conflicts: <<
	postgresql-python-py%type_pkg[python],
	postgresql-ssl-python-py%type_pkg[python] (<< %v-%r),
	postgresql-python,
	postgresql-ssl-python
<<
Replaces: <<
	postgresql-python-py%type_pkg[python],
	postgresql-ssl-python-py%type_pkg[python] (<< %v-%r),
	postgresql-python,
	postgresql-ssl-python
<<

CustomMirror: <<
	afr-ZA: ftp://ftp.za.postgresql.org/mirror/ftp.postgresql.org
	asi-CN: ftp://ftp.cn.postgresql.org/pub/postgresql
	asi-ID: ftp://ftp9.id.postgresql.org/postgresql
	asi-ID: http://ftp9.id.postgresql.org
	asi-JP: ftp://ftp2.jp.postgresql.org/pub/postgresql
	asi-JP: ftp://ftp3.jp.postgresql.org/pub/db/postgresql
	asi-JP: http://ftp2.jp.postgresql.org/pub/postgresql
	asi-KR: ftp://ftp2.kr.postgresql.org/pub/postgresql
	asi-MY: ftp://ftp.my.postgresql.org/pub/postgresql
	asi-TW: ftp://ftp.tw.postgresql.org/pub/postgresql
	asi-TW: ftp://ftp4.tw.postgresql.org/pub/postgresql
	asi-TW: http://ftp4.tw.postgresql.org/pub/postgresql
	asi-VN: ftp://ftp.vn.postgresql.org/postgresql
	aus-AU: ftp://ftp2.au.postgresql.org/pub/postgresql
	eur-AT: ftp://ftp.at.postgresql.org/db/www.postgresql.org/pub
	eur-AT: http://ftp.at.postgresql.org/db/www.postgresql.org/pub
	eur-BA: ftp://ftp.ba.postgresql.org/pub/postgresql
	eur-BE: ftp://ftp.be.postgresql.org/postgresql
	eur-BE: ftp://ftp2.be.postgresql.org/pub/postgresql
	eur-BE: http://ftp.be.postgresql.org/postgresql
	eur-BE: http://ftp2.be.postgresql.org
	eur-BG: ftp://ftp3.bg.postgresql.org/postgresql
	eur-CH: ftp://ftp.ch.postgresql.org/mirror/postgresql
	eur-CH: ftp://ftp2.ch.postgresql.org/pub/mirrors/postgresql
	eur-CH: http://ftp2.ch.postgresql.org/pub/mirrors/postgresql
	eur-CZ: ftp://ftp.cz.postgresql.org/pgsql
	eur-CZ: ftp://ftp2.cz.postgresql.org/pub/postgresql
	eur-CZ: http://ftp.cz.postgresql.org
	eur-CZ: http://ftp2.cz.postgresql.org/pub/postgresql
	eur-DE: ftp://ftp.de.postgresql.org/packages/databases/PostgreSQL
	eur-DE: ftp://ftp10.de.postgresql.org/pub/mirror/postgresql
	eur-DE: ftp://ftp7.de.postgresql.org/pub/ftp.postgresql.org
	eur-DE: ftp://ftp8.de.postgresql.org/pub/misc/pgsql
	eur-DE: ftp://ftp9.de.postgresql.org/unix/databases/postgresql
	eur-DE: http://ftp.de.postgresql.org/packages/databases/PostgreSQL
	eur-DE: http://ftp8.de.postgresql.org/pub/misc/pgsql
	eur-DK: ftp://ftp.dk.postgresql.org/postgresql
	eur-DK: http://ftp.dk.postgresql.org/postgresql
	eur-EE: ftp://ftp.ee.postgresql.org/pub/postgresql
	eur-EE: http://ftp.ee.postgresql.org/pub/postgresql
	eur-ES: ftp://ftp5.es.postgresql.org/mirror/postgresql
	eur-ES: http://ftp5.es.postgresql.org/mirror/postgresql
	eur-FI: ftp://ftp.fi.postgresql.org/pub/postgresql
	eur-FR: ftp://ftp.fr.postgresql.org
	eur-FR: ftp://ftp4.fr.postgresql.org/pub/mirrors/postgresql
	eur-GR: ftp://ftp.gr.postgresql.org/pub/databases/postgresql
	eur-GR: ftp://ftp2.gr.postgresql.org/pub/databases/postgresql
	eur-GR: ftp://ftp3.gr.postgresql.org/mirrors/postgresql
	eur-GR: http://ftp.gr.postgresql.org/pub/databases/postgresql
	eur-GR: http://ftp2.gr.postgresql.org/pub/databases/postgresql
	eur-GR: http://ftp3.gr.postgresql.org/mirrors/postgresql
	eur-IE: ftp://ftp.ie.postgresql.org/mirrors/ftp.postgresql.org/pub
	eur-IE: ftp://ftp2.ie.postgresql.org/mirrors/ftp.postgresql.org
	eur-IE: http://ftp.ie.postgresql.org/mirrors/ftp.postgresql.org/pub
	eur-IE: http://ftp2.ie.postgresql.org/mirrors/ftp.postgresql.org
	eur-IL: ftp://ftp.il.postgresql.org/ftp.postgresql.org
	eur-IS: ftp://ftp.is.postgresql.org/pub/postgresql
	eur-IT: ftp://ftp2.it.postgresql.org/mirrors/postgres
	eur-IT: ftp://ftp6.it.postgresql.org/pub/PostgreSQL
	eur-IT: ftp://ftp7.it.postgresql.org/pub/unix/postgres
	eur-IT: http://ftp2.it.postgresql.org/mirrors/postgres
	eur-IT: http://ftp7.it.postgresql.org/pub/unix/postgres
	eur-LT: ftp://ftp.lt.postgresql.org
	eur-LT: ftp://ftp2.lt.postgresql.org/pub/PostgreSQL
	eur-LT: http://ftp.lt.postgresql.org
	eur-LT: http://ftp2.lt.postgresql.org/pub/PostgreSQL
	eur-LV: ftp://ftp.lv.postgresql.org/mirrors/ftp.postgresql.org
	eur-NL: ftp://ftp.nl.postgresql.org/pub/mirror/postgresql
	eur-NL: ftp://ftp2.nl.postgresql.org/mirror/postgresql
	eur-NL: ftp://ftp4.nl.postgresql.org/postgresql.zeelandnet.nl
	eur-NL: http://ftp2.nl.postgresql.org
	eur-NL: http://ftp4.nl.postgresql.org
	eur-NO: ftp://ftp.no.postgresql.org/pub/databases/postgresql
	eur-PL: ftp://ftp6.pl.postgresql.org/pub/postgresql
	eur-PL: ftp://ftp7.pl.postgresql.org/pub/mirror/ftp.postgresql.org
	eur-PL: ftp://ftp8.pl.postgresql.org/pub/postgresql
	eur-PL: ftp://ftp9.pl.postgresql.org/pub/mirrors/ftp.postgresql.org
	eur-PL: http://ftp6.pl.postgresql.org/pub/postgresql
	eur-PL: http://ftp8.pl.postgresql.org/pub/postgresql
	eur-PL: http://ftp9.pl.postgresql.org/pub/mirrors/ftp.postgresql.org
	eur-PT: ftp://ftp.pt.postgresql.org/pub/postgresql
	eur-PT: http://ftp.pt.postgresql.org/pub/postgresql
	eur-RO: ftp://ftp6.ro.postgresql.org/pub/mirrors/ftp.postgresql.org
	eur-RO: ftp://ftp7.ro.postgresql.org/1/PostgreSQL
	eur-RO: http://ftp6.ro.postgresql.org/pub/mirrors/ftp.postgresql.org
	eur-RU: ftp://ftp.ru.postgresql.org/pub/mirrors/pgsql
	eur-RU: ftp://ftp2.ru.postgresql.org/pub/databases/postgresql
	eur-RU: ftp://ftp3.ru.postgresql.org/pub/mirror/postgresql/pub
	eur-RU: http://ftp2.ru.postgresql.org/pub/databases/postgresql
	eur-SE: ftp://ftp.se.postgresql.org/pub/databases/relational/postgresql
	eur-SE: http://ftp.se.postgresql.org/pub/databases/relational/postgresql
	eur-SI: ftp://ftp.si.postgresql.org/pub/mirrors/postgresql
	eur-SK: ftp://ftp2.sk.postgresql.org/pub/postgresql
	eur-TR: ftp://ftp.tr.postgresql.org/pub/PostgreSQL
	eur-UA: ftp://ftp.ua.postgresql.org/pub/mirrors/postgresql.org
	eur-UA: ftp://ftp2.ua.postgresql.org/pub/postgresql
	eur-UK: ftp://ftp2.uk.postgresql.org/sites/ftp.postgresql.org
	eur-UK: http://ftp2.uk.postgresql.org/sites/ftp.postgresql.org
	nam-CA: ftp://ftp5.ca.postgresql.org/mirrors/postgresql
	nam-US: ftp://ftp.postgresql.org/pub
	nam-US: ftp://ftp10.us.postgresql.org/pub/postgresql
	nam-US: ftp://ftp2.lv.postgresql.org/postgresql
	nam-US: ftp://ftp3.ua.postgresql.org/pub/mirrors/postgresql
	nam-US: ftp://ftp5.us.postgresql.org/pub/PostgreSQL
	nam-US: ftp://ftp7.us.postgresql.org/pub/postgresql
	nam-US: ftp://ftp9.us.postgresql.org/pub/mirrors/postgresql
	nam-US: http://ftp2.lv.postgresql.org
	nam-US: http://ftp7.us.postgresql.org/pub/postgresql
	nam-US: http://ftp9.us.postgresql.org/pub/mirrors/postgresql
	sam-AR: ftp://ftp.ar.postgresql.org/pub/mirrors/postgresql
	sam-BR: ftp://ftp2.br.postgresql.org/postgresql
	sam-BR: http://ftp2.br.postgresql.org/postgresql
<<
Source: mirror:custom:source/v%v/postgresql-%v.tar.bz2
Source-MD5: 84e1fedd5f676e978a3afa744bc71b0a
Source2: ftp://ftp.druid.net/pub/distrib/PyGreSQL-3.8.1.tgz
Source2-MD5: 5575979dac93c9c5795d7693a8f91c86
PatchFile: postgresql82.patch
PatchFile-MD5: 6b399f03d00dbe624d2dff4d3891c51f
PatchScript: sed -e 's|@INSTPREFIX@|%p|g' -e 's|python2.1|python%type_raw[python]|g' < %{PatchFile} | patch -p1

SetCPPFLAGS: -DHAVE_OPTRESET -I%p/include/postgresql -I%p/include
SetLIBS: -L%p/lib
NoSetCPPFLAGS: true
NoSetLDFLAGS: true
ConfigureParams: --prefix=%p --with-docdir=%p/share/doc --mandir=%p/share/man --enable-multibyte --enable-recode --with-CXX --without-perl --with-python --with-openssl --with-libraries=%p/lib --with-includes=%p/include --without-tcl --without-java --enable-odbc --with-pam --with-rendezvous
CompileScript: <<
#!/bin/sh -ev

	export lt_cv_sys_max_cmd_len=65536
	export ac_cv_path_PYTHON=%p/bin/python%type_raw[python]
	export CPPFLAGS="-I%p/lib/system-openssl/include -I%p/include -DHAVE_OPTRESET -fno-common"
	export LDFLAGS="-L%p/lib/system-openssl/lib -L%p/lib"
	./configure %c

	pushd src/pl/plpython
	make BE_DLLLIBS="-bundle_loader %p/bin/postgres"
	popd

	pushd ../PyGreSQL-3.8.1
	python%type_raw[python] setup.py build
	popd
<<

InstallScript: <<
#!/bin/sh -ev

	pushd src/pl/plpython
	make install DESTDIR=%d INSTALLSITEMAN3DIR=%i/share/man/man3
	popd

	pushd ../PyGreSQL-3.8.1
	python%type_raw[python] setup.py install --root="%d"
	install -d -m 755 %i/share/doc/%N
	install -c -m 755 tutorial/* docs/*.txt %i/share/doc/%N/
	popd

	mv %i/lib/postgresql-8.2/plpython.so %i/lib/postgresql-8.2/plpython-%type_pkg[python].so
<<
DocFiles: COPYRIGHT HISTORY INSTALL README
SplitOff: <<
	Package: postgresql-ssl-python-py%type_pkg[python]
	Depends: postgresql-python-py%type_pkg[python] (>= %v-%r)
	DocFiles: COPYRIGHT HISTORY INSTALL README
<<

PostInstScript: <<
	update-alternatives --install %p/lib/postgresql-8.2/plpython.so postgresql-python-plpython.so %p/lib/postgresql-8.2/plpython-%type_pkg[python].so %type_pkg[python]
	cat <<END
*** WARNING ***

To be able to use this (plpython) in PostgreSQL, you will need to
start your database:

	sudo %p/bin/pgsql.sh start

...and then run:

	sudo -u postgres %p/bin/createlang plpythonu template1

*** WARNING ***
END
<<
PostRmScript: <<
	update-alternatives --remove postgresql-python-plpython.so %p/lib/postgresql-8.2/plpython-%type_pkg[python].so
	if [ ! -f %p/lib/postgresql-8.2/plpython.so ]; then
	  sudo -u postgres %p/bin/droplang plpython template1 >/dev/null 2>&1 || :
	fi
<<

Homepage: http://www.postgresql.org/
DescDetail: <<
To be able to use this (plpython) in PostgreSQL, you will need to
start your database:

	sudo %p/bin/pgsql.sh start

...and then run:

	sudo -u postgres %p/bin/createlang plpythonu template1
<<
<<

