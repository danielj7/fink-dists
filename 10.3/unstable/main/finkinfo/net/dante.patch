diff -Nru3 dante-1.1.14/aclocal.m4 dante-patched/aclocal.m4
--- dante-1.1.14/aclocal.m4	2003-07-27 14:06:16.000000000 +0200
+++ dante-patched/aclocal.m4	2003-12-03 21:56:18.000000000 +0100
@@ -2408,7 +2408,7 @@
       allow_undefined_flag='-undefined suppress'
       ;;
     *) # Darwin 1.3 on
-      allow_undefined_flag='-flat_namespace -undefined suppress'
+      allow_undefined_flag='allow_undefined_flag='-twolevel_namespace -undefined dynamic_lookup -multiply_defined suppress'
       ;;
     esac
     # FIXME: Relying on posixy $() will cause problems for
diff -Nru3 dante-1.1.14/configure dante-patched/configure
--- dante-1.1.14/configure	2003-07-27 14:02:42.000000000 +0200
+++ dante-patched/configure	2003-12-03 21:59:30.000000000 +0100
@@ -4601,7 +4601,7 @@
       allow_undefined_flag='-undefined suppress'
       ;;
     *) # Darwin 1.3 on
-      allow_undefined_flag='-flat_namespace -undefined suppress'
+      allow_undefined_flag='-twolevel_namespace -undefined dynamic_lookup -multiply_defined suppress'
       ;;
     esac
     # FIXME: Relying on posixy $() will cause problems for
@@ -16520,7 +16520,7 @@
 
 #look for PAM header and lib
 
-for ac_header in security/pam_appl.h
+for ac_header in pam/pam_appl.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
 echo "$as_me:16526: checking for $ac_header" >&5
diff -Nru3 dante-1.1.14/configure.ac dante-patched/configure.ac
--- dante-1.1.14/configure.ac	2003-07-23 17:47:33.000000000 +0200
+++ dante-patched/configure.ac	2003-12-03 21:58:28.000000000 +0100
@@ -698,6 +698,9 @@
 	*-osf*)
 		so_sndlowat=t
 	;;
+	*darwin*)
+		so_sndlowat=t
+	;;
 esac
 if test "x${so_sndlowat}" = xt; then
 	AC_DEFINE(HAVE_SO_SNDLOWAT)
@@ -1390,7 +1393,7 @@
 AM_CONDITIONAL(WANT_LIBWRAP, test "x${want_libwrap}" != "x")
 
 #look for PAM header and lib
-AC_CHECK_HEADERS(security/pam_appl.h, [have_pam_header=t])
+AC_CHECK_HEADERS(pam/pam_appl.h, [have_pam_header=t])
 AC_SEARCH_LIBS(pam_start, pam, [have_libpam=t])
 
 if test x"${have_pam_header}" != x -a x"${have_libpam}" != x; then
diff -Nru3 dante-1.1.14/include/common.h dante-patched/include/common.h
--- dante-1.1.14/include/common.h	2003-07-02 14:13:31.000000000 +0200
+++ dante-patched/include/common.h	2003-12-03 20:26:04.000000000 +0100
@@ -175,7 +175,7 @@
 #include <ifaddrs.h>
 #endif /* HAVE_IFADDRS_H */
 #if HAVE_PAM
-#include <security/pam_appl.h>
+#include <pam/pam_appl.h>
 #endif /* HAVE_PAM */
 
 #include "yacconfig.h"
diff -Nru3 dante-1.1.14/include/redefac.h dante-patched/include/redefac.h
--- dante-1.1.14/include/redefac.h	2003-04-28 18:31:21.000000000 +0200
+++ dante-patched/include/redefac.h	2003-12-03 20:48:51.000000000 +0100
@@ -815,6 +815,11 @@
 #endif
 
 
+#ifndef HAVE_PAM_PAM_APPL_H
+#define HAVE_PAM_PAM_APPL_H 0
+#endif
+
+
 #ifndef HAVE_PATHS_H
 #define HAVE_PATHS_H 0
 #endif
@@ -825,11 +830,6 @@
 #endif
 
 
-#ifndef HAVE_SECURITY_PAM_APPL_H
-#define HAVE_SECURITY_PAM_APPL_H 0
-#endif
-
-
 #ifndef HAVE_SELECT
 #define HAVE_SELECT 0
 #endif
diff -Nru3 dante-1.1.14/ltmain.sh dante-patched/ltmain.sh
--- dante-1.1.14/ltmain.sh	2001-12-12 12:34:39.000000000 +0100
+++ dante-patched/ltmain.sh	2003-12-03 20:26:04.000000000 +0100
@@ -2899,6 +2899,16 @@
 	  $run eval '(cd $output_objdir && $rm ${realname}U && $mv $realname ${realname}U)' || exit $?
 	fi
 
+       tmp_deplibs=
+       for test_deplib in $deplibs; do
+               case " $convenience " in
+               *" $test_deplib "*) ;;
+               *)
+                       tmp_deplibs="$tmp_deplibs $test_deplib"
+                       ;;
+               esac
+       done
+       deplibs="$tmp_deplibs" 
 	# Do each of the archive commands.
 	if test -n "$export_symbols" && test -n "$archive_expsym_cmds"; then
 	  eval cmds=\"$archive_expsym_cmds\"
