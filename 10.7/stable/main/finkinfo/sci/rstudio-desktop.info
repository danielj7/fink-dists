Package: rstudio-desktop
Version: 0.98.653
Revision: 5
Distribution: 10.8, 10.7
Description: IDE for R
License: GPL
Homepage: http://rstudio.org
Maintainer: BABA Yoshihiko <babayoshihiko@mac.com>
Depends: <<
  r-base (>=3.1.0), r-base31, r-base31-shlibs,
  boost1.53.nopython-shlibs,
  libiconv, libpng16-shlibs
<<
BuildDepends: << 
  fink-package-precedence,
  fink (>= 0.28), cmake, 
  boost1.53.nopython,
  r-base (>=3.1.0), r-base31-dev,
  libiconv-dev, libpng16
<<

Source: https://github.com/rstudio/rstudio/archive/v%v.tar.gz
Source-MD5: 2bee961e598456fbeee77e42c636397e
SourceDirectory: rstudio-%v

Source2: https://s3.amazonaws.com/rstudio-buildtools/gin-1.5.zip
Source2-MD5: 2409168cc18bf5f341e107e6887fe359

Source3: https://s3.amazonaws.com/rstudio-buildtools/gwt-2.5.1.zip
Source3-MD5: 6ada64bdd849abd0d954c44d42187340

Source4: https://s3.amazonaws.com/rstudio-dictionaries/core-dictionaries.zip
Source4-MD5: 0e03798b8e53096c4a906bde05e32378

Source5: https://s3.amazonaws.com/rstudio-buildtools/mathjax-20.zip
Source5-MD5: 480ede551eeffec08162a7a913eee906

Source6: https://s3.amazonaws.com/rstudio-buildtools/pandoc-1.12.3.zip
Source6-MD5: 1541304bf51d86e361b7d930f899ac1c

# includes fix for boost and apple headers both using "common" words
# for tokens and parameters
PatchFile: %n.patch
PatchFile-MD5: 3bd07931adb36018d5c8017d52fb30cb
PatchScript: sed 's|@PREFIX@|%p|g' < %{PatchFile} | patch -p1

GCC: 4.0
SetCXXFLAGS: -I%p/Library/Frameworks/R.framework/Versions/3.1/Resources/include
SetLDFLAGS: %p/Library/Frameworks/R.framework/Versions/3.1/Resources/lib/libR.dylib
CompileScript: <<
#!/bin/bash -ev
  # Move Source2-5 files
  # See dependencies/osx/install-dependencies-osx
  mkdir -p src/gwt/lib/gin/1.5
  FILES="LICENSE README javadoc"
  for FILE in $FILES;
    do
      mv  ../$FILE   src/gwt/lib/gin/1.5/
    done
  mv  ../*.jar         src/gwt/lib/gin/1.5/
  
  mkdir -p src/gwt/lib/gwt
  mv ../gwt-2.5.1 src/gwt/lib/gwt/2.5.1
  
  mkdir -p dependencies/common/dictionaries
  mv ../*.dic* dependencies/common/dictionaries/
  mv ../*.aff dependencies/common/dictionaries/
  
  mv ../mathjax dependencies/common/
  
  mkdir -p dependencies/common/pandoc
  mv ../pandoc-1.12.3 dependencies/common/pandoc/1.12.3

  # See package/osx/make-package
  mkdir -p build
  cd build

  cmake -DRSTUDIO_TARGET=Desktop \
         -DRSTUDIO_PACKAGE_BUILD=1 \
         -DCMAKE_BUILD_TYPE=Release \
         -DCMAKE_INSTALL_PREFIX=%b/Applications \
         -DCMAKE_VERBOSE_MAKEFILE=TRUE \
         -DLIBR_LIBRARIES=%p/Library/Frameworks/R.framework/Versions/3.1/Resources/lib \
         ..
#        -DBOOST_ROOT=%p/opt/boost-1_55
 
  make VERBOSE=1
  make install CMAKE_INSTALL_PREFIX=%p/Applications
<<
# Install Phase.
InstallScript: <<
#!/bin/bash -ev
  echo "test"
<<
DescPackaging: <<
Upstream has abandoned QT on darwin as of v0.98.475 in favor of the WebKit framework...
http://blog.rstudio.org/2013/11/12/rstudio-os-x-mavericks-issues-resolved/
so unnecessary Depends/BuildDepends on qt/webit are purged.

Synced with newest r-base package. If the user doesn't have the r-base package
installed, fink will install the r-base from the latest R release causing the
wrong symlinks to be installed for the designated r-base release.
<<
AppBundles: Applications/RStudio.app
