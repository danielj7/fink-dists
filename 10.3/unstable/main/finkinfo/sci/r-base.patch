--- R/src/modules/X11/dataentry.c.orig	Fri Jan 30 05:08:22 2004
+++ R/src/modules/X11/dataentry.c	Fri Jan 30 05:05:11 2004
@@ -29,7 +29,8 @@
 #include "Print.h"
 
 /* don't use X11 function prototypes (which tend to ...): */
-#define NeedFunctionPrototypes 0
+#define NeedFunctionPrototypes 1
+#include <X11/Xfuncproto.h>
 #include <X11/X.h>
 #include <X11/Xlib.h>
 #include <X11/Xutil.h>
--- R/configure.orig	Sat Apr 17 19:05:34 2004
+++ R/configure	Sat Apr 17 19:07:50 2004
@@ -28293,7 +28293,7 @@
     ##     LIBR_LDFLAGS="-dynamiclib"
 
     ## LIBR_LDFLAGS="-dynamiclib -install_name ${R_FRAMEWORK_DIR}/Versions/${PACKAGE_VERSION}/Resources/bin/libR.dylib -compatibility_version ${PACKAGE_VERSION}  -current_version ${PACKAGE_VERSION}"
-	LIBR_LDFLAGS="-dynamiclib -install_name libR.dylib -compatibility_version ${PACKAGE_VERSION}  -current_version ${PACKAGE_VERSION}  -headerpad_max_install_names"
+	LIBR_LDFLAGS="-dynamiclib -install_name  ${prefix}/R.framework/Versions/${PACKAGE_VERSION}/Resources/bin/libR.dylib -compatibility_version ${PACKAGE_VERSION}  -current_version ${PACKAGE_VERSION}  -headerpad_max_install_names"
     ##    fi
     ## <FIXME>
     ## We need '-framework Carbon' because currently the Quartz device
--- R/Makefile.in.orig	Mon Apr  5 13:39:27 2004
+++ R/Makefile.in	Wed Apr 21 05:48:34 2004
@@ -84,7 +84,7 @@
 	  $(INSTALL_DATA) $(srcdir)/$${f} $(rhome); \
 	done
 @WANT_R_FRAMEWORK_TRUE@		$(MAKE) install-R-framework
-@WANT_R_FRAMEWORK_TRUE@		@(sed 's/^LIBR =.*/LIBR = -framework R/' \
+@WANT_R_FRAMEWORK_TRUE@		@(sed 's|^LIBR =.*|LIBR = -F$(prefix) -framework R|' \
 @WANT_R_FRAMEWORK_TRUE@		  $(top_builddir)/etc/Makeconf > $(rhome)/etc/Makeconf)
 @WANT_R_FRAMEWORK_TRUE@		@(sed 's/Versions\/$(VERSION)\/Resources/Resources/' \
 @WANT_R_FRAMEWORK_TRUE@		  $(R_FRAMEWORK_DIR)/Resources/bin/R > \
@@ -189,8 +189,8 @@
 	  cp -R * "$(R_FRAMEWORK_DIR)/Resources/bin")
 	@(cd "$(R_FRAMEWORK_DIR)/Resources/bin" && \
 	  sed 's/^args=/args=--gui=aqua/' < R > RAqua && \
-	  chmod 755 RAqua && \
-	  install_name_tool -id "$(R_FRAMEWORK_DIR)/Versions/$(VERSION)/Resources/bin/libR.dylib" libR.dylib)
+	  chmod 755 RAqua)
+#  install_name_tool -id "$(R_FRAMEWORK_DIR)/Versions/$(VERSION)/Resources/bin/libR.dylib" libR.dylib)
 	@(sed 's/Versions\/$(VERSION)\/Resources/Resources/' $(R_FRAMEWORK_DIR)/Resources/bin/RAqua > \
 	  $(R_FRAMEWORK_DIR)/Resources/bin/RRAqua)
 	@(mv $(R_FRAMEWORK_DIR)/Resources/bin/RRAqua $(R_FRAMEWORK_DIR)/Resources/bin/RAqua)
@@ -201,18 +201,17 @@
 
 
 install-aqua:
-	@(rm -rf /Applications/R.app)
-	@(mkdir -p /Applications/R.app/Contents/Resources)
+	@(rm -rf $(FINKPREFIX)/Applications/R.app)
+	@(mkdir -p $(FINKPREFIX)/Applications/R.app/Contents/Resources)
 	@(cd "$(srcdir)/src/modules/aqua/Contents" && \
-	  cp PkgInfo /Applications/R.app/Contents)
+	  cp PkgInfo $(FINKPREFIX)/Applications/R.app/Contents)
 	@(cd "$(top_builddir)/src/modules/aqua/Contents" && \
-	  cp Info.plist  /Applications/R.app/Contents)
+	  cp Info.plist  $(FINKPREFIX)/Applications/R.app/Contents)
 	@(cd "$(srcdir)/src/modules/aqua/Contents/Resources" && \
-	  cp -R * /Applications/R.app/Contents/Resources)
-	@(mkdir -p /Applications/R.app/Contents/MacOS)
-	@test -f "$(R_FRAMEWORK_DIR)/Resources/bin/RAqua"  \
-	  || (echo "please, make install-R-framework first" &&  exit 1)
-	@(cd /Applications/R.app/Contents/MacOS && \
-	  ln -f -n "$(R_FRAMEWORK_DIR)/Resources/bin/RAqua" R && \
-	  chmod 755 R)
+	  cp -R * $(FINKPREFIX)/Applications/R.app/Contents/Resources)
+	@(mkdir -p $(FINKPREFIX)/Applications/R.app/Contents/MacOS)
+#@test -f "$(R_FRAMEWORK_DIR)/Resources/bin/RAqua"  \
+#  || (echo "please, make install-R-framework first" &&  exit 1)
+	@(cd $(FINKPREFIX)/Applications/R.app/Contents/MacOS && \
+	  ln -f -n -s "$(R_FRAMEWORK_DIR)/Resources/bin/RAqua" R )
 TAGS:
