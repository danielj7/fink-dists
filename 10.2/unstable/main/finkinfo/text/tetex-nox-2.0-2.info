Package: tetex-nox
Version: 2.0
Revision: 2
GCC: 3.1
Description: Base programs for teTeX, with X11 disabled
BuildDepends: t1lib1, libpng3 (>= 1.0.12-3), libwww, dlcompat-dev, tetex-dev (= %v-%r)
Depends: dlcompat-shlibs, t1lib1-shlibs, libpng3-shlibs, libwww-bin, ghostscript, fink (>= 0.9.3), tetex-texmf (>= 2.0-1), tetex-shlibs (= %v-%r)
Replaces: context, dvipdfm, epstopdf, pdftex, tetex-macosx
Provides: context, dvipdfm, epstopdf, pdftex, tetex-macosx, tetex-base
Conflicts: system-tetex, bundle-tetex, tetex-base
Provides: bundle-tetex
Replaces: bundle-tetex
Recommends: detex, ifmslide, latex2html, pdfscreen, pdfslide, ppower4, tex4ht, texpower
Suggests: foiltex
Source: ftp://cam.ctan.org/tex-archive/systems/unix/teTeX/%v/distrib/tetex-src-%v.tar.gz
Source-MD5: 47aed744f1311d49dd9fbd60581da2c4
SourceDirectory: tetex-src-%v
PatchScript: sed 's|@PREFIX@|%p|g' < %a/tetex-%v-%r.patch | patch -p1
ConfigureParams: --without-x --without-texinfo --enable-shared --datadir='${prefix}/share' --infodir='${prefix}/share/info' --mandir='${prefix}/share/man' --disable-multiplatform --with-system-ncurses --with-system-pnglib --with-system-t1lib --with-system-wwwlib --with-system-zlib
CompileScript: <<
 ./configure %c
 export DYLD_LIBRARY_PATH="%b/texk/kpathsea/SHARED" ; make
<<
InstallScript: <<
 export DYLD_LIBRARY_PATH="%b/texk/kpathsea/SHARED" ; make install prefix=%i texmf=%i/share/texmf

echo "create a local texmf tree"
 mkdir -p %i/etc/texmf.local/web2c
 chmod 775 %i/etc/texmf.local
 chmod 775 %i/etc/texmf.local/web2c
 %i/bin/mktexlsr %i/etc/texmf.local
 mkdir -p %i/etc/ls-R
 mv %i/etc/texmf.local/ls-R %i/etc/ls-R/texmf.local
 ln -s %p/etc/ls-R/texmf.local %i/etc/texmf.local/ls-R
 mkdir -p %i/share
 ln -s %p/etc/texmf.local %i/share/texmf-local

echo "the ls-R file is supplied in tetex-texmf"
 rm -f %i/share/texmf/ls-R

echo "readlink is supplied in Fink's debianutils package"
 rm -f %i/bin/readlink
 rm -f %i/share/man/man1/readlink.1

echo "prepare texi2html for the alternatives system"
 mv %i/bin/texi2html %i/bin/texi2html.tetex-base
 mv %i/share/man/man1/texi2html.1 %i/share/man/man1/texi2html.1.tetex-base

rm -Rf %i/include
rm -Rf %i/lib
<<
InfoDocs: kpathsea.info web2c.info dvips.info latex.info
DocFiles: LICENSE.src ChangeLog INSTALL PROBLEMS README QuickInstall
PostInstScript: <<
  if [ ! -e %p/share/texmf/tex/context ] ; then
    echo "UPGRADE PROBLEM: We apologize for the inconvenience, but please reinstall"
    echo "tetex-texmf and then install tetex-nox again."
    exit 1
  fi
  update-alternatives --install %p/bin/texi2html texi2html %p/bin/texi2html.tetex-base 40
  update-alternatives --install %p/share/man/man1/texi2html.1 texi2html.1 %p/share/man/man1/texi2html.1.tetex-base 40
  mktexlsr
  fmtutil --all
  texlinks
  mktexlsr
<<
PreRmScript: <<
  if [ $1 != "upgrade" ]; then
    update-alternatives --remove texi2html %p/bin/texi2html.tetex-base
    update-alternatives --remove texi2html.1 %p/share/man/man1/texi2html.1.tetex-base
  fi
  rm -f %p/share/texmf/web2c/*.efmt
  rm -f %p/share/texmf/web2c/*.log
  rm -f %p/share/texmf/web2c/*.fmt
  rm -f %p/share/texmf/web2c/*.base
  rm -f %p/share/texmf/web2c/*.mem
  rm -f %p/share/texmf/web2c/*.oft
<<
License: OSI-Approved
DescDetail: <<
TeX takes a text file and a set of formatting commands as input and 
creates a typesetter independent .dvi (DeVice Independent) file as output.
TeTeX includes higher level formatting packages such as LaTeX, since
TeX by itself is not very user-friendly.
<<
DescPort: <<
The Makefile is patched to prevent the mktexlsr, fmtutil, and texlinks
utilities from running during Fink's install phase.  They are run in the
PostInstall script.

User files are stored in $HOME/Library/texmf (not $HOME/texmf) for
backwards-compatibility with earlier Fink teTeX installations.

To build shared libraries, we give the configure flag --enable-shared, set
the DYLD_LIBRARY_PATH environment variable, and patch klibtool.

We use update-alternatives for texi2html to allow users to install a
more up-to-date version if they choose.
<<
DescPackaging: <<
 Other TeX related packages should use %p/etc/texmf.local/ as their texmf
 tree for storing files, rather than %p/share/texmf/.  In this way, the
 original texmf tree will be preserved. 

 There is a variant tetex-nox package with X11 disabled.

 texinfo is a separate package.

 readlink and its manpage are removed since they conflict with debianutils,
  an essential Fink package.

 Many thanks to the original teTeX maintainer Jeff Whitaker.
<<
Maintainer: Dave Morrison <dmrrsn@users.sourceforge.net>
Homepage: http://www.tug.org/teTeX
